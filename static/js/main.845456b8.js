/*! For license information please see main.845456b8.js.LICENSE.txt */
!function(){var t={663:function(t,e,n){var i,r=n(704).default,o=n(61).default,a=n(728).default,s=n(690).default;self,t.exports=(i=n(470),function(){"use strict";var t={228:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.AsepriteRaw=void 0,e.AsepriteRaw=function(){function t(){s(this,t)}return a(t)}()},103:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function s(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.AsepriteResource=void 0;var r=n(205),l=n(758);e.AsepriteResource=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];s(this,t),this.bustCache=n,this._resource=new r.Resource(e,"json",n),this.convertPath=function(t,e){if(0===e.indexOf("/"))return e;var n=t.split("/"),i=e.split("/");return n[n.length-1].includes(".")&&n.pop(),n.concat(i).join("/")}}return a(t,[{key:"load",value:function(){return i(this,void 0,void 0,o().mark((function t(){var e,n,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._resource.load();case 2:return e=t.sent,n=this.convertPath(this._resource.path,e.meta.image),i=new r.ImageSource(n,this.bustCache),t.next=7,i.load();case 7:return this.rawAseprite=e,this.image=i,t.abrupt("return",this.data=new l.AsepriteSpriteSheet(e,i));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"getSpriteSheet",value:function(){if(this.isLoaded())return this.data.getSpriteSheet();r.Logger.getInstance().warn("AspriteResource must be loaded before .getSpriteSheet() is called")}},{key:"getAnimation",value:function(t){if(this.isLoaded())return this.data.getAnimation(t);r.Logger.getInstance().warn("AspriteResource must be loaded before .getAnimation() is called")}},{key:"isLoaded",value:function(){return!!this.data}}]),t}()},758:function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.AsepriteSpriteSheet=void 0;var i=n(205);e.AsepriteSpriteSheet=function(){function t(e,n){var o=this;s(this,t),this.asepriteRaw=e,this.image=n,this._animations=new Map;var a,l=r(e.meta.frameTags);try{var u=function(){var t=a.value,r=t.from,s=t.to,l=(0,i.range)(r,s),u=Object.values(e.frames).filter((function(t,e){return l.includes(e)})).map((function(t){return{duration:t.duration,graphic:new i.Sprite({image:n,sourceView:{x:t.frame.x,y:t.frame.y,width:t.frame.w,height:t.frame.h},destSize:{width:t.frame.w,height:t.frame.h}})}})),c=i.AnimationStrategy.Loop;switch(t.direction){case"pingpong":c=i.AnimationStrategy.PingPong;break;case"reverse":u.reverse()}o._animations.set(t.name,new i.Animation({frames:u,strategy:c}))};for(l.s();!(a=l.n()).done;)u()}catch(p){l.e(p)}finally{l.f()}for(var c=[],h=0,d=Object.values(e.frames);h<d.length;h++){var f=d[h];c.push(new i.Sprite({image:n,sourceView:{x:f.frame.x,y:f.frame.y,width:f.frame.w,height:f.frame.h}}))}this._spriteSheet=new i.SpriteSheet({sprites:c,rows:e.meta.size.h/c[0].height,columns:e.meta.size.w/c[0].width})}return a(t,[{key:"getSpriteSheet",value:function(){return this._spriteSheet}},{key:"getAnimation",value:function(t){if(!this._animations.has(t))throw new Error("No animation exists with name ".concat(t,", check your exported Aseprite file"));return this._animations.get(t)}}]),t}()},607:function(t,e,n){var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(n(228),e),r(n(103),e),r(n(758),e)},205:function(t){t.exports=i}},e={};return function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,n),o.exports}(607)}())},470:function(t,e,n){"use strict";n.r(e),n.d(e,{ActionContext:function(){return E},ActionQueue:function(){return T},ActionSequence:function(){return P},ActionsComponent:function(){return I},ActionsSystem:function(){return Z},ActivateEvent:function(){return R},Actor:function(){return M},AddedComponent:function(){return F},AddedEntity:function(){return D},AffineMatrix:function(){return B},Animation:function(){return z},AnimationDirection:function(){return L},AnimationStrategy:function(){return O},ArcadeSolver:function(){return N},AudioContextFactory:function(){return U},Axis:function(){return H},BaseAlign:function(){return W},Blink:function(){return V},BodyComponent:function(){return X},BoundingBox:function(){return G},BroadphaseStrategy:function(){return j},BrowserComponent:function(){return q},BrowserEvents:function(){return Y},Camera:function(){return K},Canvas:function(){return Q},Circle:function(){return J},CircleCollider:function(){return $},Class:function(){return tt},Clock:function(){return et},ClosestLine:function(){return nt},ClosestLineJumpTable:function(){return it},Collider:function(){return rt},ColliderComponent:function(){return ot},CollisionContact:function(){return at},CollisionEndEvent:function(){return st},CollisionGroup:function(){return lt},CollisionGroupManager:function(){return ut},CollisionJumpTable:function(){return ct},CollisionPostSolveEvent:function(){return ht},CollisionPreSolveEvent:function(){return dt},CollisionResolutionStrategy:function(){return ft},CollisionStartEvent:function(){return pt},CollisionSystem:function(){return vt},CollisionType:function(){return gt},Color:function(){return yt},ColorBlindFlags:function(){return mt},ColorBlindnessMode:function(){return _t},ColorBlindnessPostProcessor:function(){return wt},Component:function(){return xt},CompositeCollider:function(){return bt},Configurable:function(){return kt},ConsoleAppender:function(){return Ct},ContactConstraintPoint:function(){return St},ContactEndEvent:function(){return At},ContactStartEvent:function(){return Et},CoordPlane:function(){return Tt},DeactivateEvent:function(){return Pt},Debug:function(){return It},DebugGraphicsComponent:function(){return Zt},DebugSystem:function(){return Rt},DebugText:function(){return Mt},DegreeOfFreedom:function(){return Ft},Delay:function(){return Dt},Detector:function(){return Bt},Die:function(){return zt},Direction:function(){return Lt},DisplayMode:function(){return Ot},DynamicTree:function(){return Nt},DynamicTreeCollisionProcessor:function(){return Ut},EX_VERSION:function(){return Ht},EaseBy:function(){return Wt},EaseTo:function(){return Vt},EasingFunctions:function(){return Xt},EdgeCollider:function(){return Gt},ElasticToActorStrategy:function(){return jt},EmitterType:function(){return qt},Engine:function(){return Yt},EnterTriggerEvent:function(){return Kt},EnterViewPortEvent:function(){return Qt},Entity:function(){return Jt},EntityManager:function(){return $t},EventDispatcher:function(){return te},EventTypes:function(){return ee},Events:function(){return ne},ExResponse:function(){return ie},ExcaliburGraphicsContext2DCanvas:function(){return re},ExcaliburGraphicsContextWebGL:function(){return oe},ExcaliburWebGLContextAccessor:function(){return ae},ExitTriggerEvent:function(){return se},ExitViewPortEvent:function(){return le},Fade:function(){return ue},Flags:function(){return ce},Follow:function(){return he},Font:function(){return de},FontStyle:function(){return fe},FontUnit:function(){return pe},FpsSampler:function(){return ve},FrameStats:function(){return ge},Future:function(){return ye},GameEvent:function(){return me},GameStartEvent:function(){return _e},GameStopEvent:function(){return we},GamepadAxisEvent:function(){return xe},GamepadButtonEvent:function(){return be},GamepadConnectEvent:function(){return ke},GamepadDisconnectEvent:function(){return Ce},Gif:function(){return Se},GlobalCoordinates:function(){return Ae},Graphic:function(){return Ee},GraphicsComponent:function(){return Te},GraphicsGroup:function(){return Pe},GraphicsLayer:function(){return Ie},GraphicsLayers:function(){return Ze},GraphicsSystem:function(){return Re},HiddenEvent:function(){return Me},ImageFiltering:function(){return Fe},ImageSource:function(){return De},InitializeEvent:function(){return Be},Input:function(){return ze},Integrator:function(){return Le},IsometricEntityComponent:function(){return Oe},IsometricEntitySystem:function(){return Ne},IsometricMap:function(){return Ue},IsometricTile:function(){return He},KillEvent:function(){return We},Label:function(){return Ve},LimitCameraBoundsStrategy:function(){return Xe},Line:function(){return Ge},LineSegment:function(){return je},Loader:function(){return qe},LockCameraToActorAxisStrategy:function(){return Ye},LockCameraToActorStrategy:function(){return Ke},LogLevel:function(){return Qe},Logger:function(){return Je},Matrix:function(){return $e},MatrixLocations:function(){return tn},MediaEvent:function(){return en},Meet:function(){return nn},MotionComponent:function(){return rn},MotionSystem:function(){return on},MoveBy:function(){return an},MoveTo:function(){return sn},NativeSoundEvent:function(){return ln},NativeSoundProcessedEvent:function(){return un},Observable:function(){return cn},OffscreenSystem:function(){return hn},Pair:function(){return dn},ParallaxComponent:function(){return fn},ParallelActions:function(){return pn},ParseGif:function(){return vn},Particle:function(){return gn},ParticleEmitter:function(){return yn},Physics:function(){return mn},PhysicsStats:function(){return _n},PointerComponent:function(){return wn},PointerSystem:function(){return xn},Polygon:function(){return bn},PolygonCollider:function(){return kn},Pool:function(){return Cn},PostCollisionEvent:function(){return Sn},PostDebugDrawEvent:function(){return An},PostDrawEvent:function(){return En},PostFrameEvent:function(){return Tn},PostKillEvent:function(){return Pn},PostUpdateEvent:function(){return In},PreCollisionEvent:function(){return Zn},PreDebugDrawEvent:function(){return Rn},PreDrawEvent:function(){return Mn},PreFrameEvent:function(){return Fn},PreKillEvent:function(){return Dn},PreUpdateEvent:function(){return Bn},Projection:function(){return zn},QuadIndexBuffer:function(){return Ln},Query:function(){return On},QueryManager:function(){return Nn},RadiusAroundActorStrategy:function(){return Un},Random:function(){return Hn},Raster:function(){return Wn},Ray:function(){return Vn},RealisticSolver:function(){return Xn},Rectangle:function(){return Gn},RemovedComponent:function(){return jn},RemovedEntity:function(){return qn},Repeat:function(){return Yn},RepeatForever:function(){return Kn},Resolution:function(){return Qn},Resource:function(){return Jn},RotateBy:function(){return $n},RotateTo:function(){return ti},RotationType:function(){return ei},ScaleBy:function(){return ni},ScaleTo:function(){return ii},Scene:function(){return ri},Screen:function(){return oi},ScreenAppender:function(){return ai},ScreenElement:function(){return si},ScreenShader:function(){return li},ScrollPreventionMode:function(){return ui},Semaphore:function(){return ci},Shader:function(){return hi},Shape:function(){return di},Side:function(){return fi},Sound:function(){return pi},Sprite:function(){return vi},SpriteFont:function(){return gi},SpriteSheet:function(){return yi},StandardClock:function(){return mi},StateMachine:function(){return _i},StrategyContainer:function(){return wi},Stream:function(){return xi},System:function(){return bi},SystemManager:function(){return ki},SystemType:function(){return Ci},TagComponent:function(){return Si},TestClock:function(){return Ai},Text:function(){return Ei},TextAlign:function(){return Ti},TextureLoader:function(){return Pi},Tile:function(){return Ii},TileMap:function(){return Zi},Timer:function(){return Ri},Toaster:function(){return Mi},Transform:function(){return Fi},TransformComponent:function(){return Di},TreeNode:function(){return Bi},Trigger:function(){return zi},TwoPI:function(){return Li},Util:function(){return Oi},Vector:function(){return Ni},VectorView:function(){return Ui},VertexBuffer:function(){return Hi},VertexLayout:function(){return Wi},VisibleEvent:function(){return Vi},WebAudio:function(){return Xi},WebAudioInstance:function(){return Gi},World:function(){return ji},canonicalizeAngle:function(){return qi},clamp:function(){return Yi},createId:function(){return Ki},frac:function(){return Qi},hasGraphicsTick:function(){return Ji},hasOnInitialize:function(){return $i},hasOnPostUpdate:function(){return tr},hasOnPreUpdate:function(){return er},hasPostDraw:function(){return nr},hasPreDraw:function(){return ir},has_initialize:function(){return rr},has_postupdate:function(){return or},has_preupdate:function(){return ar},isAddedComponent:function(){return sr},isAddedSystemEntity:function(){return lr},isRemoveSystemEntity:function(){return ur},isRemovedComponent:function(){return cr},isScreenElement:function(){return hr},maxMessages:function(){return dr},obsolete:function(){return fr},pixelSnapEpsilon:function(){return pr},randomInRange:function(){return vr},randomIntInRange:function(){return gr},range:function(){return yr},resetObsoleteCounter:function(){return mr},sign:function(){return _r},toDegrees:function(){return wr},toRadians:function(){return xr},vec:function(){return br},webgl:function(){return kr}});var i=n(963),r=n(326),o=n(885),a=n(2);function s(){s=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(T){u=function(t,e,n){return t[e]=n}}function c(t,e,n,i){var r=e&&e.prototype instanceof f?e:f,o=Object.create(r.prototype),a=new S(i||[]);return o._invoke=function(t,e,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return E()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=b(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=h(t,e,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}(t,n,a),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(T){return{type:"throw",arg:T}}}t.wrap=c;var d={};function f(){}function p(){}function v(){}var g={};u(g,r,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(A([])));m&&m!==e&&n.call(m,r)&&(g=m);var _=v.prototype=f.prototype=Object.create(g);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function i(r,o,s,l){var u=h(t[r],t,o);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==(0,a.Z)(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){i("next",t,s,l)}),(function(t){i("throw",t,s,l)})):e.resolve(d).then((function(t){c.value=t,s(c)}),(function(t){return i("throw",t,s,l)}))}l(u.arg)}var r;this._invoke=function(t,n){function o(){return new e((function(e,r){i(t,n,e,r)}))}return r=r?r.then(o,o):o()}}function b(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,b(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=h(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function A(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return p.prototype=v,u(_,"constructor",v),u(v,"constructor",p),p.displayName=u(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,l,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},w(x.prototype),u(x.prototype,o,(function(){return this})),t.AsyncIterator=x,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var a=new x(c(e,n,i,r),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(_),u(_,l,"Generator"),u(_,r,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=A,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(n,i){return a.type="throw",a.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),C(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;C(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:A(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function l(t,e,n,i,r,o,a){try{var s=t[o](a),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(i,r)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function a(t){l(o,i,r,a,s,"next",t)}function s(t){l(o,i,r,a,s,"throw",t)}a(void 0)}))}}var c=n(942);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){(0,c.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f=n(301),p=n(415);function v(t,e,n,i){return v="undefined"!==typeof Reflect&&Reflect.set?Reflect.set:function(t,e,n,i){var r,o=(0,p.Z)(t,e);if(o){if((r=Object.getOwnPropertyDescriptor(o,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(i,e)){if(!r.writable)return!1;r.value=n,Object.defineProperty(i,e,r)}else(0,c.Z)(i,e,n);return!0},v(t,e,n,i)}function g(t,e,n,i,r){if(!v(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}var y=n(120),m=n(762),_=n(340),w=n(62),x=n(982),b=n(671),k=n(144),C={4662:function(t,e,n){n(3430);var i=n(8791);t.exports=i("Array","sort")},8343:function(t,e,n){n(4769);var i=n(9276);t.exports=i.Object.keys},7111:function(t,e,n){var i=n(6733),r=n(9821),o=TypeError;t.exports=function(t){if(i(t))return t;throw o(r(t)+" is not a function")}},1176:function(t,e,n){var i=n(5052),r=String,o=TypeError;t.exports=function(t){if(i(t))return t;throw o(r(t)+" is not an object")}},9540:function(t,e,n){var i=n(905),r=n(3231),o=n(9646),a=function(t){return function(e,n,a){var s,l=i(e),u=o(l),c=r(a,u);if(t&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},6038:function(t,e,n){var i=n(4229);t.exports=function(t,e){var n=[][t];return!!n&&i((function(){n.call(null,e||function(){return 1},1)}))}},9794:function(t,e,n){var i=n(3231),r=n(9646),o=n(2324),a=Array,s=Math.max;t.exports=function(t,e,n){for(var l=r(t),u=i(e,l),c=i(void 0===n?l:n,l),h=a(s(c-u,0)),d=0;u<c;u++,d++)o(h,d,t[u]);return h.length=d,h}},3867:function(t,e,n){var i=n(9794),r=Math.floor,o=function(t,e){for(var n,i,r=t.length,o=1;o<r;){for(i=o,n=t[o];i&&e(t[i-1],n)>0;)t[i]=t[--i];i!==o++&&(t[i]=n)}return t},a=function(t,e,n,i){for(var r=e.length,o=n.length,a=0,s=0;a<r||s<o;)t[a+s]=a<r&&s<o?i(e[a],n[s])<=0?e[a++]:n[s++]:a<r?e[a++]:n[s++];return t};t.exports=function t(e,n){var s=e.length,l=r(s/2);return s<8?o(e,n):a(e,t(i(e,0,l),n),t(i(e,l),n),n)}},7079:function(t,e,n){var i=n(5968),r=i({}.toString),o=i("".slice);t.exports=function(t){return o(r(t),8,-1)}},1589:function(t,e,n){var i=n(1601),r=n(6733),o=n(7079),a=n(95)("toStringTag"),s=Object,l="Arguments"==o(function(){return arguments}());t.exports=i?o:function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(n){}}(e=s(t),a))?n:l?o(e):"Object"==(i=o(e))&&r(e.callee)?"Arguments":i}},7081:function(t,e,n){var i=n(8270),r=n(4826),o=n(7933),a=n(1787);t.exports=function(t,e,n){for(var s=r(e),l=a.f,u=o.f,c=0;c<s.length;c++){var h=s[c];i(t,h)||n&&i(n,h)||l(t,h,u(e,h))}}},5762:function(t,e,n){var i=n(7400),r=n(1787),o=n(5358);t.exports=i?function(t,e,n){return r.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},5358:function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},2324:function(t,e,n){var i=n(9310),r=n(1787),o=n(5358);t.exports=function(t,e,n){var a=i(e);a in t?r.f(t,a,o(0,n)):t[a]=n}},4768:function(t,e,n){var i=n(6733),r=n(1787),o=n(6039),a=n(8400);t.exports=function(t,e,n,s){s||(s={});var l=s.enumerable,u=void 0!==s.name?s.name:e;if(i(n)&&o(n,u,s),s.global)l?t[e]=n:a(e,n);else{try{s.unsafe?t[e]&&(l=!0):delete t[e]}catch(c){}l?t[e]=n:r.f(t,e,{value:n,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return t}},8400:function(t,e,n){var i=n(9859),r=Object.defineProperty;t.exports=function(t,e){try{r(i,t,{value:e,configurable:!0,writable:!0})}catch(n){i[t]=e}return e}},9563:function(t,e,n){var i=n(9821),r=TypeError;t.exports=function(t,e){if(!delete t[e])throw r("Cannot delete property "+i(e)+" of "+i(t))}},7400:function(t,e,n){var i=n(4229);t.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},2635:function(t,e,n){var i=n(9859),r=n(5052),o=i.document,a=r(o)&&r(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},2671:function(t,e,n){var i=n(598).match(/firefox\/(\d+)/i);t.exports=!!i&&+i[1]},8506:function(t,e,n){var i=n(598);t.exports=/MSIE|Trident/.test(i)},598:function(t,e,n){var i=n(1333);t.exports=i("navigator","userAgent")||""},6358:function(t,e,n){var i,r,o=n(9859),a=n(598),s=o.process,l=o.Deno,u=s&&s.versions||l&&l.version,c=u&&u.v8;c&&(r=(i=c.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!r&&a&&(!(i=a.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=a.match(/Chrome\/(\d+)/))&&(r=+i[1]),t.exports=r},9811:function(t,e,n){var i=n(598).match(/AppleWebKit\/(\d+)\./);t.exports=!!i&&+i[1]},8791:function(t,e,n){var i=n(9859),r=n(5968);t.exports=function(t,e){return r(i[t].prototype[e])}},3837:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3103:function(t,e,n){var i=n(9859),r=n(7933).f,o=n(5762),a=n(4768),s=n(8400),l=n(7081),u=n(6541);t.exports=function(t,e){var n,c,h,d,f,p=t.target,v=t.global,g=t.stat;if(n=v?i:g?i[p]||s(p,{}):(i[p]||{}).prototype)for(c in e){if(d=e[c],h=t.dontCallGetSet?(f=r(n,c))&&f.value:n[c],!u(v?c:p+(g?".":"#")+c,t.forced)&&void 0!==h){if(typeof d==typeof h)continue;l(d,h)}(t.sham||h&&h.sham)&&o(d,"sham",!0),a(n,c,d,t)}}},4229:function(t){t.exports=function(t){try{return!!t()}catch(e){return!0}}},7188:function(t,e,n){var i=n(4229);t.exports=!i((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},266:function(t,e,n){var i=n(7188),r=Function.prototype.call;t.exports=i?r.bind(r):function(){return r.apply(r,arguments)}},1805:function(t,e,n){var i=n(7400),r=n(8270),o=Function.prototype,a=i&&Object.getOwnPropertyDescriptor,s=r(o,"name"),l=s&&"something"===function(){}.name,u=s&&(!i||i&&a(o,"name").configurable);t.exports={EXISTS:s,PROPER:l,CONFIGURABLE:u}},5968:function(t,e,n){var i=n(7188),r=Function.prototype,o=r.bind,a=r.call,s=i&&o.bind(a,a);t.exports=i?function(t){return t&&s(t)}:function(t){return t&&function(){return a.apply(t,arguments)}}},1333:function(t,e,n){var i=n(9859),r=n(6733),o=function(t){return r(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?o(i[t]):i[t]&&i[t][e]}},5300:function(t,e,n){var i=n(7111);t.exports=function(t,e){var n=t[e];return null==n?void 0:i(n)}},9859:function(t,e,n){var i=function(t){return t&&t.Math==Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},8270:function(t,e,n){var i=n(5968),r=n(2991),o=i({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return o(r(t),e)}},5977:function(t){t.exports={}},4394:function(t,e,n){var i=n(7400),r=n(4229),o=n(2635);t.exports=!i&&!r((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},9337:function(t,e,n){var i=n(5968),r=n(4229),o=n(7079),a=Object,s=i("".split);t.exports=r((function(){return!a("z").propertyIsEnumerable(0)}))?function(t){return"String"==o(t)?s(t,""):a(t)}:a},8511:function(t,e,n){var i=n(5968),r=n(6733),o=n(5353),a=i(Function.toString);r(o.inspectSource)||(o.inspectSource=function(t){return a(t)}),t.exports=o.inspectSource},6407:function(t,e,n){var i,r,o,a=n(8694),s=n(9859),l=n(5968),u=n(5052),c=n(5762),h=n(8270),d=n(5353),f=n(4399),p=n(5977),v="Object already initialized",g=s.TypeError,y=s.WeakMap;if(a||d.state){var m=d.state||(d.state=new y),_=l(m.get),w=l(m.has),x=l(m.set);i=function(t,e){if(w(m,t))throw new g(v);return e.facade=t,x(m,t,e),e},r=function(t){return _(m,t)||{}},o=function(t){return w(m,t)}}else{var b=f("state");p[b]=!0,i=function(t,e){if(h(t,b))throw new g(v);return e.facade=t,c(t,b,e),e},r=function(t){return h(t,b)?t[b]:{}},o=function(t){return h(t,b)}}t.exports={set:i,get:r,has:o,enforce:function(t){return o(t)?r(t):i(t,{})},getterFor:function(t){return function(e){var n;if(!u(e)||(n=r(e)).type!==t)throw g("Incompatible receiver, "+t+" required");return n}}}},6733:function(t){t.exports=function(t){return"function"==typeof t}},6541:function(t,e,n){var i=n(4229),r=n(6733),o=/#|\.prototype\./,a=function(t,e){var n=l[s(t)];return n==c||n!=u&&(r(e)?i(e):!!e)},s=a.normalize=function(t){return String(t).replace(o,".").toLowerCase()},l=a.data={},u=a.NATIVE="N",c=a.POLYFILL="P";t.exports=a},5052:function(t,e,n){var i=n(6733);t.exports=function(t){return"object"==typeof t?null!==t:i(t)}},4231:function(t){t.exports=!1},9395:function(t,e,n){var i=n(1333),r=n(6733),o=n(1321),a=n(6969),s=Object;t.exports=a?function(t){return"symbol"==typeof t}:function(t){var e=i("Symbol");return r(e)&&o(e.prototype,s(t))}},9646:function(t,e,n){var i=n(4237);t.exports=function(t){return i(t.length)}},6039:function(t,e,n){var i=n(4229),r=n(6733),o=n(8270),a=n(7400),s=n(1805).CONFIGURABLE,l=n(8511),u=n(6407),c=u.enforce,h=u.get,d=Object.defineProperty,f=a&&!i((function(){return 8!==d((function(){}),"length",{value:8}).length})),p=String(String).split("String"),v=t.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!o(t,"name")||s&&t.name!==e)&&(a?d(t,"name",{value:e,configurable:!0}):t.name=e),f&&n&&o(n,"arity")&&t.length!==n.arity&&d(t,"length",{value:n.arity});try{n&&o(n,"constructor")&&n.constructor?a&&d(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(r){}var i=c(t);return o(i,"source")||(i.source=p.join("string"==typeof e?e:"")),t};Function.prototype.toString=v((function(){return r(this)&&h(this).source||l(this)}),"toString")},917:function(t){var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var i=+t;return(i>0?n:e)(i)}},3839:function(t,e,n){var i=n(6358),r=n(4229);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},8694:function(t,e,n){var i=n(9859),r=n(6733),o=n(8511),a=i.WeakMap;t.exports=r(a)&&/native code/.test(o(a))},1787:function(t,e,n){var i=n(7400),r=n(4394),o=n(7137),a=n(1176),s=n(9310),l=TypeError,u=Object.defineProperty,c=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",f="writable";e.f=i?o?function(t,e,n){if(a(t),e=s(e),a(n),"function"===typeof t&&"prototype"===e&&"value"in n&&f in n&&!n.writable){var i=c(t,e);i&&i.writable&&(t[e]=n.value,n={configurable:d in n?n.configurable:i.configurable,enumerable:h in n?n.enumerable:i.enumerable,writable:!1})}return u(t,e,n)}:u:function(t,e,n){if(a(t),e=s(e),a(n),r)try{return u(t,e,n)}catch(i){}if("get"in n||"set"in n)throw l("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},7933:function(t,e,n){var i=n(7400),r=n(266),o=n(9195),a=n(5358),s=n(905),l=n(9310),u=n(8270),c=n(4394),h=Object.getOwnPropertyDescriptor;e.f=i?h:function(t,e){if(t=s(t),e=l(e),c)try{return h(t,e)}catch(n){}if(u(t,e))return a(!r(o.f,t,e),t[e])}},8151:function(t,e,n){var i=n(140),r=n(3837).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},894:function(t,e){e.f=Object.getOwnPropertySymbols},1321:function(t,e,n){var i=n(5968);t.exports=i({}.isPrototypeOf)},140:function(t,e,n){var i=n(5968),r=n(8270),o=n(905),a=n(9540).indexOf,s=n(5977),l=i([].push);t.exports=function(t,e){var n,i=o(t),u=0,c=[];for(n in i)!r(s,n)&&r(i,n)&&l(c,n);for(;e.length>u;)r(i,n=e[u++])&&(~a(c,n)||l(c,n));return c}},5632:function(t,e,n){var i=n(140),r=n(3837);t.exports=Object.keys||function(t){return i(t,r)}},9195:function(t,e){var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,r=i&&!n.call({1:2},1);e.f=r?function(t){var e=i(this,t);return!!e&&e.enumerable}:n},2914:function(t,e,n){var i=n(266),r=n(6733),o=n(5052),a=TypeError;t.exports=function(t,e){var n,s;if("string"===e&&r(n=t.toString)&&!o(s=i(n,t)))return s;if(r(n=t.valueOf)&&!o(s=i(n,t)))return s;if("string"!==e&&r(n=t.toString)&&!o(s=i(n,t)))return s;throw a("Can't convert object to primitive value")}},4826:function(t,e,n){var i=n(1333),r=n(5968),o=n(8151),a=n(894),s=n(1176),l=r([].concat);t.exports=i("Reflect","ownKeys")||function(t){var e=o.f(s(t)),n=a.f;return n?l(e,n(t)):e}},9276:function(t,e,n){var i=n(9859);t.exports=i},8885:function(t){var e=TypeError;t.exports=function(t){if(void 0==t)throw e("Can't call method on "+t);return t}},4399:function(t,e,n){var i=n(3036),r=n(1441),o=i("keys");t.exports=function(t){return o[t]||(o[t]=r(t))}},5353:function(t,e,n){var i=n(9859),r=n(8400),o="__core-js_shared__",a=i[o]||r(o,{});t.exports=a},3036:function(t,e,n){var i=n(4231),r=n(5353);(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.23.3",mode:i?"pure":"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.3/LICENSE",source:"https://github.com/zloirock/core-js"})},3231:function(t,e,n){var i=n(3329),r=Math.max,o=Math.min;t.exports=function(t,e){var n=i(t);return n<0?r(n+e,0):o(n,e)}},905:function(t,e,n){var i=n(9337),r=n(8885);t.exports=function(t){return i(r(t))}},3329:function(t,e,n){var i=n(917);t.exports=function(t){var e=+t;return e!==e||0===e?0:i(e)}},4237:function(t,e,n){var i=n(3329),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},2991:function(t,e,n){var i=n(8885),r=Object;t.exports=function(t){return r(i(t))}},2066:function(t,e,n){var i=n(266),r=n(5052),o=n(9395),a=n(5300),s=n(2914),l=n(95),u=TypeError,c=l("toPrimitive");t.exports=function(t,e){if(!r(t)||o(t))return t;var n,l=a(t,c);if(l){if(void 0===e&&(e="default"),n=i(l,t,e),!r(n)||o(n))return n;throw u("Can't convert object to primitive value")}return void 0===e&&(e="number"),s(t,e)}},9310:function(t,e,n){var i=n(2066),r=n(9395);t.exports=function(t){var e=i(t,"string");return r(e)?e:e+""}},1601:function(t,e,n){var i={};i[n(95)("toStringTag")]="z",t.exports="[object z]"===String(i)},3326:function(t,e,n){var i=n(1589),r=String;t.exports=function(t){if("Symbol"===i(t))throw TypeError("Cannot convert a Symbol value to a string");return r(t)}},9821:function(t){var e=String;t.exports=function(t){try{return e(t)}catch(n){return"Object"}}},1441:function(t,e,n){var i=n(5968),r=0,o=Math.random(),a=i(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+a(++r+o,36)}},6969:function(t,e,n){var i=n(3839);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7137:function(t,e,n){var i=n(7400),r=n(4229);t.exports=i&&r((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},95:function(t,e,n){var i=n(9859),r=n(3036),o=n(8270),a=n(1441),s=n(3839),l=n(6969),u=r("wks"),c=i.Symbol,h=c&&c.for,d=l?c:c&&c.withoutSetter||a;t.exports=function(t){if(!o(u,t)||!s&&"string"!=typeof u[t]){var e="Symbol."+t;s&&o(c,t)?u[t]=c[t]:u[t]=l&&h?h(e):d(e)}return u[t]}},3430:function(t,e,n){var i=n(3103),r=n(5968),o=n(7111),a=n(2991),s=n(9646),l=n(9563),u=n(3326),c=n(4229),h=n(3867),d=n(6038),f=n(2671),p=n(8506),v=n(6358),g=n(9811),y=[],m=r(y.sort),_=r(y.push),w=c((function(){y.sort(void 0)})),x=c((function(){y.sort(null)})),b=d("sort"),k=!c((function(){if(v)return v<70;if(!(f&&f>3)){if(p)return!0;if(g)return g<603;var t,e,n,i,r="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)y.push({k:e+i,v:n})}for(y.sort((function(t,e){return e.v-t.v})),i=0;i<y.length;i++)e=y[i].k.charAt(0),r.charAt(r.length-1)!==e&&(r+=e);return"DGBEFHACIJK"!==r}}));i({target:"Array",proto:!0,forced:w||!x||!b||!k},{sort:function(t){void 0!==t&&o(t);var e=a(this);if(k)return void 0===t?m(e):m(e,t);var n,i,r=[],c=s(e);for(i=0;i<c;i++)i in e&&_(r,e[i]);for(h(r,function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:u(e)>u(n)?1:-1}}(t)),n=r.length,i=0;i<n;)e[i]=r[i++];for(;i<c;)l(e,i++);return e}})},4769:function(t,e,n){var i=n(3103),r=n(2991),o=n(5632);i({target:"Object",stat:!0,forced:n(4229)((function(){o(1)}))},{keys:function(t){return o(r(t))}})},1388:function(t,e,n){n.d(e,{Z:function(){return s}});var i=n(272),r=n.n(i),o=n(2609),a=n.n(o)()(r());a.push([t.id,"/* Buttons styles start */\r\n\r\nbutton#excalibur-play {\r\n  display: inline-block;\r\n  position: relative;\r\n  z-index: 999;\r\n  border-radius: 6px;\r\n  border: none;\r\n  /*border: 3px solid;\r\n    border-color: white;\r\n    box-shadow: 0 0 10px #ccc;*/\r\n  padding: 1rem 1.5rem 1rem 4rem;\r\n  margin: 0;\r\n  text-decoration: none;\r\n  background: #00b233;\r\n  color: #ffffff;\r\n  font-family: sans-serif;\r\n  font-size: 2rem;\r\n  white-space: nowrap;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  transition: background 250ms ease-in-out, transform 150ms ease;\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n\r\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r\n  animation: excalibur-button-fadein 200ms;\r\n}\r\n\r\n/*\r\nbutton#excalibur-play {\r\n  display: none;\r\n}*/\r\n\r\nbutton#excalibur-play:after {\r\n  position: absolute;\r\n  content: '';\r\n  border: 8px solid;\r\n  border-color: transparent transparent transparent white;\r\n  left: 35px;\r\n  top: 24px;\r\n  width: 0;\r\n  height: 0;\r\n}\r\n\r\nbutton#excalibur-play:before {\r\n  position: absolute;\r\n  content: '';\r\n  border: 3px solid;\r\n  left: 19px;\r\n  top: 14px;\r\n  border-radius: 20px;\r\n  width: 30px;\r\n  height: 30px;\r\n}\r\n\r\nbutton#excalibur-play:hover,\r\nbutton#excalibur-play:focus {\r\n  background: #00982c;\r\n}\r\n\r\nbutton#excalibur-play:focus {\r\n  outline: 1px solid #fff;\r\n  outline-offset: -4px;\r\n}\r\n\r\nbutton#excalibur-play:active {\r\n  transform: scale(0.99);\r\n}\r\n\r\n@keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Firefox < 16 */\r\n@-moz-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Safari, Chrome and Opera > 12.1 */\r\n@-webkit-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Internet Explorer */\r\n@-ms-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Opera < 12.1 */\r\n@-o-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n","",{version:3,sources:["webpack://./Loader.css"],names:[],mappings:"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF",sourcesContent:["/* Buttons styles start */\r\n\r\nbutton#excalibur-play {\r\n  display: inline-block;\r\n  position: relative;\r\n  z-index: 999;\r\n  border-radius: 6px;\r\n  border: none;\r\n  /*border: 3px solid;\r\n    border-color: white;\r\n    box-shadow: 0 0 10px #ccc;*/\r\n  padding: 1rem 1.5rem 1rem 4rem;\r\n  margin: 0;\r\n  text-decoration: none;\r\n  background: #00b233;\r\n  color: #ffffff;\r\n  font-family: sans-serif;\r\n  font-size: 2rem;\r\n  white-space: nowrap;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  transition: background 250ms ease-in-out, transform 150ms ease;\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n\r\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r\n  animation: excalibur-button-fadein 200ms;\r\n}\r\n\r\n/*\r\nbutton#excalibur-play {\r\n  display: none;\r\n}*/\r\n\r\nbutton#excalibur-play:after {\r\n  position: absolute;\r\n  content: '';\r\n  border: 8px solid;\r\n  border-color: transparent transparent transparent white;\r\n  left: 35px;\r\n  top: 24px;\r\n  width: 0;\r\n  height: 0;\r\n}\r\n\r\nbutton#excalibur-play:before {\r\n  position: absolute;\r\n  content: '';\r\n  border: 3px solid;\r\n  left: 19px;\r\n  top: 14px;\r\n  border-radius: 20px;\r\n  width: 30px;\r\n  height: 30px;\r\n}\r\n\r\nbutton#excalibur-play:hover,\r\nbutton#excalibur-play:focus {\r\n  background: #00982c;\r\n}\r\n\r\nbutton#excalibur-play:focus {\r\n  outline: 1px solid #fff;\r\n  outline-offset: -4px;\r\n}\r\n\r\nbutton#excalibur-play:active {\r\n  transform: scale(0.99);\r\n}\r\n\r\n@keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Firefox < 16 */\r\n@-moz-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Safari, Chrome and Opera > 12.1 */\r\n@-webkit-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Internet Explorer */\r\n@-ms-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Opera < 12.1 */\r\n@-o-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n"],sourceRoot:""}]);var s=a},7379:function(t,e,n){n.d(e,{Z:function(){return s}});var i=n(272),r=n.n(i),o=n(2609),a=n.n(o)()(r());a.push([t.id,"\r\n#ex-toast-container {\r\n  position: absolute;\r\n  height: 0;\r\n  min-width: 50%;\r\n  left: 50%;\r\n  top: 0;\r\n}\r\n\r\n.ex-toast-message {\r\n  left: -50%;\r\n  position: relative;\r\n  display: flex;\r\n  justify-content: space-between;\r\n\r\n\r\n  padding: 10px;\r\n  margin-top: 5px;\r\n  font-size: 18px;\r\n  font-family: sans-serif;\r\n  border-radius: 6px;\r\n  border: 3px solid #b7b779;\r\n  background-color: rgb(253, 253, 192);\r\n}\r\n\r\n\r\n.ex-toast-message button {\r\n  align-self: flex-start;\r\n}","",{version:3,sources:["webpack://./Util/Toaster.css"],names:[],mappings:";AACA;EACE,kBAAkB;EAClB,SAAS;EACT,cAAc;EACd,SAAS;EACT,MAAM;AACR;;AAEA;EACE,UAAU;EACV,kBAAkB;EAClB,aAAa;EACb,8BAA8B;;;EAG9B,aAAa;EACb,eAAe;EACf,eAAe;EACf,uBAAuB;EACvB,kBAAkB;EAClB,yBAAyB;EACzB,oCAAoC;AACtC;;;AAGA;EACE,sBAAsB;AACxB",sourcesContent:["\r\n#ex-toast-container {\r\n  position: absolute;\r\n  height: 0;\r\n  min-width: 50%;\r\n  left: 50%;\r\n  top: 0;\r\n}\r\n\r\n.ex-toast-message {\r\n  left: -50%;\r\n  position: relative;\r\n  display: flex;\r\n  justify-content: space-between;\r\n\r\n\r\n  padding: 10px;\r\n  margin-top: 5px;\r\n  font-size: 18px;\r\n  font-family: sans-serif;\r\n  border-radius: 6px;\r\n  border: 3px solid #b7b779;\r\n  background-color: rgb(253, 253, 192);\r\n}\r\n\r\n\r\n.ex-toast-message button {\r\n  align-self: flex-start;\r\n}"],sourceRoot:""}]);var s=a},2609:function(t){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i="undefined"!==typeof e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,o){"string"===typeof t&&(t=[[null,t,void 0]]);var a={};if(i)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var u=0;u<t.length;u++){var c=[].concat(t[u]);i&&a[c[0]]||("undefined"!==typeof o&&("undefined"===typeof c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),r&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=r):c[4]="".concat(r)),e.push(c))}},e}},272:function(t){t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"===typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),o="/*# ".concat(r," */"),a=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[e].concat(a).concat([o]).join("\n")}return[e].join("\n")}}},S={};function A(t){var e=S[t];if(void 0!==e)return e.exports;var n=S[t]={id:t,exports:{}};return C[t](n,n.exports,A),n.exports}A.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return A.d(e,{a:e}),e},A.d=function(t,e){for(var n in e)A.o(e,n)&&!A.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},A.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),A.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},A.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};e={};!function(){A.d(e,{fWn:function(){return ki},Ia8:function(){return ti},rqv:function(){return yo},hLI:function(){return Ci},yyv:function(){return xr},tX5:function(){return zt},vtX:function(){return Ei},r7K:function(){return Nn},lCh:function(){return ji},cE4:function(){return ot},fwF:function(){return hr},sce:function(){return rr},_c7:function(){return or},KUs:function(){return sr},Ajp:function(){return Pe},RDh:function(){return Zi},_H9:function(){return si},mxs:function(){return yi},OmD:function(){return On},kBf:function(){return q},C4F:function(){return on},NQt:function(){return Jr},JjN:function(){return $r},V1s:function(){return Wi},Xz7:function(){return Oe},Cdc:function(){return Kn},FKn:function(){return Zn},wTW:function(){return Ze},SUY:function(){return so},ab2:function(){return Tn},GfZ:function(){return In},YMS:function(){return Sn},oyv:function(){return Ln},aUb:function(){return Rn},SdD:function(){return Dt},JUv:function(){return mn},jEj:function(){return _o},TFq:function(){return Fn},HDU:function(){return Mt},R_y:function(){return Rt},ydN:function(){return rn},t50:function(){return Ft},s$$:function(){return cr},v2G:function(){return je},Ilk:function(){return X},s9i:function(){return Rr},dxL:function(){return vr},LLX:function(){return Zr},wA2:function(){return fn},R_p:function(){return An},IQ$:function(){return pr},I5F:function(){return W},X8$:function(){return lr},FR6:function(){return Zt},U8o:function(){return It},kbG:function(){return ln},iS_:function(){return Lt},cGG:function(){return Mr},RPN:function(){return Mi},skb:function(){return _r},SLU:function(){return te},RdJ:function(){return Pn},cNu:function(){return _i},gU7:function(){return Qe},LSk:function(){return wi},Nmp:function(){return ui},d1Y:function(){return he},xrL:function(){return bn},sRW:function(){return Cn},cmV:function(){return Lo},qWz:function(){return gi},N0Q:function(){return vi},q8b:function(){return Jn},ynB:function(){return Dn},jT9:function(){return Ni},wAz:function(){return dr},D4V:function(){return fo},N6H:function(){return Ut},W1A:function(){return Nt},JHW:function(){return Vn},v2K:function(){return Qi},pBf:function(){return Wt},GMl:function(){return nt},zW2:function(){return t},B0K:function(){return Ne},Nv7:function(){return Ae},C_p:function(){return ke},iqw:function(){return ie},MUA:function(){return Ht},xqU:function(){return Ot},pTp:function(){return mi},vUK:function(){return p},j9l:function(){return xi},Zxw:function(){return Si},Hdx:function(){return li},Z$d:function(){return oi},iqV:function(){return ao},o$7:function(){return Fr},olM:function(){return Y},Zm$:function(){return lt},$QH:function(){return dt},i78:function(){return ft},h6u:function(){return St},hts:function(){return Ct},j88:function(){return bt},VME:function(){return kt},nt:function(){return To},Ukr:function(){return to},zsu:function(){return jt},oA6:function(){return qn},TVh:function(){return fr},TwZ:function(){return Gn},GTT:function(){return jn},xxj:function(){return mr},XdK:function(){return Et},Jmb:function(){return qt},cXo:function(){return Qt},Dm5:function(){return Bt},IIB:function(){return l},zI0:function(){return an},LYD:function(){return br},cEG:function(){return kr},SEl:function(){return go},t9V:function(){return vo},SKZ:function(){return ut},__J:function(){return po},RI$:function(){return Hi},x12:function(){return Fo},ccz:function(){return En},aNw:function(){return Ye},xwn:function(){return Oi},dNK:function(){return Li},ini:function(){return z},YdH:function(){return U},y3G:function(){return rt},l57:function(){return j},xn0:function(){return We},t2V:function(){return bi},uxB:function(){return yn},cpd:function(){return ar},fiy:function(){return ii},$XZ:function(){return ri},uqK:function(){return Ve},STE:function(){return Xe},y$z:function(){return vn},mAD:function(){return Cr},sOq:function(){return _n},hUw:function(){return Ri},_0G:function(){return mo},Sqs:function(){return Mo},hpZ:function(){return gr},Vol:function(){return yr},wIZ:function(){return un},cBi:function(){return Dr},RFv:function(){return Qn},kfC:function(){return wr},mgq:function(){return Do},YVA:function(){return Bn},Kgp:function(){return _e},HH$:function(){return Pt},M_d:function(){return yt},rgh:function(){return vt},Ra6:function(){return xt},KhR:function(){return ht},BS5:function(){return _t},xhz:function(){return Tt},xOq:function(){return gt},a9j:function(){return pt},bHk:function(){return wt},CgK:function(){return ct},cuY:function(){return mt},kvE:function(){return wn},SBu:function(){return ve},AE_:function(){return $i},ctO:function(){return tr},OLH:function(){return Ui},kky:function(){return S},nSF:function(){return Le},zHn:function(){return kn},zwx:function(){return ur},AeJ:function(){return Yn},hLz:function(){return Hn},D9g:function(){return Yi},wA:function(){return ei},jhr:function(){return ni},GVs:function(){return Ee},_zO:function(){return Vt},w6$:function(){return hi},mhV:function(){return ci},MOD:function(){return $n},kwd:function(){return fi},Lmr:function(){return di},xsS:function(){return Sr},lLr:function(){return Te},Z$r:function(){return V},IXb:function(){return Pi},SGH:function(){return Ir},SMj:function(){return ro},L34:function(){return zo},exe:function(){return se},bnF:function(){return zn},MFA:function(){return H},$uU:function(){return qe},jyi:function(){return Yt},E03:function(){return $t},V6q:function(){return Jt},rg2:function(){return lo},DVW:function(){return Ue},nVo:function(){return Bi},F6N:function(){return Zo},xP7:function(){return Gi},Odq:function(){return er},Zif:function(){return zi},ZGJ:function(){return pn},MJk:function(){return uo},xvT:function(){return Ai},PHM:function(){return ai},dpR:function(){return Kt},n9L:function(){return Di},KwO:function(){return Fi},B7y:function(){return Ii},x7r:function(){return ho},wx7:function(){return dn},Uvn:function(){return gn},OFT:function(){return xn},xzN:function(){return Xi},M5Z:function(){return E},ZrN:function(){return c},OWs:function(){return O},dF9:function(){return cn},oZy:function(){return le},rD2:function(){return ue},VHo:function(){return At},ohE:function(){return Ie},R$E:function(){return He},q3I:function(){return nr},Pab:function(){return Z},uZ5:function(){return I},McK:function(){return v},F9c:function(){return T},k0b:function(){return Xn},hnT:function(){return xo},RSJ:function(){return So},Mku:function(){return ko},h90:function(){return Eo},rms:function(){return Ao},ErP:function(){return wo},aVg:function(){return Co},lPc:function(){return bo},Z8E:function(){return Un},_N2:function(){return qi},yFn:function(){return Ki},lNv:function(){return Wn},cu9:function(){return Ti},MZQ:function(){return Je},FUM:function(){return nn},BxR:function(){return xe},vdf:function(){return D},iaL:function(){return B},w6H:function(){return F},Q4c:function(){return tn},Xxe:function(){return P},Uxb:function(){return R},Yr5:function(){return M},Bhw:function(){return N},yOA:function(){return n}});var t={};A.r(t),A.d(t,{ActivateEvent:function(){return zt},CollisionEndEvent:function(){return Dt},CollisionPostSolveEvent:function(){return Mt},CollisionPreSolveEvent:function(){return Rt},CollisionStartEvent:function(){return Ft},ContactEndEvent:function(){return Zt},ContactStartEvent:function(){return It},DeactivateEvent:function(){return Lt},EnterTriggerEvent:function(){return Ut},EnterViewPortEvent:function(){return Nt},EventTypes:function(){return nt},ExitTriggerEvent:function(){return Ht},ExitViewPortEvent:function(){return Ot},GameEvent:function(){return lt},GameStartEvent:function(){return dt},GameStopEvent:function(){return ft},GamepadAxisEvent:function(){return St},GamepadButtonEvent:function(){return Ct},GamepadConnectEvent:function(){return bt},GamepadDisconnectEvent:function(){return kt},HiddenEvent:function(){return Et},InitializeEvent:function(){return Bt},KillEvent:function(){return ut},PostCollisionEvent:function(){return Pt},PostDebugDrawEvent:function(){return yt},PostDrawEvent:function(){return vt},PostFrameEvent:function(){return xt},PostKillEvent:function(){return ht},PostUpdateEvent:function(){return _t},PreCollisionEvent:function(){return Tt},PreDebugDrawEvent:function(){return gt},PreDrawEvent:function(){return pt},PreFrameEvent:function(){return wt},PreKillEvent:function(){return ct},PreUpdateEvent:function(){return mt},VisibleEvent:function(){return At}});var n={};A.r(n),A.d(n,{getAttributeComponentSize:function(){return oe},getAttributePointerType:function(){return ae},getGlTypeSizeBytes:function(){return re}});var a={};A.r(a),A.d(a,{circle:function(){return Be},line:function(){return Re},point:function(){return Me},roundRect:function(){return De},vector:function(){return Fe}});var l={};A.r(l),A.d(l,{Axes:function(){return Ur},Buttons:function(){return Or},Gamepad:function(){return Wr},Gamepads:function(){return Lr},KeyEvent:function(){return Br},Keyboard:function(){return zr},Keys:function(){return Tr},NativePointerButton:function(){return Gr},PointerButton:function(){return qr},PointerComponent:function(){return Qn},PointerEvent:function(){return eo},PointerEventReceiver:function(){return oo},PointerScope:function(){return Ar},PointerSystem:function(){return wr},PointerType:function(){return Kr},WheelDeltaMode:function(){return Vr},WheelEvent:function(){return no}});var c={};A.r(c),A.d(c,{ConsoleAppender:function(){return W},DrawUtil:function(){return a},EasingFunctions:function(){return Jn},LogLevel:function(){return z},Logger:function(){return U},Observable:function(){return vn},ScreenAppender:function(){return V},addItemToArray:function(){return Q},contains:function(){return $},delay:function(){return et},fail:function(){return tt},getPosition:function(){return K},removeItemFromArray:function(){return J}});A(4662),A(8343);function h(){if("undefined"===typeof window&&(window={audioContext:function(){}}),"undefined"===typeof window||window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setInterval(t,1e3/60)}),"undefined"===typeof window||window.cancelAnimationFrame||(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(){}),"undefined"!==typeof window&&!window.AudioContext){if(window.webkitAudioContext){var t=window.webkitAudioContext.prototype.decodeAudioData;window.webkitAudioContext.prototype.decodeAudioData=function(e){var n=this;return new Promise((function(i,r){t.call(n,e,i,r)}))}}window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext}"undefined"===typeof window||window.devicePixelRatio||(window.devicePixelRatio=window.devicePixelRatio||1)}var p=function(){function t(){(0,b.Z)(this,t)}return(0,k.Z)(t,null,[{key:"useCanvasGraphicsContext",value:function(){t.enable("use-canvas-context")}},{key:"freeze",value:function(){t._FROZEN=!0}},{key:"_reset",value:function(){t._FROZEN=!1,t._FLAGS={}}},{key:"enable",value:function(e){if(this._FROZEN)throw Error("Feature flags can only be enabled before Engine constructor time");t._FLAGS[e]=!0}},{key:"disable",value:function(e){if(this._FROZEN)throw Error("Feature flags can only be disabled before Engine constructor time");t._FLAGS[e]=!1}},{key:"isEnabled",value:function(e){return!!t._FLAGS[e]}},{key:"show",value:function(){return Object.keys(t._FLAGS)}}]),t}();function v(t,e){return{type:t,value:e}}p._FROZEN=!1,p._FLAGS={};var C=4294967295,S=function(){function t(e){(0,b.Z)(this,t),this.seed=e,this._lowerMask=2147483647,this._upperMask=2147483648,this._w=32,this._n=624,this._m=397,this._a=2567483615,this._u=11,this._s=7,this._b=2636928640,this._t=15,this._c=4022730752,this._l=18,this._f=1812433253,this._mt=new Array(this._n),this._mt[0]=(e||Date.now())>>>0;for(var n=1;n<this._n;n++){var i=this._mt[n-1]^this._mt[n-1]>>>this._w-2;this._mt[n]=(this._f*((4294901760&i)>>>16)<<16)+this._f*(65535&i)+n>>>0}this._index=this._n}return(0,k.Z)(t,[{key:"_twist",value:function(){for(var t=[0,this._a],e=0,n=0;n<this._n-this._m;n++)e=this._mt[n]&this._upperMask|this._mt[n+1]&this._lowerMask,this._mt[n]=this._mt[n+this._m]^e>>>1^t[1&e]&C;for(;n<this._n-1;n++)e=this._mt[n]&this._upperMask|this._mt[n+1]&this._lowerMask,this._mt[n]=this._mt[n+(this._m-this._n)]^e>>>1^t[1&e]&C;e=this._mt[this._n-1]&this._upperMask|this._mt[0]&this._lowerMask,this._mt[this._n-1]=this._mt[this._m-1]^e>>>1^t[1&e]&C,this._index=0}},{key:"nextInt",value:function(){this._index>=this._n&&this._twist();var t=this._mt[this._index++];return t^=t>>>this._u,t^=t<<this._s&this._b,t^=t<<this._t&this._c,(t^=t>>>this._l)>>>0}},{key:"next",value:function(){return this.nextInt()*(1/4294967296)}},{key:"floating",value:function(t,e){return(e-t)*this.next()+t}},{key:"integer",value:function(t,e){return Math.floor((e-t+1)*this.next()+t)}},{key:"bool",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;return this.next()<=t}},{key:"pickOne",value:function(t){return t[this.integer(0,t.length-1)]}},{key:"pickSet",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?this._pickSetWithDuplicates(t,e):this._pickSetWithoutDuplicates(t,e)}},{key:"_pickSetWithoutDuplicates",value:function(t,e){if(e>t.length||e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 < n <= length");if(e===t.length)return t;for(var n=new Array(e),i=0,r=t.slice(0);i<e;){var o=this.integer(0,r.length-1);n[i++]=r[o],r.splice(o,1)}return n}},{key:"_pickSetWithDuplicates",value:function(t,e){if(e<0)throw new Error("Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT");for(var n=new Array(e),i=0;i<e;i++)n[i]=this.pickOne(t);return n}},{key:"shuffle",value:function(t){for(var e=t.slice(0),n=null,i=0;i<e.length-2;i++){var r=this.integer(i,e.length-1);n=e[i],e[i]=e[r],e[r]=n}return e}},{key:"range",value:function(t,e,n){for(var i=new Array(t),r=0;r<t;r++)i[r]=this.integer(e,n);return i}},{key:"d4",value:function(){return this.integer(1,4)}},{key:"d6",value:function(){return this.integer(1,6)}},{key:"d8",value:function(){return this.integer(1,8)}},{key:"d10",value:function(){return this.integer(1,10)}},{key:"d12",value:function(){return this.integer(1,12)}},{key:"d20",value:function(){return this.integer(1,20)}}]),t}(),E=2*Math.PI;function T(t){return t>=0?t-Math.floor(t):t-Math.ceil(t)}function P(t){return 0===t?0:t<0?-1:1}function I(t,e,n){return Math.min(Math.max(e,t),n)}function Z(t){var e=t;if(t>E)for(;e>E;)e-=E;if(t<0)for(;e<0;)e+=E;return e}function R(t){return 180/Math.PI*t}function M(t){return t/180*Math.PI}var F=function(t,e){return Array.from(new Array(e-t+1),(function(e,n){return n+t}))};function D(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new S;return n?n.floating(t,e):t+Math.random()*(e-t)}function B(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new S;return n?n.integer(t,e):Math.round(D(t,e))}var z,L,O=function(){function t(e,n){(0,b.Z)(this,t),this._x=0,this._y=0,this._x=e,this._y=n}return(0,k.Z)(t,[{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}},{key:"setTo",value:function(t,e){this.x=t,this.y=e}},{key:"equals",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.001;return Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e}},{key:"distance",value:function(t){if(!t)return Math.sqrt(this.x*this.x+this.y*this.y);var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)}},{key:"squareDistance",value:function(e){e||(e=t.Zero);var n=this.x-e.x,i=this.y-e.y;return n*n+i*i}},{key:"clampMagnitude",value:function(t){var e=I(this.size,0,t);return this.size=e,this}},{key:"size",get:function(){return this.distance()},set:function(t){var e=this.normalize().scale(t);this.setTo(e.x,e.y)}},{key:"normalize",value:function(){var e=this.distance();return e>0?new t(this.x/e,this.y/e):new t(0,1)}},{key:"average",value:function(t){return this.add(t).scale(.5)}},{key:"scale",value:function(e,n){var i=n||new t(0,0);return e instanceof t?(i.x=this.x*e.x,i.y=this.y*e.y):(i.x=this.x*e,i.y=this.y*e),i}},{key:"add",value:function(e,n){return n?(n.x=this.x+e.x,n.y=this.y+e.y,n):new t(this.x+e.x,this.y+e.y)}},{key:"sub",value:function(e){return new t(this.x-e.x,this.y-e.y)}},{key:"addEqual",value:function(t){return this.setTo(this.x+t.x,this.y+t.y),this}},{key:"subEqual",value:function(t){return this.setTo(this.x-t.x,this.y-t.y),this}},{key:"scaleEqual",value:function(t){return this.setTo(this.x*t,this.y*t),this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"cross",value:function(e){return e instanceof t?this.x*e.y-this.y*e.x:"number"===typeof e?new t(e*this.y,-e*this.x):void 0}},{key:"perpendicular",value:function(){return new t(this.y,-this.x)}},{key:"normal",value:function(){return this.perpendicular().normalize()}},{key:"negate",value:function(){return this.scale(-1)}},{key:"toAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"rotate",value:function(e,n){n||(n=new t(0,0));var i=Math.sin(e),r=Math.cos(e);return new t(r*(this.x-n.x)-i*(this.y-n.y)+n.x,i*(this.x-n.x)+r*(this.y-n.y)+n.y)}},{key:"clone",value:function(e){var n=null!==e&&void 0!==e?e:new t(0,0);return n.x=this.x,n.y=this.y,n}},{key:"toString",value:function(t){return t?"(".concat(this.x.toFixed(t),", ").concat(this.y.toFixed(t),")"):"(".concat(this.x,", ").concat(this.y,")")}}],[{key:"Zero",get:function(){return new t(0,0)}},{key:"One",get:function(){return new t(1,1)}},{key:"Half",get:function(){return new t(.5,.5)}},{key:"Up",get:function(){return new t(0,-1)}},{key:"Down",get:function(){return new t(0,1)}},{key:"Left",get:function(){return new t(-1,0)}},{key:"Right",get:function(){return new t(1,0)}},{key:"fromAngle",value:function(e){return new t(Math.cos(e),Math.sin(e))}},{key:"isValid",value:function(t){return null!==t&&void 0!==t&&(!isNaN(t.x)&&!isNaN(t.y)&&(t.x!==1/0&&t.y!==1/0&&t.x!==-1/0&&t.y!==-1/0))}},{key:"distance",value:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}},{key:"min",value:function(e,n){return new t(Math.min(e.x,n.x),Math.min(e.y,n.y))}},{key:"max",value:function(e,n){return new t(Math.max(e.x,n.x),Math.max(e.y,n.y))}},{key:"cross",value:function(e,n){return new t(-e*n.y,e*n.x)}}]),t}();function N(t,e){return new O(t,e)}(L=z||(z={}))[L.Debug=0]="Debug",L[L.Info=1]="Info",L[L.Warn=2]="Warn",L[L.Error=3]="Error",L[L.Fatal=4]="Fatal";var U=function(){function t(){if((0,b.Z)(this,t),this._appenders=[],this.defaultLevel=z.Info,t._INSTANCE)throw new Error("Logger is a singleton");return t._INSTANCE=this,t._INSTANCE.addAppender(new W),t._INSTANCE}return(0,k.Z)(t,[{key:"addAppender",value:function(t){this._appenders.push(t)}},{key:"clearAppenders",value:function(){this._appenders.length=0}},{key:"_log",value:function(t,e){null==t&&(t=this.defaultLevel);for(var n=this._appenders.length,i=0;i<n;i++)t>=this.defaultLevel&&this._appenders[i].log(t,e)}},{key:"debug",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(z.Debug,e)}},{key:"info",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(z.Info,e)}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(z.Warn,e)}},{key:"error",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(z.Error,e)}},{key:"fatal",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log(z.Fatal,e)}}],[{key:"getInstance",value:function(){return null==t._INSTANCE&&(t._INSTANCE=new t),t._INSTANCE}}]),t}();U._INSTANCE=null;var H,W=function(){function t(){(0,b.Z)(this,t)}return(0,k.Z)(t,[{key:"log",value:function(t,e){if(console||console.log||!console.warn||!console.error){var n=[];n.unshift.apply(n,e),n.unshift("["+z[t]+"] : "),t<z.Warn?console.log.apply?console.log.apply(console,n):console.log(n.join(" ")):t<z.Error?console.warn.apply?console.warn.apply(console,n):console.warn(n.join(" ")):console.error.apply?console.error.apply(console,n):console.error(n.join(" "))}}}]),t}(),V=function(){function t(e,n){(0,b.Z)(this,t),this._messages=[],this._canvas=document.createElement("canvas"),this._canvas.width=e||window.innerWidth,this._canvas.height=n||window.innerHeight,this._canvas.style.position="absolute",this._ctx=this._canvas.getContext("2d"),document.body.appendChild(this._canvas)}return(0,k.Z)(t,[{key:"log",value:function(t,e){var n=e.join(",");this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._messages.unshift("["+z[t]+"] : "+n);for(var i=10,r=1,o=0;o<this._messages.length;o++)this._ctx.fillStyle="rgba(255,255,255,"+r.toFixed(2)+")",this._ctx.fillText(this._messages[o],200,i),i+=10,r=r>0?r-.05:0}}]),t}(),X=function(){function t(e,n,i,r){(0,b.Z)(this,t),this.r=e,this.g=n,this.b=i,this.a=null!=r?r:1}return(0,k.Z)(t,[{key:"lighten",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=G.fromRGBA(this.r,this.g,this.b,this.a);return e.l+=(1-e.l)*t,e.toRGBA()}},{key:"darken",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=G.fromRGBA(this.r,this.g,this.b,this.a);return e.l-=e.l*t,e.toRGBA()}},{key:"saturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=G.fromRGBA(this.r,this.g,this.b,this.a);return e.s+=e.s*t,e.toRGBA()}},{key:"desaturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=G.fromRGBA(this.r,this.g,this.b,this.a);return e.s-=e.s*t,e.toRGBA()}},{key:"multiply",value:function(e){return new t(e.r/255*this.r/255*255,e.g/255*this.g/255*255,e.b/255*this.b/255*255,e.a*this.a)}},{key:"screen",value:function(t){var e=t.invert(),n=t.invert();return e.multiply(n).invert()}},{key:"invert",value:function(){return new t(255-this.r,255-this.g,255-this.b,1-this.a)}},{key:"average",value:function(e){return new t((e.r+this.r)/2,(e.g+this.g)/2,(e.b+this.b)/2,(e.a+this.a)/2)}},{key:"equal",value:function(t){return this.toString()===t.toString()}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rgb";switch(t){case"rgb":return this.toRGBA();case"hsl":return this.toHSLA();case"hex":return this.toHex();default:throw new Error("Invalid Color format")}}},{key:"_componentToHex",value:function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},{key:"toHex",value:function(){return"#"+this._componentToHex(this.r)+this._componentToHex(this.g)+this._componentToHex(this.b)}},{key:"toRGBA",value:function(){var t=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return void 0!==this.a||null!==this.a?"rgba("+t+", "+String(this.a)+")":"rgb("+t+")"}},{key:"toHSLA",value:function(){return G.fromRGBA(this.r,this.g,this.b,this.a).toString()}},{key:"fillStyle",value:function(){return this.toString()}},{key:"clone",value:function(){return new t(this.r,this.g,this.b,this.a)}}],[{key:"fromRGB",value:function(e,n,i,r){return new t(e,n,i,r)}},{key:"fromRGBString",value:function(e){var n;if(n=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)/i)){var i=parseInt(n[1],10),r=parseInt(n[2],10),o=parseInt(n[3],10),a=1;return n[4]&&(a=parseFloat(n[4])),new t(i,r,o,a)}throw new Error("Invalid rgb/a string: "+e)}},{key:"fromHex",value:function(e){var n;if(n=e.match(/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i)){var i=parseInt(n[1],16),r=parseInt(n[2],16),o=parseInt(n[3],16),a=1;return n[4]&&(a=parseInt(n[4],16)/255),new t(i,r,o,a)}throw new Error("Invalid hex string: "+e)}},{key:"fromHSL",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=new G(t,e,n,i);return r.toRGBA()}},{key:"Black",get:function(){return t.fromHex("#000000")}},{key:"White",get:function(){return t.fromHex("#FFFFFF")}},{key:"Gray",get:function(){return t.fromHex("#808080")}},{key:"LightGray",get:function(){return t.fromHex("#D3D3D3")}},{key:"DarkGray",get:function(){return t.fromHex("#A9A9A9")}},{key:"Yellow",get:function(){return t.fromHex("#FFFF00")}},{key:"Orange",get:function(){return t.fromHex("#FFA500")}},{key:"Red",get:function(){return t.fromHex("#FF0000")}},{key:"Vermilion",get:function(){return t.fromHex("#FF5B31")}},{key:"Rose",get:function(){return t.fromHex("#FF007F")}},{key:"Magenta",get:function(){return t.fromHex("#FF00FF")}},{key:"Violet",get:function(){return t.fromHex("#7F00FF")}},{key:"Blue",get:function(){return t.fromHex("#0000FF")}},{key:"Azure",get:function(){return t.fromHex("#007FFF")}},{key:"Cyan",get:function(){return t.fromHex("#00FFFF")}},{key:"Viridian",get:function(){return t.fromHex("#59978F")}},{key:"Green",get:function(){return t.fromHex("#00FF00")}},{key:"Chartreuse",get:function(){return t.fromHex("#7FFF00")}},{key:"Transparent",get:function(){return t.fromHex("#FFFFFF00")}},{key:"ExcaliburBlue",get:function(){return t.fromHex("#176BAA")}}]),t}(),G=function(){function t(e,n,i,r){(0,b.Z)(this,t),this.h=e,this.s=n,this.l=i,this.a=r}return(0,k.Z)(t,[{key:"toRGBA",value:function(){var e,n,i;if(0===this.s)e=n=i=this.l;else{var r=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,o=2*this.l-r;e=t.hue2rgb(o,r,this.h+1/3),n=t.hue2rgb(o,r,this.h),i=t.hue2rgb(o,r,this.h-1/3)}return new X(255*e,255*n,255*i,this.a)}},{key:"toString",value:function(){var t=this.h.toFixed(0),e=this.s.toFixed(0),n=this.l.toFixed(0),i=this.a.toFixed(0);return"hsla(".concat(t,", ").concat(e,", ").concat(n,", ").concat(i,")")}}],[{key:"hue2rgb",value:function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}},{key:"fromRGBA",value:function(e,n,i,r){e/=255,n/=255,i/=255;var o,a,s=Math.max(e,n,i),l=Math.min(e,n,i),u=(s+l)/2;if(s===l)o=a=0;else{var c=s-l;switch(a=u>.5?c/(2-s-l):c/(s+l),s){case e:o=(n-i)/c+(n<i?6:0);break;case n:o=(i-e)/c+2;break;case i:o=(e-n)/c+4}o/=6}return new t(o,a,u,r)}}]),t}();!function(t){t.None="None",t.Top="Top",t.Bottom="Bottom",t.Left="Left",t.Right="Right"}(H||(H={})),function(t){t.getOpposite=function(e){return e===t.Top?t.Bottom:e===t.Bottom?t.Top:e===t.Left?t.Right:e===t.Right?t.Left:t.None},t.fromDirection=function(e){for(var n=[O.Left,O.Right,O.Up,O.Down],i=[t.Left,t.Right,t.Top,t.Bottom],r=-Number.MAX_VALUE,o=-1,a=0;a<n.length;a++)n[a].dot(e)>r&&(r=n[a].dot(e),o=a);return i[o]}}(H||(H={}));var j,q=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,b.Z)(this,t),"object"===typeof e?(this.left=e.left,this.top=e.top,this.right=e.right,this.bottom=e.bottom):"number"===typeof e&&(this.left=e,this.top=n,this.right=i,this.bottom=r)}return(0,k.Z)(t,[{key:"clone",value:function(){return new t(this.left,this.top,this.right,this.bottom)}},{key:"width",get:function(){return this.right-this.left}},{key:"height",get:function(){return this.bottom-this.top}},{key:"hasZeroDimensions",value:function(){return 0===this.width||0===this.height}},{key:"center",get:function(){return new O((this.left+this.right)/2,(this.top+this.bottom)/2)}},{key:"translate",value:function(e){return new t(this.left+e.x,this.top+e.y,this.right+e.x,this.bottom+e.y)}},{key:"rotate",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O.Zero,i=this.getPoints().map((function(t){return t.rotate(e,n)}));return t.fromPoints(i)}},{key:"scale",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O.Zero,i=this.translate(n);return new t(i.left*e.x,i.top*e.y,i.right*e.x,i.bottom*e.y)}},{key:"transform",value:function(e){var n=e.data[0]*this.left,i=e.data[1]*this.left,r=e.data[0]*this.right,o=e.data[1]*this.right,a=e.data[2]*this.top,s=e.data[3]*this.top,l=e.data[2]*this.bottom,u=e.data[3]*this.bottom,c=e.getPosition();return new t({left:Math.min(n,r)+Math.min(a,l)+c.x,top:Math.min(i,o)+Math.min(s,u)+c.y,right:Math.max(n,r)+Math.max(a,l)+c.x,bottom:Math.max(i,o)+Math.max(s,u)+c.y})}},{key:"getPerimeter",value:function(){return 2*(this.width+this.height)}},{key:"getPoints",value:function(){var t=[];return t.push(new O(this.left,this.top)),t.push(new O(this.right,this.top)),t.push(new O(this.right,this.bottom)),t.push(new O(this.left,this.bottom)),t}},{key:"rayCast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=-1/0,i=1/0,r=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,o=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,a=(this.left-t.pos.x)*r,s=(this.right-t.pos.x)*r;n=Math.min(a,s),i=Math.max(a,s);var l=(this.top-t.pos.y)*o,u=(this.bottom-t.pos.y)*o;return n=Math.max(n,Math.min(l,u)),(i=Math.min(i,Math.max(l,u)))>=Math.max(0,n)&&n<e}},{key:"rayCastTime",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=-1/0,i=1/0,r=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,o=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,a=(this.left-t.pos.x)*r,s=(this.right-t.pos.x)*r;n=Math.min(a,s),i=Math.max(a,s);var l=(this.top-t.pos.y)*o,u=(this.bottom-t.pos.y)*o;return n=Math.max(n,Math.min(l,u)),(i=Math.min(i,Math.max(l,u)))>=Math.max(0,n)&&n<e?n:-1}},{key:"contains",value:function(e){return e instanceof O?this.left<=e.x&&this.top<=e.y&&this.bottom>=e.y&&this.right>=e.x:e instanceof t&&(this.left<=e.left&&this.top<=e.top&&e.bottom<=this.bottom&&e.right<=this.right)}},{key:"combine",value:function(e){return new t(Math.min(this.left,e.left),Math.min(this.top,e.top),Math.max(this.right,e.right),Math.max(this.bottom,e.bottom))}},{key:"dimensions",get:function(){return new O(this.width,this.height)}},{key:"overlaps",value:function(t,e){var n=e||0;if(t.hasZeroDimensions())return this.contains(t);if(this.hasZeroDimensions())return t.contains(this);var i=this.combine(t);return i.width+n<t.width+this.width&&i.height+n<t.height+this.height}},{key:"intersect",value:function(t){var e=this.combine(t);if(e.width<t.width+this.width&&e.height<t.height+this.height&&!e.dimensions.equals(t.dimensions)&&!e.dimensions.equals(this.dimensions)){var n=0;n=this.right>=t.left&&this.right<=t.right?t.left-this.right:t.right-this.left;var i=0;return i=this.top<=t.bottom&&this.top>=t.top?t.bottom-this.top:t.top-this.bottom,Math.abs(n)<Math.abs(i)?new O(n,0):new O(0,i)}if(e.dimensions.equals(t.dimensions)||e.dimensions.equals(this.dimensions)){var r=0;r=this.width-t.width>=0?this.right-t.right<=t.left-this.left?t.left-this.right:t.right-this.left:t.right-this.right<=this.left-t.left?this.left-t.right:this.right-t.left;var o=0;return o=this.height-t.height>=0?this.bottom-t.bottom<=t.top-this.top?t.top-this.bottom:t.bottom-this.top:t.bottom-this.bottom<=this.top-t.top?this.top-t.bottom:this.bottom-t.top,Math.abs(r)<Math.abs(o)?new O(r,0):new O(0,o)}return null}},{key:"intersectWithSide",value:function(e){var n=this.intersect(e);return t.getSideFromIntersection(n)}},{key:"draw",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X.Yellow;t.debug.drawRect(this.left,this.top,this.width,this.height,{color:e})}}],[{key:"getSideFromIntersection",value:function(t){return t&&t?Math.abs(t.x)>Math.abs(t.y)?t.x<0?H.Right:H.Left:t.y<0?H.Bottom:H.Top:H.None}},{key:"fromPoints",value:function(e){for(var n=1/0,i=1/0,r=-1/0,o=-1/0,a=0;a<e.length;a++)e[a].x<n&&(n=e[a].x),e[a].x>r&&(r=e[a].x),e[a].y<i&&(i=e[a].y),e[a].y>o&&(o=e[a].y);return new t(n,i,r,o)}},{key:"fromDimension",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O.Half,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:O.Zero;return new t(-e*i.x+r.x,-n*i.y+r.y,e-e*i.x+r.x,n-n*i.y+r.y)}}]),t}(),Y=function(){function t(){var e=this;(0,b.Z)(this,t),this._isCompleted=!1,this.promise=new Promise((function(t,n){e._resolver=t,e._rejecter=n}))}return(0,k.Z)(t,[{key:"isCompleted",get:function(){return this._isCompleted}},{key:"resolve",value:function(t){this._isCompleted||(this._isCompleted=!0,this._resolver(t))}},{key:"reject",value:function(t){this._isCompleted||(this._isCompleted=!0,this._rejecter(t))}}]),t}();function K(t){var e=0,n=0;return function t(n){e+=n.offsetLeft,n.offsetParent&&t(n.offsetParent)}(t),function t(e){n+=e.offsetTop,e.offsetParent&&t(e.offsetParent)}(t),new O(e,n)}function Q(t,e){return-1===e.indexOf(t)&&(e.push(t),!0)}function J(t,e){var n;return(n=e.indexOf(t))>-1&&(e.splice(n,1),!0)}function $(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}function tt(t){throw new Error(t)}function et(t,e){var n,i=new Y;return(null!==(n=null===e||void 0===e?void 0:e.schedule.bind(e))&&void 0!==n?n:setTimeout)((function(){i.resolve()}),t),i.promise}!function(t){t[t.X=12]="X",t[t.Y=13]="Y"}(j||(j={}));var nt,it,rt=function(){function t(){(0,b.Z)(this,t),this.data=new Float32Array(16),this._scaleX=1,this._scaleSignX=1,this._scaleY=1,this._scaleSignY=1}return(0,k.Z)(t,[{key:"clone",value:function(e){var n=e||new t;return n.data[0]=this.data[0],n.data[1]=this.data[1],n.data[2]=this.data[2],n.data[3]=this.data[3],n.data[4]=this.data[4],n.data[5]=this.data[5],n.data[6]=this.data[6],n.data[7]=this.data[7],n.data[8]=this.data[8],n.data[9]=this.data[9],n.data[10]=this.data[10],n.data[11]=this.data[11],n.data[12]=this.data[12],n.data[13]=this.data[13],n.data[14]=this.data[14],n.data[15]=this.data[15],n}},{key:"toDOMMatrix",value:function(){return new DOMMatrix((0,x.Z)(this.data))}},{key:"reset",value:function(){var t=this;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t}},{key:"multiply",value:function(e,n){if(e instanceof O){var i=n||new O(0,0),r=e,o=r.x*this.data[0]+r.y*this.data[4]+this.data[12],a=r.x*this.data[1]+r.y*this.data[5]+this.data[13];return i.x=o,i.y=a,i}var s=n||new t,l=e,u=this.data[0],c=this.data[1],h=this.data[2],d=this.data[3],f=this.data[4],p=this.data[5],v=this.data[6],g=this.data[7],y=this.data[8],m=this.data[9],_=this.data[10],w=this.data[11],x=this.data[12],b=this.data[13],k=this.data[14],C=this.data[15],S=l.data[0],A=l.data[1],E=l.data[2],T=l.data[3],I=l.data[4],Z=l.data[5],R=l.data[6],M=l.data[7],F=l.data[8],D=l.data[9],B=l.data[10],z=l.data[11],L=l.data[12],N=l.data[13],U=l.data[14],H=l.data[15];s.data[0]=u*S+f*A+y*E+x*T,s.data[1]=c*S+p*A+m*E+b*T,s.data[2]=h*S+v*A+_*E+k*T,s.data[3]=d*S+g*A+w*E+C*T,s.data[4]=u*I+f*Z+y*R+x*M,s.data[5]=c*I+p*Z+m*R+b*M,s.data[6]=h*I+v*Z+_*R+k*M,s.data[7]=d*I+g*Z+w*R+C*M,s.data[8]=u*F+f*D+y*B+x*z,s.data[9]=c*F+p*D+m*B+b*z,s.data[10]=h*F+v*D+_*B+k*z,s.data[11]=d*F+g*D+w*B+C*z,s.data[12]=u*L+f*N+y*U+x*H,s.data[13]=c*L+p*N+m*U+b*H,s.data[14]=h*L+v*N+_*U+k*H,s.data[15]=d*L+g*N+w*U+C*H;var W=this.getScale();return s._scaleSignX=P(W.x)*P(s._scaleSignX),s._scaleSignY=P(W.y)*P(s._scaleSignY),s}},{key:"translate",value:function(t,e){var n=this.data[0],i=this.data[1],r=this.data[2],o=this.data[3],a=this.data[4],s=this.data[5],l=this.data[6],u=this.data[7],c=this.data[8],h=this.data[9],d=this.data[10],f=this.data[11],p=this.data[12],v=this.data[13],g=this.data[14],y=this.data[15];return this.data[12]=n*t+a*e+0*c+1*p,this.data[13]=i*t+s*e+0*h+1*v,this.data[14]=r*t+l*e+0*d+1*g,this.data[15]=o*t+u*e+0*f+1*y,this}},{key:"setPosition",value:function(t,e){this.data[12]=t,this.data[13]=e}},{key:"getPosition",value:function(){return N(this.data[12],this.data[13])}},{key:"rotate",value:function(t){var e=this.data[0],n=this.data[1],i=this.data[2],r=this.data[3],o=this.data[4],a=this.data[5],s=this.data[6],l=this.data[7],u=Math.sin(t),c=Math.cos(t);return this.data[0]=c*e+u*o,this.data[1]=c*n+u*a,this.data[2]=c*i+u*s,this.data[3]=c*r+u*l,this.data[4]=c*o-u*e,this.data[5]=c*a-u*n,this.data[6]=c*s-u*i,this.data[7]=c*l-u*r,this}},{key:"scale",value:function(t,e){var n=this.data[0],i=this.data[1],r=this.data[2],o=this.data[3],a=this.data[4],s=this.data[5],l=this.data[6],u=this.data[7];return this.data[0]=n*t,this.data[1]=i*t,this.data[2]=r*t,this.data[3]=o*t,this.data[4]=a*e,this.data[5]=s*e,this.data[6]=l*e,this.data[7]=u*e,this}},{key:"setRotation",value:function(t){var e=this.getScale(),n=Math.sin(t),i=Math.cos(t);this.data[0]=i*e.x,this.data[1]=n*e.y,this.data[4]=-n*e.x,this.data[5]=i*e.y}},{key:"getRotation",value:function(){return Z(Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX()))}},{key:"getScaleX",value:function(){var t=N(this.data[0],this.data[4]).size;return this._scaleSignX*t}},{key:"getScaleY",value:function(){var t=N(this.data[1],this.data[5]).size;return this._scaleSignY*t}},{key:"getScale",value:function(){return N(this.getScaleX(),this.getScaleY())}},{key:"setScaleX",value:function(t){if(this._scaleX!==t){this._scaleSignX=P(t);var e=N(this.data[0]*this._scaleSignX,this.data[4]*this._scaleSignX).normalize();this.data[0]=e.x*t,this.data[4]=e.y*t,this._scaleX=t}}},{key:"setScaleY",value:function(t){if(this._scaleY!==t){this._scaleSignY=P(t);var e=N(this.data[1]*this._scaleSignY,this.data[5]*this._scaleSignY).normalize();this.data[1]=e.x*t,this.data[5]=e.y*t,this._scaleY=t}}},{key:"setScale",value:function(t){this.setScaleX(t.x),this.setScaleY(t.y)}},{key:"getBasisDeterminant",value:function(){return this.data[0]*this.data[5]-this.data[1]*this.data[4]}},{key:"getAffineInverse",value:function(e){var n=1/this.getBasisDeterminant(),i=this.data[0],r=this.data[4],o=this.data[1],a=this.data[5],s=e||t.identity();s.data[0]=a*n,s.data[1]=-o*n,s.data[4]=-r*n,s.data[5]=i*n;var l=this.data[12],u=this.data[13];return s.data[12]=-(l*s.data[0]+u*s.data[4]),s.data[13]=-(l*s.data[1]+u*s.data[5]),s}},{key:"isIdentity",value:function(){return 1===this.data[0]&&0===this.data[1]&&0===this.data[2]&&0===this.data[3]&&0===this.data[4]&&1===this.data[5]&&0===this.data[6]&&0===this.data[7]&&0===this.data[8]&&0===this.data[9]&&1===this.data[10]&&0===this.data[11]&&0===this.data[12]&&0===this.data[13]&&0===this.data[14]&&1===this.data[15]}},{key:"toString",value:function(){return"\n[".concat(this.data[0]," ").concat(this.data[4]," ").concat(this.data[8]," ").concat(this.data[12],"]\n[").concat(this.data[1]," ").concat(this.data[5]," ").concat(this.data[9]," ").concat(this.data[13],"]\n[").concat(this.data[2]," ").concat(this.data[6]," ").concat(this.data[10]," ").concat(this.data[14],"]\n[").concat(this.data[3]," ").concat(this.data[7]," ").concat(this.data[11]," ").concat(this.data[15],"]\n")}}],[{key:"ortho",value:function(e,n,i,r,o,a){var s=new t;return s.data[0]=2/(n-e),s.data[1]=0,s.data[2]=0,s.data[3]=0,s.data[4]=0,s.data[5]=2/(r-i),s.data[6]=0,s.data[7]=0,s.data[8]=0,s.data[9]=0,s.data[10]=-2/(a-o),s.data[11]=0,s.data[12]=-(n+e)/(n-e),s.data[13]=-(r+i)/(r-i),s.data[14]=-(a+o)/(a-o),s.data[15]=1,s}},{key:"fromFloat32Array",value:function(e){var n=new t;return n.data=e,n}},{key:"identity",value:function(){var e=new t;return e.data[0]=1,e.data[1]=0,e.data[2]=0,e.data[3]=0,e.data[4]=0,e.data[5]=1,e.data[6]=0,e.data[7]=0,e.data[8]=0,e.data[9]=0,e.data[10]=1,e.data[11]=0,e.data[12]=0,e.data[13]=0,e.data[14]=0,e.data[15]=1,e}},{key:"translation",value:function(e,n){var i=t.identity();return i.data[12]=e,i.data[13]=n,i}},{key:"scale",value:function(e,n){var i=t.identity();return i.data[0]=e,i.data[5]=n,i.data[10]=1,i.data[15]=1,i}},{key:"rotation",value:function(e){var n=t.identity();return n.data[0]=Math.cos(e),n.data[4]=-Math.sin(e),n.data[1]=Math.sin(e),n.data[5]=Math.cos(e),n}}]),t}(),ot=function(){function t(){(0,b.Z)(this,t),this.data=new Float64Array(6),this._scale=new Float64Array([1,1]),this._scaleSignX=1,this._scaleSignY=1}return(0,k.Z)(t,[{key:"toDOMMatrix",value:function(){return new DOMMatrix((0,x.Z)(this.data))}},{key:"setPosition",value:function(t,e){this.data[4]=t,this.data[5]=e}},{key:"getPosition",value:function(){return N(this.data[4],this.data[5])}},{key:"rotate",value:function(t){var e=this.data[0],n=this.data[1],i=this.data[2],r=this.data[3],o=Math.sin(t),a=Math.cos(t);return this.data[0]=a*e+o*i,this.data[1]=a*n+o*r,this.data[2]=a*i-o*e,this.data[3]=a*r-o*n,this}},{key:"translate",value:function(t,e){var n=this.data[0],i=this.data[1],r=this.data[2],o=this.data[3],a=this.data[4],s=this.data[5];return this.data[4]=n*t+r*e+a,this.data[5]=i*t+o*e+s,this}},{key:"scale",value:function(t,e){var n=this.data[0],i=this.data[1],r=this.data[2],o=this.data[3];return this.data[0]=n*t,this.data[1]=i*t,this.data[2]=r*e,this.data[3]=o*e,this._scale[0]=t,this._scale[1]=e,this}},{key:"determinant",value:function(){return this.data[0]*this.data[3]-this.data[1]*this.data[2]}},{key:"inverse",value:function(e){var n=1/this.determinant(),i=this.data[0],r=this.data[2],o=this.data[1],a=this.data[3],s=e||t.identity();s.data[0]=a*n,s.data[1]=-o*n,s.data[2]=-r*n,s.data[3]=i*n;var l=this.data[4],u=this.data[5];return s.data[4]=-(l*s.data[0]+u*s.data[2]),s.data[5]=-(l*s.data[1]+u*s.data[3]),s}},{key:"multiply",value:function(e,n){if(e instanceof O){var i=n||new O(0,0),r=e,o=r.x*this.data[0]+r.y*this.data[2]+this.data[4],a=r.x*this.data[1]+r.y*this.data[3]+this.data[5];return i.x=o,i.y=a,i}var s=n||new t,l=e,u=this.data[0],c=this.data[1],h=this.data[2],d=this.data[3],f=this.data[4],p=this.data[5],v=l.data[0],g=l.data[1],y=l.data[2],m=l.data[3],_=l.data[4],w=l.data[5];s.data[0]=u*v+h*g,s.data[1]=c*v+d*g,s.data[2]=u*y+h*m,s.data[3]=c*y+d*m,s.data[4]=u*_+h*w+f,s.data[5]=c*_+d*w+p;var x=this.getScale();return s._scaleSignX=P(x.x)*P(s._scaleSignX),s._scaleSignY=P(x.y)*P(s._scaleSignY),s}},{key:"to4x4",value:function(){var t=new rt;return t.data[0]=this.data[0],t.data[1]=this.data[1],t.data[2]=0,t.data[3]=0,t.data[4]=this.data[2],t.data[5]=this.data[3],t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=this.data[4],t.data[13]=this.data[5],t.data[14]=0,t.data[15]=1,t}},{key:"setRotation",value:function(t){var e=this.getScale(),n=Math.sin(t),i=Math.cos(t);this.data[0]=i*e.x,this.data[1]=n*e.y,this.data[2]=-n*e.x,this.data[3]=i*e.y}},{key:"getRotation",value:function(){return Z(Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX()))}},{key:"getScaleX",value:function(){var t=N(this.data[0],this.data[2]).distance();return this._scaleSignX*t}},{key:"getScaleY",value:function(){var t=N(this.data[1],this.data[3]).distance();return this._scaleSignY*t}},{key:"getScale",value:function(){return N(this.getScaleX(),this.getScaleY())}},{key:"setScaleX",value:function(t){if(t!==this._scale[0]){this._scaleSignX=P(t);var e=N(this.data[0]*this._scaleSignX,this.data[2]*this._scaleSignX).normalize();this.data[0]=e.x*t,this.data[2]=e.y*t,this._scale[0]=t}}},{key:"setScaleY",value:function(t){if(t!==this._scale[1]){this._scaleSignY=P(t);var e=N(this.data[1]*this._scaleSignY,this.data[3]*this._scaleSignY).normalize();this.data[1]=e.x*t,this.data[3]=e.y*t,this._scale[1]=t}}},{key:"setScale",value:function(t){this.setScaleX(t.x),this.setScaleY(t.y)}},{key:"isIdentity",value:function(){return 1===this.data[0]&&0===this.data[1]&&0===this.data[2]&&1===this.data[3]&&0===this.data[4]&&0===this.data[5]}},{key:"reset",value:function(){var t=this;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=1,t.data[4]=0,t.data[5]=0,t}},{key:"clone",value:function(e){var n=e||new t;return n.data[0]=this.data[0],n.data[1]=this.data[1],n.data[2]=this.data[2],n.data[3]=this.data[3],n.data[4]=this.data[4],n.data[5]=this.data[5],n}},{key:"toString",value:function(){return"\n[".concat(this.data[0]," ").concat(this.data[2]," ").concat(this.data[4],"]\n[").concat(this.data[1]," ").concat(this.data[3]," ").concat(this.data[5],"]\n[0 0 1]\n")}}],[{key:"identity",value:function(){var e=new t;return e.data[0]=1,e.data[1]=0,e.data[2]=0,e.data[3]=1,e.data[4]=0,e.data[5]=0,e}},{key:"translation",value:function(e,n){var i=t.identity();return i.data[4]=e,i.data[5]=n,i}},{key:"scale",value:function(e,n){var i=t.identity();return i.data[0]=e,i.data[3]=n,i._scale[0]=e,i._scale[1]=n,i}},{key:"rotation",value:function(e){var n=t.identity();return n.data[0]=Math.cos(e),n.data[1]=Math.sin(e),n.data[2]=-Math.sin(e),n.data[3]=Math.cos(e),n}}]),t}(),at=function(){function t(){(0,b.Z)(this,t),this._transforms=[],this._currentTransform=ot.identity()}return(0,k.Z)(t,[{key:"save",value:function(){this._transforms.push(this._currentTransform),this._currentTransform=this._currentTransform.clone()}},{key:"restore",value:function(){this._currentTransform=this._transforms.pop()}},{key:"translate",value:function(t,e){return this._currentTransform.translate(t,e)}},{key:"rotate",value:function(t){return this._currentTransform.rotate(t)}},{key:"scale",value:function(t,e){return this._currentTransform.scale(t,e)}},{key:"current",get:function(){return this._currentTransform},set:function(t){this._currentTransform=t}}]),t}(),st=function(){function t(){(0,b.Z)(this,t),this._states=[],this._currentState=this._getDefaultState()}return(0,k.Z)(t,[{key:"_getDefaultState",value:function(){return{opacity:1,z:0,tint:X.White}}},{key:"_cloneState",value:function(){return{opacity:this._currentState.opacity,z:this._currentState.z,tint:this._currentState.tint.clone()}}},{key:"save",value:function(){this._states.push(this._currentState),this._currentState=this._cloneState()}},{key:"restore",value:function(){this._currentState=this._states.pop()}},{key:"current",get:function(){return this._currentState},set:function(t){this._currentState=t}}]),t}();(it=nt||(nt={})).Kill="kill",it.PreKill="prekill",it.PostKill="postkill",it.PreDraw="predraw",it.PostDraw="postdraw",it.PreDebugDraw="predebugdraw",it.PostDebugDraw="postdebugdraw",it.PreUpdate="preupdate",it.PostUpdate="postupdate",it.PreFrame="preframe",it.PostFrame="postframe",it.PreCollision="precollision",it.CollisionStart="collisionstart",it.CollisionEnd="collisionend",it.PostCollision="postcollision",it.Initialize="initialize",it.Activate="activate",it.Deactivate="deactivate",it.ExitViewport="exitviewport",it.EnterViewport="enterviewport",it.ExitTrigger="exit",it.EnterTrigger="enter",it.Connect="connect",it.Disconnect="disconnect",it.Button="button",it.Axis="axis",it.Visible="visible",it.Hidden="hidden",it.Start="start",it.Stop="stop",it.PointerUp="pointerup",it.PointerDown="pointerdown",it.PointerMove="pointermove",it.PointerEnter="pointerenter",it.PointerLeave="pointerleave",it.PointerCancel="pointercancel",it.PointerWheel="pointerwheel",it.Up="up",it.Down="down",it.Move="move",it.Enter="enter",it.Leave="leave",it.Cancel="cancel",it.Wheel="wheel",it.Press="press",it.Release="release",it.Hold="hold",it.PointerDragStart="pointerdragstart",it.PointerDragEnd="pointerdragend",it.PointerDragEnter="pointerdragenter",it.PointerDragLeave="pointerdragleave",it.PointerDragMove="pointerdragmove";var lt=function(){function t(){(0,b.Z)(this,t),this._bubbles=!0}return(0,k.Z)(t,[{key:"bubbles",get:function(){return this._bubbles},set:function(t){this._bubbles=t}},{key:"stopPropagation",value:function(){this.bubbles=!1}}]),t}(),ut=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this)).target=t,i}return(0,k.Z)(n)}(lt),ct=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this)).target=t,i}return(0,k.Z)(n)}(lt),ht=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this)).target=t,i}return(0,k.Z)(n)}(lt),dt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this)).target=t,i}return(0,k.Z)(n)}(lt),ft=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this)).target=t,i}return(0,k.Z)(n)}(lt),pt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i,r){var o;return(0,b.Z)(this,n),(o=e.call(this)).ctx=t,o.delta=i,o.target=r,o}return(0,k.Z)(n)}(lt),vt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i,r){var o;return(0,b.Z)(this,n),(o=e.call(this)).ctx=t,o.delta=i,o.target=r,o}return(0,k.Z)(n)}(lt),gt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this)).ctx=t,r.target=i,r}return(0,k.Z)(n)}(lt),yt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this)).ctx=t,r.target=i,r}return(0,k.Z)(n)}(lt),mt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i,r){var o;return(0,b.Z)(this,n),(o=e.call(this)).engine=t,o.delta=i,o.target=r,o}return(0,k.Z)(n)}(lt),_t=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i,r){var o;return(0,b.Z)(this,n),(o=e.call(this)).engine=t,o.delta=i,o.target=r,o}return(0,k.Z)(n)}(lt),wt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this)).engine=t,r.prevStats=i,r.target=t,r}return(0,k.Z)(n)}(lt),xt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this)).engine=t,r.stats=i,r.target=t,r}return(0,k.Z)(n)}(lt),bt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this)).index=t,r.gamepad=i,r.target=i,r}return(0,k.Z)(n)}(lt),kt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this)).index=t,r.gamepad=i,r.target=i,r}return(0,k.Z)(n)}(lt),Ct=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i,r){var o;return(0,b.Z)(this,n),(o=e.call(this)).button=t,o.value=i,o.target=r,o}return(0,k.Z)(n)}(lt),St=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i,r){var o;return(0,b.Z)(this,n),(o=e.call(this)).axis=t,o.value=i,o.target=r,o}return(0,k.Z)(n)}(lt),At=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this)).target=t,i}return(0,k.Z)(n)}(lt),Et=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this)).target=t,i}return(0,k.Z)(n)}(lt),Tt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i,r,o){var a;return(0,b.Z)(this,n),(a=e.call(this)).other=i,a.side=r,a.intersection=o,a.target=t,a}return(0,k.Z)(n)}(lt),Pt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i,r,o){var a;return(0,b.Z)(this,n),(a=e.call(this)).other=i,a.side=r,a.intersection=o,a.target=t,a}return(0,k.Z)(n,[{key:"actor",get:function(){return this.target},set:function(t){this.target=t}}]),n}(lt),It=(0,k.Z)((function t(e,n,i){(0,b.Z)(this,t),this.target=e,this.other=n,this.contact=i})),Zt=(0,k.Z)((function t(e,n){(0,b.Z)(this,t),this.target=e,this.other=n})),Rt=(0,k.Z)((function t(e,n,i,r,o){(0,b.Z)(this,t),this.target=e,this.other=n,this.side=i,this.intersection=r,this.contact=o})),Mt=(0,k.Z)((function t(e,n,i,r,o){(0,b.Z)(this,t),this.target=e,this.other=n,this.side=i,this.intersection=r,this.contact=o})),Ft=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i,r){var o;return(0,b.Z)(this,n),(o=e.call(this)).other=i,o.contact=r,o.target=t,o}return(0,k.Z)(n,[{key:"actor",get:function(){return this.target},set:function(t){this.target=t}}]),n}(lt),Dt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this)).other=i,r.target=t,r}return(0,k.Z)(n,[{key:"actor",get:function(){return this.target},set:function(t){this.target=t}}]),n}(lt),Bt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this)).engine=t,r.target=i,r}return(0,k.Z)(n)}(lt),zt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this)).context=t,r.target=i,r}return(0,k.Z)(n)}(lt),Lt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this)).context=t,r.target=i,r}return(0,k.Z)(n)}(lt),Ot=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this)).target=t,i}return(0,k.Z)(n)}(lt),Nt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this)).target=t,i}return(0,k.Z)(n)}(lt),Ut=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this)).target=t,r.actor=i,r}return(0,k.Z)(n)}(lt),Ht=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this)).target=t,r.actor=i,r}return(0,k.Z)(n)}(lt),Wt=function(){function t(){(0,b.Z)(this,t),this._handlers={},this._wiredEventDispatchers=[],this._deferedHandlerRemovals=[]}return(0,k.Z)(t,[{key:"clear",value:function(){this._handlers={},this._wiredEventDispatchers=[]}},{key:"_processDeferredHandlerRemovals",value:function(){var t,e=(0,m.Z)(this._deferedHandlerRemovals);try{for(e.s();!(t=e.n()).done;){var n=t.value;this._removeHandler(n.name,n.handler)}}catch(i){e.e(i)}finally{e.f()}this._deferedHandlerRemovals.length=0}},{key:"emit",value:function(t,e){if(this._processDeferredHandlerRemovals(),t){var n,i;if(t=t.toLowerCase(),e||(e=new lt),this._handlers[t])for(n=0,i=this._handlers[t].length;n<i;n++)this._handlers[t][n](e);for(n=0,i=this._wiredEventDispatchers.length;n<i;n++)this._wiredEventDispatchers[n].emit(t,e)}}},{key:"on",value:function(t,e){this._processDeferredHandlerRemovals(),t=t.toLowerCase(),this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(e)}},{key:"off",value:function(t,e){this._deferedHandlerRemovals.push({name:t,handler:e})}},{key:"_removeHandler",value:function(t,e){t=t.toLowerCase();var n=this._handlers[t];if(n)if(e){var i=n.indexOf(e);i>-1&&this._handlers[t].splice(i,1)}else this._handlers[t].length=0}},{key:"once",value:function(t,e){var n=this;this._processDeferredHandlerRemovals();this.on(t,(function i(r){var o=r||new lt;n.off(t,i),e(o)}))}},{key:"wire",value:function(t){t._wiredEventDispatchers.push(this)}},{key:"unwire",value:function(t){var e=t._wiredEventDispatchers.indexOf(this);e>-1&&t._wiredEventDispatchers.splice(e,1)}}]),t}(),Vt=function(){function t(e,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,b.Z)(this,t),this.path=e,this.responseType=n,this.bustCache=i,this.data=null,this.logger=U.getInstance(),this.events=new Wt}return(0,k.Z)(t,[{key:"isLoaded",value:function(){return null!==this.data}},{key:"_cacheBust",value:function(t){return/\?\w*=\w*/.test(t)?t+="&__="+Date.now():t+="?__="+Date.now(),t}},{key:"load",value:function(){var t=this;return new Promise((function(e,n){if(null!==t.data)return t.logger.debug("Already have data for resource",t.path),t.events.emit("complete",t.data),void e(t.data);var i=new XMLHttpRequest;i.open("GET",t.bustCache?t._cacheBust(t.path):t.path,!0),i.responseType=t.responseType,i.addEventListener("loadstart",(function(e){return t.events.emit("loadstart",e)})),i.addEventListener("progress",(function(e){return t.events.emit("progress",e)})),i.addEventListener("error",(function(e){return t.events.emit("error",e)})),i.addEventListener("load",(function(e){return t.events.emit("load",e)})),i.addEventListener("load",(function(){if(0!==i.status&&200!==i.status)return t.logger.error("Failed to load resource ",t.path," server responded with error code",i.status),t.events.emit("error",i.response),void n(new Error(i.statusText));t.data=i.response,t.events.emit("complete",t.data),t.logger.debug("Completed loading resource",t.path),e(t.data)})),i.send()}))}}]),t}();function Xt(t,e){return t&&void 0===t.__isProxy?new Proxy(t,{set:function(t,n,i){return t[n]!==i&&(t[n]=i,"string"===typeof n&&"_"!==n[0]&&e(t)),!0},get:function(t,e){return"__isProxy"===e||t[e]}}):t}function Gt(t,e){return t&&void 0===t.__isProxy?new Proxy(t,{set:function(t,n,i){return t[n]=i,"string"===typeof n&&"_"!==n[0]&&e(t),!0},get:function(t,e){return"__isProxy"===e||t[e]}}):t}var jt=function(){function t(e){var n,i,r,o,a,s;(0,b.Z)(this,t),this.id=t._ID++,this.transform=ot.identity(),this.tint=null,this._transformStale=!0,this.showDebug=!1,this._flipHorizontal=!1,this._flipVertical=!1,this._rotation=0,this.opacity=1,this._scale=O.One,this._origin=null,this._width=0,this._height=0,e&&(this.origin=null!==(n=e.origin)&&void 0!==n?n:this.origin,this.flipHorizontal=null!==(i=e.flipHorizontal)&&void 0!==i?i:this.flipHorizontal,this.flipVertical=null!==(r=e.flipVertical)&&void 0!==r?r:this.flipVertical,this.rotation=null!==(o=e.rotation)&&void 0!==o?o:this.rotation,this.opacity=null!==(a=e.opacity)&&void 0!==a?a:this.opacity,this.scale=null!==(s=e.scale)&&void 0!==s?s:this.scale)}return(0,k.Z)(t,[{key:"isStale",value:function(){return this._transformStale}},{key:"flipHorizontal",get:function(){return this._flipHorizontal},set:function(t){this._flipHorizontal=t,this._transformStale=!0}},{key:"flipVertical",get:function(){return this._flipVertical},set:function(t){this._flipVertical=t,this._transformStale=!0}},{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this._transformStale=!0}},{key:"scale",get:function(){return this._scale},set:function(t){var e=this;this._scale=Xt(t,(function(){e._transformStale=!0})),this._transformStale=!0}},{key:"origin",get:function(){return this._origin},set:function(t){var e=this;this._origin=Xt(t,(function(){e._transformStale=!0})),this._transformStale=!0}},{key:"cloneGraphicOptions",value:function(){return{origin:this.origin?this.origin.clone():null,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,rotation:this.rotation,opacity:this.opacity,scale:this.scale?this.scale.clone():null}}},{key:"width",get:function(){return Math.abs(this._width*this.scale.x)},set:function(t){this._width=t,this._transformStale=!0}},{key:"height",get:function(){return Math.abs(this._height*this.scale.y)},set:function(t){this._height=t,this._transformStale=!0}},{key:"localBounds",get:function(){return q.fromDimension(this.width,this.height,O.Zero)}},{key:"draw",value:function(t,e,n){this._preDraw(t,e,n),this._drawImage(t,0,0),this._postDraw(t)}},{key:"_preDraw",value:function(t,e,n){t.save(),t.translate(e,n),this._transformStale&&(this.transform.reset(),this.transform.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this._rotate(this.transform),this._flip(this.transform),this._transformStale=!1),t.multiply(this.transform),t.opacity=t.opacity*this.opacity,this.tint&&(t.tint=this.tint)}},{key:"_rotate",value:function(t){var e,n=this.scale.x>0?1:-1,i=this.scale.y>0?1:-1,r=null!==(e=this.origin)&&void 0!==e?e:N(this.width/2,this.height/2);t.translate(r.x,r.y),t.rotate(this.rotation),t.scale(n,i),t.translate(-r.x,-r.y)}},{key:"_flip",value:function(t){this.flipHorizontal&&(t.translate(this.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,this.height/this.scale.y),t.scale(1,-1))}},{key:"_postDraw",value:function(t){this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}]),t}();jt._ID=0;var qt,Yt=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i,r,o;(0,b.Z)(this,n),(i=e.call(this,t))._logger=U.getInstance(),i._dirty=!0,i._logNotLoadedWarning=!1,i.image=t.image;var a=t.width,s=t.height;return i.sourceView=null!==(r=t.sourceView)&&void 0!==r?r:{x:0,y:0,width:null!==a&&void 0!==a?a:0,height:null!==s&&void 0!==s?s:0},i.destSize=null!==(o=t.destSize)&&void 0!==o?o:{width:null!==a&&void 0!==a?a:0,height:null!==s&&void 0!==s?s:0},i._updateSpriteDimensions(),i.image.ready.then((function(){i._updateSpriteDimensions()})),i}return(0,k.Z)(n,[{key:"width",get:function(){return Math.abs(this.destSize.width*this.scale.x)},set:function(t){t/=Math.abs(this.scale.x),this.destSize.width=t,g((0,y.Z)(n.prototype),"width",Math.ceil(this.destSize.width),this,!0)}},{key:"height",get:function(){return Math.abs(this.destSize.height*this.scale.y)},set:function(t){t/=Math.abs(this.scale.y),this.destSize.height=t,g((0,y.Z)(n.prototype),"height",Math.ceil(this.destSize.height),this,!0)}},{key:"_updateSpriteDimensions",value:function(){var t,e,n,i,r,o,a=this.image,s=a.width,l=a.height;this.sourceView.width=(null===(t=this.sourceView)||void 0===t?void 0:t.width)||s,this.sourceView.height=(null===(e=this.sourceView)||void 0===e?void 0:e.height)||l,this.destSize.width=(null===(n=this.destSize)||void 0===n?void 0:n.width)||(null===(i=this.sourceView)||void 0===i?void 0:i.width)||s,this.destSize.height=(null===(r=this.destSize)||void 0===r?void 0:r.height)||(null===(o=this.sourceView)||void 0===o?void 0:o.height)||l,this.width=Math.ceil(this.destSize.width)*this.scale.x,this.height=Math.ceil(this.destSize.height)*this.scale.y}},{key:"_preDraw",value:function(t,e,i){this.image.isLoaded()&&this._dirty&&(this._dirty=!1,this._updateSpriteDimensions()),(0,f.Z)((0,y.Z)(n.prototype),"_preDraw",this).call(this,t,e,i)}},{key:"_drawImage",value:function(t,e,n){this.image.isLoaded()?t.drawImage(this.image.image,this.sourceView.x,this.sourceView.y,this.sourceView.width,this.sourceView.height,e,n,this.destSize.width,this.destSize.height):(this._logNotLoadedWarning||this._logger.warn("ImageSource ".concat(this.image.path)+" is not yet loaded and won't be drawn. Please call .load() or include in a Loader.\n\nRead https://excaliburjs.com/docs/imagesource for more information."),this._logNotLoadedWarning=!0)}},{key:"clone",value:function(){return new n(d({image:this.image,sourceView:d({},this.sourceView),destSize:d({},this.destSize)},this.cloneGraphicOptions()))}}],[{key:"from",value:function(t){return new n({image:t})}}]),n}(jt);!function(t){t.Pixel="Pixel",t.Blended="Blended"}(qt||(qt={}));var Kt=function(){function t(){(0,b.Z)(this,t)}return(0,k.Z)(t,null,[{key:"register",value:function(e){t._GL=e,t._MAX_TEXTURE_SIZE=e.getParameter(e.MAX_TEXTURE_SIZE)}},{key:"get",value:function(e){return t._TEXTURE_MAP.get(e)}},{key:"has",value:function(e){return t._TEXTURE_MAP.has(e)}},{key:"load",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t._GL;if(!r)return null;var o=null;if(t.has(e)&&(o=t.get(e)),o)return i&&(r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e)),o;o=r.createTexture(),t.checkImageSizeSupportedAndLog(e),r.bindTexture(r.TEXTURE_2D,o),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);var a=null!==n&&void 0!==n?n:t.filtering;return r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,a===qt.Pixel?r.NEAREST:r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,a===qt.Pixel?r.NEAREST:r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),t._TEXTURE_MAP.set(e,o),o}},{key:"delete",value:function(e){var n=t._GL;if(!n)return null;var i=null;t.has(e)&&(i=t.get(e),n.deleteTexture(i))}},{key:"checkImageSizeSupportedAndLog",value:function(e){var n,i=null!==(n=e.dataset.originalSrc)&&void 0!==n?n:"internal canvas bitmap";return e.width>t._MAX_TEXTURE_SIZE||e.height>t._MAX_TEXTURE_SIZE?(t._LOGGER.error("The image [".concat(i,"] provided to Excalibur is too large for the device's maximum texture size of ")+"(".concat(t._MAX_TEXTURE_SIZE,"x").concat(t._MAX_TEXTURE_SIZE,") please resize to an image ")+"for excalibur to render properly.\n\nImages will likely render as black rectangles.\n\nRead more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits"),!1):((e.width>4096||e.height>4096)&&t._LOGGER.warn("The image [".concat(i,"] provided to excalibur is too large may not work on all mobile devices, ")+"it is recommended you resize images to a maximum (4096x4096).\n\nImages will likely render as black rectangles on some mobile platforms.\n\nRead more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits"),!0)}}]),t}();Kt._LOGGER=U.getInstance(),Kt.filtering=qt.Blended,Kt._TEXTURE_MAP=new Map,Kt._MAX_TEXTURE_SIZE=0;var Qt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;(0,b.Z)(this,t),this.path=e,this._logger=U.getInstance(),this.data=new Image,this._readyFuture=new Y,this.ready=this._readyFuture.promise,this._resource=new Vt(e,"blob",n),this._filtering=i,(e.endsWith(".svg")||e.endsWith(".gif"))&&this._logger.warn("Image type is not fully supported, you may have mixed results ".concat(e,". Fully supported: jpg, bmp, and png"))}return(0,k.Z)(t,[{key:"width",get:function(){return this.image.naturalWidth}},{key:"height",get:function(){return this.image.naturalHeight}},{key:"isLoaded",value:function(){return this._src||(this._src=this.data.src),!!this._src}},{key:"image",get:function(){return this.data}},{key:"load",value:function(){var t=u(s().mark((function t(){var e,n,i,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isLoaded()){t.next=2;break}return t.abrupt("return",this.data);case 2:if(t.prev=2,this.path.includes("data:image/")){t.next=10;break}return t.next=6,this._resource.load();case 6:n=t.sent,e=URL.createObjectURL(n),t.next=11;break;case 10:e=this.path;case 11:return i=new Image,r=new Y,i.onload=function(){return r.resolve()},i.src=e,i.setAttribute("data-original-src",this.path),t.next=18,r.promise;case 18:this.data=i,t.next=24;break;case 21:throw t.prev=21,t.t0=t.catch(2),"Error loading ImageSource from path '".concat(this.path,"' with error [").concat(t.t0.message,"]");case 24:return Kt.load(this.data,this._filtering),this._readyFuture.resolve(this.data),t.abrupt("return",this.data);case 27:case"end":return t.stop()}}),t,this,[[2,21]])})));return function(){return t.apply(this,arguments)}}()},{key:"toSprite",value:function(){return Yt.from(this)}},{key:"unload",value:function(){this.data=new Image}}]),t}(),Jt=function(){function t(e){(0,b.Z)(this,t),this._logger=U.getInstance(),this.sprites=[];var n=e.sprites,i=e.rows,r=e.columns;this.sprites=n,this.rows=null!==i&&void 0!==i?i:1,this.columns=null!==r&&void 0!==r?r:this.sprites.length}return(0,k.Z)(t,[{key:"getSprite",value:function(t,e){if(t>=this.columns||t<0)return this._logger.warn("No sprite exists in the SpriteSheet at (".concat(t,", ").concat(e,"), x: ").concat(t," should be between 0 and ").concat(this.columns-1)),null;if(e>=this.rows||e<0)return this._logger.warn("No sprite exists in the SpriteSheet at (".concat(t,", ").concat(e,"), y: ").concat(e," should be between 0 and ").concat(this.rows-1)),null;var n=t+e*this.columns;return this.sprites[n]}}],[{key:"fromImageSourceWithSourceViews",value:function(e){return new t({sprites:e.sourceViews.map((function(t){return new Yt({image:e.image,sourceView:t})}))})}},{key:"fromImageSource",value:function(e){var n,i=[];e.spacing=null!==(n=e.spacing)&&void 0!==n?n:{};for(var r=e.image,o=e.grid,a=o.rows,s=o.columns,l=o.spriteWidth,u=o.spriteHeight,c=e.spacing,h=c.originOffset,f=c.margin,p=d({x:0,y:0},h),v=d({x:0,y:0},f),g=0;g<s;g++)for(var y=0;y<a;y++)i[g+y*s]=new Yt({image:r,sourceView:{x:g*l+v.x*g+p.x,y:y*u+v.y*y+p.y,width:l,height:u},destSize:{height:u,width:l}});return new t({sprites:i,rows:a,columns:s})}}]),t}(),$t=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;(0,b.Z)(this,n),(i=e.call(this,t))._text="",i.alphabet="",i.shadow=null,i.caseInsensitive=!1,i.spacing=0,i._logger=U.getInstance(),i._alreadyWarnedAlphabet=!1,i._alreadyWarnedSpriteSheet=!1;var r=t.alphabet,o=t.spriteSheet,a=t.caseInsensitive,s=t.spacing,l=t.shadow;return i.alphabet=r,i.spriteSheet=o,i.caseInsensitive=null!==a&&void 0!==a?a:i.caseInsensitive,i.spacing=null!==s&&void 0!==s?s:i.spacing,i.shadow=null!==l&&void 0!==l?l:i.shadow,i}return(0,k.Z)(n,[{key:"_getCharacterSprites",value:function(t){for(var e=[],n=this.caseInsensitive?t.toLocaleLowerCase():t,i=this.caseInsensitive?this.alphabet.toLocaleLowerCase():this.alphabet,r=0;r<n.length;r++){var o=n[r],a=i.indexOf(o);-1===a&&(a=0,this._alreadyWarnedAlphabet||(this._logger.warn("SpriteFont - Cannot find letter '".concat(o,"' in configured alphabet '").concat(i,"'.")),this._logger.warn("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."),this._alreadyWarnedAlphabet=!0));var s=this.spriteSheet.sprites[a];s?e.push(s):this._alreadyWarnedSpriteSheet||(this._logger.warn("SpriteFont - Cannot find sprite for '".concat(o,"' at index '").concat(a,"' in configured SpriteSheet")),this._logger.warn("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."),this._alreadyWarnedSpriteSheet=!0)}return e}},{key:"measureText",value:function(t){var e,n=t.split("\n"),i=n.reduce((function(t,e){return t.length>e.length?t:e})),r=this._getCharacterSprites(i),o=0,a=0,s=(0,m.Z)(r);try{for(s.s();!(e=s.n()).done;){var l=e.value;o+=l.width+this.spacing,a=Math.max(a,l.height)}}catch(u){s.e(u)}finally{s.f()}return q.fromDimension(o,a*n.length,O.Zero)}},{key:"_drawImage",value:function(t,e,n){var i,r=0,o=0,a=0,s=this._text.split("\n"),l=(0,m.Z)(s);try{for(l.s();!(i=l.n()).done;){var u,c=i.value,h=(0,m.Z)(this._getCharacterSprites(c));try{for(h.s();!(u=h.n()).done;){var d=u.value;d.draw(t,e+r,n+o),r+=d.width+this.spacing,a=Math.max(a,d.height)}}catch(f){h.e(f)}finally{h.f()}r=0,o+=a}}catch(f){l.e(f)}finally{l.f()}}},{key:"render",value:function(t,e,n,i,r){this._text=e;var o=this.measureText(e);this.width=o.width,this.height=o.height,this.shadow&&(t.save(),t.translate(this.shadow.offset.x,this.shadow.offset.y),this.draw(t,i,r),t.restore()),this.draw(t,i,r)}},{key:"clone",value:function(){return new n({alphabet:this.alphabet,spriteSheet:this.spriteSheet,spacing:this.spacing})}}]),n}(jt),te=function(){function t(){(0,b.Z)(this,t),this.fontSheet="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAwCAYAAAD+f6R/AAAAAXNSR0IArs4c6QAABcJJREFUeJztnemu7CgMhGE07//KmT9NhrAFVzkQndQntXRP3/bCZkwCSQhCCCGEEEIIIYQQQog/TRz953Ecx/nDGIe/vdNhlc9tIz605Fk/ZmWfsO1hn9Gxuv1KHbvb3iL/VN+d1WORbyr7yR/5b9M4vjNeqko6jPJHq5wGHU151o9J2Udse9hndCxuv0rH7rY3yD/Wdyf13MrnQeDfkZIUSGKM4ff3cWN82pEZuTyQGX2IxeyR63va//8VNCYCq+1yEkLtWyagXv1P1r1H+110gP3PzT4gT8uW/mdQ8mUG8E9DqOz4MS9ICKGbXpS2BpnIrRzYeS96cll08INlCMl2/glzdcfazuuPqQO03lmqrBHsf272Q6NODXj6zzZIJd/LAHYTg3Mays5gBi7ZR27fOgs0yj8rm36DLMFiPgkAdXHKOwUQeMCQ/adSh/qBQrT/tPxbAwA9+DOZEILPAATSuHMgTv7+Auk/df2lHPCZLvMSLJe34LkEQ9PwXF1SRTllMYgvIaflqyVAjLGbsiCDcOK76jflxZ+sINPyROc5071yKWK5CJTV3dMp6+tBlyCtNlhAq/+XbWoBDcRNXYBMzD4VvQygSuPYC2jGGaSSOxXfy3dTUEsanIvNeepm38N/hssSALTPZnAXfwIYRJn2b7UBcw0FKX+nDdAMpm2j9WVnxrUa7TXaVAca/B+TgaAVh6R/rH0P/5m01dt/RLYViJn+w/bhVX2P7f/duqom5qb02pRLCLGIMgBU1wCEEN9BAUCID6MAIMSHUQAQ4sMoAAjxYRQAhPgwd1uB0fuZ7H3cnn2P+9mr/Pe4B8/eB/fwP4eRtci/0f6OfTCPt/9oHwC6G6y19RHZDumxmwzR4eE/s/2Tte/q/+XLdc9DeJ19diesQc/j7Z8fCe4tAS4CxZ7sp7eiJi7HiZmjmOTGJs+93CbS3nP0XIPH3vW8/qz6QPnX2QdsV/1uw/iZYvg8ACeHd28rpPzfNfhL+7vkw/4Ou9s+Onhbv91elpKZ48Dl6bzpwwibHigRArf+Ptk9+L3Y1Q5OB4LgCeSBw1iuB3GeJh1/HrX/zF0A9Mk+u45zMkc3r4rWPomma5+p/514LB+Zo93MErJ1JHxXPzByGa/licRYVKbpeQCoQ6Q8yxuCwJF9IPsoDkHAo/3Tx26cvA4EtJ/n04w8QOq/mrR7ddfLAC5BYFNlVI/0CnOVUflOpvJUQMx9AIMIW/nWDM67/qw0+95v9goBqD9j+72u/KD9U89IbnQbMIR2Zbneh5zUY7Hdk7XIP3UffVb+r+wDYAZLq+1n1+C7y3/ny2r7p5yeByDEh9HzAIQQJwoAQnwYBQAhPowCgBBjoNu3hNxSFACE6INuKvPajPZ4EFEAEKINcybGYzOd247WEd3TgA2jlmjEyrd+j9hvfVbD2PWQ3ZmGlu2HyO8og8eBuNUvNYWoDgMVpwHTJoLWdz1Y+ZYOy5uF7t6PPruZxANrud1lQXkP0jsGz/Yz+vGGMuygFyhSPcJnc1pMnQZElc+cRnoAlxdTvoDuK7puqF7uCQy+3fyFMiA02/vJQHh7DQDogMPTSGFNA56HTzbZ9yAfBOb1Zyo3qGM3MfMZ3f76huXf6xlmAHknMlLNXsBBBvbljIz9Uyz5Y5TzIBLR/qy/rNyrZ8+L/0BZ0m+tgXD0OK5XZxC/9P7I/g4hVFvzXf1/6i5A7+3AlijMPBLMZfCvuAp7A9rY56ApHitmLQc7c8bOv6ftAxlM9Xp35nkEK7nJetBsaMhtAAAuOLQGXwhh2dXQnn1rZ/a42BI3dL7L+jkFAbQddwdA9Ah35yMKhgEgVT46EFh5D4jz+OgavNKxeBCd1wDSJ/97oR8eoJkLi9t9/BDgDHTJ5NE7Dnzechh914OVv9M1K9PCqsfqb88XVg9qN9lm6nG176UPu+zn17GOxuO0vOWEEC/j+LFKTgghlvEfYJaLS+SA2O0AAAAASUVORK5CYII=",this.size=16,this.load()}return(0,k.Z)(t,[{key:"load",value:function(){var t=this;return this._imageSource=new Qt(this.fontSheet),this._imageSource.load().then((function(){t._spriteSheet=Jt.fromImageSource({image:t._imageSource,grid:{rows:3,columns:16,spriteWidth:16,spriteHeight:16}}),t._spriteFont=new $t({alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!'&.\"?-()+ ",caseInsensitive:!0,spriteSheet:t._spriteSheet,spacing:-6})}))}},{key:"write",value:function(t,e,n){this._imageSource.isLoaded()&&this._spriteFont.render(t,e,null,n.x,n.y)}}]),t}(),ee=function(){function t(e,n){(0,b.Z)(this,t),this._gl=e,this._texture=n}return(0,k.Z)(t,[{key:"use",value:function(){var t=this._gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this._texture)}},{key:"disable",value:function(){var t=this._gl;t.bindTexture(t.TEXTURE_2D,null)}}]),t}(),ne=function(){function t(e){(0,b.Z)(this,t),this.width=e.width,this.height=e.height,this._gl=e.gl,this._setupFramebuffer()}return(0,k.Z)(t,[{key:"setResolution",value:function(t,e){var n=this._gl;this.width=t,this.height=e,n.bindTexture(n.TEXTURE_2D,this._frameTexture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,null)}},{key:"frameBuffer",get:function(){return this._frameBuffer}},{key:"frameTexture",get:function(){return this._frameTexture}},{key:"_setupFramebuffer",value:function(){var t=this._gl;this._frameTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._frameTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);var e=t.COLOR_ATTACHMENT0;this._frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,e,t.TEXTURE_2D,this._frameTexture,0),this.disable()}},{key:"toRenderSource",value:function(){return new ee(this._gl,this._frameTexture)}},{key:"use",value:function(){var t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer),t.viewport(0,0,this.width,this.height)}},{key:"disable",value:function(){var t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null)}}]),t}(),ie=function(){function t(){(0,b.Z)(this,t)}return(0,k.Z)(t,null,[{key:"clear",value:function(){t._GL=null}},{key:"register",value:function(e){t._GL=e}},{key:"gl",get:function(){if(!t._GL)throw Error("Attempted gl access before init");return t._GL}}]),t}();function re(t,e){switch(e){case t.FLOAT:return 4;case t.SHORT:case t.UNSIGNED_SHORT:return 2;case t.BYTE:case t.UNSIGNED_BYTE:default:return 1}}function oe(t,e){switch(e){case t.LOW_FLOAT:case t.HIGH_FLOAT:case t.FLOAT:return 1;case t.FLOAT_VEC2:return 2;case t.FLOAT_VEC3:return 3;case t.FLOAT_VEC4:return 4;case t.BYTE:case t.UNSIGNED_BYTE:case t.UNSIGNED_SHORT:case t.SHORT:default:return 1}}function ae(t,e){switch(e){case t.LOW_FLOAT:case t.HIGH_FLOAT:case t.FLOAT:case t.FLOAT_VEC2:case t.FLOAT_VEC3:case t.FLOAT_VEC4:return t.FLOAT;case t.BYTE:return t.BYTE;case t.UNSIGNED_BYTE:return t.UNSIGNED_BYTE;case t.SHORT:return t.SHORT;case t.UNSIGNED_SHORT:return t.UNSIGNED_SHORT;default:return t.FLOAT}}var se=function(){function t(e){(0,b.Z)(this,t),this._gl=ie.gl,this.uniforms={},this.attributes={},this._compiled=!1;var n=e.vertexSource,i=e.fragmentSource;this.vertexSource=n,this.fragmentSource=i}return(0,k.Z)(t,[{key:"compiled",get:function(){return this._compiled}},{key:"use",value:function(){this._gl.useProgram(this.program),t._ACTIVE_SHADER_INSTANCE=this}},{key:"isCurrentlyBound",value:function(){return t._ACTIVE_SHADER_INSTANCE===this}},{key:"compile",value:function(){var t=this._gl,e=this._compileShader(t,this.vertexSource,t.VERTEX_SHADER),n=this._compileShader(t,this.fragmentSource,t.FRAGMENT_SHADER);this.program=this._createProgram(t,e,n);var i,r=this.getAttributes(),o=(0,m.Z)(r);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.attributes[a.name]=a}}catch(h){o.e(h)}finally{o.f()}var s,l=this.getUniforms(),u=(0,m.Z)(l);try{for(u.s();!(s=u.n()).done;){var c=s.value;this.uniforms[c.name]=c}}catch(h){u.e(h)}finally{u.f()}return this._compiled=!0,this.program}},{key:"getUniforms",value:function(){for(var t=this._gl,e=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),n=[],i=0;i<e;i++){var r=t.getActiveUniform(this.program,i),o=t.getUniformLocation(this.program,r.name);n.push({name:r.name,glType:r.type,location:o})}return n}},{key:"getAttributes",value:function(){for(var t=this._gl,e=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),n=[],i=0;i<e;i++){var r=t.getActiveAttrib(this.program,i),o=t.getAttribLocation(this.program,r.name);n.push({name:r.name,glType:ae(t,r.type),size:oe(t,r.type),location:o,normalized:!1})}return n}},{key:"setTexture",value:function(t,e){var n=this._gl;n.activeTexture(n.TEXTURE0+t),n.bindTexture(n.TEXTURE_2D,e)}},{key:"setUniformInt",value:function(t,e){this.setUniform("uniform1i",t,~~e)}},{key:"setUniformIntArray",value:function(t,e){this.setUniform("uniform1iv",t,e)}},{key:"setUniformBoolean",value:function(t,e){this.setUniform("uniform1i",t,e?1:0)}},{key:"setUniformFloat",value:function(t,e){this.setUniform("uniform1f",t,e)}},{key:"setUniformFloatArray",value:function(t,e){this.setUniform("uniform1fv",t,e)}},{key:"setUniformFloatVector",value:function(t,e){this.setUniform("uniform2f",t,e.x,e.y)}},{key:"setUniformMatrix",value:function(t,e){this.setUniform("uniformMatrix4fv",t,!1,e.data)}},{key:"setUniform",value:function(t,e){if(!this._compiled)throw Error("Must compile shader before setting a uniform ".concat(t,":").concat(e));if(!this.isCurrentlyBound())throw Error("Currently accessed shader instance is not the current active shader in WebGL, must call `shader.use()` before setting uniforms");var n=this._gl,i=n.getUniformLocation(this.program,e);if(!i)throw Error("Uniform ".concat(t,":").concat(e," doesn't exist or is not used in the shader source code,")+" unused uniforms are optimized away by most browsers");for(var r=arguments.length,o=new Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];var s=[i].concat(o);this._gl[t].apply(this._gl,s)}},{key:"_createProgram",value:function(t,e,n){var i=t.createProgram();if(null===i)throw Error("Could not create graphics shader program");if(t.attachShader(i,e),t.attachShader(i,n),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS))throw Error("Could not link the program: [".concat(t.getProgramInfoLog(i),"]"));return i}},{key:"_compileShader",value:function(t,e,n){var i=t.VERTEX_SHADER===n?"vertex":"fragment",r=t.createShader(n);if(null===r)throw Error("Could not build shader: [".concat(e,"]"));if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){var o=t.getShaderInfoLog(r);throw Error("Could not compile ".concat(i," shader:\n\n").concat(o).concat(this._processSourceForError(e,o)))}return r}},{key:"_processSourceForError",value:function(t,e){for(var n=t.split("\n"),i=e.search(/\d:\d/),r=e.indexOf(" ",i),a=e.slice(i,r).split(":").map((function(t){return Number(t)})),s=(0,o.Z)(a,2),l=(s[0],s[1]),u=0;u<n.length;u++)n[u]="".concat(u+1,": ").concat(n[u]).concat(l===u+1?" <----- ERROR!":"");return"\n\nSource:\n"+n.join("\n")}}]),t}();se._ACTIVE_SHADER_INSTANCE=null;var le=function(){function t(e){(0,b.Z)(this,t),this._gl=ie.gl,this.type="dynamic";var n=e.size,i=e.type,r=e.data;if(this.buffer=this._gl.createBuffer(),!r&&!n)throw Error("Must either provide data or a size to the VertexBuffer");this.bufferData=r||new Float32Array(n),this.type=null!==i&&void 0!==i?i:this.type;var o=this._gl;o.bindBuffer(o.ARRAY_BUFFER,this.buffer),o.bufferData(o.ARRAY_BUFFER,this.bufferData,"static"===this.type?o.STATIC_DRAW:o.DYNAMIC_DRAW)}return(0,k.Z)(t,[{key:"bind",value:function(){var t=this._gl;t.bindBuffer(t.ARRAY_BUFFER,this.buffer)}},{key:"upload",value:function(t){var e=this._gl;e.bindBuffer(e.ARRAY_BUFFER,this.buffer),t?e.bufferSubData(e.ARRAY_BUFFER,0,this.bufferData,0,t):e.bufferData(e.ARRAY_BUFFER,this.bufferData,"static"===this.type?e.STATIC_DRAW:e.DYNAMIC_DRAW)}}]),t}(),ue=function(){function t(e){(0,b.Z)(this,t),this._gl=ie.gl,this._logger=U.getInstance(),this._layout=[],this._attributes=[],this._vertexTotalSizeBytes=0;var n=e.shader,i=e.vertexBuffer,r=e.attributes;this._vertexBuffer=i,this._attributes=r,this._shader=n,this.initialize()}return(0,k.Z)(t,[{key:"vertexBuffer",get:function(){return this._vertexBuffer}},{key:"attributes",get:function(){return this._attributes}},{key:"totalVertexSizeBytes",get:function(){return this._vertexTotalSizeBytes}},{key:"initialize",value:function(){if(!this._shader.compiled)throw Error("Shader not compiled, shader must be compiled before defining a vertex layout");this._layout.length=0;var t,e=this._shader.attributes,n=(0,m.Z)(this._attributes);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=e[i[0]];if(!r)throw Error("The attribute named: ".concat(i[0]," size ").concat(i[1])+" not found in the shader source code:\n ".concat(this._shader.vertexSource));if(r.size!==i[1])throw Error("VertexLayout size definition for attribute: [".concat(i[0],", ").concat(i[1],"],")+" doesnt match shader source size ".concat(r.size,":\n ").concat(this._shader.vertexSource));this._layout.push(r)}}catch(c){n.e(c)}finally{n.f()}var o,a=0,s=(0,m.Z)(this._layout);try{for(s.s();!(o=s.n()).done;){var l=o.value,u=re(this._gl,l.glType);this._vertexTotalSizeBytes+=u*l.size,a+=l.size}}catch(c){s.e(c)}finally{s.f()}this._vertexBuffer.bufferData.length%a!==0&&this._logger.warn("The vertex component size (".concat(a,")  does divide evenly into the specified vertex buffer")+" (".concat(this._vertexBuffer.bufferData.length,")"))}},{key:"use",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0,n=this._gl;if(!this._shader.isCurrentlyBound())throw Error("Shader associated with this vertex layout is not active! Call shader.use() before layout.use()");this._vertexBuffer.bind(),t&&this._vertexBuffer.upload(e);var i,r=0,o=(0,m.Z)(this._layout);try{for(o.s();!(i=o.n()).done;){var a=i.value;n.vertexAttribPointer(a.location,a.size,a.glType,a.normalized,this.totalVertexSizeBytes,r),n.enableVertexAttribArray(a.location),r+=re(n,a.glType)*a.size}}catch(s){o.e(s)}finally{o.f()}}}]),t}(),ce=function(){function t(){(0,b.Z)(this,t)}return(0,k.Z)(t,null,[{key:"clear",value:function(){t.DrawCallCount=0,t.DrawnImagesCount=0}}]),t}();ce.DrawCallCount=0,ce.DrawnImagesCount=0;var he,de=function(){function t(){(0,b.Z)(this,t),this.type="ex.line",this.priority=0,this._maxLines=10922,this._vertexIndex=0,this._lineCount=0}return(0,k.Z)(t,[{key:"initialize",value:function(t,e){this._gl=t,this._context=e,this._shader=new se({vertexSource:"#version 300 es\r\nin vec2 a_position;\r\nin vec4 a_color;\r\n\r\nout lowp vec4 v_color;\r\n\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n\r\n   // Passthrough the color\r\n   v_color = a_color;\r\n}",fragmentSource:"#version 300 es\r\nprecision mediump float;\r\n\r\n// Color\r\nin lowp vec4 v_color;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n  fragColor = v_color;\r\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._vertexBuffer=new le({size:12*this._maxLines,type:"dynamic"}),this._layout=new ue({vertexBuffer:this._vertexBuffer,shader:this._shader,attributes:[["a_position",2],["a_color",4]]})}},{key:"draw",value:function(t,e,n){this._isFull()&&this.flush(),this._lineCount++;var i=this._context.getTransform(),r=i.multiply(t),o=i.multiply(e),a=this._vertexBuffer.bufferData;a[this._vertexIndex++]=r.x,a[this._vertexIndex++]=r.y,a[this._vertexIndex++]=n.r/255,a[this._vertexIndex++]=n.g/255,a[this._vertexIndex++]=n.b/255,a[this._vertexIndex++]=n.a,a[this._vertexIndex++]=o.x,a[this._vertexIndex++]=o.y,a[this._vertexIndex++]=n.r/255,a[this._vertexIndex++]=n.g/255,a[this._vertexIndex++]=n.b/255,a[this._vertexIndex++]=n.a}},{key:"_isFull",value:function(){return this._lineCount>=this._maxLines}},{key:"hasPendingDraws",value:function(){return 0!==this._lineCount}},{key:"flush",value:function(){if(0!==this._lineCount){var t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),t.drawArrays(t.LINES,0,2*this._lineCount),ce.DrawnImagesCount+=this._lineCount,ce.DrawCallCount++,this._vertexIndex=0,this._lineCount=0}}}]),t}(),fe=function(){function t(){(0,b.Z)(this,t),this.type="ex.point",this.priority=0,this._maxPoints=10922,this._pointCount=0,this._vertexIndex=0}return(0,k.Z)(t,[{key:"initialize",value:function(t,e){this._gl=t,this._context=e,this._shader=new se({vertexSource:"#version 300 es\r\nin vec2 a_position;\r\nin vec4 a_color;\r\nin float a_size;\r\nout lowp vec4 v_color;\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n  gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n  gl_PointSize = a_size * 2.0;\r\n  v_color = a_color;\r\n}",fragmentSource:'#version 300 es\r\n\r\nprecision mediump float;\r\nin lowp vec4 v_color;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n  float r = 0.0, delta = 0.0, alpha = 1.0;\r\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\r\n  r = dot(cxy, cxy);\r\n\r\n  delta = fwidth(r);\r\n  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\r\n  // "premultiply" the color by alpha\r\n  vec4 color = v_color;\r\n  color.a = color.a * alpha;\r\n  color.rgb = color.rgb * color.a;\r\n  fragColor = color;\r\n}'}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._buffer=new le({size:7*this._maxPoints,type:"dynamic"}),this._layout=new ue({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_color",4],["a_size",1]]})}},{key:"draw",value:function(t,e,n){this._isFull()&&this.flush(),this._pointCount++;var i=this._context.getTransform(),r=this._context.opacity,o=this._context.snapToPixel,a=i.multiply(t);o&&(a.x=~~(a.x+xe),a.y=~~(a.y+xe));var s=this._buffer.bufferData;s[this._vertexIndex++]=a.x,s[this._vertexIndex++]=a.y,s[this._vertexIndex++]=e.r/255,s[this._vertexIndex++]=e.g/255,s[this._vertexIndex++]=e.b/255,s[this._vertexIndex++]=e.a*r,s[this._vertexIndex++]=n*Math.max(i.getScaleX(),i.getScaleY())}},{key:"_isFull",value:function(){return this._pointCount>=this._maxPoints}},{key:"hasPendingDraws",value:function(){return 0!==this._pointCount}},{key:"flush",value:function(){if(0!==this._pointCount){var t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),t.drawArrays(t.POINTS,0,this._pointCount),ce.DrawnImagesCount+=this._pointCount,ce.DrawCallCount++,this._pointCount=0,this._vertexIndex=0}}}]),t}(),pe=function(){function t(e){(0,b.Z)(this,t),this._gl=e,this._shader=new se({vertexSource:"#version 300 es\r\nin vec2 a_position;\r\n\r\nin vec2 a_texcoord;\r\nout vec2 v_texcoord;\r\n\r\nvoid main() {\r\n  gl_Position = vec4(a_position, 0.0, 1.0);\r\n\r\n  // Pass the texcoord to the fragment shader.\r\n  v_texcoord = a_texcoord;\r\n}",fragmentSource:"#version 300 es\r\nprecision mediump float;\r\n\r\n// Passed in from the vertex shader.\r\nin vec2 v_texcoord;\r\n\r\n// The texture.\r\nuniform sampler2D u_texture;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n   fragColor = texture(u_texture, v_texcoord);\r\n}"}),this._shader.compile(),this._buffer=new le({type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new ue({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}return(0,k.Z)(t,[{key:"renderWithPostProcessor",value:function(t){var e=this._gl;t.getShader().use(),t.getLayout().use(),e.drawArrays(e.TRIANGLES,0,6)}},{key:"renderToScreen",value:function(){var t=this._gl;this._shader.use(),this._layout.use(),t.drawArrays(t.TRIANGLES,0,6)}}]),t}(),ve=function(){function t(e,n){(0,b.Z)(this,t),this._gl=ie.gl,this._logger=U.getInstance();var i=this._gl;this.buffer=i.createBuffer(),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.buffer);var r=6*e;if(n){var o=Math.floor(16383.5);this.bufferGlType=i.UNSIGNED_SHORT,this.bufferData=new Uint16Array(r),e>o&&this._logger.warn("Total quads exceeds hardware index buffer limit (uint16), max(".concat(o,") requested quads(").concat(e,")"))}else this.bufferData=new Uint32Array(r);for(var a=0,s=0;s<r;s+=6)this.bufferData[s+0]=a+0,this.bufferData[s+1]=a+1,this.bufferData[s+2]=a+2,this.bufferData[s+3]=a+2,this.bufferData[s+4]=a+1,this.bufferData[s+5]=a+3,a+=4;i.bufferData(i.ELEMENT_ARRAY_BUFFER,this.bufferData,i.STATIC_DRAW)}return(0,k.Z)(t,[{key:"size",get:function(){return this.bufferData.length}},{key:"upload",value:function(){var t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.bufferData,t.STATIC_DRAW)}},{key:"bind",value:function(){var t=this._gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer)}}]),t}(),ge=function(){function t(){(0,b.Z)(this,t),this.type="ex.image",this.priority=0,this._maxImages=10922,this._maxTextures=0,this._imageCount=0,this._textures=[],this._vertexIndex=0}return(0,k.Z)(t,[{key:"initialize",value:function(t,e){this._gl=t,this._context=e,this._maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),125);var n=this._transformFragmentSource("#version 300 es\r\nprecision mediump float;\r\n\r\n// UV coord\r\nin vec2 v_texcoord;\r\n\r\n// Texture index\r\nin lowp float v_textureIndex;\r\n\r\n// Textures in the current draw\r\nuniform sampler2D u_textures[%%count%%];\r\n\r\n// Opacity\r\nin float v_opacity;\r\n\r\nin vec4 v_tint;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n   // In order to support the most efficient sprite batching, we have multiple\r\n   // textures loaded into the gpu (usually 8) this picker logic skips over textures\r\n   // that do not apply to a particular sprite.\r\n\r\n   vec4 color = vec4(1.0, 0, 0, 1.0);\r\n\r\n   // GLSL is templated out to pick the right texture and set the vec4 color\r\n   %%texture_picker%%\r\n\r\n   color.rgb = color.rgb * v_opacity;\r\n   color.a = color.a * v_opacity;\r\n   fragColor = color * v_tint;\r\n}",this._maxTextures);this._shader=new se({fragmentSource:n,vertexSource:"#version 300 es\r\nin vec2 a_position;\r\n\r\n// Opacity \r\nin float a_opacity;\r\nout float v_opacity;\r\n\r\n// UV coordinate\r\nin vec2 a_texcoord;\r\nout vec2 v_texcoord;\r\n\r\n// Texture number\r\nin lowp float a_textureIndex;\r\nout lowp float v_textureIndex;\r\n\r\nin vec4 a_tint;\r\nout vec4 v_tint;\r\n\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n\r\n   // Pass through the Opacity to the fragment shader\r\n   v_opacity = a_opacity;\r\n   // Pass through the UV coord to the fragment shader\r\n   v_texcoord = a_texcoord;\r\n   // Pass through the texture number to the fragment shader\r\n   v_textureIndex = a_textureIndex;\r\n   // Pass through the tint\r\n   v_tint = a_tint;\r\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",e.ortho),this._shader.setUniformIntArray("u_textures",(0,x.Z)(Array(this._maxTextures)).map((function(t,e){return e}))),this._buffer=new le({size:40*this._maxImages,type:"dynamic"}),this._layout=new ue({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_opacity",1],["a_texcoord",2],["a_textureIndex",1],["a_tint",4]]}),this._quads=new ve(this._maxImages,!0)}},{key:"_transformFragmentSource",value:function(t,e){for(var n=t.replace("%%count%%",e.toString()),i="",r=0;r<e;r++)i+=0===r?"if (v_textureIndex <= ".concat(r,".5) {\n"):"   else if (v_textureIndex <= ".concat(r,".5) {\n"),i+="      color = texture(u_textures[".concat(r,"], v_texcoord);\n"),i+="   }\n";return n=n.replace("%%texture_picker%%",i)}},{key:"_addImageAsTexture",value:function(t){var e=Kt.load(t);-1===this._textures.indexOf(e)&&this._textures.push(e)}},{key:"_bindTextures",value:function(t){for(var e=0;e<this._maxTextures;e++)t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this._textures[e]||this._textures[0])}},{key:"_getTextureIdForImage",value:function(t){return t?this._textures.indexOf(Kt.get(t)):-1}},{key:"_isFull",value:function(){return this._imageCount>=this._maxImages||this._textures.length>=this._maxTextures}},{key:"draw",value:function(t,e,n,i,r,o,a,s,l){var u,c,h,d;this._isFull()&&this.flush(),this._imageCount++,this._addImageAsTexture(t);var f=(null===t||void 0===t?void 0:t.width)||i||0,p=(null===t||void 0===t?void 0:t.height)||r||0,v=[0,0,null!==(u=null!==i&&void 0!==i?i:null===t||void 0===t?void 0:t.width)&&void 0!==u?u:0,null!==(c=null!==r&&void 0!==r?r:null===t||void 0===t?void 0:t.height)&&void 0!==c?c:0],g=[null!==e&&void 0!==e?e:1,null!==n&&void 0!==n?n:1];void 0!==o&&void 0!==a&&void 0!==s&&void 0!==l&&(v=[null!==e&&void 0!==e?e:1,null!==n&&void 0!==n?n:1,null!==(h=null!==i&&void 0!==i?i:null===t||void 0===t?void 0:t.width)&&void 0!==h?h:0,null!==(d=null!==r&&void 0!==r?r:null===t||void 0===t?void 0:t.height)&&void 0!==d?d:0],g=[o,a],f=s,p=l),e=v[0],n=v[1];var y=v[2],m=v[3],_=this._context.getTransform(),w=this._context.opacity,x=this._context.snapToPixel,b=N(g[0],g[1]),k=N(g[0]+f,g[1]),C=N(g[0],g[1]+p),S=N(g[0]+f,g[1]+p);b=_.multiply(b),k=_.multiply(k),C=_.multiply(C),S=_.multiply(S),x&&(b.x=~~(b.x+xe),b.y=~~(b.y+xe),k.x=~~(k.x+xe),k.y=~~(k.y+xe),C.x=~~(C.x+xe),C.y=~~(C.y+xe),S.x=~~(S.x+xe),S.y=~~(S.y+xe));var A=this._context.tint,E=this._getTextureIdForImage(t),T=t.width||f,P=t.height||p,I=e/T,Z=n/P,R=(e+y-.01)/T,M=(n+m-.01)/P,F=this._layout.vertexBuffer.bufferData;F[this._vertexIndex++]=b.x,F[this._vertexIndex++]=b.y,F[this._vertexIndex++]=w,F[this._vertexIndex++]=I,F[this._vertexIndex++]=Z,F[this._vertexIndex++]=E,F[this._vertexIndex++]=A.r/255,F[this._vertexIndex++]=A.g/255,F[this._vertexIndex++]=A.b/255,F[this._vertexIndex++]=A.a,F[this._vertexIndex++]=C.x,F[this._vertexIndex++]=C.y,F[this._vertexIndex++]=w,F[this._vertexIndex++]=I,F[this._vertexIndex++]=M,F[this._vertexIndex++]=E,F[this._vertexIndex++]=A.r/255,F[this._vertexIndex++]=A.g/255,F[this._vertexIndex++]=A.b/255,F[this._vertexIndex++]=A.a,F[this._vertexIndex++]=k.x,F[this._vertexIndex++]=k.y,F[this._vertexIndex++]=w,F[this._vertexIndex++]=R,F[this._vertexIndex++]=Z,F[this._vertexIndex++]=E,F[this._vertexIndex++]=A.r/255,F[this._vertexIndex++]=A.g/255,F[this._vertexIndex++]=A.b/255,F[this._vertexIndex++]=A.a,F[this._vertexIndex++]=S.x,F[this._vertexIndex++]=S.y,F[this._vertexIndex++]=w,F[this._vertexIndex++]=R,F[this._vertexIndex++]=M,F[this._vertexIndex++]=E,F[this._vertexIndex++]=A.r/255,F[this._vertexIndex++]=A.g/255,F[this._vertexIndex++]=A.b/255,F[this._vertexIndex++]=A.a}},{key:"hasPendingDraws",value:function(){return 0!==this._imageCount}},{key:"flush",value:function(){if(0!==this._imageCount){var t=this._gl;this._shader.use(),this._layout.use(!0,40*this._imageCount),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._bindTextures(t),this._quads.bind(),t.drawElements(t.TRIANGLES,6*this._imageCount,this._quads.bufferGlType,0),ce.DrawnImagesCount+=this._imageCount,ce.DrawCallCount++,this._imageCount=0,this._vertexIndex=0,this._textures.length=0}}}]),t}(),ye=function(){function t(){(0,b.Z)(this,t),this.type="ex.rectangle",this.priority=0,this._maxRectangles=10922,this._rectangleCount=0,this._vertexIndex=0}return(0,k.Z)(t,[{key:"initialize",value:function(t,e){this._gl=t,this._context=e,this._shader=new se({fragmentSource:"#version 300 es\r\n\r\nprecision mediump float;\r\n\r\n// UV coord\r\nin vec2 v_uv;\r\n\r\nin vec2 v_size; // in pixels\r\n\r\n// Color coord to blend with image\r\nin lowp vec4 v_color;\r\n\r\n// Stroke color if used\r\nin lowp vec4 v_strokeColor;\r\n\r\n// Stroke thickness if used\r\nin lowp float v_strokeThickness; // in pixels\r\n\r\n// Opacity\r\nin float v_opacity;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n    // modified from https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\r\n    vec2 uv = v_uv;\r\n    vec2 fragCoord = uv * v_size;\r\n    float maxX = v_size.x - v_strokeThickness;\r\n    float minX = v_strokeThickness;\r\n    float maxY = v_size.y - v_strokeThickness;\r\n    float minY = v_strokeThickness;\r\n\r\n    if (fragCoord.x < maxX && fragCoord.x > minX &&\r\n        fragCoord.y < maxY && fragCoord.y > minY) {\r\n      fragColor = v_color;\r\n    } else {\r\n      fragColor = v_strokeColor;\r\n    }\r\n    fragColor.a *= v_opacity;\r\n    fragColor.rgb *= fragColor.a;\r\n\r\n    // vec2 v2CenteredPos     = abs(fragCoord - v_size.xy / 2.0);\r\n    // vec2 v2HalfShapeSizePx = v_size.xy/2.0 - v_strokeThickness/2.0;\r\n\r\n    // float fHalfBorderDist      = 0.0;\r\n    // float fHalfBorderThickness = 0.0;\r\n\r\n    // if (fragCoord.x > max(v_radius, v_strokeThickness) && \r\n    //     fragCoord.x < v_size.x - max(v_radius, v_strokeThickness))\r\n    // {\r\n    //     fHalfBorderDist      = v2CenteredPos.y - v2HalfShapeSizePx.y;\r\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\r\n    // }\r\n    // else if (fragCoord.y > max(v_radius, v_strokeThickness) && \r\n    //          fragCoord.y < v_size.y - max(v_radius, v_strokeThickness))\r\n    // {\r\n    //     fHalfBorderDist      = v2CenteredPos.x - v2HalfShapeSizePx.x;\r\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\r\n    // }\r\n    // else\r\n    // {\r\n    //     vec2 edgeVec = max(vec2(0.0), v_radius - vec2(\r\n    //         uv.x > 0.5 ? v_size.x - fragCoord.x : fragCoord.x,\r\n    //         uv.y > 0.5 ? v_size.y - fragCoord.y : fragCoord.y));\r\n        \r\n    //     float ellipse_ab    = v_radius-v_strokeThickness;\r\n    //     vec2 ellipse_isect = (v_strokeThickness > v_radius || v_strokeThickness > v_radius) ? vec2(0.0) :\r\n    //                             edgeVec.xy * ellipse_ab*ellipse_ab / length(ellipse_ab*edgeVec.yx); \r\n            \r\n    //     fHalfBorderThickness = (v_radius - length(ellipse_isect)) / 2.0;\r\n    //     fHalfBorderDist      = length(edgeVec) - (v_radius - fHalfBorderThickness);\r\n    // }\r\n\r\n    // vec4 v4FromColor = v_strokeColor;\r\n    // v4FromColor.rgb *= v4FromColor.a;\r\n    // vec4 v4ToColor   = vec4(0.0); // background color is transparent\r\n    // if (fHalfBorderDist < 0.0) {\r\n    //     v4ToColor = v_color;\r\n    //     v4ToColor.rgb *= v4ToColor.a;\r\n    // }\r\n\r\n    // float mixPct = abs(fHalfBorderDist) - fHalfBorderThickness;\r\n\r\n    // vec4 finalColor = mix(v4FromColor, v4ToColor, mixPct);\r\n    // gl_FragColor = finalColor;\r\n}",vertexSource:"#version 300 es\r\nin vec2 a_position;\r\n\r\n// UV coordinate\r\nin vec2 a_uv;\r\nout vec2 v_uv;\r\n\r\nin vec2 a_size;\r\nout vec2 v_size;\r\n\r\n// Opacity \r\nin float a_opacity;\r\nout float v_opacity;\r\n\r\nin vec4 a_color;\r\nout vec4 v_color;\r\n\r\nin vec4 a_strokeColor;\r\nout vec4 v_strokeColor;\r\n\r\nin float a_strokeThickness;\r\nout float v_strokeThickness;\r\n\r\nuniform mat4 u_matrix;\r\n\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n\r\n   // Pass through UV coords\r\n   v_uv = a_uv;\r\n   // Pass through size\r\n   v_size = a_size;\r\n   // Pass through the Opacity to the fragment shader\r\n   v_opacity = a_opacity;\r\n   // Pass through the color to the fragment shader\r\n   v_color = a_color;\r\n   // Pass through the stroke color to the fragment shader\r\n   v_strokeColor = a_strokeColor;\r\n   // Pass through the stroke thickenss to the fragment shader\r\n   v_strokeThickness = a_strokeThickness;\r\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",e.ortho),this._buffer=new le({size:64*this._maxRectangles,type:"dynamic"}),this._layout=new ue({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_size",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new ve(this._maxRectangles,!0)}},{key:"_isFull",value:function(){return this._rectangleCount>=this._maxRectangles}},{key:"draw",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0]instanceof O&&e[1]instanceof O?this.drawLine.apply(this,e):this.drawRectangle.apply(this,e)}},{key:"drawLine",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this._isFull()&&this.flush(),this._rectangleCount++;var r=this._context.getTransform(),o=this._context.opacity,a=this._context.snapToPixel,s=e.sub(t),l=s.size,u=s.normalize().perpendicular(),c=i/2,h=r.multiply(u.scale(c).add(t)),d=r.multiply(u.scale(-c).add(t)),f=r.multiply(u.scale(c).add(e)),p=r.multiply(u.scale(-c).add(e));a&&(h.x=~~(h.x+xe),h.y=~~(h.y+xe),f.x=~~(f.x+xe),f.y=~~(f.y+xe),d.x=~~(d.x+xe),d.y=~~(d.y+xe),p.x=~~(p.x+xe),p.y=~~(p.y+xe));var v=0,g=0,y=1,m=1,_=X.Transparent,w=0,x=1,b=this._layout.vertexBuffer.bufferData;b[this._vertexIndex++]=h.x,b[this._vertexIndex++]=h.y,b[this._vertexIndex++]=v,b[this._vertexIndex++]=g,b[this._vertexIndex++]=l,b[this._vertexIndex++]=i,b[this._vertexIndex++]=o,b[this._vertexIndex++]=n.r/255,b[this._vertexIndex++]=n.g/255,b[this._vertexIndex++]=n.b/255,b[this._vertexIndex++]=n.a,b[this._vertexIndex++]=_.r/255,b[this._vertexIndex++]=_.g/255,b[this._vertexIndex++]=_.b/255,b[this._vertexIndex++]=_.a,b[this._vertexIndex++]=w/x,b[this._vertexIndex++]=d.x,b[this._vertexIndex++]=d.y,b[this._vertexIndex++]=v,b[this._vertexIndex++]=m,b[this._vertexIndex++]=l,b[this._vertexIndex++]=i,b[this._vertexIndex++]=o,b[this._vertexIndex++]=n.r/255,b[this._vertexIndex++]=n.g/255,b[this._vertexIndex++]=n.b/255,b[this._vertexIndex++]=n.a,b[this._vertexIndex++]=_.r/255,b[this._vertexIndex++]=_.g/255,b[this._vertexIndex++]=_.b/255,b[this._vertexIndex++]=_.a,b[this._vertexIndex++]=w/x,b[this._vertexIndex++]=f.x,b[this._vertexIndex++]=f.y,b[this._vertexIndex++]=y,b[this._vertexIndex++]=g,b[this._vertexIndex++]=l,b[this._vertexIndex++]=i,b[this._vertexIndex++]=o,b[this._vertexIndex++]=n.r/255,b[this._vertexIndex++]=n.g/255,b[this._vertexIndex++]=n.b/255,b[this._vertexIndex++]=n.a,b[this._vertexIndex++]=_.r/255,b[this._vertexIndex++]=_.g/255,b[this._vertexIndex++]=_.b/255,b[this._vertexIndex++]=_.a,b[this._vertexIndex++]=w/x,b[this._vertexIndex++]=p.x,b[this._vertexIndex++]=p.y,b[this._vertexIndex++]=y,b[this._vertexIndex++]=m,b[this._vertexIndex++]=l,b[this._vertexIndex++]=i,b[this._vertexIndex++]=o,b[this._vertexIndex++]=n.r/255,b[this._vertexIndex++]=n.g/255,b[this._vertexIndex++]=n.b/255,b[this._vertexIndex++]=n.a,b[this._vertexIndex++]=_.r/255,b[this._vertexIndex++]=_.g/255,b[this._vertexIndex++]=_.b/255,b[this._vertexIndex++]=_.a,b[this._vertexIndex++]=w/x}},{key:"drawRectangle",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:X.Transparent,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this._isFull()&&this.flush(),this._rectangleCount++;var a=this._context.getTransform(),s=this._context.opacity,l=this._context.snapToPixel,u=a.multiply(t.add(N(0,0))),c=a.multiply(t.add(N(e,0))),h=a.multiply(t.add(N(e,n))),d=a.multiply(t.add(N(0,n)));l&&(u.x=~~(u.x+xe),u.y=~~(u.y+xe),c.x=~~(c.x+xe),c.y=~~(c.y+xe),d.x=~~(d.x+xe),d.y=~~(d.y+xe),h.x=~~(h.x+xe),h.y=~~(h.y+xe));var f=0,p=0,v=1,g=1,y=this._layout.vertexBuffer.bufferData;y[this._vertexIndex++]=u.x,y[this._vertexIndex++]=u.y,y[this._vertexIndex++]=f,y[this._vertexIndex++]=p,y[this._vertexIndex++]=e,y[this._vertexIndex++]=n,y[this._vertexIndex++]=s,y[this._vertexIndex++]=i.r/255,y[this._vertexIndex++]=i.g/255,y[this._vertexIndex++]=i.b/255,y[this._vertexIndex++]=i.a,y[this._vertexIndex++]=r.r/255,y[this._vertexIndex++]=r.g/255,y[this._vertexIndex++]=r.b/255,y[this._vertexIndex++]=r.a,y[this._vertexIndex++]=o,y[this._vertexIndex++]=d.x,y[this._vertexIndex++]=d.y,y[this._vertexIndex++]=f,y[this._vertexIndex++]=g,y[this._vertexIndex++]=e,y[this._vertexIndex++]=n,y[this._vertexIndex++]=s,y[this._vertexIndex++]=i.r/255,y[this._vertexIndex++]=i.g/255,y[this._vertexIndex++]=i.b/255,y[this._vertexIndex++]=i.a,y[this._vertexIndex++]=r.r/255,y[this._vertexIndex++]=r.g/255,y[this._vertexIndex++]=r.b/255,y[this._vertexIndex++]=r.a,y[this._vertexIndex++]=o,y[this._vertexIndex++]=c.x,y[this._vertexIndex++]=c.y,y[this._vertexIndex++]=v,y[this._vertexIndex++]=p,y[this._vertexIndex++]=e,y[this._vertexIndex++]=n,y[this._vertexIndex++]=s,y[this._vertexIndex++]=i.r/255,y[this._vertexIndex++]=i.g/255,y[this._vertexIndex++]=i.b/255,y[this._vertexIndex++]=i.a,y[this._vertexIndex++]=r.r/255,y[this._vertexIndex++]=r.g/255,y[this._vertexIndex++]=r.b/255,y[this._vertexIndex++]=r.a,y[this._vertexIndex++]=o,y[this._vertexIndex++]=h.x,y[this._vertexIndex++]=h.y,y[this._vertexIndex++]=v,y[this._vertexIndex++]=g,y[this._vertexIndex++]=e,y[this._vertexIndex++]=n,y[this._vertexIndex++]=s,y[this._vertexIndex++]=i.r/255,y[this._vertexIndex++]=i.g/255,y[this._vertexIndex++]=i.b/255,y[this._vertexIndex++]=i.a,y[this._vertexIndex++]=r.r/255,y[this._vertexIndex++]=r.g/255,y[this._vertexIndex++]=r.b/255,y[this._vertexIndex++]=r.a,y[this._vertexIndex++]=o}},{key:"hasPendingDraws",value:function(){return 0!==this._rectangleCount}},{key:"flush",value:function(){if(0!==this._rectangleCount){var t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),t.drawElements(t.TRIANGLES,6*this._rectangleCount,this._quads.bufferGlType,0),ce.DrawnImagesCount+=this._rectangleCount,ce.DrawCallCount++,this._rectangleCount=0,this._vertexIndex=0}}}]),t}(),me=function(){function t(){(0,b.Z)(this,t),this.type="ex.circle",this.priority=0,this._maxCircles=10922,this._circleCount=0,this._vertexIndex=0}return(0,k.Z)(t,[{key:"initialize",value:function(t,e){this._gl=t,this._context=e,this._shader=new se({fragmentSource:"#version 300 es\r\nprecision highp float;\r\n\r\n// UV coord\r\nin vec2 v_uv;\r\n\r\n// Color coord to blend with image\r\nin lowp vec4 v_color;\r\n\r\n// Stroke color if used\r\nin lowp vec4 v_strokeColor;\r\n\r\n// Stroke thickness if used\r\nin lowp float v_strokeThickness;\r\n\r\n// Opacity\r\nin float v_opacity;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n  // make (0, 0) the center the uv \r\n  vec2 uv = v_uv * 2.0 - 1.0;\r\n\r\n  vec4 color = v_color;\r\n  vec4 strokeColor = v_strokeColor;\r\n\r\n  // circle border is at radius 1.0 \r\n  // dist is > 0 when inside the circle \r\n  float d = length(uv);\r\n  float dist = 1.0 - length(uv);\r\n\r\n  // Fade based on fwidth\r\n  float fade = fwidth(dot(uv, uv));\r\n\r\n  // if dist is greater than 0 step to 1;\r\n  // when we cross this 0 threshold add a smooth fade\r\n  float fill = smoothstep(-fade/2.0, fade/2.0, dist);\r\n\r\n  // if dist is greater than the stroke thickness step to 1\r\n  float stroke = 1.0 - smoothstep(v_strokeThickness, v_strokeThickness + fade, dist);\r\n\r\n  strokeColor.a *= fill * stroke;\r\n  strokeColor.rgb *= strokeColor.a;\r\n\r\n  color.a *= fill * (1.0 - stroke);\r\n  color.rgb *= color.a;\r\n\r\n  vec4 finalColor = mix(vec4(0.0), (color + strokeColor), fill);\r\n  finalColor.rgb = finalColor.rgb * v_opacity;\r\n  finalColor.a = finalColor.a * v_opacity;\r\n  fragColor = finalColor;\r\n}",vertexSource:"#version 300 es\r\nin vec2 a_position;\r\n\r\n// UV coordinate\r\nin vec2 a_uv;\r\nout vec2 v_uv;\r\n\r\n// Opacity \r\nin float a_opacity;\r\nout float v_opacity;\r\n\r\nin vec4 a_color;\r\nout vec4 v_color;\r\n\r\nin vec4 a_strokeColor;\r\nout vec4 v_strokeColor;\r\n\r\nin float a_strokeThickness;\r\nout float v_strokeThickness;\r\n\r\nuniform mat4 u_matrix;\r\n\r\n\r\nvoid main() {\r\n   // Set the vertex position using the ortho transform matrix\r\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\r\n\r\n   // Pass through UV coords\r\n   v_uv = a_uv;\r\n   // Pass through the Opacity to the fragment shader\r\n   v_opacity = a_opacity;\r\n   // Pass through the color to the fragment shader\r\n   v_color = a_color;\r\n   // Pass through the stroke color to the fragment shader\r\n   v_strokeColor = a_strokeColor;\r\n   // Pass through the stroke thickenss to the fragment shader\r\n   v_strokeThickness = a_strokeThickness;\r\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",e.ortho),this._buffer=new le({size:56*this._maxCircles,type:"dynamic"}),this._layout=new ue({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new ve(this._maxCircles,!0)}},{key:"_isFull",value:function(){return this._circleCount>=this._maxCircles}},{key:"draw",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:X.Transparent,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this._isFull()&&this.flush(),this._circleCount++;var o=this._context.getTransform(),a=this._context.opacity,s=this._context.snapToPixel,l=o.multiply(t.add(N(-e,-e))),u=o.multiply(t.add(N(e,-e))),c=o.multiply(t.add(N(e,e))),h=o.multiply(t.add(N(-e,e)));s&&(l.x=~~(l.x+xe),l.y=~~(l.y+xe),u.x=~~(u.x+xe),u.y=~~(u.y+xe),h.x=~~(h.x+xe),h.y=~~(h.y+xe),c.x=~~(c.x+xe),c.y=~~(c.y+xe));var d=0,f=0,p=1,v=1,g=this._layout.vertexBuffer.bufferData;g[this._vertexIndex++]=l.x,g[this._vertexIndex++]=l.y,g[this._vertexIndex++]=d,g[this._vertexIndex++]=f,g[this._vertexIndex++]=a,g[this._vertexIndex++]=n.r/255,g[this._vertexIndex++]=n.g/255,g[this._vertexIndex++]=n.b/255,g[this._vertexIndex++]=n.a,g[this._vertexIndex++]=i.r/255,g[this._vertexIndex++]=i.g/255,g[this._vertexIndex++]=i.b/255,g[this._vertexIndex++]=i.a,g[this._vertexIndex++]=r/e,g[this._vertexIndex++]=h.x,g[this._vertexIndex++]=h.y,g[this._vertexIndex++]=d,g[this._vertexIndex++]=v,g[this._vertexIndex++]=a,g[this._vertexIndex++]=n.r/255,g[this._vertexIndex++]=n.g/255,g[this._vertexIndex++]=n.b/255,g[this._vertexIndex++]=n.a,g[this._vertexIndex++]=i.r/255,g[this._vertexIndex++]=i.g/255,g[this._vertexIndex++]=i.b/255,g[this._vertexIndex++]=i.a,g[this._vertexIndex++]=r/e,g[this._vertexIndex++]=u.x,g[this._vertexIndex++]=u.y,g[this._vertexIndex++]=p,g[this._vertexIndex++]=f,g[this._vertexIndex++]=a,g[this._vertexIndex++]=n.r/255,g[this._vertexIndex++]=n.g/255,g[this._vertexIndex++]=n.b/255,g[this._vertexIndex++]=n.a,g[this._vertexIndex++]=i.r/255,g[this._vertexIndex++]=i.g/255,g[this._vertexIndex++]=i.b/255,g[this._vertexIndex++]=i.a,g[this._vertexIndex++]=r/e,g[this._vertexIndex++]=c.x,g[this._vertexIndex++]=c.y,g[this._vertexIndex++]=p,g[this._vertexIndex++]=v,g[this._vertexIndex++]=a,g[this._vertexIndex++]=n.r/255,g[this._vertexIndex++]=n.g/255,g[this._vertexIndex++]=n.b/255,g[this._vertexIndex++]=n.a,g[this._vertexIndex++]=i.r/255,g[this._vertexIndex++]=i.g/255,g[this._vertexIndex++]=i.b/255,g[this._vertexIndex++]=i.a,g[this._vertexIndex++]=r/e}},{key:"hasPendingDraws",value:function(){return 0!==this._circleCount}},{key:"flush",value:function(){if(0!==this._circleCount){var t=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),t.drawElements(t.TRIANGLES,6*this._circleCount,this._quads.bufferGlType,0),ce.DrawnImagesCount+=this._circleCount,ce.DrawCallCount++,this._circleCount=0,this._vertexIndex=0}}}]),t}(),_e=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;(0,b.Z)(this,t),this.builder=e,this.recycler=n,this.maxObjects=i,this.totalAllocations=0,this.index=0,this.objects=[],this.disableWarnings=!1,this._logger=U.getInstance()}return(0,k.Z)(t,[{key:"preallocate",value:function(){for(var t=0;t<this.maxObjects;t++)this.objects[t]=this.builder()}},{key:"using",value:function(t){var e=t(this);return e?this.done.apply(this,(0,x.Z)(e)):this.done()}},{key:"borrow",value:function(t){t(this.get()),this.index--}},{key:"get",value:function(){this.index===this.maxObjects&&(this.disableWarnings||this._logger.warn("Max pooled objects reached, possible memory leak? Doubling"),this.maxObjects=2*this.maxObjects);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.objects[this.index])return this.recycler.apply(this,[this.objects[this.index++]].concat(e));this.totalAllocations++;var i=this.objects[this.index++]=this.builder.apply(this,e);return i}},{key:"done",value:function(){this.index=0;for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var i=0,r=e;i<r.length;i++){var o=r[i],a=this.objects.indexOf(o);this.objects[a]=this.builder(),this.totalAllocations++}return e}}]),t}(),we=(0,k.Z)((function t(){(0,b.Z)(this,t),this.z=0,this.priority=0,this.transform=ot.identity(),this.state={z:0,opacity:1,tint:X.White}})),xe=1e-4,be=function(){function t(e){(0,b.Z)(this,t),this._webglCtx=e,this._debugText=new te}return(0,k.Z)(t,[{key:"drawRect",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{color:X.Black};this.drawLine(N(t,e),N(t+n,e),d({},r)),this.drawLine(N(t+n,e),N(t+n,e+i),d({},r)),this.drawLine(N(t+n,e+i),N(t,e+i),d({},r)),this.drawLine(N(t,e+i),N(t,e),d({},r))}},{key:"drawLine",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{color:X.Black};this._webglCtx.draw("ex.line",t,e,n.color)}},{key:"drawPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{color:X.Black,size:5};this._webglCtx.draw("ex.point",t,e.color,e.size)}},{key:"drawText",value:function(t,e){this._debugText.write(this._webglCtx,t,e)}}]),t}(),ke=function(){function t(e){(0,b.Z)(this,t),this._logger=U.getInstance(),this._renderers=new Map,this._isDrawLifecycle=!1,this.useDrawSorting=!0,this._drawCallPool=new _e((function(){return new we}),(function(t){return t.priority=0,t.z=0,t.renderer=void 0,t.args=void 0,t}),4e3),this._drawCalls=[],this._postProcessTargets=[],this._postprocessors=[],this._transform=new at,this._state=new st,this.snapToPixel=!1,this.smoothing=!1,this.backgroundColor=X.ExcaliburBlue,this._alreadyWarnedDrawLifecycle=!1,this.debug=new be(this);var n=e.canvasElement,i=e.enableTransparency,r=e.smoothing,o=e.snapToPixel,a=e.backgroundColor,s=e.useDrawSorting;if(this.__gl=n.getContext("webgl2",{antialias:null!==r&&void 0!==r?r:this.smoothing,premultipliedAlpha:!1,alpha:null===i||void 0===i||i,depth:!0,powerPreference:"high-performance"}),!this.__gl)throw Error("Failed to retrieve webgl context from browser");ie.register(this.__gl),Kt.register(this.__gl),this.snapToPixel=null!==o&&void 0!==o?o:this.snapToPixel,this.smoothing=null!==r&&void 0!==r?r:this.smoothing,this.backgroundColor=null!==a&&void 0!==a?a:this.backgroundColor,this.useDrawSorting=null!==s&&void 0!==s?s:this.useDrawSorting,this._drawCallPool.disableWarnings=!0,this._drawCallPool.preallocate(),this._init()}return(0,k.Z)(t,[{key:"z",get:function(){return this._state.current.z},set:function(t){this._state.current.z=t}},{key:"opacity",get:function(){return this._state.current.opacity},set:function(t){this._state.current.opacity=t}},{key:"tint",get:function(){return this._state.current.tint},set:function(t){this._state.current.tint=t}},{key:"width",get:function(){return this.__gl.canvas.width}},{key:"height",get:function(){return this.__gl.canvas.height}},{key:"ortho",get:function(){return this._ortho}},{key:"checkIfResolutionSupported",value:function(t){var e=!0;return(t.width>4096||t.height>4096)&&(e=!1),e}},{key:"_init",value:function(){var t=this.__gl;this._ortho=rt.ortho(0,t.canvas.width,t.canvas.height,0,400,-400),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this.register(new ge),this.register(new ye),this.register(new me),this.register(new fe),this.register(new de),this._screenRenderer=new pe(t),this._renderTarget=new ne({gl:t,width:t.canvas.width,height:t.canvas.height}),this._postProcessTargets=[new ne({gl:t,width:t.canvas.width,height:t.canvas.height}),new ne({gl:t,width:t.canvas.width,height:t.canvas.height})]}},{key:"register",value:function(t){this._renderers.set(t.type,t),t.initialize(this.__gl,this)}},{key:"get",value:function(t){return this._renderers.get(t)}},{key:"_isCurrentRenderer",value:function(t){return!this._currentRenderer||this._currentRenderer===t}},{key:"beginDrawLifecycle",value:function(){this._isDrawLifecycle=!0}},{key:"endDrawLifecycle",value:function(){this._isDrawLifecycle=!1}},{key:"draw",value:function(t){this._isDrawLifecycle||this._alreadyWarnedDrawLifecycle||(this._logger.warn("Attempting to draw outside the the drawing lifecycle (preDraw/postDraw) is not supported and is a source of bugs/errors.\nIf you want to do custom drawing, use Actor.graphics, or any onPreDraw or onPostDraw handler."),this._alreadyWarnedDrawLifecycle=!0);var e=this._renderers.get(t);if(!e)throw Error("No renderer with name ".concat(t," has been registered"));for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];if(this.useDrawSorting){var o=this._drawCallPool.get();o.z=this._state.current.z,o.priority=e.priority,o.renderer=t,this.getTransform().clone(o.transform),o.state.z=this._state.current.z,o.state.opacity=this._state.current.opacity,o.state.tint=this._state.current.tint,o.args=i,this._drawCalls.push(o)}else this._currentRenderer||(this._currentRenderer=e),this._isCurrentRenderer(e)||this._currentRenderer.flush(),e.draw.apply(e,i),this._currentRenderer=e}},{key:"resetTransform",value:function(){this._transform.current=ot.identity()}},{key:"updateViewport",value:function(t){var e=this.__gl;this._ortho=this._ortho=rt.ortho(0,t.width,t.height,0,400,-400),this._renderTarget.setResolution(e.canvas.width,e.canvas.height),this._postProcessTargets[0].setResolution(e.canvas.width,e.canvas.height),this._postProcessTargets[1].setResolution(e.canvas.width,e.canvas.height)}},{key:"drawImage",value:function(t,e,n,i,r,o,a,s,l){if(0!==i&&0!==r&&0!==s&&0!==l&&0!==t.width&&0!==t.height)return t?void this.draw("ex.image",t,e,n,i,r,o,a,s,l):(U.getInstance().warn("Cannot draw a null or undefined image"),void(console.trace&&console.trace()))}},{key:"drawLine",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.draw("ex.rectangle",t,e,n,i)}},{key:"drawRectangle",value:function(t,e,n,i,r,o){this.draw("ex.rectangle",t,e,n,i,r,o)}},{key:"drawCircle",value:function(t,e,n,i,r){this.draw("ex.circle",t,e,n,i,r)}},{key:"save",value:function(){this._transform.save(),this._state.save()}},{key:"restore",value:function(){this._transform.restore(),this._state.restore()}},{key:"translate",value:function(t,e){this._transform.translate(this.snapToPixel?~~(t+xe):t,this.snapToPixel?~~(e+xe):e)}},{key:"rotate",value:function(t){this._transform.rotate(t)}},{key:"scale",value:function(t,e){this._transform.scale(t,e)}},{key:"transform",value:function(t){this._transform.current=t}},{key:"getTransform",value:function(){return this._transform.current}},{key:"multiply",value:function(t){this._transform.current.multiply(t,this._transform.current)}},{key:"addPostProcessor",value:function(t){this._postprocessors.push(t),t.initialize(this.__gl)}},{key:"removePostProcessor",value:function(t){var e=this._postprocessors.indexOf(t);-1!==e&&this._postprocessors.splice(e,1)}},{key:"clearPostProcessors",value:function(){this._postprocessors.length=0}},{key:"clear",value:function(){var t=this.__gl;this._renderTarget.use(),t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT)}},{key:"flush",value:function(){var t=this,e=this.__gl;if(this._renderTarget.use(),this.useDrawSorting){var n,i=new Map,r=(0,m.Z)(this._renderers);try{var a=function(){var e=(0,o.Z)(n.value,1)[0],r=t._drawCalls.findIndex((function(t){return t.renderer===e}));i.set(e,r)};for(r.s();!(n=r.n()).done;)a()}catch(y){r.e(y)}finally{r.f()}this._drawCalls.sort((function(t,e){var n=t.z-e.z,r=i.get(t.renderer)-i.get(e.renderer),o=t.priority-e.priority;return 0===n?0===o?r:o:n}));var s=this._transform.current,l=this._state.current;if(this._drawCalls.length){for(var u=this._drawCalls[0].renderer,c=this._renderers.get(u),h=0;h<this._drawCalls.length;h++){var d;this._transform.current=this._drawCalls[h].transform,this._state.current=this._drawCalls[h].state,this._drawCalls[h].renderer!==u&&(c.flush(),u=this._drawCalls[h].renderer,c=this._renderers.get(u)),(d=c).draw.apply(d,(0,x.Z)(this._drawCalls[h].args))}c.hasPendingDraws()&&c.flush()}this._transform.current=s,this._state.current=l,this._drawCallPool.done(),this._drawCalls.length=0}else{var f,p=(0,m.Z)(this._renderers.values());try{for(p.s();!(f=p.n()).done;){var v=f.value;v.hasPendingDraws()&&v.flush()}}catch(y){p.e(y)}finally{p.f()}}this._renderTarget.disable(),this._renderTarget.toRenderSource().use();for(var g=0;g<this._postprocessors.length;g++)this._postProcessTargets[g%2].use(),this._screenRenderer.renderWithPostProcessor(this._postprocessors[g]),this._postProcessTargets[g%2].toRenderSource().use();e.bindFramebuffer(e.FRAMEBUFFER,null),this._screenRenderer.renderToScreen()}}]),t}(),Ce=1e-4,Se=function(){function t(e){(0,b.Z)(this,t),this._ex=e,this._debugText=new te}return(0,k.Z)(t,[{key:"drawRect",value:function(t,e,n,i){this._ex.__ctx.save(),this._ex.__ctx.strokeStyle="red",this._ex.__ctx.strokeRect(this._ex.snapToPixel?~~(t+Ce):t,this._ex.snapToPixel?~~(e+Ce):e,this._ex.snapToPixel?~~(n+Ce):n,this._ex.snapToPixel?~~(i+Ce):i),this._ex.__ctx.restore()}},{key:"drawLine",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{color:X.Black};this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.strokeStyle=n.color.toString(),this._ex.__ctx.moveTo(this._ex.snapToPixel?~~(t.x+Ce):t.x,this._ex.snapToPixel?~~(t.y+Ce):t.y),this._ex.__ctx.lineTo(this._ex.snapToPixel?~~(e.x+Ce):e.x,this._ex.snapToPixel?~~(e.y+Ce):e.y),this._ex.__ctx.lineWidth=2,this._ex.__ctx.stroke(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}},{key:"drawPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{color:X.Black,size:5};this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.fillStyle=e.color.toString(),this._ex.__ctx.arc(this._ex.snapToPixel?~~(t.x+Ce):t.x,this._ex.snapToPixel?~~(t.y+Ce):t.y,e.size,0,2*Math.PI),this._ex.__ctx.fill(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}},{key:"drawText",value:function(t,e){this._debugText.write(this._ex,t,e)}}]),t}(),Ae=function(){function t(e){(0,b.Z)(this,t),this.useDrawSorting=!1,this.z=0,this.backgroundColor=X.ExcaliburBlue,this._state=new st,this.snapToPixel=!1,this.debug=new Se(this);var n=e.canvasElement,i=e.enableTransparency,r=e.snapToPixel,o=e.smoothing,a=e.backgroundColor;this.__ctx=n.getContext("2d",{alpha:null===i||void 0===i||i}),this.backgroundColor=null!==a&&void 0!==a?a:this.backgroundColor,this.snapToPixel=null!==r&&void 0!==r?r:this.snapToPixel,this.smoothing=null!==o&&void 0!==o?o:this.smoothing}return(0,k.Z)(t,[{key:"width",get:function(){return this.__ctx.canvas.width}},{key:"height",get:function(){return this.__ctx.canvas.height}},{key:"opacity",get:function(){return this._state.current.opacity},set:function(t){this._state.current.opacity=t}},{key:"tint",get:function(){return this._state.current.tint},set:function(t){this._state.current.tint=t}},{key:"smoothing",get:function(){return this.__ctx.imageSmoothingEnabled},set:function(t){this.__ctx.imageSmoothingEnabled=t}},{key:"resetTransform",value:function(){this.__ctx.resetTransform()}},{key:"updateViewport",value:function(t){}},{key:"drawImage",value:function(t,e,n,i,r,o,a,s,l){var u=this;if(0!==i&&0!==r&&0!==s&&0!==l&&0!==t.width&&0!==t.height){this.__ctx.globalAlpha=this.opacity;var c=[t,e,n,i,r,o,a,s,l].filter((function(t){return void 0!==t})).map((function(t){return"number"===typeof t&&u.snapToPixel?~~t:t}));this.__ctx.drawImage.apply(this.__ctx,c),ce.DrawCallCount++,ce.DrawnImagesCount=1}}},{key:"drawLine",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.__ctx.save(),this.__ctx.beginPath(),this.__ctx.strokeStyle=n.toString(),this.__ctx.moveTo(this.snapToPixel?~~(t.x+Ce):t.x,this.snapToPixel?~~(t.y+Ce):t.y),this.__ctx.lineTo(this.snapToPixel?~~(e.x+Ce):e.x,this.snapToPixel?~~(e.y+Ce):e.y),this.__ctx.lineWidth=i,this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}},{key:"drawRectangle",value:function(t,e,n,i){this.__ctx.save(),this.__ctx.fillStyle=i.toString(),this.__ctx.fillRect(this.snapToPixel?~~(t.x+Ce):t.x,this.snapToPixel?~~(t.y+Ce):t.y,this.snapToPixel?~~(e+Ce):e,this.snapToPixel?~~(n+Ce):n),this.__ctx.restore()}},{key:"drawCircle",value:function(t,e,n,i,r){this.__ctx.save(),this.__ctx.beginPath(),i&&(this.__ctx.strokeStyle=i.toString()),r&&(this.__ctx.lineWidth=r),this.__ctx.fillStyle=n.toString(),this.__ctx.arc(this.snapToPixel?~~(t.x+Ce):t.x,this.snapToPixel?~~(t.y+Ce):t.y,e,0,2*Math.PI),this.__ctx.fill(),i&&this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}},{key:"save",value:function(){this.__ctx.save()}},{key:"restore",value:function(){this.__ctx.restore()}},{key:"translate",value:function(t,e){this.__ctx.translate(this.snapToPixel?~~(t+Ce):t,this.snapToPixel?~~(e+Ce):e)}},{key:"rotate",value:function(t){this.__ctx.rotate(t)}},{key:"scale",value:function(t,e){this.__ctx.scale(t,e)}},{key:"getTransform",value:function(){throw new Error("Not implemented")}},{key:"multiply",value:function(t){this.__ctx.setTransform(this.__ctx.getTransform().multiply(t.toDOMMatrix()))}},{key:"addPostProcessor",value:function(t){}},{key:"removePostProcessor",value:function(t){}},{key:"clearPostProcessors",value:function(){}},{key:"beginDrawLifecycle",value:function(){}},{key:"endDrawLifecycle",value:function(){}},{key:"clear",value:function(){this.__ctx.clearRect(0,0,this.width,this.height),this.__ctx.fillStyle=this.backgroundColor.toString(),this.__ctx.fillRect(0,0,this.width,this.height),ce.clear()}},{key:"flush",value:function(){}}]),t}();!function(t){t.Fixed="Fixed",t.FitContainerAndFill="FitContainerAndFill",t.FitScreenAndFill="FitScreenAndFill",t.FitContainerAndZoom="FitContainerAndZoom",t.FitScreenAndZoom="FitScreenAndZoom",t.FitScreen="FitScreen",t.FillScreen="FillScreen",t.FitContainer="FitContainer",t.FillContainer="FillContainer"}(he||(he={}));var Ee=function(){function t(){(0,b.Z)(this,t)}return(0,k.Z)(t,null,[{key:"SVGA",get:function(){return{width:800,height:600}}},{key:"Standard",get:function(){return{width:1920,height:1080}}},{key:"Atari2600",get:function(){return{width:160,height:192}}},{key:"GameBoy",get:function(){return{width:160,height:144}}},{key:"GameBoyAdvance",get:function(){return{width:240,height:160}}},{key:"NintendoDS",get:function(){return{width:256,height:192}}},{key:"NES",get:function(){return{width:256,height:224}}},{key:"SNES",get:function(){return{width:256,height:244}}}]),t}(),Te=function(){function t(e){var n,i,r,o=this;(0,b.Z)(this,t),this._antialiasing=!0,this._resolutionStack=[],this._viewportStack=[],this._pixelRatioOverride=null,this._isFullScreen=!1,this._isDisposed=!1,this._logger=U.getInstance(),this._fullscreenChangeHandler=function(){o._isFullScreen=!o._isFullScreen,o._logger.debug("Fullscreen Change",o._isFullScreen)},this._pixelRatioChangeHandler=function(){o._logger.debug("Pixel Ratio Change",window.devicePixelRatio),o._listenForPixelRatio(),o._devicePixelRatio=o._calculateDevicePixelRatio(),o.applyResolutionAndViewport()},this._resizeHandler=function(){var t=o.parent;o._logger.debug("View port resized"),o._setResolutionAndViewportByDisplayMode(t),o.applyResolutionAndViewport()},this._devicePixelRatio=this._calculateDevicePixelRatio(),this._alreadyWarned=!1,this._contentArea=new q,this.viewport=e.viewport,this.resolution=null!==(n=e.resolution)&&void 0!==n?n:d({},this.viewport),this._contentResolution=this.resolution,this._displayMode=null!==(i=e.displayMode)&&void 0!==i?i:he.Fixed,this._canvas=e.canvas,this.graphicsContext=e.context,this._antialiasing=null!==(r=e.antialiasing)&&void 0!==r?r:this._antialiasing,this._browser=e.browser,this._pixelRatioOverride=e.pixelRatio,this._applyDisplayMode(),this._listenForPixelRatio(),this._canvas.addEventListener("fullscreenchange",this._fullscreenChangeHandler),this.applyResolutionAndViewport()}return(0,k.Z)(t,[{key:"_listenForPixelRatio",value:function(){this._mediaQueryList&&!this._mediaQueryList.addEventListener&&this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._mediaQueryList=this._browser.window.nativeComponent.matchMedia("(resolution: ".concat(window.devicePixelRatio,"dppx)")),this._mediaQueryList.addEventListener?this._mediaQueryList.addEventListener("change",this._pixelRatioChangeHandler,{once:!0}):this._mediaQueryList.addListener(this._pixelRatioChangeHandler)}},{key:"dispose",value:function(){this._isDisposed||(this._isDisposed=!0,this._browser.window.off("resize",this._resizeHandler),this._resizeObserver&&this._resizeObserver.disconnect(),this.parent.removeEventListener("resize",this._resizeHandler),this._mediaQueryList.removeEventListener?this._mediaQueryList.removeEventListener("change",this._pixelRatioChangeHandler):this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._canvas.removeEventListener("fullscreenchange",this._fullscreenChangeHandler))}},{key:"_calculateDevicePixelRatio",value:function(){return window.devicePixelRatio<1?1:window.devicePixelRatio||1}},{key:"pixelRatio",get:function(){return this._pixelRatioOverride?this._pixelRatioOverride:this._devicePixelRatio}},{key:"isHiDpi",get:function(){return 1!==this.pixelRatio}},{key:"displayMode",get:function(){return this._displayMode}},{key:"canvas",get:function(){return this._canvas}},{key:"parent",get:function(){switch(this.displayMode){case he.FillContainer:case he.FitContainer:case he.FitContainerAndFill:case he.FitContainerAndZoom:return this.canvas.parentElement||document.body;default:return window}}},{key:"resolution",get:function(){return this._resolution},set:function(t){this._resolution=t}},{key:"viewport",get:function(){return this._viewport?this._viewport:this._resolution},set:function(t){this._viewport=t}},{key:"aspectRatio",get:function(){return this._resolution.width/this._resolution.height}},{key:"scaledWidth",get:function(){return this._resolution.width*this.pixelRatio}},{key:"scaledHeight",get:function(){return this._resolution.height*this.pixelRatio}},{key:"setCurrentCamera",value:function(t){this._camera=t}},{key:"pushResolutionAndViewport",value:function(){this._resolutionStack.push(this.resolution),this._viewportStack.push(this.viewport),this.resolution=d({},this.resolution),this.viewport=d({},this.viewport)}},{key:"peekViewport",value:function(){return this._viewportStack[this._viewportStack.length-1]}},{key:"peekResolution",value:function(){return this._resolutionStack[this._resolutionStack.length-1]}},{key:"popResolutionAndViewport",value:function(){this.resolution=this._resolutionStack.pop(),this.viewport=this._viewportStack.pop()}},{key:"applyResolutionAndViewport",value:function(){(this._canvas.width=this.scaledWidth,this._canvas.height=this.scaledHeight,this.graphicsContext instanceof ke)&&(this.graphicsContext.checkIfResolutionSupported({width:this.scaledWidth,height:this.scaledHeight})||this._alreadyWarned||(this._alreadyWarned=!0,this._logger.warn("The currently configured resolution (".concat(this.resolution.width,"x").concat(this.resolution.height,") and pixel ratio (").concat(this.pixelRatio,")")+" are too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly. Try reducing the resolution or disabling Hi DPI scaling to avoid this (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).")));this._antialiasing?this._canvas.style.imageRendering="auto":(this._canvas.style.imageRendering="pixelated",""===this._canvas.style.imageRendering&&(this._canvas.style.imageRendering="crisp-edges")),this._canvas.style.width=this.viewport.width+"px",this._canvas.style.height=this.viewport.height+"px",this.graphicsContext.updateViewport(this.resolution),this.graphicsContext.resetTransform(),this.graphicsContext.smoothing=this._antialiasing,this.graphicsContext instanceof Ae&&this.graphicsContext.scale(this.pixelRatio,this.pixelRatio)}},{key:"antialiasing",get:function(){return this._antialiasing},set:function(t){this._antialiasing=t,this.graphicsContext.smoothing=this._antialiasing}},{key:"isFullScreen",get:function(){return this._isFullScreen}},{key:"goFullScreen",value:function(t){if(t){var e=document.getElementById(t);if(e)return e.requestFullscreen()}return this._canvas.requestFullscreen()}},{key:"exitFullScreen",value:function(){return document.exitFullscreen()}},{key:"pageToScreenCoordinates",value:function(t){var e=t.x,n=t.y;if(this._isFullScreen||(e-=K(this._canvas).x,n-=K(this._canvas).y),this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){var i=window.innerWidth/this.aspectRatio;n=(n-(window.innerHeight-i)/2)/i*this.viewport.height,e=e/window.innerWidth*this.viewport.width}else{var r=window.innerHeight*this.aspectRatio;e=(e-(window.innerWidth-r)/2)/r*this.viewport.width,n=n/window.innerHeight*this.viewport.height}return e=e/this.viewport.width*this.resolution.width,n=n/this.viewport.height*this.resolution.height,new O(e,n)}},{key:"screenToPageCoordinates",value:function(t){var e=t.x,n=t.y;if(e=e/this.resolution.width*this.viewport.width,n=n/this.resolution.height*this.viewport.height,this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){var i=window.innerWidth/this.aspectRatio,r=(window.innerHeight-i)/2;n=n/this.viewport.height*i+r,e=e/this.viewport.width*window.innerWidth}else{var o=window.innerHeight*this.aspectRatio,a=(window.innerWidth-o)/2;e=e/this.viewport.width*o+a,n=n/this.viewport.height*window.innerHeight}return this._isFullScreen||(e+=K(this._canvas).x,n+=K(this._canvas).y),new O(e,n)}},{key:"screenToWorldCoordinates",value:function(t){return this._camera?this._camera.inverse.multiply(t):t.sub(N(this.resolution.width/2,this.resolution.height/2))}},{key:"worldToScreenCoordinates",value:function(t){return this._camera?this._camera.transform.multiply(t):t.add(N(this.resolution.width/2,this.resolution.height/2))}},{key:"pageToWorldCoordinates",value:function(t){var e=this.pageToScreenCoordinates(t);return this.screenToWorldCoordinates(e)}},{key:"worldToPageCoordinates",value:function(t){var e=this.worldToScreenCoordinates(t);return this.screenToPageCoordinates(e)}},{key:"getWorldBounds",value:function(){var t=this.screenToWorldCoordinates(O.Zero),e=t.x+this.drawWidth,n=t.y+this.drawHeight;return new q(t.x,t.y,e,n)}},{key:"canvasWidth",get:function(){return this.canvas.width}},{key:"halfCanvasWidth",get:function(){return this.canvas.width/2}},{key:"canvasHeight",get:function(){return this.canvas.height}},{key:"halfCanvasHeight",get:function(){return this.canvas.height/2}},{key:"drawWidth",get:function(){return this._camera?this.resolution.width/this._camera.zoom:this.resolution.width}},{key:"halfDrawWidth",get:function(){return this.drawWidth/2}},{key:"drawHeight",get:function(){return this._camera?this.resolution.height/this._camera.zoom:this.resolution.height}},{key:"halfDrawHeight",get:function(){return this.drawHeight/2}},{key:"center",get:function(){return N(this.halfDrawWidth,this.halfDrawHeight)}},{key:"contentArea",get:function(){return this._contentArea}},{key:"_computeFit",value:function(){document.body.style.margin="0px",document.body.style.overflow="hidden";var t=this.aspectRatio,e=0,n=0;window.innerWidth/t<window.innerHeight?(e=window.innerWidth,n=window.innerWidth/t):(e=window.innerHeight*t,n=window.innerHeight),this.viewport={width:e,height:n},this._contentArea=q.fromDimension(this.resolution.width,this.resolution.height,O.Zero)}},{key:"_computeFitScreenAndFill",value:function(){document.body.style.margin="0px",document.body.style.overflow="hidden";var t=window.innerWidth,e=window.innerHeight;this._computeFitAndFill(t,e)}},{key:"_computeFitContainerAndFill",value:function(){document.body.style.margin="0px",document.body.style.overflow="hidden";var t=this.canvas.parentElement,e=t.clientWidth,n=t.clientHeight;this._computeFitAndFill(e,n)}},{key:"_computeFitAndFill",value:function(t,e){if(this.viewport={width:t,height:e},t/e<=this._contentResolution.width/this._contentResolution.height){this.resolution={width:t*this._contentResolution.width/t,height:t*this._contentResolution.width/t*e/t};var n=(this.resolution.height-this._contentResolution.height)/2;this._contentArea=new q({top:n,left:0,right:this._contentResolution.width,bottom:this.resolution.height-n})}else{this.resolution={width:e*this._contentResolution.height/e*t/e,height:e*this._contentResolution.height/e};var i=(this.resolution.width-this._contentResolution.width)/2;this._contentArea=new q({top:0,left:i,right:this.resolution.width-i,bottom:this._contentResolution.height})}}},{key:"_computeFitScreenAndZoom",value:function(){document.body.style.margin="0px",document.body.style.overflow="hidden",this.canvas.style.position="absolute";var t=window.innerWidth,e=window.innerHeight;this._computeFitAndZoom(t,e)}},{key:"_computeFitContainerAndZoom",value:function(){document.body.style.margin="0px",document.body.style.overflow="hidden",this.canvas.style.position="absolute";var t=this.canvas.parentElement;t.style.position="relative",t.style.overflow="hidden";var e=t.clientWidth,n=t.clientHeight;this._computeFitAndZoom(e,n)}},{key:"_computeFitAndZoom",value:function(t,e){var n=this.aspectRatio,i=0,r=0;t/n<e?(i=t,r=t/n):(i=e*n,r=e);var o=t/i,a=e/r,s=Math.max(o,a),l=i*s,u=r*s;this.canvas.style.left=l>t?-(l-t)/2+"px":"",this.canvas.style.top=u>e?-(u-e)/2+"px":"",this.viewport={width:l,height:u};var c=q.fromDimension(this.viewport.width,this.viewport.height,O.Zero);if(this.viewport.width>t){var h=(this.viewport.width-t)/this.viewport.width*this.resolution.width;c.top=0,c.left=h/2,c.right=this.resolution.width-h/2,c.bottom=this.resolution.height}if(this.viewport.height>e){var d=(this.viewport.height-e)/this.viewport.height*this.resolution.height;c.top=d/2,c.left=0,c.bottom=this.resolution.height-d/2,c.right=this.resolution.width}this._contentArea=c}},{key:"_computeFitContainer",value:function(){var t=this.aspectRatio,e=0,n=0,i=this.canvas.parentElement;i.clientWidth/t<i.clientHeight?(e=i.clientWidth,n=i.clientWidth/t):(e=i.clientHeight*t,n=i.clientHeight),this.viewport={width:e,height:n},this._contentArea=q.fromDimension(this.resolution.width,this.resolution.height,O.Zero)}},{key:"_applyDisplayMode",value:function(){var t=this;this._setResolutionAndViewportByDisplayMode(this.parent),this.parent instanceof Window?this._browser.window.on("resize",this._resizeHandler):(this._resizeObserver=new ResizeObserver((function(){t._resizeHandler()})),this._resizeObserver.observe(this.parent)),this.parent.addEventListener("resize",this._resizeHandler)}},{key:"_setResolutionAndViewportByDisplayMode",value:function(t){this.displayMode===he.FillContainer&&(this.resolution={width:t.clientWidth,height:t.clientHeight},this.viewport=this.resolution),this.displayMode===he.FillScreen&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.resolution={width:t.innerWidth,height:t.innerHeight},this.viewport=this.resolution),this.displayMode===he.FitScreen&&this._computeFit(),this.displayMode===he.FitContainer&&this._computeFitContainer(),this.displayMode===he.FitScreenAndFill&&this._computeFitScreenAndFill(),this.displayMode===he.FitContainerAndFill&&this._computeFitContainerAndFill(),this.displayMode===he.FitScreenAndZoom&&this._computeFitScreenAndZoom(),this.displayMode===he.FitContainerAndZoom&&this._computeFitContainerAndZoom()}}]),t}(),Pe=function(){function t(){(0,b.Z)(this,t)}return(0,k.Z)(t,null,[{key:"create",value:function(){return this._INSTANCE||(window.AudioContext||window.webkitAudioContext)&&(this._INSTANCE=new AudioContext),this._INSTANCE}}]),t}();Pe._INSTANCE=null;var Ie=function(){function t(){(0,b.Z)(this,t)}return(0,k.Z)(t,null,[{key:"unlock",value:function(){return new Promise((function(e,n){if(t._UNLOCKED||!Pe.create())return e(!0);var i=setTimeout((function(){U.getInstance().warn("Excalibur was unable to unlock the audio context, audio probably will not play in this browser."),e(!1)}),200),r=Pe.create();r.resume().then((function(){var n=r.createBuffer(1,1,22050),o=r.createBufferSource(),a=!1;o.buffer=n,o.connect(r.destination),o.onended=function(){return a=!0},o.start(0),setTimeout((function(){!function(t){return!!t.playbackState}(o)?(r.currentTime>0||a)&&(t._UNLOCKED=!0):o.playbackState!==o.PLAYING_STATE&&o.playbackState!==o.FINISHED_STATE||(t._UNLOCKED=!0)}),0),clearTimeout(i),e(!0)}),(function(){n()}))}))}},{key:"isUnlocked",value:function(){return this._UNLOCKED}}]),t}();Ie._UNLOCKED=!1;var Ze=function(){function t(){(0,b.Z)(this,t),this.eventDispatcher=new Wt}return(0,k.Z)(t,[{key:"on",value:function(t,e){this.eventDispatcher.on(t,e)}},{key:"off",value:function(t,e){this.eventDispatcher.off(t,e)}},{key:"emit",value:function(t,e){this.eventDispatcher.emit(t,e)}},{key:"once",value:function(t,e){this.eventDispatcher.once(t,e)}}]),t}();function Re(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X.Red,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"butt";t.save(),t.beginPath(),t.lineWidth=a,t.lineCap=s,t.strokeStyle=e.toString(),t.moveTo(n,i),t.lineTo(r,o),t.closePath(),t.stroke(),t.restore()}function Me(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X.Red,n=arguments.length>2?arguments[2]:void 0;t.beginPath(),t.strokeStyle=e.toString(),t.arc(n.x,n.y,5,0,2*Math.PI),t.closePath(),t.stroke()}function Fe(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=e?e.toString():"blue",a=i.scale(r);t.beginPath(),t.strokeStyle=o,t.moveTo(n.x,n.y),t.lineTo(n.x+a.x,n.y+a.y),t.closePath(),t.stroke()}function De(t,e,n,i,r){var o,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:X.White,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if("number"===typeof a)o={tl:a,tr:a,br:a,bl:a};else{var u={tl:0,tr:0,br:0,bl:0};for(var c in u)if(u.hasOwnProperty(c)){var h=c;o[h]=a[h]||u[h]}}t.beginPath(),t.moveTo(e+o.tl,n),t.lineTo(e+i-o.tr,n),t.quadraticCurveTo(e+i,n,e+i,n+o.tr),t.lineTo(e+i,n+r-o.br),t.quadraticCurveTo(e+i,n+r,e+i-o.br,n+r),t.lineTo(e+o.bl,n+r),t.quadraticCurveTo(e,n+r,e,n+r-o.bl),t.lineTo(e,n+o.tl),t.quadraticCurveTo(e,n,e+o.tl,n),t.closePath(),l&&(t.fillStyle=l.toString(),t.fill()),s&&(t.strokeStyle=s.toString(),t.stroke())}function Be(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:X.White,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;t.beginPath(),t.arc(e,n,i,0,2*Math.PI),t.closePath(),o&&(t.fillStyle=o.toString(),t.fill()),r&&(t.strokeStyle=r.toString(),t.stroke())}var ze=A(1388),Le=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i,r,o,a,s,l,u,c,h,d,f;(0,b.Z)(this,n),(i=e.call(this,t)).filtering=null,i.lineCap="butt",i.quality=1,i._dirty=!0,i._smoothing=!1,i._color=Xt(X.Black,(function(){return i.flagDirty()})),i._lineWidth=1,i._lineDash=[],i._padding=0,t&&(i.quality=null!==(r=t.quality)&&void 0!==r?r:i.quality,i.color=null!==(o=t.color)&&void 0!==o?o:X.Black,i.strokeColor=null===t||void 0===t?void 0:t.strokeColor,i.smoothing=null!==(a=t.smoothing)&&void 0!==a?a:i.smoothing,i.lineWidth=null!==(s=t.lineWidth)&&void 0!==s?s:i.lineWidth,i.lineDash=null!==(l=t.lineDash)&&void 0!==l?l:i.lineDash,i.lineCap=null!==(u=t.lineCap)&&void 0!==u?u:i.lineCap,i.padding=null!==(c=t.padding)&&void 0!==c?c:i.padding,i.filtering=null!==(h=t.filtering)&&void 0!==h?h:i.filtering),i._bitmap=document.createElement("canvas");var p=null!==(d=null===t||void 0===t?void 0:t.width)&&void 0!==d?d:i._bitmap.width,v=null!==(f=null===t||void 0===t?void 0:t.height)&&void 0!==f?f:i._bitmap.height;i.width=p,i.height=v;var g=i._bitmap.getContext("2d");if(!g)throw new Error("Browser does not support 2d canvas drawing, cannot create Raster graphic");return i._ctx=g,i}return(0,k.Z)(n,[{key:"cloneRasterOptions",value:function(){return{color:this.color?this.color.clone():null,strokeColor:this.strokeColor?this.strokeColor.clone():null,smoothing:this.smoothing,lineWidth:this.lineWidth,lineDash:this.lineDash,lineCap:this.lineCap,quality:this.quality,padding:this.padding}}},{key:"dirty",get:function(){return this._dirty}},{key:"flagDirty",value:function(){this._dirty=!0}},{key:"width",get:function(){return Math.abs(this._getTotalWidth()*this.scale.x)},set:function(t){t/=Math.abs(this.scale.x),this._bitmap.width=t,this._originalWidth=t,this.flagDirty()}},{key:"height",get:function(){return Math.abs(this._getTotalHeight()*this.scale.y)},set:function(t){t/=Math.abs(this.scale.y),this._bitmap.height=t,this._originalHeight=t,this.flagDirty()}},{key:"_getTotalWidth",value:function(){var t;return 1*((null!==(t=this._originalWidth)&&void 0!==t?t:this._bitmap.width)+2*this.padding)}},{key:"_getTotalHeight",value:function(){var t;return 1*((null!==(t=this._originalHeight)&&void 0!==t?t:this._bitmap.height)+2*this.padding)}},{key:"localBounds",get:function(){return q.fromDimension(this._getTotalWidth()*this.scale.x,this._getTotalHeight()*this.scale.y,O.Zero)}},{key:"smoothing",get:function(){return this._smoothing},set:function(t){this._smoothing=t,this.flagDirty()}},{key:"color",get:function(){return this._color},set:function(t){var e=this;this.flagDirty(),this._color=Xt(t,(function(){return e.flagDirty()}))}},{key:"strokeColor",get:function(){return this._strokeColor},set:function(t){var e=this;this.flagDirty(),this._strokeColor=Xt(t,(function(){return e.flagDirty()}))}},{key:"lineWidth",get:function(){return this._lineWidth},set:function(t){this._lineWidth=t,this.flagDirty()}},{key:"lineDash",get:function(){return this._lineDash},set:function(t){this._lineDash=t,this.flagDirty()}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding=t,this.flagDirty()}},{key:"rasterize",value:function(){this._dirty=!1,this._ctx.clearRect(0,0,this._getTotalWidth(),this._getTotalHeight()),this._ctx.save(),this._applyRasterProperties(this._ctx),this.execute(this._ctx),this._ctx.restore(),Kt.load(this._bitmap,this.filtering,!0)}},{key:"_applyRasterProperties",value:function(t){var e,n,i;this._bitmap.width=this._getTotalWidth()*this.quality,this._bitmap.height=this._getTotalHeight()*this.quality,t.scale(this.quality,this.quality),t.translate(this.padding,this.padding),t.imageSmoothingEnabled=this.smoothing,t.lineWidth=this.lineWidth,t.setLineDash(null!==(e=this.lineDash)&&void 0!==e?e:t.getLineDash()),t.lineCap=this.lineCap,t.strokeStyle=null===(n=this.strokeColor)||void 0===n?void 0:n.toString(),t.fillStyle=null===(i=this.color)||void 0===i?void 0:i.toString()}},{key:"_drawImage",value:function(t,e,n){this._dirty&&this.rasterize(),t.scale(1/this.quality,1/this.quality),t.drawImage(this._bitmap,e,n)}}]),n}(jt),Oe=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this,t))._options=t,i}return(0,k.Z)(n,[{key:"ctx",get:function(){return this._ctx}},{key:"clone",value:function(){return new n(d(d(d({},this._options),this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){var e,n;(null===(e=this._options)||void 0===e?void 0:e.draw)&&(null===(n=this._options)||void 0===n||n.draw(t)),this._options.cache||this.flagDirty()}}]),n}(Le),Ne=(0,k.Z)((function t(){(0,b.Z)(this,t)}));Ne.type={any:"",blob:"blob",json:"json",text:"text",document:"document",arraybuffer:"arraybuffer"};var Ue=function(){function t(){(0,b.Z)(this,t),this.states=new Map}return(0,k.Z)(t,[{key:"currentState",get:function(){return this._currentState},set:function(t){this._currentState=t}},{key:"in",value:function(t){return this.currentState.name===t}},{key:"go",value:function(t,e){var n,i;if(this.currentState.transitions.includes(t)||this.currentState.transitions.includes("*")){var r=this.states.get(t);if(this.currentState.onExit)if(!1===(null===(n=this.currentState)||void 0===n?void 0:n.onExit({to:r.name,data:this.data})))return!1;if(null===r||void 0===r?void 0:r.onEnter)if(!1===(null===r||void 0===r?void 0:r.onEnter({from:this.currentState.name,eventData:e,data:this.data})))return!1;return this.currentState=r,(null===(i=this.currentState)||void 0===i?void 0:i.onState)&&this.currentState.onState(),!0}return!1}},{key:"update",value:function(t){this.currentState.onUpdate&&this.currentState.onUpdate(this.data,t)}},{key:"save",value:function(t){localStorage.setItem(t,JSON.stringify({currentState:this.currentState.name,data:this.data}))}},{key:"restore",value:function(t){var e=JSON.parse(localStorage.getItem(t));this.currentState=this.states.get(e.currentState),this.data=e.data}}],[{key:"create",value:function(e,n){var i=new t;for(var r in i.data=n,e.states)i.states.set(r,d({name:r},e.states[r]));var o,a=(0,m.Z)(i.states.values());try{for(a.s();!(o=a.n()).done;){var s,l=o.value,u=(0,m.Z)(l.transitions);try{for(u.s();!(s=u.n()).done;){var c=s.value;if("*"!==c&&!i.states.has(c))throw Error("Invalid state machine, state [".concat(l.name,"] has a transition to another state that doesn't exist [").concat(c,"]"))}}catch(h){u.e(h)}finally{u.f()}}}catch(h){a.e(h)}finally{a.f()}return i.currentState=i.startState=i.states.get(e.start),i}}]),t}(),He=function(){function t(e){var n=this;(0,b.Z)(this,t),this._src=e,this._audioContext=Pe.create(),this._volumeNode=this._audioContext.createGain(),this._playingPromise=new Promise((function(t){n._playingResolve=t})),this._stateMachine=Ue.create({start:"STOPPED",states:{PLAYING:{onEnter:function(t){var e=t.data;n._createNewBufferSource(),n._handleEnd(),n._instance.start(0,e.pausedAt*n._playbackRate,n.duration),e.startedAt=n._audioContext.currentTime-e.pausedAt,e.pausedAt=0},onState:function(){return n._playStarted()},onExit:function(t){"STOPPED"===t.to&&n._playingResolve(!0),n._instance.onended=null,n._instance.disconnect(),n._instance.stop(0),n._instance=null},transitions:["STOPPED","PAUSED","SEEK"]},SEEK:{onEnter:function(t){var e=t.eventData,i=t.data;i.pausedAt=(null!==e&&void 0!==e?e:0)/n._playbackRate,i.startedAt=0},transitions:["*"]},STOPPED:{onEnter:function(t){var e=t.data;e.pausedAt=0,e.startedAt=0,n._playingResolve(!0)},transitions:["PLAYING","PAUSED","SEEK"]},PAUSED:{onEnter:function(t){var e=t.data;e.pausedAt=n._audioContext.currentTime-e.startedAt},transitions:["PLAYING","STOPPED","SEEK"]}}},{startedAt:0,pausedAt:0}),this._volume=1,this._loop=!1,this._playStarted=function(){},this._playbackRate=1,this._createNewBufferSource()}return(0,k.Z)(t,[{key:"_createNewBufferSource",value:function(){this._instance=this._audioContext.createBufferSource(),this._instance.buffer=this._src,this._instance.loop=this.loop,this._instance.playbackRate.value=this._playbackRate,this._instance.connect(this._volumeNode),this._volumeNode.connect(this._audioContext.destination)}},{key:"_handleEnd",value:function(){var t=this;this.loop||(this._instance.onended=function(){t._playingResolve(!0)})}},{key:"loop",get:function(){return this._loop},set:function(t){var e=this;this._loop=t,this._instance&&(this._instance.loop=t,this.loop||(this._instance.onended=function(){e._playingResolve(!0)}))}},{key:"volume",get:function(){return this._volume},set:function(t){t=I(t,0,1),this._volume=t,this._stateMachine.in("PLAYING")&&this._volumeNode.gain.setTargetAtTime?this._volumeNode.gain.setTargetAtTime(t,this._audioContext.currentTime,.1):this._volumeNode.gain.value=t}},{key:"duration",get:function(){var t;return null!==(t=this._duration)&&void 0!==t?t:this.getTotalPlaybackDuration()},set:function(t){this._duration=t}},{key:"isPlaying",value:function(){return this._stateMachine.in("PLAYING")}},{key:"isPaused",value:function(){return this._stateMachine.in("PAUSED")||this._stateMachine.in("SEEK")}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return this._playStarted=t,this._stateMachine.go("PLAYING"),this._playingPromise}},{key:"pause",value:function(){this._stateMachine.go("PAUSED")}},{key:"stop",value:function(){this._stateMachine.go("STOPPED")}},{key:"seek",value:function(t){this._stateMachine.go("PAUSED"),this._stateMachine.go("SEEK",t)}},{key:"getTotalPlaybackDuration",value:function(){return this._src.duration}},{key:"getPlaybackPosition",value:function(){var t=this._stateMachine.data,e=t.pausedAt,n=t.startedAt;return e?e*this._playbackRate:n?(this._audioContext.currentTime-n)*this._playbackRate:0}},{key:"playbackRate",get:function(){return this._instance.playbackRate.value},set:function(t){this._instance.playbackRate.value=this._playbackRate=t}}]),t}(),We=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MediaEvent";return(0,b.Z)(this,n),(i=e.call(this)).target=t,i._name=r,i}return(0,k.Z)(n,[{key:"bubbles",get:function(){return!1},set:function(t){}},{key:"_path",get:function(){return null},set:function(t){}},{key:"stopPropagation",value:function(){}},{key:"action",value:function(){}},{key:"propagate",value:function(){}},{key:"layPath",value:function(t){}}]),n}(lt),Ve=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this,t,"NativeSoundEvent")).track=i,r}return(0,k.Z)(n)}(We),Xe=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this,t,"NativeSoundProcessedEvent"))._processedData=i,r.data=r._processedData,r}return(0,k.Z)(n)}(We);function Ge(t){try{var e=new Audio,n=t.match(/.*\.([A-Za-z0-9]+)$/)[1];return!!e.canPlayType("audio/"+n)}catch(i){return U.getInstance().warn("Cannot determine audio support, assuming no support for the Audio Tag",i),!1}}var je,qe=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;(0,b.Z)(this,n),(t=e.call(this)).logger=U.getInstance(),t._loop=!1,t._volume=1,t._isStopped=!1,t._tracks=[],t._wasPlayingOnHidden=!1,t._playbackRate=1,t._audioContext=Pe.create(),t._resource=new Vt("",Ne.type.arraybuffer);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];for(var a=0,s=r;a<s.length;a++){var l=s[a];if(Ge(l)){t.path=l;break}}return t.path||(t.logger.warn("This browser does not support any of the audio files specified:",r.join(", ")),t.logger.warn("Attempting to use",r[0]),t.path=r[0]),t}return(0,k.Z)(n,[{key:"loop",get:function(){return this._loop},set:function(t){this._loop=t;var e,n=(0,m.Z)(this._tracks);try{for(n.s();!(e=n.n()).done;){e.value.loop=this._loop}}catch(i){n.e(i)}finally{n.f()}this.logger.debug("Set loop for all instances of sound",this.path,"to",this._loop)}},{key:"volume",get:function(){return this._volume},set:function(t){this._volume=t;var e,n=(0,m.Z)(this._tracks);try{for(n.s();!(e=n.n()).done;){e.value.volume=this._volume}}catch(i){n.e(i)}finally{n.f()}this.emit("volumechange",new Ve(this)),this.logger.debug("Set loop for all instances of sound",this.path,"to",this._volume)}},{key:"duration",get:function(){return this._duration},set:function(t){this._duration=t}},{key:"instances",get:function(){return this._tracks}},{key:"path",get:function(){return this._resource.path},set:function(t){this._resource.path=t}},{key:"isLoaded",value:function(){return!!this.data}},{key:"load",value:function(){var t=u(s().mark((function t(){var e,n,i,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.data){t.next=2;break}return t.abrupt("return",this.data);case 2:return t.next=4,this._resource.load();case 4:return i=t.sent,t.next=7,this.decodeAudio(i.slice(0));case 7:return r=t.sent,this._duration=null!==(n=null!==(e=this._duration)&&void 0!==e?e:null===r||void 0===r?void 0:r.duration)&&void 0!==n?n:void 0,this.emit("processed",new Xe(this,r)),t.abrupt("return",this.data=r);case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"decodeAudio",value:function(){var t=u(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._audioContext.decodeAudioData(e.slice(0));case 3:case 11:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),this.logger.error("Unable to decode  this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file."),t.next=11,Promise.reject();case 12:case"end":return t.stop()}}),t,this,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()},{key:"wireEngine",value:function(t){var e=this;t&&(this._engine=t,this._engine.on("hidden",(function(){t.pauseAudioWhenHidden&&e.isPlaying()&&(e._wasPlayingOnHidden=!0,e.pause())})),this._engine.on("visible",(function(){t.pauseAudioWhenHidden&&e._wasPlayingOnHidden&&(e.play(),e._wasPlayingOnHidden=!1)})),this._engine.on("start",(function(){e._isStopped=!1})),this._engine.on("stop",(function(){e.stop(),e._isStopped=!0})))}},{key:"instanceCount",value:function(){return this._tracks.length}},{key:"isPlaying",value:function(){return this._tracks.some((function(t){return t.isPlaying()}))}},{key:"isPaused",value:function(){return this._tracks.some((function(t){return t.isPaused()}))}},{key:"play",value:function(t){return this.isLoaded()?this._isStopped?(this.logger.warn("Cannot start playing. Engine is in a stopped state."),Promise.resolve(!1)):(this.volume=t||this.volume,this.isPaused()?this._resumePlayback():this._startPlayback()):(this.logger.warn("Cannot start playing. Resource",this.path,"is not loaded yet"),Promise.resolve(!0))}},{key:"pause",value:function(){if(this.isPlaying()){var t,e=(0,m.Z)(this._tracks);try{for(e.s();!(t=e.n()).done;){t.value.pause()}}catch(n){e.e(n)}finally{e.f()}this.emit("pause",new Ve(this)),this.logger.debug("Paused all instances of sound",this.path)}}},{key:"stop",value:function(){var t,e=(0,m.Z)(this._tracks);try{for(e.s();!(t=e.n()).done;){t.value.stop()}}catch(n){e.e(n)}finally{e.f()}this.emit("stop",new Ve(this)),this._tracks.length=0,this.logger.debug("Stopped all instances of sound",this.path)}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){var e=this;this._playbackRate=t,this._tracks.forEach((function(t){t.playbackRate=e._playbackRate}))}},{key:"seek",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;0===this._tracks.length&&this._getTrackInstance(this.data),this._tracks[e].seek(t)}},{key:"getTotalPlaybackDuration",value:function(){return this.data.duration}},{key:"getPlaybackPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._tracks.length?this._tracks[t].getPlaybackPosition():0}},{key:"getTrackId",value:function(t){return this._tracks.indexOf(t)}},{key:"_resumePlayback",value:function(){var t=u(s().mark((function t(){var e,n,i,r,o=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isPaused){t.next=8;break}e=[],n=(0,m.Z)(this._tracks);try{for(r=function(){var t=i.value;e.push(t.play().then((function(){return o.emit("playbackend",new Ve(o,t)),o._tracks.splice(o.getTrackId(t),1),!0})))},n.s();!(i=n.n()).done;)r()}catch(a){n.e(a)}finally{n.f()}return this.emit("resume",new Ve(this)),this.logger.debug("Resuming paused instances for sound",this.path,this._tracks),t.next=8,Promise.all(e);case 8:return t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_startPlayback",value:function(){var t=u(s().mark((function t(){var e,n,i=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getTrackInstance(this.data);case 2:return e=t.sent,t.next=5,e.play((function(){i.emit("playbackstart",new Ve(i,e)),i.logger.debug("Playing new instance for sound",i.path)}));case 5:return n=t.sent,this.emit("playbackend",new Ve(this,e)),this._tracks.splice(this.getTrackId(e),1),t.abrupt("return",n);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_getTrackInstance",value:function(t){var e=new He(t);return e.loop=this.loop,e.volume=this.volume,e.duration=this.duration,e.playbackRate=this._playbackRate,this._tracks.push(e),e}}]),n}(Ze),Ye=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this)).canvas=new Oe({filtering:qt.Blended,smoothing:!0,cache:!0,draw:i.draw.bind((0,r.Z)(i))}),i._resourceList=[],i._index=0,i._playButtonShown=!1,i._resourceCount=0,i._numLoaded=0,i._progressCounts={},i._totalCounts={},i.logo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdQAAAB2CAYAAABxhGI9AAAACXBIWXMAAAsSAAALEgHS3X78AAAKnUlEQVR42u3dP2wjSx0H8N8hJIonIRmJjsq0SBR+BQ1dcqKhe0lD77SvSwpKkJKGPulpktfRIMUdEqKIqV57rpAokM4dbSiyq7ONPTP7x39ifz7SFbnEnp3xer47O7uzH15fXwMA6OYHmgAABCoACFQAEKgAgEAFAIEKAAIVAAQqACBQAUCgAoBABQCBCgAIVAAQqAAgUAFAoAIAAhUABCoACFQAEKgAgECFLbmOiNeFf2PbAyz68Pr6qhUgbRwR92v+/zwiJrYHMEKFMmcN///UtgcQqFBk1PD/97U9Qx8VCFSgu4EmAIEKAAIVAAQqACBQ4Z25jojP8eX+0WtNAgIVaOY+Im5j+eKh24h41jQgUIEyZ7F5NaPU7wCBCiwYd/w9cOB+qAlgJ3KLLow0EV198803RWvJfvfddx+0lhEqHKu5JgAjVCBvlhmFzjQRXUekHz9+TP79y8uLRjNChXfvoePvAYEKxNtj1e42/O5JoIJABcrdRMRVLM+X3kTEpaaB988cKuzWg9EobTWdMx0Oly8uN4dqhAoARqgnaN3arHfqu7OyH8ItKLVB/P+CEfMTHyGPY3npx1m8zWGDEeoBfUk/xdti57dr/r1Wv2+6EPow3tZ5rRdS72s1neuF97xvWd+XTH0/V+UMttDWqbI/r2nrxfp+jv2uSjSO7S+OXy/A/3lN+9xX5T5HxEUPZZ0tfB71+w57eJ/HFu+z+jkv1u92YX9fbI/HhX3JA9rp5MPr66tWaG9UfUGbrHIzi7cLUyYFf/tpTady03EEeL8mUJ6i7MKYNvWNqr4Pe2jradXO60LrvPAz2PQ5RPX684ah8dxD+2zantnCgVipSVV+m/tgB9W2DDq2Sx/vM95wcHhZhWVJm8yrv58cSgfTdc70+++/X/r522+/tUKSEepBqo+om4ZLPerMjUwuNnQCtx1GWJtee1FwdD5uWd86xLs8UaVt2aNEO1/saZ/Z5rYMW4zq6v34rGV9Bg3q2eZ9SkeNm9qwyUh30OPIHYFKx5FG03C7znSOqYBq+qW/zpQ3anH037TNHluG6f0WPsPhHvab4QFty7ogOeuxDYcNy2/zu2214WNYWxmBurNO8bGn97pNBOO8xy/9uCorZZ4I2r4C7aJgO7ZV9iE49Dm6NvOWx+pWE9CUq3zbdTp9doz38TbXtzqH9RT5CyWe422OaZoZGeZCabrhPQY9HjwsjpTvCg4YtlE2+Ta/j2bzn8fqrDqgm+6yUHOmAvWUjAtGhbNYvsBknDnqH1Qhc7VmxHgeb/NbudA5j/UXlYwif2p6luhAc9teu1npiHKnDs8if6tCm7JLX3NKpgttXe9ruc9mHMd7a83iwdxF5vt8tutARaCeklRnNK9C8WnNF7geJQ4T4XG3JhSnVdilQrG+yOnrlVHfsEGYzhNBn7Lu6tS7+HJafJQ4EMiNlNqWXZ9WPvVgnVYHG5M1ByDXkT6leX2EgTqJtyt45yv7S2qO3sEZjZhDLXeR+YKdJ0Zdk8QocvH9N732KrNtq+FZ/zzIHABcJrYpd+Xv14lOd5ap76SgrduW/VTQ1qcQpqnbgu4ifZvUMNpd9XuoZmvCtPaQ2Y/BCHVLgbrJTeRPDdVf6pfMKDU2fOkHmVFFfXr3MsouLsnNvV5kRoe5+s431PeuoKPqWnaurY/ZPBEeqwceN4l96iwO6H7Mjq4y7VGPVNe10VaZMzVCPVWpI/Z6FZbcv5fMqGCU+dLfFGzj58jP8+bCdJCo7yzKTwdOF0bu9Ug7V4c+yz7FJfYeGoysUss0HssIdVZwYLDujMqlESoCdTtGsZtbHnJBeNdDSJSs0jTKdMJN1HNX54Wv7bvsU9NkVJVa13dX+/wuArV0X/l5RHyo/lnfF4G6p6DrS0kHdtXhy35TGErDPYZUn2WfWqDOo/lVqdMD2O/hKJhD7S/odukymq9s02QN4EEPR/zbaOumZc+r15zK1Zqznl9jsfiemTM1QmV3HUuTkedlg9HIQzRbUD93dfC+2tpj2fIHEH2+RqCCQH13gZq7hWXTNpVu19OB1fc9nQ0AKOKUb5lU0P1kDyOneoWk0lOZ9cIP0x7qu8+2BhCoR2wYu1+e7DmaXzBSsu5vaX1ne2zrpmUPTmxf7PM1Dm4y/vC7ny7Nif7+z/9ZmtM0Z3panPLtPmra9f16bcK0Dpbnwk43Vd/RHtu6zfNQTy1QBy3aqG2g9nVmxml+BOoJyT3NpWmn9xhfFnu4bvDa+44BXhqqfdf3uUF9+yz77AT31Yue2mjecYQ62NLfgkA9ghHqLNEhNem4H1c6vdyDxhf/bpz5m4coW/c39wi6VH2bPtHlcaV9cvXts+zxCe6rTeqc2ndL7uGd93QwM9bFcAzMoZZ7SgTBbWx+asui61h/iq1+RmjqdbnQXQ3T1DNQ63V/U9ucqm/pMzPb1rePsk/1iTOjgvatR4W3Lc8ULB78pELyrnAfeTcj1NU509/86mfJ33/8+Mf00a05UyPUEw7UVCeWG/WNEiExyHRMt5ltW30izUPk18ytt7lNfc8i//DvtvXto+ySA5BjljsLUF8lPkqMPEtW1JomDsiGBZ9Byb4NAvUITSN9GuwsIj6t6UTOqk7jJREkmzqli8xIs96udSO20sX0H1vW92IL9e1a9rgqVyf91gbPsTy9UD9n9lOkT8k+RfkFR5PMNqxOcdSf32PBvg3vilO+zdxE+okx9Wm0ph36XYsRZCpMF993GOk5qvqB3Dct6jvssb67KvuUNJ3frw92bhr8/STSF0JdRPMLpUCgnsgo9S76PZ246ZFk1wWvK5m3vVoYvW1Sz7nN91jfXbQ1ZQc7TW6HeaoOalypG/8/p/rP1aNAc6ZHzSnfdqPUPhdy2PQw6Nz9gSVhuhiqueUHR3uu7y7K3rdDX4u46ZrPbUa0IFBZ0seKQ3XQTRt2vm3W/a2DbNKys++rvm3ep6+y1x2UdP3bWU9lzra47U1GmlctX/sQ23t+aOlByLTh/4NAPaCRxtcdO5HLSJ/6vNtCwGx67VPmPbvWd1q9frKHtp4kAqRJ2HR9j762JfX3bZ//elPtj13PPDx1+D5tqk/Xi6NO8SHz7MmH19dXrdBNfVFP6T2PT1UHNit87/t4m5+aRH+nQBdvqyhZDKJLfZs8h7XPsqdV2ZOV+tanKB8aln0dyxdAXbV4j4gvt4oMOrbP6vbU73NW7TMlbdTnPrWpfqXfh9HKZ9vke7KuTeZRNtXRSe6+1FV//ce/ln5eXfsXgcqXzr6+9261M3moOoa7E6nvTZTfy7iNsmfb7kjfgXGsvxe0vihsEts9HTquPpt1q1vtahu2TqAiUAEEKj0zhwoARqgAu/OnX/442WH+9xc/Wvr58re/Tr7f41/+ZsRqhAoACFQAEKgAcHjMoQJskJsz/eqrr5Z+vvr7v5fmQFevAl5lztQIFQAQqAAgUAHgIJlDBdhgdQ41N2eKESoAIFABQKACwFEwhwoARqgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAEKgAgUAFAoAKAQAUAgQoACFQAEKgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAQqAAgUAFAoAKAQAUAlvwPcFDns1DsH4sAAAAASUVORK5CYII=",i.logoWidth=468,i.logoHeight=118,i.loadingBarColor=X.White,i.backgroundColor="#176BAA",i.suppressPlayButton=!1,i._playButtonStyles=ze.Z.toString(),i.playButtonText="Play game",i.startButtonFactory=function(){var t=document.getElementById("excalibur-play");return t||(t=document.createElement("button")),t.id="excalibur-play",t.textContent=i.playButtonText,t.style.display="none",t},i._loadingFuture=new Y,t&&i.addResources(t),i}return(0,k.Z)(n,[{key:"_image",get:function(){return this._imageElement||(this._imageElement=new Image,this._imageElement.src=this.logo),this._imageElement}},{key:"playButtonRootElement",get:function(){return this._playButtonRootElement}},{key:"playButtonElement",get:function(){return this._playButtonElement}},{key:"_playButton",get:function(){var t=document.getElementById("excalibur-play-root");return t&&(this._playButtonRootElement=t),this._playButtonRootElement||(this._playButtonRootElement=document.createElement("div"),this._playButtonRootElement.id="excalibur-play-root",this._playButtonRootElement.style.position="absolute",document.body.appendChild(this._playButtonRootElement)),this._styleBlock||(this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._playButtonStyles,document.head.appendChild(this._styleBlock)),this._playButtonElement||(this._playButtonElement=this.startButtonFactory(),this._playButtonRootElement.appendChild(this._playButtonElement)),this._playButtonElement}},{key:"wireEngine",value:function(t){this._engine=t,this.canvas.width=this._engine.canvas.width,this.canvas.height=this._engine.canvas.height}},{key:"addResource",value:function(t){var e=this._index++;this._resourceList.push(t),this._progressCounts[e]=0,this._totalCounts[e]=1,this._resourceCount++}},{key:"addResources",value:function(t){for(var e=0,n=t.length;e<n;e++)this.addResource(t[e])}},{key:"isLoaded",value:function(){return this._numLoaded===this._resourceCount}},{key:"showPlayButton",value:function(){var t=u(s().mark((function t(){var e,n,i,r,o=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.suppressPlayButton){t.next=6;break}return this.hidePlayButton(),t.next=4,et(500,null===(e=this._engine)||void 0===e?void 0:e.clock);case 4:t.next=16;break;case 6:return i=function(){o._positionPlayButton()},(null===(n=this._engine)||void 0===n?void 0:n.browser)&&this._engine.browser.window.on("resize",i),this._playButtonShown=!0,this._playButton.style.display="block",document.body.addEventListener("keyup",(function(t){"Enter"===t.key&&o._playButton.click()})),this._positionPlayButton(),r=new Promise((function(t){var e=function(e){var n;e.stopPropagation(),o.hidePlayButton(),(null===(n=o._engine)||void 0===n?void 0:n.browser)&&o._engine.browser.window.off("resize",i),t()};o._playButton.addEventListener("click",e),o._playButton.addEventListener("touchend",e),o._playButton.addEventListener("pointerup",e)})),t.next=15,r;case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"hidePlayButton",value:function(){this._playButtonShown=!1,this._playButton.style.display="none"}},{key:"dispose",value:function(){this._playButtonRootElement.parentElement&&(this._playButtonRootElement.removeChild(this._playButtonElement),document.body.removeChild(this._playButtonRootElement),document.head.removeChild(this._styleBlock),this._playButtonRootElement=null,this._playButtonElement=null,this._styleBlock=null)}},{key:"update",value:function(t,e){}},{key:"areResourcesLoaded",value:function(){return this._loadingFuture.promise}},{key:"load",value:function(){var t=u(s().mark((function t(){var e,n,i,r,o,a=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this._image)||void 0===e?void 0:e.decode();case 2:return this.canvas.flagDirty(),t.next=5,Promise.all(this._resourceList.map(function(){var t=u(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.load().finally((function(){a._numLoaded++,a.canvas.flagDirty()}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 5:i=(0,m.Z)(this._resourceList);try{for(i.s();!(r=i.n()).done;)(o=r.value)instanceof qe&&o.wireEngine(this._engine)}catch(l){i.e(l)}finally{i.f()}return this._loadingFuture.resolve(),t.next=10,et(200,null===(n=this._engine)||void 0===n?void 0:n.clock);case 10:return this.canvas.flagDirty(),t.next=13,this.showPlayButton();case 13:return t.next=15,Ie.unlock();case 15:return t.abrupt("return",this.data=this._resourceList);case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"markResourceComplete",value:function(){this._numLoaded++}},{key:"progress",get:function(){return this._resourceCount>0?I(this._numLoaded,0,this._resourceCount)/this._resourceCount:1}},{key:"_positionPlayButton",value:function(){if(this._engine){var t=this._engine.screen.viewport.height,e=this._engine.screen.viewport.width;if(this._playButtonRootElement){var n=this._engine.canvas.offsetLeft,i=this._engine.canvas.offsetTop,r=this._playButton.clientWidth,o=this._playButton.clientHeight;this.playButtonPosition?(this._playButtonRootElement.style.left="".concat(this.playButtonPosition.x,"px"),this._playButtonRootElement.style.top="".concat(this.playButtonPosition.y,"px")):(this._playButtonRootElement.style.left="".concat(n+e/2-r/2,"px"),this._playButtonRootElement.style.top="".concat(i+t/2-o/2+100,"px"))}}}},{key:"draw",value:function(t){var e=this._engine.canvasHeight/this._engine.pixelRatio,n=this._engine.canvasWidth/this._engine.pixelRatio;this._positionPlayButton(),t.fillStyle=this.backgroundColor,t.fillRect(0,0,n,e);var i=e/2,r=Math.min(this.logoWidth,.75*n),o=n/2-r/2;this.logoPosition&&(o=this.logoPosition.x,i=this.logoPosition.y);var a=Math.floor(r*(this.logoHeight/this.logoWidth)),s=this._engine.getAntialiasing();if(this._engine.setAntialiasing(!0),this.logoPosition?t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,o,i,r,a):t.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,o,i-a-20,r,a),this.suppressPlayButton||!this._playButtonShown){var l=o,u=i;this.loadingBarPosition&&(l=this.loadingBarPosition.x,u=this.loadingBarPosition.y),t.lineWidth=2,De(t,l,u,r,20,10,this.loadingBarColor);var c=r*this.progress-10;De(t,l+5,u+5,c>10?c:10,10,5,null,this.loadingBarColor),this._engine.setAntialiasing(s)}else this._engine.setAntialiasing(s)}}]),n}(Ze),Ke={webgl:"WebGL",webaudio:"WebAudio",gamepadapi:"Gamepad API"},Qe=function(){function t(){(0,b.Z)(this,t),this._features=null,this.failedTests=[],this._criticalTests={canvasSupport:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},arrayBufferSupport:function(){var t=new XMLHttpRequest;t.open("GET","/");try{t.responseType="arraybuffer"}catch(e){return!1}return"arraybuffer"===t.responseType},dataUrlSupport:function(){return 0===document.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")},objectUrlSupport:function(){return"URL"in window&&"revokeObjectURL"in URL&&"createObjectURL"in URL},rgbaSupport:function(){var t=document.createElement("a").style;return t.cssText="background-color:rgba(150,255,150,.5)",(""+t.backgroundColor).indexOf("rgba")>-1}},this._warningTest={webAudioSupport:function(){return!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext)},webglSupport:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("webgl"))}},this._features=this._loadBrowserFeatures()}return(0,k.Z)(t,[{key:"getBrowserFeatures",value:function(){return null===this._features&&(this._features=this._loadBrowserFeatures()),this._features}},{key:"logBrowserFeatures",value:function(){for(var t="%cSUPPORTED BROWSER FEATURES\n==========================%c\n",e=["font-weight: bold; color: navy","font-weight: normal; color: inherit"],n=this.getBrowserFeatures(),i=0,r=Object.keys(Ke);i<r.length;i++){var o=r[i];n[o]?(t+="(%c\u2713%c)",e.push("font-weight: bold; color: green"),e.push("font-weight: normal; color: inherit")):(t+="(%c\u2717%c)",e.push("font-weight: bold; color: red"),e.push("font-weight: normal; color: inherit")),t+=" "+Ke[o]+"\n"}e.unshift(t),console.log.apply(console,e)}},{key:"_loadBrowserFeatures",value:function(){var t=this;return{canvas:t._criticalTests.canvasSupport(),arraybuffer:t._criticalTests.arrayBufferSupport(),dataurl:t._criticalTests.dataUrlSupport(),objecturl:t._criticalTests.objectUrlSupport(),rgba:t._criticalTests.rgbaSupport(),webaudio:t._warningTest.webAudioSupport(),webgl:t._warningTest.webglSupport(),gamepadapi:!!navigator.getGamepads}}},{key:"test",value:function(){var t=!1;for(var e in this._criticalTests)this._criticalTests[e].call(this)||(this.failedTests.push(e),U.getInstance().error("Critical browser feature missing, Excalibur requires:",e),t=!0);if(t)return!1;for(var n in this._warningTest)this._warningTest[n]()||U.getInstance().warn("Warning browser feature missing, Excalibur will have reduced performance:",n);return!0}}]),t}();!function(t){t.PreventCollision="PreventCollision",t.Passive="Passive",t.Active="Active",t.Fixed="Fixed"}(je||(je={}));var Je=5,$e={},tn=function(){for(var t in $e)$e[t]=0},en=function(t,e){var n=p.isEnabled("suppress-obsolete-message");$e[t]<Je&&!n&&(U.getInstance().warn(t),console.trace&&e.showStackTrace&&console.trace()),$e[t]++};function nn(t){return t=d({message:"This feature will be removed in future versions of Excalibur.",alternateMethod:null,showStackTrace:!1},t),function(e,n,i){if(i&&"function"!==typeof i.value&&"function"!==typeof i.get&&"function"!==typeof i.set)throw new SyntaxError("Only classes/functions/getters/setters can be marked as obsolete");var r="".concat(e.name||"").concat(e.name&&n?".":"").concat(n||""),o="".concat(r," is marked obsolete: ").concat(t.message)+(t.alternateMethod?" Use ".concat(t.alternateMethod," instead"):"");$e[o]||($e[o]=0);var a=i?d({},i):e;if(!i){var s=function(e){(0,_.Z)(i,e);var n=(0,w.Z)(i);function i(){(0,b.Z)(this,i),en(o,t);for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return n.call.apply(n,[this].concat(r))}return(0,k.Z)(i)}(a);return s}return i&&i.value?(a.value=function(){return en(o,t),i.value.apply(this,arguments)},a):(i&&i.get&&(a.get=function(){return en(o,t),i.get.apply(this,arguments)}),i&&i.set&&(a.set=function(){return en(o,t),i.set.apply(this,arguments)}),a)}}var rn,on,an,sn=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};!function(t){t.Arcade="arcade",t.Realistic="realistic"}(rn||(rn={})),function(t){t[t.DynamicAABBTree=0]="DynamicAABBTree"}(on||(on={})),function(t){t[t.Euler=0]="Euler"}(an||(an={}));var ln,un=function(){function t(){(0,b.Z)(this,t)}return(0,k.Z)(t,null,[{key:"gravity",get:function(){return t.acc},set:function(e){t.acc=e}},{key:"useArcadePhysics",value:function(){t.collisionResolutionStrategy=rn.Arcade}},{key:"useRealisticPhysics",value:function(){t.collisionResolutionStrategy=rn.Realistic}},{key:"dynamicTreeVelocityMultiplyer",get:function(){return t.dynamicTreeVelocityMultiplier},set:function(e){t.dynamicTreeVelocityMultiplier=e}}]),t}();un.acc=new O(0,0),un.enabled=!0,un.broadphaseStrategy=on.DynamicAABBTree,un.collisionResolutionStrategy=rn.Arcade,un.defaultMass=10,un.integrator=an.Euler,un.dynamicTreeVelocityMultiplier=2,un.boundsPadding=5,un.positionIterations=3,un.velocityIterations=8,un.slop=1,un.steeringFactor=.2,un.warmStart=!0,un.bodiesCanSleepByDefault=!1,un.surfaceEpsilon=.1,un.sleepEpsilon=.07,un.wakeThreshold=3*un.sleepEpsilon,un.sleepBias=.9,un.checkForFastBodies=!0,un.disableMinimumSpeedForFastBody=!1,sn([nn({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"dynamicTreeVelocityMultiplier"})],un,"dynamicTreeVelocityMultiplyer",null),function(t){t.World="world",t.Screen="screen"}(ln||(ln={}));var cn=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this,0,0))._getX=t.getX,i._getY=t.getY,i._setX=t.setX,i._setY=t.setY,i}return(0,k.Z)(n,[{key:"x",get:function(){return this._x=this._getX()},set:function(t){this._setX(t),this._x=t}},{key:"y",get:function(){return this._y=this._getY()},set:function(t){this._setY(t),this._y=t}}]),n}(O),hn=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this,t.x,t.y)).original=t,r.change=i,r}return(0,k.Z)(n,[{key:"x",get:function(){return this._x=this.original.x},set:function(t){this.change(t,this._y),this._x=this.original.x=t}},{key:"y",get:function(){return this._y=this.original.y},set:function(t){this.change(this._x,t),this._y=this.original.y=t}}]),n}(O),dn=function(){function t(){(0,b.Z)(this,t),this._parent=null,this._children=[],this._pos=N(0,0),this._rotation=0,this._scale=N(1,1),this._isDirty=!1,this._isInverseDirty=!1,this._matrix=ot.identity(),this._inverse=ot.identity()}return(0,k.Z)(t,[{key:"parent",get:function(){return this._parent},set:function(t){if(this._parent){var e=this._parent._children.indexOf(this);e>-1&&this._parent._children.splice(e,1)}this._parent=t,this._parent&&this._parent._children.push(this),this.flagDirty()}},{key:"children",get:function(){return this._children}},{key:"pos",get:function(){var t=this;return new hn(this._pos,(function(e,n){e===t._pos.x&&n===t._pos.y||t.flagDirty()}))},set:function(t){t.equals(this._pos)||(this._pos.x=t.x,this._pos.y=t.y,this.flagDirty())}},{key:"globalPos",get:function(){var t=this;return new cn({getX:function(){return t.matrix.data[4]},getY:function(){return t.matrix.data[5]},setX:function(e){if(t.parent){var n=t.parent.inverse.multiply(N(e,t.pos.y)).x;t.pos.x=n}else t.pos.x=e;e!==t.matrix.data[4]&&t.flagDirty()},setY:function(e){if(t.parent){var n=t.parent.inverse.multiply(N(t.pos.x,e)).y;t.pos.y=n}else t.pos.y=e;e!==t.matrix.data[5]&&t.flagDirty()}})},set:function(t){var e=t.clone();this.parent&&(e=this.parent.inverse.multiply(t)),e.equals(this._pos)||(this._pos=e,this.flagDirty())}},{key:"rotation",get:function(){return this._rotation},set:function(t){var e=Z(t);e!==this._rotation&&this.flagDirty(),this._rotation=e}},{key:"globalRotation",get:function(){return this.parent?this.matrix.getRotation():this.rotation},set:function(t){var e=0;this.parent&&(e=this.parent.globalRotation);var n=Z(t+e);n!==this._rotation&&this.flagDirty(),this._rotation=n}},{key:"scale",get:function(){var t=this;return new hn(this._scale,(function(e,n){e===t._scale.x&&n===t._scale.y||t.flagDirty()}))},set:function(t){t.equals(this._scale)||(this._scale.x=t.x,this._scale.y=t.y,this.flagDirty())}},{key:"globalScale",get:function(){var t=this;return new cn({getX:function(){return t.parent?t.matrix.getScaleX():t.scale.x},getY:function(){return t.parent?t.matrix.getScaleY():t.scale.y},setX:function(e){if(t.parent){var n=t.parent.globalScale.x;t.scale.x=e/n}else t.scale.x=e},setY:function(e){if(t.parent){var n=t.parent.globalScale.y;t.scale.y=e/n}else t.scale.y=e}})},set:function(t){var e=N(1,1);this.parent&&(e=this.parent.globalScale),this.scale=t.scale(N(1/e.x,1/e.y))}},{key:"matrix",get:function(){return this._isDirty&&(null===this.parent?this._matrix=this._calculateMatrix():this._matrix=this.parent.matrix.multiply(this._calculateMatrix()),this._isDirty=!1),this._matrix}},{key:"inverse",get:function(){return this._isInverseDirty&&(this._inverse=this.matrix.inverse(),this._isInverseDirty=!1),this._inverse}},{key:"_calculateMatrix",value:function(){return ot.identity().translate(this.pos.x,this.pos.y).rotate(this.rotation).scale(this.scale.x,this.scale.y)}},{key:"flagDirty",value:function(){this._isDirty=!0,this._isInverseDirty=!0;for(var t=0;t<this._children.length;t++)this._children[t].flagDirty()}},{key:"apply",value:function(t){return this.matrix.multiply(t)}},{key:"applyInverse",value:function(t){return this.inverse.multiply(t)}},{key:"setTransform",value:function(t,e,n){this._pos.x=t.x,this._pos.y=t.y,this._rotation=Z(e),this._scale.x=n.x,this._scale.y=n.y,this.flagDirty()}},{key:"clone",value:function(e){var n=null!==e&&void 0!==e?e:new t;this._pos.clone(n._pos),n._rotation=this._rotation,this._scale.clone(n._scale),n.flagDirty()}}]),t}();var fn=function(){function t(){(0,b.Z)(this,t),this.owner=null}return(0,k.Z)(t,[{key:"clone",value:function(){var t,e=new this.constructor;for(var n in this)if(this.hasOwnProperty(n)){var i=this[n];(null===(t=i)||void 0===t?void 0:t.clone)&&"owner"!==n&&"clone"!==n?e[n]=i.clone():e[n]=i}return e}}]),t}(),pn=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;return(0,b.Z)(this,n),(r=e.call(this)).type=t,r.value=i,r}return(0,k.Z)(n)}(fn),vn=function(){function t(){(0,b.Z)(this,t),this.observers=[],this.subscriptions=[]}return(0,k.Z)(t,[{key:"register",value:function(t){this.observers.push(t)}},{key:"subscribe",value:function(t){this.subscriptions.push(t)}},{key:"unregister",value:function(t){var e=this.observers.indexOf(t);-1!==e&&this.observers.splice(e,1)}},{key:"unsubscribe",value:function(t){var e=this.subscriptions.indexOf(t);-1!==e&&this.subscriptions.splice(e,1)}},{key:"notifyAll",value:function(t){for(var e=this.observers.length,n=0;n<e;n++)this.observers[n].notify(t);for(var i=this.subscriptions.length,r=0;r<i;r++)this.subscriptions[r](t)}},{key:"clear",value:function(){this.observers.length=0,this.subscriptions.length=0}}]),t}(),gn=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.apply(this,arguments)).type="ex.transform",t._transform=new dn,t._addChildTransform=function(e){var i=e.get(n);i&&(i._transform.parent=t._transform)},t.zIndexChanged$=new vn,t._z=0,t.coordPlane=ln.World,t}return(0,k.Z)(n,[{key:"get",value:function(){return this._transform}},{key:"onAdd",value:function(t){var e,i=this,r=(0,m.Z)(t.children);try{for(r.s();!(e=r.n()).done;){var o=e.value;this._addChildTransform(o)}}catch(a){r.e(a)}finally{r.f()}t.childrenAdded$.subscribe((function(t){return i._addChildTransform(t)})),t.childrenRemoved$.subscribe((function(t){var e=t.get(n);e&&(e._transform.parent=null)}))}},{key:"onRemove",value:function(t){this._transform.parent=null}},{key:"z",get:function(){return this._z},set:function(t){var e=this._z;this._z=t,e!==t&&this.zIndexChanged$.notifyAll(t)}},{key:"pos",get:function(){return this._transform.pos},set:function(t){this._transform.pos=t}},{key:"globalPos",get:function(){return this._transform.globalPos},set:function(t){this._transform.globalPos=t}},{key:"rotation",get:function(){return this._transform.rotation},set:function(t){this._transform.rotation=t}},{key:"globalRotation",get:function(){return this._transform.globalRotation},set:function(t){this._transform.globalRotation=t}},{key:"scale",get:function(){return this._transform.scale},set:function(t){this._transform.scale=t}},{key:"globalScale",get:function(){return this._transform.globalScale},set:function(t){this._transform.globalScale=t}},{key:"applyInverse",value:function(t){return this._transform.applyInverse(t)}},{key:"apply",value:function(t){return this._transform.apply(t)}}]),n}(fn),yn=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.apply(this,arguments)).type="ex.motion",t.vel=O.Zero,t.acc=O.Zero,t.scaleFactor=O.Zero,t.angularVelocity=0,t.torque=0,t.inertia=1,t}return(0,k.Z)(n)}(fn),mn=function(){function t(e,n,i){(0,b.Z)(this,t),this._name=e,this._category=n,this._mask=i}return(0,k.Z)(t,[{key:"name",get:function(){return this._name}},{key:"category",get:function(){return this._category}},{key:"mask",get:function(){return this._mask}},{key:"canCollide",value:function(t){return 0!==(this.category&t.mask)&&0!==(t.category&this.mask)}},{key:"invert",value:function(){return new t("~("+this.name+")",~this.category,~this.mask)}}],[{key:"combine",value:function(e){var n=e.map((function(t){return t.name})).join("+"),i=e.reduce((function(t,e){return e.category|t}),0);return new t(n,i,~i)}},{key:"collidesWith",value:function(e){return t.combine(e).invert()}}]),t}();mn.All=new mn("Collide with all groups",-1,-1);var _n=function(){function t(e,n){(0,b.Z)(this,t),this.colliderA=e,this.colliderB=n,this.id=null,this.id=t.calculatePairHash(e.id,n.id)}return(0,k.Z)(t,[{key:"canCollide",get:function(){var e=this.colliderA,n=this.colliderB;return t.canCollide(e,n)}},{key:"collide",value:function(){return this.colliderA.collide(this.colliderB)}},{key:"hasCollider",value:function(t){return t===this.colliderA||t===this.colliderB}}],[{key:"canCollide",value:function(t,e){var n,i,r=null===(n=null===t||void 0===t?void 0:t.owner)||void 0===n?void 0:n.get(On),o=null===(i=null===e||void 0===e?void 0:e.owner)||void 0===i?void 0:i.get(On);return t.id!==e.id&&((!t.owner||!e.owner||t.owner.id!==e.owner.id)&&(!t.localBounds.hasZeroDimensions()&&!e.localBounds.hasZeroDimensions()&&(!(!r||!o)&&(!!r.group.canCollide(o.group)&&((r.collisionType!==je.Fixed||o.collisionType!==je.Fixed)&&(o.collisionType!==je.PreventCollision&&r.collisionType!==je.PreventCollision&&!(!r.active||!o.active)))))))}},{key:"calculatePairHash",value:function(t,e){return t.value<e.value?"#".concat(t.value,"+").concat(e.value):"#".concat(e.value,"+").concat(t.value)}}]),t}(),wn=function(){function t(e,n){(0,b.Z)(this,t),this.min=e,this.max=n}return(0,k.Z)(t,[{key:"overlaps",value:function(t){return this.max>t.min&&t.max>this.min}},{key:"getOverlap",value:function(t){return this.overlaps(t)?this.max>t.max?t.max-this.min:this.max-t.min:0}}]),t}(),xn=function(){function t(e){(0,b.Z)(this,t),this.parent=e,this.parent=e||null,this.data=null,this.bounds=new q,this.left=null,this.right=null,this.height=0}return(0,k.Z)(t,[{key:"isLeaf",value:function(){return!this.left&&!this.right}}]),t}(),bn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new q(-Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);(0,b.Z)(this,t),this.worldBounds=e,this.root=null,this.nodes={}}return(0,k.Z)(t,[{key:"_insert",value:function(t){if(null===this.root)return this.root=t,void(this.root.parent=null);for(var e=t.bounds,n=this.root;!n.isLeaf();){var i=n.left,r=n.right,o=n.bounds.getPerimeter(),a=n.bounds.combine(e).getPerimeter(),s=2*a,l=2*(a-o),u=0,c=e.combine(i.bounds),h=void 0;i.isLeaf()?u=c.getPerimeter()+l:(h=i.bounds.getPerimeter(),u=c.getPerimeter()-h+l);var d=0,f=e.combine(r.bounds);if(r.isLeaf()?d=f.getPerimeter()+l:(h=r.bounds.getPerimeter(),d=f.getPerimeter()-h+l),s<u&&s<d)break;n=u<d?i:r}var p=n.parent,v=new xn(p);v.bounds=e.combine(n.bounds),v.height=n.height+1,null!==p?(p.left===n?p.left=v:p.right=v,v.left=n,v.right=t,n.parent=v,t.parent=v):(v.left=n,v.right=t,n.parent=v,t.parent=v,this.root=v);for(var g=t.parent;g;){if(!(g=this._balance(g)).left)throw new Error("Parent of current leaf cannot have a null left child"+g);if(!g.right)throw new Error("Parent of current leaf cannot have a null right child"+g);g.height=1+Math.max(g.left.height,g.right.height),g.bounds=g.left.bounds.combine(g.right.bounds),g=g.parent}}},{key:"_remove",value:function(t){if(t!==this.root){var e,n=t.parent,i=n.parent;if(e=n.left===t?n.right:n.left,i){i.left===n?i.left=e:i.right=e,e.parent=i;for(var r=i;r;)(r=this._balance(r)).bounds=r.left.bounds.combine(r.right.bounds),r.height=1+Math.max(r.left.height,r.right.height),r=r.parent}else this.root=e,e.parent=null}else this.root=null}},{key:"trackCollider",value:function(t){var e=new xn;e.data=t,e.bounds=t.bounds,e.bounds.left-=2,e.bounds.top-=2,e.bounds.right+=2,e.bounds.bottom+=2,this.nodes[t.id.value]=e,this._insert(e)}},{key:"updateCollider",value:function(t){var e,n=this.nodes[t.id.value];if(!n)return!1;var i=t.bounds;if(!this.worldBounds.contains(i))return U.getInstance().warn("Collider with id "+t.id.value+" is outside the world bounds and will no longer be tracked for physics"),this.untrackCollider(t),!1;if(n.bounds.contains(i))return!1;if(this._remove(n),i.left-=un.boundsPadding,i.top-=un.boundsPadding,i.right+=un.boundsPadding,i.bottom+=un.boundsPadding,t.owner){var r=null===(e=t.owner)||void 0===e?void 0:e.get(On);if(r){var o=32*r.vel.x/1e3*un.dynamicTreeVelocityMultiplier,a=32*r.vel.y/1e3*un.dynamicTreeVelocityMultiplier;o<0?i.left+=o:i.right+=o,a<0?i.top+=a:i.bottom+=a}}return n.bounds=i,this._insert(n),!0}},{key:"untrackCollider",value:function(t){var e=this.nodes[t.id.value];e&&(this._remove(e),this.nodes[t.id.value]=null,delete this.nodes[t.id.value])}},{key:"_balance",value:function(t){if(null===t)throw new Error("Cannot balance at null node");if(t.isLeaf()||t.height<2)return t;var e=t.left,n=t.right,i=t,r=e,o=n,a=e.left,s=e.right,l=n.left,u=n.right,c=o.height-r.height;if(c>1)return o.left=i,o.parent=i.parent,i.parent=o,o.parent?o.parent.left===i?o.parent.left=o:o.parent.right=o:this.root=o,l.height>u.height?(o.right=l,i.right=u,u.parent=i,i.bounds=r.bounds.combine(u.bounds),o.bounds=i.bounds.combine(l.bounds),i.height=1+Math.max(r.height,u.height),o.height=1+Math.max(i.height,l.height)):(o.right=u,i.right=l,l.parent=i,i.bounds=r.bounds.combine(l.bounds),o.bounds=i.bounds.combine(u.bounds),i.height=1+Math.max(r.height,l.height),o.height=1+Math.max(i.height,u.height)),o;if(c<-1){if(r.left=i,r.parent=i.parent,i.parent=r,r.parent)if(r.parent.left===i)r.parent.left=r;else{if(r.parent.right!==i)throw"Error rotating Dynamic Tree";r.parent.right=r}else this.root=r;return a.height>s.height?(r.right=a,i.left=s,s.parent=i,i.bounds=o.bounds.combine(s.bounds),r.bounds=i.bounds.combine(a.bounds),i.height=1+Math.max(o.height,s.height),r.height=1+Math.max(i.height,a.height)):(r.right=s,i.left=a,a.parent=i,i.bounds=o.bounds.combine(a.bounds),r.bounds=i.bounds.combine(s.bounds),i.height=1+Math.max(o.height,a.height),r.height=1+Math.max(i.height,s.height)),r}return t}},{key:"getHeight",value:function(){return null===this.root?0:this.root.height}},{key:"query",value:function(t,e){var n=t.bounds;!function i(r){if(r&&r.bounds.overlaps(n)){if(!r.isLeaf()||r.data===t)return i(r.left)||i(r.right);if(e.call(t,r.data))return!0}return!1}(this.root)}},{key:"rayCastQuery",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments.length>2?arguments[2]:void 0,i=function i(r){if(r&&r.bounds.rayCast(t,e)){if(!r.isLeaf())return i(r.left)||i(r.right);if(n.call(t,r.data))return!0}return!1};i(this.root)}},{key:"getNodes",value:function(){return function t(e){return e?[e].concat(t(e.left),t(e.right)):[]}(this.root)}},{key:"debug",value:function(t){!function e(n){n&&(n.isLeaf()?n.bounds.draw(t,X.Green):n.bounds.draw(t,X.White),n.left&&e(n.left),n.right&&e(n.right))}(this.root)}}]),t}(),kn=function(){function t(e,n){(0,b.Z)(this,t),this.pos=e,this.dir=n.normalize()}return(0,k.Z)(t,[{key:"intersect",value:function(t){var e=t.begin.sub(this.pos);if(0===this.dir.cross(t.getSlope())&&0!==e.cross(this.dir))return-1;var n=this.dir.cross(t.getSlope());if(0===n)return-1;var i=e.cross(t.getSlope())/n;if(i>=0){var r=e.cross(this.dir)/n/t.getLength();if(r>=0&&r<=1)return i}return-1}},{key:"intersectPoint",value:function(t){var e=this.intersect(t);return e<0?null:this.getPoint(e)}},{key:"getPoint",value:function(t){return this.pos.add(this.dir.scale(t))}}]),t}(),Cn=function(){function t(){(0,b.Z)(this,t),this._dynamicCollisionTree=new bn,this._pairs=new Set,this._collisionPairCache=[],this._colliders=[]}return(0,k.Z)(t,[{key:"getColliders",value:function(){return this._colliders}},{key:"track",value:function(t){if(t)if(t instanceof An){var e,n=t.getColliders(),i=(0,m.Z)(n);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.owner=t.owner,this._colliders.push(r),this._dynamicCollisionTree.trackCollider(r)}}catch(o){i.e(o)}finally{i.f()}}else this._colliders.push(t),this._dynamicCollisionTree.trackCollider(t);else U.getInstance().warn("Cannot track null collider")}},{key:"untrack",value:function(t){if(t)if(t instanceof An){var e,n=t.getColliders(),i=(0,m.Z)(n);try{for(i.s();!(e=i.n()).done;){var r=e.value,o=this._colliders.indexOf(r);-1!==o&&this._colliders.splice(o,1),this._dynamicCollisionTree.untrackCollider(r)}}catch(s){i.e(s)}finally{i.f()}}else{var a=this._colliders.indexOf(t);-1!==a&&this._colliders.splice(a,1),this._dynamicCollisionTree.untrackCollider(t)}else U.getInstance().warn("Cannot untrack a null collider")}},{key:"_pairExists",value:function(t,e){var n=_n.calculatePairHash(t.id,e.id);return this._pairs.has(n)}},{key:"broadphase",value:function(t,e,n){var i,r=this,o=e/1e3,a=t.filter((function(t){var e,n,i=null===(e=t.owner)||void 0===e?void 0:e.get(On);return(null===(n=t.owner)||void 0===n?void 0:n.active)&&i.collisionType!==je.PreventCollision}));this._collisionPairCache=[],this._pairs.clear();for(var s=0,l=a.length;s<l;s++)i=a[s],this._dynamicCollisionTree.query(i,(function(t){if(!r._pairExists(i,t)&&_n.canCollide(i,t)){var e=new _n(i,t);r._pairs.add(e.id),r._collisionPairCache.push(e)}return!1}));if(n&&(n.physics.pairs=this._collisionPairCache.length),un.checkForFastBodies){var u,c=(0,m.Z)(a);try{var h=function(){var t=u.value,e=t.owner.get(On);if(e.collisionType!==je.Active)return"continue";var i=e.vel.size*o+.5*e.acc.size*o*o,a=Math.min(t.bounds.height,t.bounds.width);if(un.disableMinimumSpeedForFastBody||i>a/2){n&&n.physics.fastBodies++;var s,l=e.globalPos.sub(e.oldPos),c=t.center,h=t.getFurthestPoint(e.vel),d=h.sub(l),f=new kn(d,e.vel);f.pos=f.pos.add(f.dir.scale(-2*un.surfaceEpsilon));var p=new O(1/0,1/0);if(r._dynamicCollisionTree.rayCastQuery(f,i+2*un.surfaceEpsilon,(function(e){if(!r._pairExists(t,e)&&_n.canCollide(t,e)){var n=e.rayCast(f,i+10*un.surfaceEpsilon);if(n){var o=n.sub(d);o.size<p.size&&(p=o,s=e)}}return!1})),s&&O.isValid(p)){var v=new _n(t,s);r._pairs.has(v.id)||(r._pairs.add(v.id),r._collisionPairCache.push(v));var g=c.sub(h);e.globalPos=d.add(g).add(p).add(f.dir.scale(10*un.surfaceEpsilon)),t.update(e.transform.get()),n&&n.physics.fastBodyCollisions++}}};for(c.s();!(u=c.n()).done;)h()}catch(d){c.e(d)}finally{c.f()}}return this._collisionPairCache}},{key:"narrowphase",value:function(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i].collide();if(n=n.concat(r),e&&r.length>0){var o,a=(0,m.Z)(r);try{for(a.s();!(o=a.n()).done;){var s=o.value;e.physics.contacts.set(s.id,s)}}catch(l){a.e(l)}finally{a.f()}}}return e&&(e.physics.collisions+=n.length),n}},{key:"update",value:function(t){for(var e=0,n=t.length,i=0;i<n;i++)this._dynamicCollisionTree.updateCollider(t[i])&&e++;return e}},{key:"debug",value:function(t){this._dynamicCollisionTree.debug(t)}}]),t}(),Sn=function(){function t(){(0,b.Z)(this,t),this.id=v("collider",t._ID++),this.__compositeColliderId=null,this.events=new Wt}return(0,k.Z)(t,[{key:"touching",value:function(t){return!!this.collide(t)}}]),t}();Sn._ID=0;var An=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;(0,b.Z)(this,n),(i=e.call(this))._collisionProcessor=new Cn,i._dynamicAABBTree=new bn,i._colliders=[];var r,o=(0,m.Z)(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;i.addCollider(a)}}catch(s){o.e(s)}finally{o.f()}return i}return(0,k.Z)(n,[{key:"clearColliders",value:function(){this._colliders=[]}},{key:"addCollider",value:function(t){this.events.wire(t.events),t.__compositeColliderId=this.id,this._colliders.push(t),this._collisionProcessor.track(t),this._dynamicAABBTree.trackCollider(t)}},{key:"removeCollider",value:function(t){this.events.unwire(t.events),t.__compositeColliderId=null,J(t,this._colliders),this._collisionProcessor.untrack(t),this._dynamicAABBTree.untrackCollider(t)}},{key:"getColliders",value:function(){return this._colliders}},{key:"worldPos",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:O.Zero}},{key:"center",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==e?e:O.Zero}},{key:"bounds",get:function(){var t,e,n=this.getColliders();return n.reduce((function(t,e){return t.combine(e.bounds)}),null!==(e=null===(t=n[0])||void 0===t?void 0:t.bounds)&&void 0!==e?e:(new q).translate(this.worldPos))}},{key:"localBounds",get:function(){var t,e,n=this.getColliders();return n.reduce((function(t,e){return t.combine(e.localBounds)}),null!==(e=null===(t=n[0])||void 0===t?void 0:t.localBounds)&&void 0!==e?e:new q)}},{key:"axes",get:function(){var t,e=this.getColliders(),n=[],i=(0,m.Z)(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;n=n.concat(r.axes)}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"getFurthestPoint",value:function(t){var e,n=this.getColliders(),i=[],r=(0,m.Z)(n);try{for(r.s();!(e=r.n()).done;){var o=e.value;i.push(o.getFurthestPoint(t))}}catch(d){r.e(d)}finally{r.f()}for(var a=i[0],s=-Number.MAX_VALUE,l=0,u=i;l<u.length;l++){var c=u[l],h=c.dot(t);h>s&&(a=c,s=h)}return a}},{key:"getInertia",value:function(t){var e,n=this.getColliders(),i=0,r=(0,m.Z)(n);try{for(r.s();!(e=r.n()).done;){i+=e.value.getInertia(t)}}catch(o){r.e(o)}finally{r.f()}return i}},{key:"collide",value:function(t){var e=this,i=[t];t instanceof n&&(i=t.getColliders());var r,o=[],a=(0,m.Z)(i);try{var s=function(){var t=r.value;e._dynamicAABBTree.query(t,(function(e){return o.push(new _n(t,e)),!1}))};for(a.s();!(r=a.n()).done;)s()}catch(d){a.e(d)}finally{a.f()}for(var l=[],u=0,c=o;u<c.length;u++){var h=c[u];l=l.concat(h.collide())}return l}},{key:"getClosestLineBetween",value:function(t){var e=this.getColliders(),i=[];if(t instanceof n){var r,o=t.getColliders(),a=(0,m.Z)(e);try{for(a.s();!(r=a.n()).done;){var s,l=r.value,u=(0,m.Z)(o);try{for(u.s();!(s=u.n()).done;){var c=s.value,h=l.getClosestLineBetween(c);h&&i.push(h)}}catch(k){u.e(k)}finally{u.f()}}}catch(k){a.e(k)}finally{a.f()}}else{var d,f=(0,m.Z)(e);try{for(f.s();!(d=f.n()).done;){var p=d.value,v=t.getClosestLineBetween(p);v&&i.push(v)}}catch(k){f.e(k)}finally{f.f()}}if(i.length){var g,y=i[0].getLength(),_=i[0],w=(0,m.Z)(i);try{for(w.s();!(g=w.n()).done;){var x=g.value,b=x.getLength();b<y&&(y=b,_=x)}}catch(k){w.e(k)}finally{w.f()}return _}return null}},{key:"contains",value:function(t){var e,n=this.getColliders(),i=(0,m.Z)(n);try{for(i.s();!(e=i.n()).done;){if(e.value.contains(t))return!0}}catch(r){i.e(r)}finally{i.f()}return!1}},{key:"rayCast",value:function(t,e){var n,i=this.getColliders(),r=[],o=(0,m.Z)(i);try{for(o.s();!(n=o.n()).done;){var a=n.value.rayCast(t,e);a&&r.push(a)}}catch(f){o.e(f)}finally{o.f()}if(r.length){var s,l=r[0],u=l.dot(t.dir),c=(0,m.Z)(r);try{for(c.s();!(s=c.n()).done;){var h=s.value,d=t.dir.dot(h);d<u&&(l=h,u=d)}}catch(f){c.e(f)}finally{c.f()}return l}return null}},{key:"project",value:function(t){var e,n=this.getColliders(),i=[],r=(0,m.Z)(n);try{for(r.s();!(e=r.n()).done;){var o=e.value.project(t);o&&i.push(o)}}catch(c){r.e(c)}finally{r.f()}if(i.length){var a,s=new wn(i[0].min,i[0].max),l=(0,m.Z)(i);try{for(l.s();!(a=l.n()).done;){var u=a.value;s.min=Math.min(u.min,s.min),s.max=Math.max(u.max,s.max)}}catch(c){l.e(c)}finally{l.f()}return s}return null}},{key:"update",value:function(t){if(t){var e,n=this.getColliders(),i=(0,m.Z)(n);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.owner=this.owner,r.update(t)}}catch(o){i.e(o)}finally{i.f()}}}},{key:"debug",value:function(t,e){var n,i=this.getColliders(),r=(0,m.Z)(i);try{for(r.s();!(n=r.n()).done;){n.value.debug(t,e)}}catch(o){r.e(o)}finally{r.f()}}},{key:"clone",value:function(){return new n(this._colliders.map((function(t){return t.clone()})))}}]),n}(Sn),En=function(){function t(e,n){(0,b.Z)(this,t),this.begin=e,this.end=n}return(0,k.Z)(t,[{key:"slope",get:function(){return(this.end.y-this.begin.y)/(this.end.x-this.begin.x)}},{key:"intercept",get:function(){return this.begin.y-this.slope*this.begin.x}},{key:"normal",value:function(){return this._normal?this._normal:this._normal=this.end.sub(this.begin).normal()}},{key:"dir",value:function(){return this._dir?this._dir:this._dir=this.end.sub(this.begin)}},{key:"getPoints",value:function(){return[this.begin,this.end]}},{key:"getSlope",value:function(){if(this._slope)return this._slope;var t=this.begin,e=this.end,n=t.distance(e);return this._slope=e.sub(t).scale(1/n)}},{key:"getEdge",value:function(){var t=this.begin;return this.end.sub(t)}},{key:"getLength",value:function(){if(this._length)return this._length;var t=this.begin,e=this.end,n=t.distance(e);return this._length=n}},{key:"midpoint",get:function(){return this.begin.add(this.end).scale(.5)}},{key:"flip",value:function(){return new t(this.end,this.begin)}},{key:"below",value:function(t){return(this.end.x-this.begin.x)*(t.y-this.begin.y)-(this.end.y-this.begin.y)*(t.x-this.begin.x)>=0}},{key:"clip",value:function(e,n){var i=e,r=(i=i.normalize()).dot(this.begin)-n,o=i.dot(this.end)-n,a=[];if(r<=0&&a.push(this.begin),o<=0&&a.push(this.end),r*o<0){var s=r/(r-o);a.push(this.begin.add(this.end.sub(this.begin).scale(s)))}return 2!==a.length?null:new t(a[0],a[1])}},{key:"distanceToPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.x,i=t.y,r=this.getLength(),o=this.end.y-this.begin.y,a=this.end.x-this.begin.x,s=(o*n-a*i+this.end.x*this.begin.y-this.end.y*this.begin.x)/r;return e?s:Math.abs(s)}},{key:"findVectorToPoint",value:function(t){var e=this.begin.sub(t),n=this.getSlope();return e.sub(n.scale(e.dot(n)))}},{key:"findPoint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.slope,i=this.intercept;if(null!==t)return new O(t,n*t+i);if(null!==e)return new O((e-i)/n,e);throw new Error("You must provide an X or a Y value")}},{key:"hasPoint",value:function(){var t,e=0;if("number"===typeof arguments[0]&&"number"===typeof arguments[1])t=new O(arguments[0],arguments[1]),e=arguments[2]||0;else{if(!(arguments[0]instanceof O))throw"Could not determine the arguments for Vector.hasPoint";t=arguments[0],e=arguments[1]||0}var n=t.x-this.begin.x,i=t.y-this.begin.y,r=this.end.x-this.begin.x,o=this.end.y-this.begin.y,a=n*o-i*r;return!(Math.abs(a)>e)&&(Math.abs(r)>=Math.abs(o)?r>0?this.begin.x<=t.x&&t.x<=this.end.x:this.end.x<=t.x&&t.x<=this.begin.x:o>0?this.begin.y<=t.y&&t.y<=this.end.y:this.end.y<=t.y&&t.y<=this.begin.y)}}]),t}();function Tn(t,e,n,i){var r=t.sub(n),o=e.dot(e),a=e.dot(i),s=i.dot(i),l=e.dot(r),u=i.dot(r),c=o*s-a*a,h=c,d=c;if(0===c||c<=.01){var f=l/a;return new En(t,n.add(i.scale(f)))}var p=a*u-s*l,v=o*u-a*l;return p<0?(p=0,v=u,d=s):p>h&&(p=h,v=u+a,d=s),v<0?(v=0,-l<0?p=0:-l>o?p=h:(p=-l,h=o)):v>d&&(v=d,-l+a<0?p=0:-l+a>o?p=h:(p=-l+a,h=o)),p=Math.abs(p)<.001?0:p/h,v=Math.abs(v)<.001?0:v/d,new En(t.add(e.scale(p)),n.add(i.scale(v)))}var Pn,In={PolygonPolygonClosestLine:function(t,e){var n=e.worldPos,i=n.sub(t.worldPos),r=i.negate(),o=new kn(t.worldPos,i),a=new kn(n,r),s=t.rayCast(o).add(o.dir.scale(.1)),l=e.rayCast(a).add(a.dir.scale(.1)),u=t.getClosestFace(s),c=e.getClosestFace(l);return Tn(u.face.begin,u.face.getEdge(),c.face.begin,c.face.getEdge())},PolygonEdgeClosestLine:function(t,e){var n=e.worldPos.sub(t.worldPos),i=new kn(t.worldPos,n),r=t.rayCast(i).add(i.dir.scale(.1)),o=t.getClosestFace(r),a=o.face.begin,s=o.face.getEdge(),l=e.asLine();return Tn(a,s,l.begin,l.getEdge())},PolygonCircleClosestLine:function(t,e){var n=e.worldPos,i=n.sub(t.worldPos),r=new kn(t.worldPos,i.normalize()),o=t.rayCast(r).add(r.dir.scale(.1)),a=t.getClosestFace(o),s=a.face.begin,l=a.face.getEdge(),u=(l.x*(n.x-s.x)+l.y*(n.y-s.y))/(l.x*l.x+l.y*l.y);u>1?u=1:u<0&&(u=0);var c=Math.sqrt(Math.pow(s.x+l.x*u-n.x,2)+Math.pow(s.y+l.y*u-n.y,2))-e.radius,h=(s.x+l.x*u-n.x)*e.radius/(e.radius+c),d=(s.y+l.y*u-n.y)*e.radius/(e.radius+c);return new En(l.scale(u).add(s),new O(n.x+h,n.y+d))},CircleCircleClosestLine:function(t,e){var n=e.worldPos.sub(t.worldPos),i=t.worldPos.sub(e.worldPos),r=new kn(t.worldPos,n),o=new kn(e.worldPos,i),a=t.rayCast(r),s=e.rayCast(o);return new En(a,s)},CircleEdgeClosestLine:function(t,e){var n=t.worldPos,i=e.asLine(),r=i.begin,o=i.getEdge(),a=(o.x*(n.x-r.x)+o.y*(n.y-r.y))/(o.x*o.x+o.y*o.y);a>1?a=1:a<0&&(a=0);var s=Math.sqrt(Math.pow(r.x+o.x*a-n.x,2)+Math.pow(r.y+o.y*a-n.y,2))-t.radius,l=(r.x+o.x*a-n.x)*t.radius/(t.radius+s),u=(r.y+o.y*a-n.y)*t.radius/(t.radius+s);return new En(o.scale(a).add(r),new O(n.x+l,n.y+u))},EdgeEdgeClosestLine:function(t,e){var n=t.asLine(),i=n.begin,r=n.getEdge(),o=e.asLine();return Tn(i,r,o.begin,o.getEdge())}},Zn=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this)).offset=O.Zero,i._globalMatrix=ot.identity(),i.offset=t.offset||O.Zero,i.radius=t.radius||0,i._globalMatrix.translate(i.offset.x,i.offset.y),i}return(0,k.Z)(n,[{key:"worldPos",get:function(){return this._globalMatrix.getPosition()}},{key:"radius",get:function(){var t,e=this._transform,n=null!==(t=null===e||void 0===e?void 0:e.globalScale)&&void 0!==t?t:O.One;return this._naturalRadius*Math.min(n.x,n.y)},set:function(t){var e,n=this._transform,i=null!==(e=null===n||void 0===n?void 0:n.globalScale)&&void 0!==e?e:O.One;this._naturalRadius=t/Math.min(i.x,i.y)}},{key:"clone",value:function(){return new n({offset:this.offset.clone(),radius:this.radius})}},{key:"center",get:function(){return this._globalMatrix.getPosition()}},{key:"contains",value:function(t){var e,n;return(null!==(n=null===(e=this._transform)||void 0===e?void 0:e.pos)&&void 0!==n?n:this.offset).distance(t)<=this.radius}},{key:"rayCast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=this.center,i=t.dir,r=t.pos,o=Math.sqrt(Math.pow(i.dot(r.sub(n)),2)-Math.pow(r.sub(n).distance(),2)+Math.pow(this.radius,2));if(o<0)return null;var a=0;if(0===o)return(a=-i.dot(r.sub(n)))>0&&a<e?t.getPoint(a):null;var s=-i.dot(r.sub(n))+o,l=-i.dot(r.sub(n))-o,u=[];s>=0&&u.push(s),l>=0&&u.push(l);var c=Math.min.apply(Math,u);return c<=e?t.getPoint(c):null}},{key:"getClosestLineBetween",value:function(t){if(t instanceof n)return In.CircleCircleClosestLine(this,t);if(t instanceof Bn)return In.PolygonCircleClosestLine(t,this).flip();if(t instanceof Dn)return In.CircleEdgeClosestLine(this,t).flip();throw new Error("Polygon could not collide with unknown CollisionShape ".concat(typeof t))}},{key:"collide",value:function(t){if(t instanceof n)return Fn.CollideCircleCircle(this,t);if(t instanceof Bn)return Fn.CollideCirclePolygon(this,t);if(t instanceof Dn)return Fn.CollideCircleEdge(this,t);throw new Error("Circle could not collide with unknown CollisionShape ".concat(typeof t))}},{key:"getFurthestPoint",value:function(t){return this.center.add(t.normalize().scale(this.radius))}},{key:"getFurthestLocalPoint",value:function(t){return t.normalize().scale(this.radius)}},{key:"bounds",get:function(){var t,e,n,i=this._transform,r=null!==(t=null===i||void 0===i?void 0:i.globalScale)&&void 0!==t?t:O.One,o=null!==(e=null===i||void 0===i?void 0:i.globalRotation)&&void 0!==e?e:0,a=null!==(n=null===i||void 0===i?void 0:i.globalPos)&&void 0!==n?n:O.Zero;return new q(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius).rotate(o).scale(r).translate(a)}},{key:"localBounds",get:function(){return new q(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius)}},{key:"axes",get:function(){return[]}},{key:"getInertia",value:function(t){return t*this.radius*this.radius/2}},{key:"update",value:function(t){var e;this._transform=t,(null!==(e=t.matrix)&&void 0!==e?e:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}},{key:"project",value:function(t){var e=[],n=this.center.dot(t);return e.push(n),e.push(n+this.radius),e.push(n-this.radius),new wn(Math.min.apply(Math,e),Math.max.apply(Math,e))}},{key:"debug",value:function(t,e){var n,i,r,o,a=this._transform,s=null!==(n=null===a||void 0===a?void 0:a.globalScale)&&void 0!==n?n:O.One,l=null!==(i=null===a||void 0===a?void 0:a.globalRotation)&&void 0!==i?i:0,u=null!==(r=null===a||void 0===a?void 0:a.globalPos)&&void 0!==r?r:O.Zero;t.save(),t.translate(u.x,u.y),t.rotate(l),t.scale(s.x,s.y),t.drawCircle(null!==(o=this.offset)&&void 0!==o?o:O.Zero,this._naturalRadius,X.Transparent,e,2),t.restore()}}]),n}(Sn),Rn=function(){function t(e,n,i,r,o,a,s,l){var u,c;(0,b.Z)(this,t),this._canceled=!1,this.colliderA=e,this.colliderB=n,this.mtv=i,this.normal=r,this.tangent=o,this.points=a,this.localPoints=s,this.info=l,this.id=_n.calculatePairHash(e.id,n.id),(e.__compositeColliderId||n.__compositeColliderId)&&(this.id+="|"+_n.calculatePairHash(null!==(u=e.__compositeColliderId)&&void 0!==u?u:e.id,null!==(c=n.__compositeColliderId)&&void 0!==c?c:n.id))}return(0,k.Z)(t,[{key:"matchAwake",value:function(){var t=this.colliderA.owner.get(On),e=this.colliderB.owner.get(On);t&&e&&t.sleeping!==e.sleeping&&(t.sleeping&&t.collisionType!==je.Fixed&&e.sleepMotion>=un.wakeThreshold&&t.setSleeping(!1),e.sleeping&&e.collisionType!==je.Fixed&&t.sleepMotion>=un.wakeThreshold&&e.setSleeping(!1))}},{key:"isCanceled",value:function(){return this._canceled}},{key:"cancel",value:function(){this._canceled=!0}}]),t}(),Mn=function(){function t(){(0,b.Z)(this,t)}return(0,k.Z)(t,null,[{key:"findPolygonPolygonSeparation",value:function(t,e){for(var n=-Number.MAX_VALUE,i=null,r=null,o=-1,a=null,s=t.getSides(),l=t.getLocalSides(),u=0;u<s.length;u++){var c=s[u],h=c.normal(),d=e.getFurthestPoint(h.negate()),f=c.distanceToPoint(d,!0);f>n&&(n=f,i=c,r=h,o=u,a=d)}return{collider:t,separation:r?n:99,axis:r,side:i,localSide:l[o],sideId:o,point:a,localPoint:r?e.getFurthestLocalPoint(r.negate()):null}}},{key:"findCirclePolygonSeparation",value:function(t,e){var n=e.axes,i=e.center.sub(t.worldPos),r=e.getFurthestPoint(i.negate());n.push(r.sub(t.worldPos).normalize());for(var o=Number.MAX_VALUE,a=null,s=-1,l=0;l<n.length;l++){var u=e.project(n[l]),c=t.project(n[l]),h=u.getOverlap(c);if(h<=0)return null;h<o&&(o=h,a=n[l],s=l)}return s<0?null:a.normalize().scale(o)}}]),t}(),Fn={CollideCircleCircle:function(t,e){var n=t.worldPos,i=e.worldPos,r=t.radius+e.radius,o=n.distance(i);if(o>r)return[];var a=r-o,s=i.sub(n).normalize(),l=s.perpendicular(),u=s.scale(a),c=t.getFurthestPoint(s),h=t.getFurthestLocalPoint(s);return[new Rn(t,e,u,s,l,[c],[h],{collider:t,separation:a,axis:s,point:c})]},CollideCirclePolygon:function(t,e){var n,i,r=Mn.findCirclePolygonSeparation(t,e);if(!r)return[];var o=r.dot(e.center.sub(t.center));r=o<0?r.negate():r;var a=t.getFurthestPoint(r),s=(null!==(i=null===(n=t.owner)||void 0===n?void 0:n.get(gn))&&void 0!==i?i:new gn).applyInverse(a),l=r.normalize(),u={collider:t,separation:-r.size,axis:l,point:a,localPoint:s,side:e.findSide(l.negate()),localSide:e.findLocalSide(l.negate())};return[new Rn(t,e,r,l,l.perpendicular(),[a],[s],u)]},CollideCircleEdge:function(t,e){var n=t.center,i=e.asLine(),r=i.end.sub(i.begin),o=r.dot(i.end.sub(n)),a=r.dot(n.sub(i.begin)),s=e.asLine(),l=e.asLocalLine();if(a<=0){var u=i.begin.sub(n),c=u.dot(u);if(c>t.radius*t.radius)return[];var h=u.normalize(),d=t.radius-Math.sqrt(c),f={collider:t,separation:d,axis:h,point:s.begin,side:s,localSide:l};return[new Rn(t,e,h.scale(d),h,h.perpendicular(),[s.begin],[l.begin],f)]}if(o<=0){var p=i.end.sub(n),v=p.dot(p);if(v>t.radius*t.radius)return[];var g=p.normalize(),y=t.radius-Math.sqrt(v),m={collider:t,separation:y,axis:g,point:s.end,side:s,localSide:l};return[new Rn(t,e,g.scale(y),g,g.perpendicular(),[s.end],[l.end],m)]}var _=r.dot(r),w=i.begin.scale(o).add(i.end.scale(a)).scale(1/_),x=n.sub(w),b=x.dot(x);if(b>t.radius*t.radius)return[];var k=r.perpendicular();k.dot(n.sub(i.begin))<0&&(k.x=-k.x,k.y=-k.y),k=k.normalize();var C=t.radius-Math.sqrt(b),S=k.scale(C),A={collider:t,separation:C,axis:k,point:w,side:s,localSide:l};return[new Rn(t,e,S,k.negate(),k.negate().perpendicular(),[w],[w.sub(e.worldPos)],A)]},CollideEdgeEdge:function(){return[]},CollidePolygonEdge:function(t,e){var n,i=t.center,r=e.center.sub(i).normalize(),o=new Bn({points:[e.begin,e.end,e.end.add(r.scale(100)),e.begin.add(r.scale(100))],offset:e.offset});o.owner=e.owner,(null===(n=e.owner)||void 0===n?void 0:n.get(gn))&&o.update(e.owner.get(gn).get());var a=this.CollidePolygonPolygon(t,o);return a.length&&(a[0].colliderB=e,a[0].id=_n.calculatePairHash(t.id,e.id)),a},CollidePolygonPolygon:function(t,e){var n,i,r,o,a=Mn.findPolygonPolygonSeparation(t,e);if(a.separation>0)return[];var s=Mn.findPolygonPolygonSeparation(e,t);if(s.separation>0)return[];var l=a.separation>s.separation?a:s,u=(l.collider===t?e:t).findSide(l.axis.negate()),c=l.side,h=c.dir().normalize(),d=u.clip(h.negate(),-h.dot(c.begin)),f=null;if(d&&(f=d.clip(h,h.dot(c.end))),f){var p=f.getPoints().filter((function(t){return c.below(t)})),v=l.axis,g=v.perpendicular();e.center.sub(t.center).dot(v)<0&&(g=(v=v.negate()).perpendicular());var y=[];if(l.collider===t){var m=null!==(i=null===(n=e.owner)||void 0===n?void 0:n.get(gn))&&void 0!==i?i:new gn;y=p.map((function(t){return m.applyInverse(t)}))}else{var _=null!==(o=null===(r=t.owner)||void 0===r?void 0:r.get(gn))&&void 0!==o?o:new gn;y=p.map((function(t){return _.applyInverse(t)}))}return[new Rn(t,e,v.scale(-l.separation),v,g,p,y,l)]}return[]},FindContactSeparation:function(t,e){var n,i,r,o,a,s,l,u=t.colliderA,c=null!==(i=null===(n=t.colliderA.owner)||void 0===n?void 0:n.get(gn))&&void 0!==i?i:new gn,h=t.colliderB,d=null!==(o=null===(r=t.colliderB.owner)||void 0===r?void 0:r.get(gn))&&void 0!==o?o:new gn;if(u instanceof Zn&&h instanceof Zn)return-(u.radius+h.radius-c.pos.distance(d.pos));if(u instanceof Bn&&h instanceof Bn&&t.info.localSide)return t.info.collider===u?(a=new En(c.apply(t.info.localSide.begin),c.apply(t.info.localSide.end)),s=d.apply(e)):(a=new En(d.apply(t.info.localSide.begin),d.apply(t.info.localSide.end)),s=c.apply(e)),a.distanceToPoint(s,!0);if(u instanceof Bn&&h instanceof Zn||h instanceof Bn&&u instanceof Zn){var f=c.apply(e);if(t.info.side)return t.info.side.distanceToPoint(f,!0)}if((u instanceof Dn&&h instanceof Bn||h instanceof Dn&&u instanceof Bn)&&(l=t.info.collider===u?d.apply(e):c.apply(e),t.info.side))return t.info.side.distanceToPoint(l,!0);if(u instanceof Zn&&h instanceof Dn||h instanceof Zn&&u instanceof Dn){var p,v=d.apply(e);u instanceof Zn&&(p=u.getFurthestPoint(t.normal));var g=v.distance(p);if(t.info.side)return g>0?-g:0}return 0}},Dn=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i,r;return(0,b.Z)(this,n),(i=e.call(this))._globalMatrix=ot.identity(),i.begin=t.begin||O.Zero,i.end=t.end||O.Zero,i.offset=null!==(r=t.offset)&&void 0!==r?r:O.Zero,i}return(0,k.Z)(n,[{key:"clone",value:function(){return new n({begin:this.begin.clone(),end:this.end.clone()})}},{key:"worldPos",get:function(){var t,e=this._transform;return null!==(t=null===e||void 0===e?void 0:e.globalPos.add(this.offset))&&void 0!==t?t:this.offset}},{key:"center",get:function(){var t=this._getTransformedBegin(),e=this._getTransformedEnd();return t.average(e)}},{key:"_getTransformedBegin",value:function(){return this._globalMatrix.multiply(this.begin)}},{key:"_getTransformedEnd",value:function(){return this._globalMatrix.multiply(this.end)}},{key:"getSlope",value:function(){var t=this._getTransformedBegin(),e=this._getTransformedEnd(),n=t.distance(e);return e.sub(t).scale(1/n)}},{key:"getLength",value:function(){var t=this._getTransformedBegin(),e=this._getTransformedEnd();return t.distance(e)}},{key:"contains",value:function(){return!1}},{key:"rayCast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=this._getTransformedBegin().sub(t.pos);if(0===t.dir.cross(this.getSlope())&&0!==n.cross(t.dir))return null;var i=t.dir.cross(this.getSlope());if(0===i)return null;var r=n.cross(this.getSlope())/i;if(r>=0&&r<=e){var o=n.cross(t.dir)/i/this.getLength();if(o>=0&&o<=1)return t.getPoint(r)}return null}},{key:"getClosestLineBetween",value:function(t){if(t instanceof Zn)return In.CircleEdgeClosestLine(t,this);if(t instanceof Bn)return In.PolygonEdgeClosestLine(t,this).flip();if(t instanceof n)return In.EdgeEdgeClosestLine(this,t);throw new Error("Polygon could not collide with unknown CollisionShape ".concat(typeof t))}},{key:"collide",value:function(t){if(t instanceof Zn)return Fn.CollideCircleEdge(t,this);if(t instanceof Bn)return Fn.CollidePolygonEdge(t,this);if(t instanceof n)return Fn.CollideEdgeEdge();throw new Error("Edge could not collide with unknown CollisionShape ".concat(typeof t))}},{key:"getFurthestPoint",value:function(t){var e=this._getTransformedBegin(),n=this._getTransformedEnd();return t.dot(e)>0?e:n}},{key:"_boundsFromBeginEnd",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return new q(Math.min(t.x,e.x)-n,Math.min(t.y,e.y)-n,Math.max(t.x,e.x)+n,Math.max(t.y,e.y)+n)}},{key:"bounds",get:function(){var t=this._getTransformedBegin(),e=this._getTransformedEnd();return this._boundsFromBeginEnd(t,e)}},{key:"localBounds",get:function(){return this._boundsFromBeginEnd(this.begin,this.end)}},{key:"asLine",value:function(){return new En(this._getTransformedBegin(),this._getTransformedEnd())}},{key:"asLocalLine",value:function(){return new En(this.begin,this.end)}},{key:"axes",get:function(){var t=this._getTransformedEnd().sub(this._getTransformedBegin()).normal(),e=[];return e.push(t),e.push(t.negate()),e.push(t.normal()),e.push(t.normal().negate()),e}},{key:"getInertia",value:function(t){var e=this.end.sub(this.begin).distance()/2;return t*e*e}},{key:"update",value:function(t){var e;this._transform=t,(null!==(e=t.matrix)&&void 0!==e?e:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}},{key:"project",value:function(t){for(var e=[],n=[this._getTransformedBegin(),this._getTransformedEnd()],i=n.length,r=0;r<i;r++)e.push(n[r].dot(t));return new wn(Math.min.apply(Math,e),Math.max.apply(Math,e))}},{key:"debug",value:function(t,e){var n=this._getTransformedBegin(),i=this._getTransformedEnd();t.drawLine(n,i,e,2),t.drawCircle(n,2,e),t.drawCircle(i,2,e)}}]),n}(Sn),Bn=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i,r,o;return(0,b.Z)(this,n),(i=e.call(this))._logger=U.getInstance(),i._transformedPoints=[],i._sides=[],i._localSides=[],i._globalMatrix=ot.identity(),i._transformedPointsDirty=!0,i._sidesDirty=!0,i._localSidesDirty=!0,i._localBoundsDirty=!0,i.offset=null!==(r=t.offset)&&void 0!==r?r:O.Zero,i._globalMatrix.translate(i.offset.x,i.offset.y),i.points=null!==(o=t.points)&&void 0!==o?o:[],i._isCounterClockwiseWinding(i.points)||i.points.reverse(),i.isConvex()||i._logger.warn("Excalibur only supports convex polygon colliders and will not behave properly.Call PolygonCollider.triangulate() to build a new collider composed of smaller convex triangles"),i._calculateTransformation(),i}return(0,k.Z)(n,[{key:"points",get:function(){return this._points},set:function(t){this._localBoundsDirty=!0,this._localSidesDirty=!0,this._sidesDirty=!0,this._points=t}},{key:"_isCounterClockwiseWinding",value:function(t){for(var e=0,n=0;n<t.length;n++)e+=(t[(n+1)%t.length].x-t[n].x)*(t[(n+1)%t.length].y+t[n].y);return e<0}},{key:"isConvex",value:function(){if(this.points.length<3)return!1;var t,e=this.points[this.points.length-2],n=this.points[this.points.length-1],i=Math.atan2(n.y-e.y,n.x-e.x),r=0,a=0,s=0,l=(0,m.Z)(this.points.entries());try{for(l.s();!(t=l.n()).done;){var u=(0,o.Z)(t.value,2),c=u[0],h=u[1];if(e=n,r=i,n=h,i=Math.atan2(n.y-e.y,n.x-e.x),e.equals(n))return!1;var d=i-r;if(d<=-Math.PI?d+=2*Math.PI:d>Math.PI&&(d-=2*Math.PI),0===c){if(0===d)return!1;a=d>0?1:-1}else if(a*d<=0)return!1;s+=d}}catch(f){l.e(f)}finally{l.f()}return 1===Math.abs(Math.round(s/(2*Math.PI)))}},{key:"tessellate",value:function(){for(var t=[],e=1;e<this.points.length-2;e++)t.push([this.points[0],this.points[e+1],this.points[e+2]]);return t.push([this.points[0],this.points[1],this.points[2]]),new An(t.map((function(t){return zn.Polygon(t)})))}},{key:"triangulate",value:function(){if(this.points.length<3)throw Error("Invalid polygon");function t(t,e){return t>=e.length?e[t%e.length]:t<0?e[t%e.length+e.length]:e[t]}function e(t,e,n,i){var r=n.sub(e),o=i.sub(n),a=e.sub(i),s=t.sub(e),l=t.sub(n),u=t.sub(i),c=r.cross(s),h=o.cross(l),d=a.cross(u);return!(c>0||h>0||d>0)}for(var n=[],i=(0,x.Z)(this.points),r=F(0,this.points.length-1);r.length>3;)for(var o=0;o<r.length;o++){var a=r[o],s=t(o-1,r),l=t(o+1,r),u=i[a],c=i[s],h=i[l],d=c.sub(u);if(h.sub(u).cross(d)>0){for(var f=!0,p=0;p<r.length;p++){var v=r[p];if(v!==a&&v!==s&&v!==l)if(e(i[v],c,u,h)){f=!1;break}}if(f){n.push([c,u,h]),r.splice(o,1);break}}}return n.push([i[r[0]],i[r[1]],i[r[2]]]),new An(n.map((function(t){return zn.Polygon(t)})))}},{key:"clone",value:function(){return new n({offset:this.offset.clone(),points:this.points.map((function(t){return t.clone()}))})}},{key:"worldPos",get:function(){return this._transform?this._transform.pos.add(this.offset):this.offset}},{key:"center",get:function(){return this.bounds.center}},{key:"_calculateTransformation",value:function(){var t=this.points,e=t.length;this._transformedPoints.length=0;for(var n=0;n<e;n++)this._transformedPoints[n]=this._globalMatrix.multiply(t[n].clone())}},{key:"getTransformedPoints",value:function(){return this._transformedPointsDirty&&(this._calculateTransformation(),this._transformedPointsDirty=!1),this._transformedPoints}},{key:"getSides",value:function(){if(this._sidesDirty){for(var t=[],e=this.getTransformedPoints(),n=e.length,i=0;i<n;i++)t.push(new En(e[i],e[(i+1)%n]));this._sides=t,this._sidesDirty=!1}return this._sides}},{key:"getLocalSides",value:function(){if(this._localSidesDirty){for(var t=[],e=this.points,n=e.length,i=0;i<n;i++)t.push(new En(e[i],e[(i+1)%n]));this._localSides=t,this._localSidesDirty=!1}return this._localSides}},{key:"findSide",value:function(t){for(var e=this.getSides(),n=e[0],i=-Number.MAX_VALUE,r=0;r<e.length;r++){var o=e[r],a=o.normal().dot(t);a>i&&(n=o,i=a)}return n}},{key:"findLocalSide",value:function(t){for(var e=this.getLocalSides(),n=e[0],i=-Number.MAX_VALUE,r=0;r<e.length;r++){var o=e[r],a=o.normal().dot(t);a>i&&(n=o,i=a)}return n}},{key:"axes",get:function(){for(var t=[],e=this.getSides(),n=0;n<e.length;n++)t.push(e[n].normal());return t}},{key:"update",value:function(t){var e;this._transform=t,this._transformedPointsDirty=!0,this._sidesDirty=!0,(null!==(e=t.matrix)&&void 0!==e?e:this._globalMatrix).clone(this._globalMatrix),this._globalMatrix.translate(this.offset.x,this.offset.y)}},{key:"contains",value:function(t){var e=new kn(t,new O(1,0));return this.getSides().reduce((function(t,n){return e.intersect(n)>=0?t+1:t}),0)%2!==0}},{key:"getClosestLineBetween",value:function(t){if(t instanceof Zn)return In.PolygonCircleClosestLine(this,t);if(t instanceof n)return In.PolygonPolygonClosestLine(this,t);if(t instanceof Dn)return In.PolygonEdgeClosestLine(this,t);throw new Error("Polygon could not collide with unknown CollisionShape ".concat(typeof t))}},{key:"collide",value:function(t){if(t instanceof Zn)return Fn.CollideCirclePolygon(t,this);if(t instanceof n)return Fn.CollidePolygonPolygon(this,t);if(t instanceof Dn)return Fn.CollidePolygonEdge(this,t);throw new Error("Polygon could not collide with unknown CollisionShape ".concat(typeof t))}},{key:"getFurthestPoint",value:function(t){for(var e=this.getTransformedPoints(),n=null,i=-Number.MAX_VALUE,r=0;r<e.length;r++){var o=t.dot(e[r]);o>i&&(i=o,n=e[r])}return n}},{key:"getFurthestLocalPoint",value:function(t){for(var e=this.points,n=e[0],i=-Number.MAX_VALUE,r=0;r<e.length;r++){var o=t.dot(e[r]);o>i&&(i=o,n=e[r])}return n}},{key:"getClosestFace",value:function(t){for(var e=this.getSides(),n=Number.POSITIVE_INFINITY,i=-1,r=-1,o=0;o<e.length;o++){var a=e[o].distanceToPoint(t);a<n&&(n=a,i=o,r=a)}return-1!==i?{distance:e[i].normal().scale(r),face:e[i]}:null}},{key:"bounds",get:function(){return this.localBounds.transform(this._globalMatrix)}},{key:"localBounds",get:function(){return this._localBoundsDirty&&(this._localBounds=q.fromPoints(this.points),this._localBoundsDirty=!1),this._localBounds}},{key:"getInertia",value:function(t){if(this._cachedMass===t&&this._cachedInertia)return this._cachedInertia;for(var e=0,n=0,i=this.points,r=0;r<i.length;r++){var o=(r+1)%i.length,a=i[o].cross(i[r]);e+=a*(i[r].dot(i[r])+i[r].dot(i[o])+i[o].dot(i[o])),n+=a}return this._cachedMass=t,this._cachedInertia=t/6*(e/n)}},{key:"rayCast",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=this.getSides(),i=n.length,r=Number.MAX_VALUE,o=-1,a=0;a<i;a++){var s=t.intersect(n[a]);s>=0&&s<r&&s<=e&&(r=s,o=a)}return o>=0?t.getPoint(r):null}},{key:"project",value:function(t){for(var e=this.getTransformedPoints(),n=e.length,i=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=0;o<n;o++){var a=e[o].dot(t);i=Math.min(i,a),r=Math.max(r,a)}return new wn(i,r)}},{key:"debug",value:function(t,e){for(var n=this.getTransformedPoints()[0],i=[n].concat((0,x.Z)(this.getTransformedPoints()),[n]),r=0;r<i.length-1;r++)t.drawLine(i[r],i[r+1],e,2),t.drawCircle(i[r],2,e),t.drawCircle(i[r+1],2,e)}}]),n}(Sn),zn=function(){function t(){(0,b.Z)(this,t)}return(0,k.Z)(t,null,[{key:"Box",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O.Half,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:O.Zero;return new Bn({points:new q(-t*n.x,-e*n.y,t-t*n.x,e-e*n.y).getPoints(),offset:i})}},{key:"Polygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O.Zero;return new Bn({points:t,offset:e})}},{key:"Circle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O.Zero;return new Zn({radius:t,offset:e})}},{key:"Edge",value:function(t,e){return new Dn({begin:t,end:e})}},{key:"Capsule",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O.Zero,r=U.getInstance();e===n&&r.warn("A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider");var o=n>=e;if(o){var a=new An([t.Circle(e/2,N(0,-n/2+e/2).add(i)),t.Box(e,n-e,O.Half,i),t.Circle(e/2,N(0,n/2-e/2).add(i))]);return a}var s=new An([t.Circle(n/2,N(-e/2+n/2,0).add(i)),t.Box(e-n,n,O.Half,i),t.Circle(n/2,N(e/2-n/2,0).add(i))]);return s}}]),t}(),Ln=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this)).type="ex.collider",i.events=new Wt,i.$colliderAdded=new vn,i.$colliderRemoved=new vn,i.set(t),i}return(0,k.Z)(n,[{key:"get",value:function(){return this._collider}},{key:"set",value:function(t){return this.clear(),t&&(this._collider=t,this._collider.owner=this.owner,this.events.wire(t.events),this.$colliderAdded.notifyAll(t),this.update()),t}},{key:"clear",value:function(){this._collider&&(this.events.unwire(this._collider.events),this.$colliderRemoved.notifyAll(this._collider),this._collider.owner=null,this._collider=null)}},{key:"bounds",get:function(){var t,e;return null!==(e=null===(t=this._collider)||void 0===t?void 0:t.bounds)&&void 0!==e?e:new q}},{key:"localBounds",get:function(){var t,e;return null!==(e=null===(t=this._collider)||void 0===t?void 0:t.localBounds)&&void 0!==e?e:new q}},{key:"update",value:function(){var t,e=null===(t=this.owner)||void 0===t?void 0:t.get(gn);this._collider&&(this._collider.owner=this.owner,e&&this._collider.update(e.get()))}},{key:"collide",value:function(t){var e=this,n=this._collider,i=t._collider;if(!n||!i)return[];var r=!1;if(i instanceof An&&(n=i,i=this._collider,r=!0),this._collider){var o=n.collide(i);return o?(r&&o.forEach((function(n){n.mtv=n.mtv.negate(),n.normal=n.normal.negate(),n.tangent=n.normal.perpendicular(),n.colliderA=e._collider,n.colliderB=t._collider})),o):[]}return[]}},{key:"onAdd",value:function(t){this._collider&&this.update(),this.events.on("precollision",(function(e){var n=e;t.events.emit("precollision",new Tt(n.target.owner,n.other.owner,n.side,n.intersection))})),this.events.on("postcollision",(function(e){var n=e;t.events.emit("postcollision",new Pt(n.target.owner,n.other.owner,n.side,n.intersection))})),this.events.on("collisionstart",(function(e){var n=e;t.events.emit("collisionstart",new Ft(n.target.owner,n.other.owner,n.contact))})),this.events.on("collisionend",(function(e){var n=e;t.events.emit("collisionend",new Dt(n.target.owner,n.other.owner))}))}},{key:"onRemove",value:function(){this.events.clear(),this.$colliderRemoved.notifyAll(this._collider)}},{key:"useBoxCollider",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O.Half,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:O.Zero,r=zn.Box(t,e,n,i);return this.set(r)}},{key:"usePolygonCollider",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O.Zero,n=zn.Polygon(t,e);return this.set(n)}},{key:"useCircleCollider",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O.Zero,n=zn.Circle(t,e);return this.set(n)}},{key:"useEdgeCollider",value:function(t,e){var n=zn.Edge(t,e);return this.set(n)}},{key:"useCompositeCollider",value:function(t){return this.set(new An(t))}}]),n}(fn);!function(t){t.Rotation="rotation",t.X="x",t.Y="y"}(Pn||(Pn={}));var On=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i,r,o,a;return(0,b.Z)(this,n),(i=e.call(this)).type="ex.body",i.dependencies=[gn,yn],i.id=v("body",n._ID++),i.events=new Wt,i._oldTransform=new dn,i.__oldTransformCaptured=!1,i.enableFixedUpdateInterpolate=!0,i.collisionType=je.PreventCollision,i.group=mn.All,i._mass=un.defaultMass,i.sleepMotion=5*un.sleepEpsilon,i.canSleep=un.bodiesCanSleepByDefault,i._sleeping=!1,i.bounciness=.2,i.friction=.99,i.useGravity=!0,i.limitDegreeOfFreedom=[],i.oldVel=new O(0,0),i.oldAcc=O.Zero,t&&(i.collisionType=null!==(r=t.type)&&void 0!==r?r:i.collisionType,i.group=null!==(o=t.group)&&void 0!==o?o:i.group,i.useGravity=null!==(a=t.useGravity)&&void 0!==a?a:i.useGravity),i}return(0,k.Z)(n,[{key:"matrix",get:function(){return this.transform.get().matrix}},{key:"mass",get:function(){return this._mass},set:function(t){this._mass=t,this._cachedInertia=void 0,this._cachedInverseInertia=void 0}},{key:"inverseMass",get:function(){return this.collisionType===je.Fixed?0:1/this.mass}},{key:"sleeping",get:function(){return this._sleeping}},{key:"setSleeping",value:function(t){this._sleeping=t,t?(this.vel=O.Zero,this.acc=O.Zero,this.angularVelocity=0,this.sleepMotion=0):this.sleepMotion=5*un.sleepEpsilon}},{key:"updateMotion",value:function(){this._sleeping&&this.setSleeping(!0);var t=this.vel.size*this.vel.size+Math.abs(this.angularVelocity*this.angularVelocity),e=un.sleepBias;this.sleepMotion=e*this.sleepMotion+(1-e)*t,this.sleepMotion=I(this.sleepMotion,0,10*un.sleepEpsilon),this.canSleep&&this.sleepMotion<un.sleepEpsilon&&this.setSleeping(!0)}},{key:"inertia",get:function(){var t=this;if(this._cachedInertia)return this._cachedInertia;var e=this.owner.get(Ln);if(e){e.$colliderAdded.subscribe((function(){t._cachedInertia=null})),e.$colliderRemoved.subscribe((function(){t._cachedInertia=null}));var n=e.get();if(n)return this._cachedInertia=n.getInertia(this.mass)}return 0}},{key:"inverseInertia",get:function(){return this._cachedInverseInertia?this._cachedInverseInertia:this._cachedInverseInertia=this.collisionType===je.Fixed?0:1/this.inertia}},{key:"active",get:function(){var t;return!!(null===(t=this.owner)||void 0===t?void 0:t.active)}},{key:"center",get:function(){return this.globalPos}},{key:"transform",get:function(){var t;return null===(t=this.owner)||void 0===t?void 0:t.get(gn)}},{key:"motion",get:function(){var t;return null===(t=this.owner)||void 0===t?void 0:t.get(yn)}},{key:"pos",get:function(){return this.transform.pos},set:function(t){this.transform.pos=t}},{key:"globalPos",get:function(){return this.transform.globalPos},set:function(t){this.transform.globalPos=t}},{key:"oldPos",get:function(){return this._oldTransform.pos}},{key:"vel",get:function(){return this.motion.vel},set:function(t){this.motion.vel=t}},{key:"acc",get:function(){return this.motion.acc},set:function(t){this.motion.acc=t}},{key:"torque",get:function(){return this.motion.torque},set:function(t){this.motion.torque=t}},{key:"oldRotation",get:function(){return this._oldTransform.rotation}},{key:"rotation",get:function(){return this.transform.globalRotation},set:function(t){this.transform.globalRotation=t}},{key:"scale",get:function(){return this.transform.globalScale},set:function(t){this.transform.globalScale=t}},{key:"oldScale",get:function(){return this._oldTransform.scale}},{key:"scaleFactor",get:function(){return this.motion.scaleFactor},set:function(t){this.motion.scaleFactor=t}},{key:"angularVelocity",get:function(){return this.motion.angularVelocity},set:function(t){this.motion.angularVelocity=t}},{key:"applyImpulse",value:function(t,e){if(this.collisionType===je.Active){var n=e.scale(this.inverseMass);if(this.limitDegreeOfFreedom.includes(Pn.X)&&(n.x=0),this.limitDegreeOfFreedom.includes(Pn.Y)&&(n.y=0),this.vel.addEqual(n),!this.limitDegreeOfFreedom.includes(Pn.Rotation)){var i=t.sub(this.globalPos);this.angularVelocity+=this.inverseInertia*i.cross(e)}}}},{key:"applyLinearImpulse",value:function(t){if(this.collisionType===je.Active){var e=t.scale(this.inverseMass);this.limitDegreeOfFreedom.includes(Pn.X)&&(e.x=0),this.limitDegreeOfFreedom.includes(Pn.Y)&&(e.y=0),this.vel=this.vel.add(e)}}},{key:"applyAngularImpulse",value:function(t,e){if(this.collisionType===je.Active&&!this.limitDegreeOfFreedom.includes(Pn.Rotation)){var n=t.sub(this.globalPos);this.angularVelocity+=this.inverseInertia*n.cross(e)}}},{key:"captureOldTransform",value:function(){this.__oldTransformCaptured=!0,this.transform.get().clone(this._oldTransform),this.oldVel.setTo(this.vel.x,this.vel.y),this.oldAcc.setTo(this.acc.x,this.acc.y)}}]),n}(fn);On._ID=0;var Nn=(0,k.Z)((function t(e){(0,b.Z)(this,t),this.data=e,this.type="Component Added"}));function Un(t){return!!t&&"Component Added"===t.type}var Hn=(0,k.Z)((function t(e){(0,b.Z)(this,t),this.data=e,this.type="Component Removed"}));function Wn(t){return!!t&&"Component Removed"===t.type}var Vn=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var r;if((0,b.Z)(this,n),(r=e.call(this)).id=n._ID++,r._name="anonymous",r.active=!0,r._componentsToRemove=[],r._componentTypeToInstance=new Map,r._componentStringToInstance=new Map,r._tagsMemo=[],r._typesMemo=[],r.componentAdded$=new vn,r.componentRemoved$=new vn,r._parent=null,r.childrenAdded$=new vn,r.childrenRemoved$=new vn,r._children=[],r._isInitialized=!1,r._setName(i),t){var o,a=(0,m.Z)(t);try{for(a.s();!(o=a.n()).done;){var s=o.value;r.addComponent(s)}}catch(l){a.e(l)}finally{a.f()}}return r}return(0,k.Z)(n,[{key:"_setName",value:function(t){t&&(this._name=t)}},{key:"name",get:function(){return this._name}},{key:"events",get:function(){return this.eventDispatcher}},{key:"kill",value:function(){this.active=!1}},{key:"isKilled",value:function(){return!this.active}},{key:"tags",get:function(){return this._tagsMemo}},{key:"hasTag",value:function(t){return this.tags.includes(t)}},{key:"addTag",value:function(t){return this.addComponent(new pn(t))}},{key:"removeTag",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.removeComponent(t,e)}},{key:"types",get:function(){return this._typesMemo}},{key:"_rebuildMemos",value:function(){this._tagsMemo=Array.from(this._componentStringToInstance.values()).filter((function(t){return t instanceof pn})).map((function(t){return t.type})),this._typesMemo=Array.from(this._componentStringToInstance.keys())}},{key:"getComponents",value:function(){return Array.from(this._componentStringToInstance.values())}},{key:"_notifyAddComponent",value:function(t){this._rebuildMemos();var e=new Nn({component:t,entity:this});this.componentAdded$.notifyAll(e)}},{key:"_notifyRemoveComponent",value:function(t){var e=new Hn({component:t,entity:this});this.componentRemoved$.notifyAll(e),this._rebuildMemos()}},{key:"parent",get:function(){return this._parent}},{key:"children",get:function(){return this._children}},{key:"unparent",value:function(){this._parent&&(this._parent.removeChild(this),this._parent=null)}},{key:"addChild",value:function(t){if(null!==t.parent)throw new Error("Entity already has a parent, cannot add without unparenting");if(this.getAncestors().includes(t))throw new Error("Cycle detected, cannot add entity");return this._children.push(t),t._parent=this,this.childrenAdded$.notifyAll(t),this}},{key:"removeChild",value:function(t){return t.parent===this&&(J(t,this._children),t._parent=null,this.childrenRemoved$.notifyAll(t)),this}},{key:"removeAllChildren",value:function(){var t=this;return this.children.forEach((function(e){t.removeChild(e)})),this}},{key:"getAncestors",value:function(){for(var t=[this],e=this.parent;e;)t.push(e),e=e.parent;return t.reverse()}},{key:"getDescendants",value:function(){for(var t=[this],e=[this];e.length>0;){var n=e.pop();e=e.concat(n.children),t=t.concat(n.children)}return t}},{key:"clone",value:function(){var t,e=new n,i=(0,m.Z)(this.types);try{for(i.s();!(t=i.n()).done;){var r=t.value;e.addComponent(this.get(r).clone())}}catch(l){i.e(l)}finally{i.f()}var o,a=(0,m.Z)(this.children);try{for(a.s();!(o=a.n()).done;){var s=o.value;e.addChild(s.clone())}}catch(l){a.e(l)}finally{a.f()}return e}},{key:"addTemplate",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=(0,m.Z)(t.getComponents());try{for(i.s();!(e=i.n()).done;){var r=e.value;this.addComponent(r.clone(),n)}}catch(l){i.e(l)}finally{i.f()}var o,a=(0,m.Z)(t.children);try{for(a.s();!(o=a.n()).done;){var s=o.value;this.addChild(s.clone().addTemplate(s))}}catch(l){a.e(l)}finally{a.f()}return this}},{key:"addComponent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.has(t.type)){if(!e)return this;this.removeComponent(t)}if(t.dependencies&&t.dependencies.length){var n,i=(0,m.Z)(t.dependencies);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.addComponent(new r)}}catch(a){i.e(a)}finally{i.f()}}t.owner=this;var o=t.constructor;return this._componentTypeToInstance.set(o,t),this._componentStringToInstance.set(t.type,t),t.onAdd&&t.onAdd(this),this._notifyAddComponent(t),this}},{key:"removeComponent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?"string"===typeof t?this._removeComponentByType(t):t instanceof fn&&this._removeComponentByType(t.type):this._componentsToRemove.push(t),this}},{key:"_removeComponentByType",value:function(t){if(this.has(t)){var e=this.get(t);e.owner=null,e.onRemove&&e.onRemove(this);var n=e.constructor;this._componentTypeToInstance.delete(n),this._componentStringToInstance.delete(e.type),this._notifyRemoveComponent(e)}}},{key:"processComponentRemoval",value:function(){var t,e=(0,m.Z)(this._componentsToRemove);try{for(e.s();!(t=e.n()).done;){var n=t.value,i="string"===typeof n?n:n.type;this._removeComponentByType(i)}}catch(r){e.e(r)}finally{e.f()}this._componentsToRemove.length=0}},{key:"has",value:function(t){return"string"===typeof t?this._componentStringToInstance.has(t):this._componentTypeToInstance.has(t)}},{key:"get",value:function(t){return"string"===typeof t?this._componentStringToInstance.get(t):this._componentTypeToInstance.get(t)}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_initialize",value:function(t){this.isInitialized||(this.onInitialize(t),(0,f.Z)((0,y.Z)(n.prototype),"emit",this).call(this,"initialize",new Bt(t,this)),this._isInitialized=!0)}},{key:"_preupdate",value:function(t,e){this.emit("preupdate",new mt(t,e,this)),this.onPreUpdate(t,e)}},{key:"_postupdate",value:function(t,e){this.emit("postupdate",new _t(t,e,this)),this.onPostUpdate(t,e)}},{key:"onInitialize",value:function(t){}},{key:"onPreUpdate",value:function(t,e){}},{key:"onPostUpdate",value:function(t,e){}},{key:"update",value:function(t,e){this._initialize(t),this._preupdate(t,e);var n,i=(0,m.Z)(this.children);try{for(i.s();!(n=i.n()).done;){n.value.update(t,e)}}catch(r){i.e(r)}finally{i.f()}this._postupdate(t,e)}}]),n}(Ze);function Xn(t){return!!t.tick}Vn._ID=0;var Gn=function(){function t(e,n){(0,b.Z)(this,t),this._options=e,this._graphics=n,this.graphics=[]}return(0,k.Z)(t,[{key:"name",get:function(){return this._options.name}},{key:"hide",value:function(t){if(t){var e=null;e=t instanceof jt?t:this._graphics.getGraphic(t),this.graphics=this.graphics.filter((function(t){return t.graphic!==e})),this._graphics.recalculateBounds()}else this.graphics.length=0}},{key:"show",value:function(t,e){var n;return e=d({},e),t instanceof jt?n=this._graphics.copyGraphics?t.clone():t:(n=this._graphics.getGraphic(t))||U.getInstance().error("No such graphic added to component named ".concat(t,". These named graphics are available: "),this._graphics.getNames()),n?(this.graphics.push({graphic:n,options:e}),this._graphics.recalculateBounds(),n):null}},{key:"use",value:function(t,e){return e=d({},e),this.hide(),this.show(t,e)}},{key:"order",get:function(){return this._options.order},set:function(t){this._options.order=t}},{key:"offset",get:function(){var t;return null!==(t=this._options.offset)&&void 0!==t?t:O.Zero},set:function(t){this._options.offset=t}},{key:"currentKeys",get:function(){var t;return null!==(t=this.name)&&void 0!==t?t:"anonymous"}}]),t}(),jn=function(){function t(e){(0,b.Z)(this,t),this._component=e,this._layers=[],this._layerMap={},this.default=new Gn({name:"default",order:0},e),this._maybeAddLayer(this.default)}return(0,k.Z)(t,[{key:"create",value:function(t){var e=new Gn(t,this._component);return this._maybeAddLayer(e)}},{key:"get",value:function(t){return t?this._getLayer(t):this._layers}},{key:"currentKeys",value:function(){var t,e=[],n=(0,m.Z)(this._layers);try{for(n.s();!(t=n.n()).done;){var i=t.value;e.push(i.currentKeys)}}catch(r){n.e(r)}finally{n.f()}return e}},{key:"has",value:function(t){return t in this._layerMap}},{key:"_maybeAddLayer",value:function(t){return this._layerMap[t.name]?this._layerMap[t.name]:(this._layerMap[t.name]=t,this._layers.push(t),this._layers.sort((function(t,e){return t.order-e.order})),t)}},{key:"_getLayer",value:function(t){return this._layerMap[t]}}]),t}(),qn=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;(0,b.Z)(this,n),(i=e.call(this)).type="ex.graphics",i._graphics={},i.visible=!0,i.opacity=1,i.offset=O.Zero,i.anchor=O.Half,i.copyGraphics=!1,i._localBounds=null;var o=t=d({visible:i.visible},t),a=o.current,s=o.anchor,l=o.opacity,u=o.visible,c=o.graphics,h=o.offset,f=o.copyGraphics,p=o.onPreDraw,v=o.onPostDraw;return i._graphics=c||{},i.offset=null!==h&&void 0!==h?h:i.offset,i.opacity=null!==l&&void 0!==l?l:i.opacity,i.anchor=null!==s&&void 0!==s?s:i.anchor,i.copyGraphics=null!==f&&void 0!==f?f:i.copyGraphics,i.onPreDraw=null!==p&&void 0!==p?p:i.onPreDraw,i.onPostDraw=null!==v&&void 0!==v?v:i.onPostDraw,i.visible=!!u,i.layers=new jn((0,r.Z)(i)),a&&i._graphics[a]&&i.show(i._graphics[a]),i}return(0,k.Z)(n,[{key:"getGraphic",value:function(t){return this._graphics[t]}},{key:"getNames",value:function(){return Object.keys(this._graphics)}},{key:"current",get:function(){return this.layers.default.graphics}},{key:"graphics",get:function(){return this._graphics}},{key:"add",value:function(t,e){var n="default",i=null;return"string"===typeof t?(n=t,i=e):i=t,this._graphics[n]=this.copyGraphics?i.clone():i,"default"===n&&this.show("default"),i}},{key:"show",value:function(t,e){var n=this.layers.default.show(t,e);return this.recalculateBounds(),n}},{key:"use",value:function(t,e){var n=this.layers.default.use(t,e);return this.recalculateBounds(),n}},{key:"hide",value:function(t){this.layers.default.hide(t)}},{key:"localBounds",get:function(){return this._localBounds&&!this._localBounds.hasZeroDimensions()||this.recalculateBounds(),this._localBounds},set:function(t){this._localBounds=t}},{key:"recalculateBounds",value:function(){var t,e=new q,n=(0,m.Z)(this.layers.get());try{for(n.s();!(t=n.n()).done;){var i,r=t.value,o=(0,m.Z)(r.graphics);try{for(o.s();!(i=o.n()).done;){var a=i.value,s=a.graphic,l=a.options,u=this.anchor,c=this.offset;(null===l||void 0===l?void 0:l.anchor)&&(u=l.anchor),(null===l||void 0===l?void 0:l.offset)&&(c=l.offset);var h=s.localBounds,d=-h.width*u.x+c.x,f=-h.height*u.y+c.y;e=null===s||void 0===s?void 0:s.localBounds.translate(N(d+r.offset.x,f+r.offset.y)).combine(e)}}catch(p){o.e(p)}finally{o.f()}}}catch(p){n.e(p)}finally{n.f()}this._localBounds=e}},{key:"update",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(0,m.Z)(this.layers.get());try{for(i.s();!(e=i.n()).done;){var r,o=e.value,a=(0,m.Z)(o.graphics);try{for(a.s();!(r=a.n()).done;){var s=r.value.graphic;Xn(s)&&(null===s||void 0===s||s.tick(t,n))}}catch(l){a.e(l)}finally{a.f()}}}catch(l){i.e(l)}finally{i.f()}}}]),n}(fn),Yn=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this,t)).width=t.width,i.height=t.height,i.rasterize(),i}return(0,k.Z)(n,[{key:"clone",value:function(){return new n(d(d({width:this.width,height:this.height},this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){this.color&&t.fillRect(0,0,this.width,this.height),this.strokeColor&&t.strokeRect(0,0,this.width,this.height)}}]),n}(Le),Kn=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i,r,o;return(0,b.Z)(this,n),(i=e.call(this,t))._radius=0,i.padding=null!==(r=t.padding)&&void 0!==r?r:2,i.radius=t.radius,i.filtering=null!==(o=t.filtering)&&void 0!==o?o:qt.Blended,i.rasterize(),i}return(0,k.Z)(n,[{key:"radius",get:function(){return this._radius},set:function(t){this._radius=t,this.width=2*this._radius,this.height=2*this._radius,this.flagDirty()}},{key:"clone",value:function(){return new n(d(d({radius:this.radius},this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){this.radius>0&&(t.beginPath(),t.arc(this.radius,this.radius,this.radius,0,2*Math.PI),this.color&&t.fill(),this.strokeColor&&t.stroke())}}]),n}(Le),Qn=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.apply(this,arguments)).type="ex.pointer",t.useColliderShape=!0,t.useGraphicsBounds=!1,t}return(0,k.Z)(n)}(fn),Jn=function(){function t(){(0,b.Z)(this,t)}return(0,k.Z)(t,null,[{key:"CreateReversibleEasingFunction",value:function(t){return function(e,n,i,r){return i<n?n-(t(e,i,n,r)-i):t(e,n,i,r)}}},{key:"CreateVectorEasingFunction",value:function(t){return function(e,n,i,r){return new O(t(e,n.x,i.x,r),t(e,n.y,i.y,r))}}}]),t}();Jn.Linear=Jn.CreateReversibleEasingFunction((function(t,e,n,i){return(n-=e)*t/i+e})),Jn.EaseInQuad=Jn.CreateReversibleEasingFunction((function(t,e,n,i){return(n-=e)*(t/=i)*t+e})),Jn.EaseOutQuad=Jn.CreateReversibleEasingFunction((function(t,e,n,i){return-(n-=e)*(t/=i)*(t-2)+e})),Jn.EaseInOutQuad=Jn.CreateReversibleEasingFunction((function(t,e,n,i){return n-=e,(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e})),Jn.EaseInCubic=Jn.CreateReversibleEasingFunction((function(t,e,n,i){return(n-=e)*(t/=i)*t*t+e})),Jn.EaseOutCubic=Jn.CreateReversibleEasingFunction((function(t,e,n,i){return t/=i,(n-=e)*(--t*t*t+1)+e})),Jn.EaseInOutCubic=Jn.CreateReversibleEasingFunction((function(t,e,n,i){return n-=e,(t/=i/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e}));var $n,ti=function(){function t(e){(0,b.Z)(this,t),this._actions=[],this._completedActions=[],this._entity=e}return(0,k.Z)(t,[{key:"add",value:function(t){this._actions.push(t)}},{key:"remove",value:function(t){var e=this._actions.indexOf(t);this._actions.splice(e,1)}},{key:"clearActions",value:function(){this._actions.length=0,this._completedActions.length=0,this._currentAction&&this._currentAction.stop()}},{key:"getActions",value:function(){return this._actions.concat(this._completedActions)}},{key:"hasNext",value:function(){return this._actions.length>0}},{key:"isComplete",value:function(){return 0===this._actions.length}},{key:"reset",value:function(){this._actions=this.getActions();for(var t=this._actions.length,e=0;e<t;e++)this._actions[e].reset();this._completedActions=[]}},{key:"update",value:function(t){this._actions.length>0&&(this._currentAction=this._actions[0],this._currentAction.update(t),this._currentAction.isComplete(this._entity)&&this._completedActions.push(this._actions.shift()))}}]),t}(),ei=function(){function t(e,n,i){(0,b.Z)(this,t),this._stopped=!1,this._repeatBuilder=n,this._repeatContext=new ki(e),this._actionQueue=this._repeatContext.getQueue(),this._repeat=i,this._originalRepeat=i,this._repeatBuilder(this._repeatContext),this._repeat--}return(0,k.Z)(t,[{key:"update",value:function(t){this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext),this._repeat--),this._actionQueue.update(t)}},{key:"isComplete",value:function(){return this._stopped||this._repeat<=0&&this._actionQueue.isComplete()}},{key:"stop",value:function(){this._stopped=!0}},{key:"reset",value:function(){this._repeat=this._originalRepeat}}]),t}(),ni=function(){function t(e,n){(0,b.Z)(this,t),this._stopped=!1,this._repeatBuilder=n,this._repeatContext=new ki(e),this._actionQueue=this._repeatContext.getQueue(),this._repeatBuilder(this._repeatContext)}return(0,k.Z)(t,[{key:"update",value:function(t){this._stopped||(this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext)),this._actionQueue.update(t))}},{key:"isComplete",value:function(){return this._stopped}},{key:"stop",value:function(){this._stopped=!0,this._actionQueue.clearActions()}},{key:"reset",value:function(){}}]),t}(),ii=function(){function t(e,n,i,r){if((0,b.Z)(this,t),this._started=!1,this._stopped=!1,this._entity=e,this._tx=e.get(gn),this._motion=e.get(yn),this._speed=r,this._offset=new O(n,i),r<=0)throw U.getInstance().error("Attempted to moveBy with speed less than or equal to zero : "+r),new Error("Speed must be greater than 0 pixels per second")}return(0,k.Z)(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._start=new O(this._tx.pos.x,this._tx.pos.y),this._end=this._start.add(this._offset),this._distance=this._offset.size,this._dir=this._end.sub(this._start).normalize()),this.isComplete(this._entity)?(this._tx.pos=N(this._end.x,this._end.y),this._motion.vel=N(0,0)):this._motion.vel=this._dir.scale(this._speed)}},{key:"isComplete",value:function(t){var e=t.get(gn);return this._stopped||e.pos.distance(this._start)>=this._distance}},{key:"stop",value:function(){this._motion.vel=N(0,0),this._stopped=!0}},{key:"reset",value:function(){this._started=!1,this._stopped=!1}}]),t}(),ri=function(){function t(e,n,i,r){(0,b.Z)(this,t),this.entity=e,this._started=!1,this._stopped=!1,this._tx=e.get(gn),this._motion=e.get(yn),this._end=new O(n,i),this._speed=r}return(0,k.Z)(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._start=new O(this._tx.pos.x,this._tx.pos.y),this._distance=this._start.distance(this._end),this._dir=this._end.sub(this._start).normalize());var e=this._dir.scale(this._speed);this._motion.vel=N(e.x,e.y),this.isComplete(this.entity)&&(this._tx.pos=N(this._end.x,this._end.y),this._motion.vel=N(0,0))}},{key:"isComplete",value:function(t){var e=t.get(gn);return this._stopped||new O(e.pos.x,e.pos.y).distance(this._start)>=this._distance}},{key:"stop",value:function(){this._motion.vel=N(0,0),this._stopped=!0}},{key:"reset",value:function(){this._started=!1,this._stopped=!1}}]),t}();!function(t){t[t.ShortestPath=0]="ShortestPath",t[t.LongestPath=1]="LongestPath",t[t.Clockwise=2]="Clockwise",t[t.CounterClockwise=3]="CounterClockwise"}($n||($n={}));var oi,ai,si,li,ui,ci=function(){function t(e,n,i,r){(0,b.Z)(this,t),this._started=!1,this._stopped=!1,this._tx=e.get(gn),this._motion=e.get(yn),this._end=n,this._speed=i,this._rotationType=r||$n.ShortestPath}return(0,k.Z)(t,[{key:"update",value:function(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation;var e=Math.abs(this._end-this._start),n=E-e;switch(e>n?(this._shortDistance=n,this._longDistance=e):(this._shortDistance=e,this._longDistance=n),this._shortestPathIsPositive=(this._start-this._end+E)%E>=Math.PI,this._rotationType){case $n.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case $n.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case $n.Clockwise:this._direction=1,this._shortestPathIsPositive?this._distance=this._shortDistance:this._distance=this._longDistance;break;case $n.CounterClockwise:this._direction=-1,this._shortestPathIsPositive?this._distance=this._longDistance:this._distance=this._shortDistance}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}},{key:"isComplete",value:function(){var t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}},{key:"stop",value:function(){this._motion.angularVelocity=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1,this._stopped=!1}}]),t}(),hi=function(){function t(e,n,i,r){(0,b.Z)(this,t),this._started=!1,this._stopped=!1,this._tx=e.get(gn),this._motion=e.get(yn),this._speed=i,this._offset=n,this._rotationType=r||$n.ShortestPath}return(0,k.Z)(t,[{key:"update",value:function(t){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation,this._end=this._start+this._offset;var e=Math.abs(this._end-this._start),n=E-e;switch(e>n?(this._shortDistance=n,this._longDistance=e):(this._shortDistance=e,this._longDistance=n),this._shortestPathIsPositive=(this._start-this._end+E)%E>=Math.PI,this._rotationType){case $n.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case $n.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case $n.Clockwise:this._direction=1,this._shortDistance>=0?this._distance=this._shortDistance:this._distance=this._longDistance;break;case $n.CounterClockwise:this._direction=-1,this._shortDistance<=0?this._distance=this._shortDistance:this._distance=this._longDistance}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(t/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}},{key:"isComplete",value:function(){var t=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||t>=Math.abs(this._distance)}},{key:"stop",value:function(){this._motion.angularVelocity=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1,this._stopped=!1,this._start=void 0,this._currentNonCannonAngle=void 0,this._distance=void 0}}]),t}(),di=function(){function t(e,n,i,r,o){(0,b.Z)(this,t),this._started=!1,this._stopped=!1,this._tx=e.get(gn),this._motion=e.get(yn),this._endX=n,this._endY=i,this._speedX=r,this._speedY=o}return(0,k.Z)(t,[{key:"update",value:function(t){if(this._started||(this._started=!0,this._startX=this._tx.scale.x,this._startY=this._tx.scale.y,this._distanceX=Math.abs(this._endX-this._startX),this._distanceY=Math.abs(this._endY-this._startY)),Math.abs(this._tx.scale.x-this._startX)>=this._distanceX)this._motion.scaleFactor.x=0;else{var e=this._endY<this._startY?-1:1;this._motion.scaleFactor.x=this._speedX*e}if(Math.abs(this._tx.scale.y-this._startY)>=this._distanceY)this._motion.scaleFactor.y=0;else{var n=this._endY<this._startY?-1:1;this._motion.scaleFactor.y=this._speedY*n}this.isComplete()&&(this._tx.scale=N(this._endX,this._endY),this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}},{key:"isComplete",value:function(){return this._stopped||Math.abs(this._tx.scale.y-this._startX)>=this._distanceX-.01&&Math.abs(this._tx.scale.y-this._startY)>=this._distanceY-.01}},{key:"stop",value:function(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1,this._stopped=!1}}]),t}(),fi=function(){function t(e,n,i,r){(0,b.Z)(this,t),this._started=!1,this._stopped=!1,this._tx=e.get(gn),this._motion=e.get(yn),this._offset=new O(n,i),this._speedX=this._speedY=r}return(0,k.Z)(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._startScale=this._tx.scale.clone(),this._endScale=this._startScale.add(this._offset),this._distanceX=Math.abs(this._endScale.x-this._startScale.x),this._distanceY=Math.abs(this._endScale.y-this._startScale.y),this._directionX=this._endScale.x<this._startScale.x?-1:1,this._directionY=this._endScale.y<this._startScale.y?-1:1),this._motion.scaleFactor.x=this._speedX*this._directionX,this._motion.scaleFactor.y=this._speedY*this._directionY,this.isComplete()&&(this._tx.scale=this._endScale,this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}},{key:"isComplete",value:function(){return this._stopped||Math.abs(this._tx.scale.x-this._startScale.x)>=this._distanceX-.01&&Math.abs(this._tx.scale.y-this._startScale.y)>=this._distanceY-.01}},{key:"stop",value:function(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}},{key:"reset",value:function(){this._started=!1,this._stopped=!1}}]),t}(),pi=function(){function t(e){(0,b.Z)(this,t),this._method=null,this._hasBeenCalled=!1,this._method=e}return(0,k.Z)(t,[{key:"update",value:function(t){this._method(),this._hasBeenCalled=!0}},{key:"isComplete",value:function(){return this._hasBeenCalled}},{key:"reset",value:function(){this._hasBeenCalled=!1}},{key:"stop",value:function(){this._hasBeenCalled=!0}}]),t}(),vi=function(){function t(e,n,i,r,o){(0,b.Z)(this,t),this.easingFcn=o,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=new O(0,0),this._lerpEnd=new O(0,0),this._initialized=!1,this._stopped=!1,this._tx=e.get(gn),this._motion=e.get(yn),this._lerpDuration=r,this._lerpEnd=new O(n,i)}return(0,k.Z)(t,[{key:"_initialize",value:function(){this._lerpStart=new O(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0}},{key:"update",value:function(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;var e=this._tx.pos.x,n=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(e=this._lerpEnd.x<this._lerpStart.x?this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),n=this._lerpEnd.y<this._lerpStart.y?this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=N((e-this._tx.pos.x)/(t/1e3),(n-this._tx.pos.y)/(t/1e3))):(this._tx.pos=N(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=O.Zero)}},{key:"isComplete",value:function(){return this._stopped||this._currentLerpTime>=this._lerpDuration}},{key:"reset",value:function(){this._initialized=!1,this._stopped=!1,this._currentLerpTime=0}},{key:"stop",value:function(){this._motion.vel=N(0,0),this._stopped=!0}}]),t}(),gi=function(){function t(e,n,i,r,o){(0,b.Z)(this,t),this.easingFcn=o,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=new O(0,0),this._lerpEnd=new O(0,0),this._initialized=!1,this._stopped=!1,this._tx=e.get(gn),this._motion=e.get(yn),this._lerpDuration=r,this._offset=new O(n,i)}return(0,k.Z)(t,[{key:"_initialize",value:function(){this._lerpStart=new O(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0,this._lerpEnd=this._lerpStart.add(this._offset)}},{key:"update",value:function(t){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=t;var e=this._tx.pos.x,n=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(e=this._lerpEnd.x<this._lerpStart.x?this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),n=this._lerpEnd.y<this._lerpStart.y?this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=N((e-this._tx.pos.x)/(t/1e3),(n-this._tx.pos.y)/(t/1e3))):(this._tx.pos=N(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=O.Zero)}},{key:"isComplete",value:function(){return this._stopped||this._currentLerpTime>=this._lerpDuration}},{key:"reset",value:function(){this._initialized=!1,this._stopped=!1,this._currentLerpTime=0}},{key:"stop",value:function(){this._motion.vel=N(0,0),this._stopped=!0}}]),t}(),yi=function(){function t(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,b.Z)(this,t),this._timeVisible=0,this._timeNotVisible=0,this._elapsedTime=0,this._totalTime=0,this._stopped=!1,this._started=!1,this._graphics=e.get(qn),this._timeVisible=n,this._timeNotVisible=i,this._duration=(n+i)*r}return(0,k.Z)(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._elapsedTime=0,this._totalTime=0),this._graphics&&(this._elapsedTime+=t,this._totalTime+=t,this._graphics.visible&&this._elapsedTime>=this._timeVisible&&(this._graphics.visible=!1,this._elapsedTime=0),!this._graphics.visible&&this._elapsedTime>=this._timeNotVisible&&(this._graphics.visible=!0,this._elapsedTime=0),this.isComplete()&&(this._graphics.visible=!0))}},{key:"isComplete",value:function(){return this._stopped||this._totalTime>=this._duration}},{key:"stop",value:function(){this._graphics&&(this._graphics.visible=!0),this._stopped=!0}},{key:"reset",value:function(){this._started=!1,this._stopped=!1,this._elapsedTime=0,this._totalTime=0}}]),t}(),mi=function(){function t(e,n,i){(0,b.Z)(this,t),this._multiplier=1,this._started=!1,this._stopped=!1,this._graphics=e.get(qn),this._endOpacity=n,this._speed=this._ogspeed=i}return(0,k.Z)(t,[{key:"update",value:function(t){this._graphics&&(this._started||(this._started=!0,this._speed=this._ogspeed,this._endOpacity<this._graphics.opacity?this._multiplier=-1:this._multiplier=1),this._speed>0&&(this._graphics.opacity+=this._multiplier*(Math.abs(this._graphics.opacity-this._endOpacity)*t)/this._speed),this._speed-=t,this.isComplete()&&(this._graphics.opacity=this._endOpacity),U.getInstance().debug("[Action fade] Actor opacity:",this._graphics.opacity))}},{key:"isComplete",value:function(){return this._stopped||Math.abs(this._graphics.opacity-this._endOpacity)<.05}},{key:"stop",value:function(){this._stopped=!0}},{key:"reset",value:function(){this._started=!1,this._stopped=!1}}]),t}(),_i=function(){function t(e){(0,b.Z)(this,t),this._elapsedTime=0,this._started=!1,this._stopped=!1,this._delay=e}return(0,k.Z)(t,[{key:"update",value:function(t){this._started||(this._started=!0),this._elapsedTime+=t}},{key:"isComplete",value:function(){return this._stopped||this._elapsedTime>=this._delay}},{key:"stop",value:function(){this._stopped=!0}},{key:"reset",value:function(){this._elapsedTime=0,this._started=!1,this._stopped=!1}}]),t}(),wi=function(){function t(e){(0,b.Z)(this,t),this._stopped=!1,this._entity=e}return(0,k.Z)(t,[{key:"update",value:function(t){this._entity.get(Ci).clearActions(),this._entity.kill(),this._stopped=!0}},{key:"isComplete",value:function(){return this._stopped}},{key:"stop",value:function(){}},{key:"reset",value:function(){}}]),t}(),xi=function(){function t(e,n,i){(0,b.Z)(this,t),this._started=!1,this._stopped=!1,this._tx=e.get(gn),this._motion=e.get(yn),this._followTx=n.get(gn),this._followMotion=n.get(yn),this._current=new O(this._tx.pos.x,this._tx.pos.y),this._end=new O(this._followTx.pos.x,this._followTx.pos.y),this._maximumDistance=void 0!==i?i:this._current.distance(this._end),this._speed=0}return(0,k.Z)(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());var e=Math.sqrt(Math.pow(this._followMotion.vel.x,2)+Math.pow(this._followMotion.vel.y,2));if(0!==e&&(this._speed=e),this._current=N(this._tx.pos.x,this._tx.pos.y),this._end=N(this._followTx.pos.x,this._followTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize(),this._distanceBetween>=this._maximumDistance){var n=this._dir.scale(this._speed);this._motion.vel=N(n.x,n.y)}else this._motion.vel=N(0,0);this.isComplete()&&(this._tx.pos=N(this._end.x,this._end.y),this._motion.vel=N(0,0))}},{key:"stop",value:function(){this._motion.vel=N(0,0),this._stopped=!0}},{key:"isComplete",value:function(){return this._stopped}},{key:"reset",value:function(){this._started=!1,this._stopped=!1}}]),t}(),bi=function(){function t(e,n,i){(0,b.Z)(this,t),this._started=!1,this._stopped=!1,this._speedWasSpecified=!1,this._tx=e.get(gn),this._motion=e.get(yn),this._meetTx=n.get(gn),this._meetMotion=n.get(yn),this._current=new O(this._tx.pos.x,this._tx.pos.y),this._end=new O(this._meetTx.pos.x,this._meetTx.pos.y),this._speed=i||0,void 0!==i&&(this._speedWasSpecified=!0)}return(0,k.Z)(t,[{key:"update",value:function(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());var e=Math.sqrt(Math.pow(this._meetMotion.vel.x,2)+Math.pow(this._meetMotion.vel.y,2));0===e||this._speedWasSpecified||(this._speed=e),this._current=N(this._tx.pos.x,this._tx.pos.y),this._end=N(this._meetTx.pos.x,this._meetTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize();var n=this._dir.scale(this._speed);this._motion.vel=N(n.x,n.y),this.isComplete()&&(this._tx.pos=N(this._end.x,this._end.y),this._motion.vel=N(0,0))}},{key:"isComplete",value:function(){return this._stopped||this._distanceBetween<=1}},{key:"stop",value:function(){this._motion.vel=N(0,0),this._stopped=!0}},{key:"reset",value:function(){this._started=!1,this._stopped=!1,this._distanceBetween=void 0}}]),t}(),ki=function(){function t(e){(0,b.Z)(this,t),this._entity=e,this._queue=new ti(e)}return(0,k.Z)(t,[{key:"getQueue",value:function(){return this._queue}},{key:"update",value:function(t){this._queue.update(t)}},{key:"clearActions",value:function(){this._queue.clearActions()}},{key:"runAction",value:function(t){return t.reset(),this._queue.add(t),this}},{key:"easeTo",value:function(){for(var t,e,n=0,i=0,r=0,o=Jn.Linear,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return s[0]instanceof O?(n=s[0].x,i=s[0].y,r=s[1],o=null!==(t=s[2])&&void 0!==t?t:o):(n=s[0],i=s[1],r=s[2],o=null!==(e=s[3])&&void 0!==e?e:o),this._queue.add(new vi(this._entity,n,i,r,o)),this}},{key:"easeBy",value:function(){for(var t,e,n=0,i=0,r=0,o=Jn.Linear,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return s[0]instanceof O?(n=s[0].x,i=s[0].y,r=s[1],o=null!==(t=s[2])&&void 0!==t?t:o):(n=s[0],i=s[1],r=s[2],o=null!==(e=s[3])&&void 0!==e?e:o),this._queue.add(new gi(this._entity,n,i,r,o)),this}},{key:"moveTo",value:function(t,e,n){var i=0,r=0,o=0;return t instanceof O?(i=t.x,r=t.y,o=e):(i=t,r=e,o=n),this._queue.add(new ri(this._entity,i,r,o)),this}},{key:"moveBy",value:function(t,e,n){var i=0,r=0,o=0;return t instanceof O?(i=t.x,r=t.y,o=e):(i=t,r=e,o=n),this._queue.add(new ii(this._entity,i,r,o)),this}},{key:"rotateTo",value:function(t,e,n){return this._queue.add(new ci(this._entity,t,e,n)),this}},{key:"rotateBy",value:function(t,e,n){return this._queue.add(new hi(this._entity,t,e,n)),this}},{key:"scaleTo",value:function(t,e,n,i){var r=1,o=1,a=0,s=0;return t instanceof O&&e instanceof O&&(r=t.x,o=t.y,a=e.x,s=e.y),"number"===typeof t&&"number"===typeof e&&(r=t,o=e,a=n,s=i),this._queue.add(new di(this._entity,r,o,a,s)),this}},{key:"scaleBy",value:function(t,e,n){var i=1,r=1;return t instanceof O&&(i=t.x,r=t.y,n=e),"number"===typeof t&&"number"===typeof e&&(i=t,r=e),this._queue.add(new fi(this._entity,i,r,n)),this}},{key:"blink",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this._queue.add(new yi(this._entity,t,e,n)),this}},{key:"fade",value:function(t,e){return this._queue.add(new mi(this._entity,t,e)),this}},{key:"delay",value:function(t){return this._queue.add(new _i(t)),this}},{key:"die",value:function(){return this._queue.add(new wi(this._entity)),this}},{key:"callMethod",value:function(t){return this._queue.add(new pi(t)),this}},{key:"repeat",value:function(t,e){return e?(this._queue.add(new ei(this._entity,t,e)),this):(this.repeatForever(t),this)}},{key:"repeatForever",value:function(t){return this._queue.add(new ni(this._entity,t)),this}},{key:"follow",value:function(t,e){return void 0===e?this._queue.add(new xi(this._entity,t)):this._queue.add(new xi(this._entity,t,e)),this}},{key:"meet",value:function(t,e){return void 0===e?this._queue.add(new bi(this._entity,t)):this._queue.add(new bi(this._entity,t,e)),this}},{key:"toPromise",value:function(){var t=this;return new Promise((function(e){t._queue.add(new pi((function(){e()})))}))}}]),t}(),Ci=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.apply(this,arguments)).type="ex.actions",t.dependencies=[gn,yn],t}return(0,k.Z)(n,[{key:"onAdd",value:function(t){this._ctx=new ki(t)}},{key:"onRemove",value:function(){this._ctx=null}},{key:"getQueue",value:function(){var t;return null===(t=this._ctx)||void 0===t?void 0:t.getQueue()}},{key:"runAction",value:function(t){var e;return null===(e=this._ctx)||void 0===e?void 0:e.runAction(t)}},{key:"update",value:function(t){var e;return null===(e=this._ctx)||void 0===e?void 0:e.update(t)}},{key:"clearActions",value:function(){var t;null===(t=this._ctx)||void 0===t||t.clearActions()}},{key:"easeTo",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this._ctx.easeTo.apply(this._ctx,e)}},{key:"easeBy",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this._ctx.easeBy.apply(this._ctx,e)}},{key:"moveTo",value:function(t,e,n){return this._ctx.moveTo.apply(this._ctx,[t,e,n])}},{key:"moveBy",value:function(t,e,n){return this._ctx.moveBy.apply(this._ctx,[t,e,n])}},{key:"rotateTo",value:function(t,e,n){return this._ctx.rotateTo(t,e,n)}},{key:"rotateBy",value:function(t,e,n){return this._ctx.rotateBy(t,e,n)}},{key:"scaleTo",value:function(t,e,n,i){return this._ctx.scaleTo.apply(this._ctx,[t,e,n,i])}},{key:"scaleBy",value:function(t,e,n){return this._ctx.scaleBy.apply(this._ctx,[t,e,n])}},{key:"blink",value:function(t,e,n){return this._ctx.blink(t,e,n)}},{key:"fade",value:function(t,e){return this._ctx.fade(t,e)}},{key:"delay",value:function(t){return this._ctx.delay(t)}},{key:"die",value:function(){return this._ctx.die()}},{key:"callMethod",value:function(t){return this._ctx.callMethod(t)}},{key:"repeat",value:function(t,e){return this._ctx.repeat(t,e)}},{key:"repeatForever",value:function(t){return this._ctx.repeatForever(t)}},{key:"follow",value:function(t,e){return this._ctx.follow(t,e)}},{key:"meet",value:function(t,e){return this._ctx.meet(t,e)}},{key:"toPromise",value:function(){return this._ctx.toPromise()}}]),n}(fn);!function(t){t.Em="em",t.Rem="rem",t.Px="px",t.Pt="pt",t.Percent="%"}(oi||(oi={})),function(t){t.Left="left",t.Right="right",t.Center="center",t.Start="start",t.End="end"}(ai||(ai={})),function(t){t.Top="top",t.Hanging="hanging",t.Middle="middle",t.Alphabetic="alphabetic",t.Ideographic="ideographic",t.Bottom="bottom"}(si||(si={})),function(t){t.Normal="normal",t.Italic="italic",t.Oblique="oblique"}(li||(li={})),function(t){t.LeftToRight="ltr",t.RightToLeft="rtl"}(ui||(ui={}));var Si=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t,i,r,o,a,s,l,u,c,h,d,f,p,v,g,y,m,_,w,x,k=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,b.Z)(this,n),(t=e.call(this,k)).filtering=qt.Blended,t.quality=2,t.padding=2,t.smoothing=!1,t.lineWidth=1,t.lineDash=[],t.color=X.Black,t.family="sans-serif",t.style=li.Normal,t.bold=!1,t.unit=oi.Px,t.textAlign=ai.Left,t.baseAlign=si.Alphabetic,t.direction=ui.LeftToRight,t.size=10,t.shadow=null,t._textBounds=new q,t._cachedTextMeasurement=new Map,t._bitmapToTextMeasurement=new Map,t._textToBitmap=new Map,t._bitmapUsage=new Map,t._textFragments=[],t.smoothing=null!==(i=null===k||void 0===k?void 0:k.smoothing)&&void 0!==i?i:t.smoothing,t.padding=null!==(r=null===k||void 0===k?void 0:k.padding)&&void 0!==r?r:t.padding,t.color=null!==(o=null===k||void 0===k?void 0:k.color)&&void 0!==o?o:t.color,t.strokeColor=null!==(a=null===k||void 0===k?void 0:k.strokeColor)&&void 0!==a?a:t.strokeColor,t.lineDash=null!==(s=null===k||void 0===k?void 0:k.lineDash)&&void 0!==s?s:t.lineDash,t.lineWidth=null!==(l=null===k||void 0===k?void 0:k.lineWidth)&&void 0!==l?l:t.lineWidth,t.filtering=null!==(u=null===k||void 0===k?void 0:k.filtering)&&void 0!==u?u:t.filtering,t.family=null!==(c=null===k||void 0===k?void 0:k.family)&&void 0!==c?c:t.family,t.style=null!==(h=null===k||void 0===k?void 0:k.style)&&void 0!==h?h:t.style,t.bold=null!==(d=null===k||void 0===k?void 0:k.bold)&&void 0!==d?d:t.bold,t.size=null!==(f=null===k||void 0===k?void 0:k.size)&&void 0!==f?f:t.size,t.unit=null!==(p=null===k||void 0===k?void 0:k.unit)&&void 0!==p?p:t.unit,t.textAlign=null!==(v=null===k||void 0===k?void 0:k.textAlign)&&void 0!==v?v:t.textAlign,t.baseAlign=null!==(g=null===k||void 0===k?void 0:k.baseAlign)&&void 0!==g?g:t.baseAlign,t.direction=null!==(y=null===k||void 0===k?void 0:k.direction)&&void 0!==y?y:t.direction,t.quality=null!==(m=null===k||void 0===k?void 0:k.quality)&&void 0!==m?m:t.quality,(null===k||void 0===k?void 0:k.shadow)&&(t.shadow={},t.shadow.blur=null!==(_=k.shadow.blur)&&void 0!==_?_:t.shadow.blur,t.shadow.offset=null!==(w=k.shadow.offset)&&void 0!==w?w:t.shadow.offset,t.shadow.color=null!==(x=k.shadow.color)&&void 0!==x?x:t.shadow.color),t}return(0,k.Z)(n,[{key:"clone",value:function(){return new n(d(d({},this.cloneGraphicOptions()),{},{size:this.size,unit:this.unit,family:this.family,style:this.style,bold:this.bold,textAlign:this.textAlign,baseAlign:this.baseAlign,direction:this.direction,shadow:this.shadow?{blur:this.shadow.blur,offset:this.shadow.offset,color:this.shadow.color}:null}))}},{key:"fontString",get:function(){return"".concat(this.style," ").concat(this.bold?"bold":""," ").concat(this.size).concat(this.unit," ").concat(this.family)}},{key:"localBounds",get:function(){return this._textBounds}},{key:"_drawImage",value:function(t,e,n){}},{key:"_rotate",value:function(t){var e,n=null!==(e=this.origin)&&void 0!==e?e:this._textBounds.center;t.translate(n.x,n.y),t.rotate(this.rotation),t.translate(-n.x,-n.y)}},{key:"_flip",value:function(t){this.flipHorizontal&&(t.translate(this._textBounds.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,-this._textBounds.height/2/this.scale.y),t.scale(1,-1))}},{key:"measureText",value:function(t){var e=!1,n=this._cachedTextMeasurement.get(t);n||(e=!0);var i=this._getRasterPropertiesHash();if(n&&i===n.rasterProps||(e=!0),e){var r=t.split("\n"),o=r.reduce((function(t,e){return t.length>e.length?t:e})),a=this._getTextBitmap(t);this._applyFont(a);var s=a.measureText(o),l=Math.abs(s.actualBoundingBoxAscent)+Math.abs(s.actualBoundingBoxDescent),u=l*r.length;l=u;var c=u-Math.abs(s.actualBoundingBoxAscent);return n={text:t,rasterProps:i,measurement:new q({left:0-Math.abs(s.actualBoundingBoxLeft)-this.padding,top:0-Math.abs(s.actualBoundingBoxAscent)-this.padding,bottom:0+c+this.padding,right:0+Math.abs(s.actualBoundingBoxRight)+this.padding})},this._cachedTextMeasurement.set(t,n),this._bitmapToTextMeasurement.set(a,n),n.measurement}return n.measurement}},{key:"_setDimension",value:function(t,e){e.canvas.width=2*(t.width+2*this.padding)*this.quality,e.canvas.height=2*(t.height+2*this.padding)*this.quality}},{key:"_postDraw",value:function(t){t.restore()}},{key:"_getRasterPropertiesHash",value:function(t){var e,n;return"__hashcode__"+this.fontString+this.showDebug+this.textAlign+this.baseAlign+this.direction+JSON.stringify(this.shadow)+(this.padding.toString()+this.smoothing.toString()+this.lineWidth.toString()+this.lineDash.toString()+(null===(e=this.strokeColor)||void 0===e?void 0:e.toString())+(t?t.toString():null===(n=this.color)||void 0===n?void 0:n.toString()).toString())}},{key:"_applyRasterProperties",value:function(t,e){var n,i,r;t.translate(this.padding,this.padding),t.imageSmoothingEnabled=this.smoothing,t.lineWidth=this.lineWidth,t.setLineDash(null!==(n=this.lineDash)&&void 0!==n?n:t.getLineDash()),t.strokeStyle=null===(i=this.strokeColor)||void 0===i?void 0:i.toString(),t.fillStyle=e?e.toString():null===(r=this.color)||void 0===r?void 0:r.toString()}},{key:"_applyFont",value:function(t){t.translate(this.padding+t.canvas.width/2,this.padding+t.canvas.height/2),t.scale(this.quality,this.quality),t.textAlign=this.textAlign,t.textBaseline=this.baseAlign,t.font=this.fontString,t.direction=this.direction,this.shadow&&(t.shadowColor=this.shadow.color.toString(),t.shadowBlur=this.shadow.blur,t.shadowOffsetX=this.shadow.offset.x,t.shadowOffsetY=this.shadow.offset.y)}},{key:"_drawText",value:function(t,e,n,i){var r=e.split("\n");this._applyRasterProperties(t,n),this._applyFont(t);for(var o=0;o<r.length;o++){var a=r[o];this.color&&t.fillText(a,0,o*i),this.strokeColor&&t.strokeText(a,0,o*i)}this.showDebug&&(Re(t,X.Red,-t.canvas.width/2,0,t.canvas.width/2,0,2),Re(t,X.Red,0,-t.canvas.height/2,0,t.canvas.height/2,2))}},{key:"_getTextBitmap",value:function(t,e){var n=t+this._getRasterPropertiesHash(e),i=this._textToBitmap.get(n);if(i)return i;var r=document.createElement("canvas").getContext("2d");return this._textToBitmap.set(n,r),r}},{key:"_splitTextBitmap",value:function(t){for(var e=[],n=0,i=0,r=Math.min(4096,t.canvas.width),o=Math.min(4096,t.canvas.height);n<t.canvas.width;){for(;i<t.canvas.height;){var a=document.createElement("canvas");a.width=r,a.height=o,a.getContext("2d").drawImage(t.canvas,n,i,r,o,0,0,r,o),e.push({x:n,y:i,canvas:a}),i+=o}n+=r,i=0}return e}},{key:"render",value:function(t,e,n,i,r){this.showDebug&&this.clearCache(),this.checkAndClearCache();var o=this._getTextBitmap(e,n),a=!this._bitmapUsage.get(o);this._textBounds=this.measureText(e),a&&this._setDimension(this._textBounds,o),this._preDraw(t,i,r);var s=e.split("\n"),l=this._textBounds.height/s.length;if(a){this._drawText(o,e,n,l);var u,c=(0,m.Z)(this._textFragments);try{for(c.s();!(u=c.n()).done;){var h=u.value;Kt.delete(h.canvas)}}catch(_){c.e(_)}finally{c.f()}this._textFragments=this._splitTextBitmap(o);var d,f=(0,m.Z)(this._textFragments);try{for(f.s();!(d=f.n()).done;){var p=d.value;Kt.load(p.canvas,this.filtering,!0)}}catch(_){f.e(_)}finally{f.f()}}var v,g=(0,m.Z)(this._textFragments);try{for(g.s();!(v=g.n()).done;){var y=v.value;t.drawImage(y.canvas,0,0,y.canvas.width,y.canvas.height,y.x/this.quality+i-o.canvas.width/this.quality/2,y.y/this.quality+r-o.canvas.height/this.quality/2,y.canvas.width/this.quality,y.canvas.height/this.quality)}}catch(_){g.e(_)}finally{g.f()}this._postDraw(t),this._bitmapUsage.set(o,performance.now())}},{key:"cacheSize",get:function(){return this._bitmapUsage.size}},{key:"clearCache",value:function(){this._bitmapUsage.clear()}},{key:"checkAndClearCache",value:function(){var t,e=(0,m.Z)(this._bitmapUsage.entries());try{for(e.s();!(t=e.n()).done;){var n=(0,o.Z)(t.value,2),i=n[0];if(n[1]+1e3<performance.now()){this._bitmapUsage.delete(i);var r=this._bitmapToTextMeasurement.get(i);r&&(this._cachedTextMeasurement.delete(r.text),this._bitmapToTextMeasurement.delete(i)),Kt.delete(i.canvas)}}}catch(a){e.e(a)}finally{e.f()}}}]),n}(jt),Ai=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i,r,o;return(0,b.Z)(this,n),(i=e.call(this,t))._text="",i._textWidth=0,i._textHeight=0,i.font=null!==(r=t.font)&&void 0!==r?r:new Si,i.color=null!==(o=t.color)&&void 0!==o?o:i.color,i.text=t.text,i}return(0,k.Z)(n,[{key:"clone",value:function(){var t,e;return new n({text:this.text.slice(),color:null!==(e=null===(t=this.color)||void 0===t?void 0:t.clone())&&void 0!==e?e:X.Black,font:this.font.clone()})}},{key:"text",get:function(){return this._text},set:function(t){this._text=t;var e=this.font.measureText(this._text);this._textWidth=e.width,this._textHeight=e.height}},{key:"font",get:function(){return this._font},set:function(t){this._font=t}},{key:"width",get:function(){return 0===this._textWidth&&this._calculateDimension(),this._textWidth*this.scale.x}},{key:"height",get:function(){return 0===this._textHeight&&this._calculateDimension(),this._textHeight*this.scale.y}},{key:"_calculateDimension",value:function(){var t=this.font.measureText(this._text),e=t.width,n=t.height;this._textWidth=e,this._textHeight=n}},{key:"localBounds",get:function(){return this.font.measureText(this._text).scale(this.scale)}},{key:"_rotate",value:function(t){}},{key:"_flip",value:function(t){}},{key:"_drawImage",value:function(t,e,n){var i,r=X.Black;this.font instanceof Si&&(r=null!==(i=this.color)&&void 0!==i?i:this.font.color),(this.isStale()||this.font.isStale())&&(this.font.flipHorizontal=this.flipHorizontal,this.font.flipVertical=this.flipVertical,this.font.rotation=this.rotation,this.font.origin=this.origin,this.font.opacity=this.opacity),this.font.tint=this.tint;var o=this.font.measureText(this._text),a=o.width,s=o.height;this._textWidth=a,this._textHeight=s,this.font.render(t,this._text,r,e,n),this.font.showDebug&&t.debug.drawRect(e-a,n-s,2*a,2*s)}}]),n}(jt);var Ei=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;(0,b.Z)(this,n),(i=e.call(this))._anchor=Xt(O.Half,(function(t){return i._handleAnchorChange(t)})),i.logger=U.getInstance(),i.scene=null,i._draggable=!1,i._dragging=!1,i._pointerDragStartHandler=function(){i._dragging=!0},i._pointerDragEndHandler=function(){i._dragging=!1},i._pointerDragMoveHandler=function(t){i._dragging&&(i.pos=t.worldPos)},i._pointerDragLeaveHandler=function(t){i._dragging&&(i.pos=t.worldPos)};var r=d({},t),o=r.name,a=r.x,s=r.y,l=r.pos,u=r.coordPlane,c=r.scale,h=r.width,f=r.height,p=r.radius,v=r.collider,g=r.vel,y=r.acc,m=r.rotation,_=r.angularVelocity,w=r.z,x=r.color,k=r.visible,C=r.anchor,S=r.collisionType,A=r.collisionGroup;i._setName(o),i.anchor=null!==C&&void 0!==C?C:n.defaults.anchor.clone();var E=new gn;return i.addComponent(E),i.pos=null!==l&&void 0!==l?l:N(null!==a&&void 0!==a?a:0,null!==s&&void 0!==s?s:0),i.rotation=null!==m&&void 0!==m?m:0,i.scale=null!==c&&void 0!==c?c:N(1,1),i.z=null!==w&&void 0!==w?w:0,E.coordPlane=null!==u&&void 0!==u?u:ln.World,i.addComponent(new Qn),i.addComponent(new qn({anchor:i.anchor})),i.addComponent(new yn),i.vel=null!==g&&void 0!==g?g:O.Zero,i.acc=null!==y&&void 0!==y?y:O.Zero,i.angularVelocity=null!==_&&void 0!==_?_:0,i.addComponent(new Ci),i.addComponent(new On),i.body.collisionType=null!==S&&void 0!==S?S:je.Passive,A&&(i.body.group=A),v?i.addComponent(new Ln(v)):p?i.addComponent(new Ln(zn.Circle(p))):h>0&&f>0?i.addComponent(new Ln(zn.Box(h,f,i.anchor))):i.addComponent(new Ln),i.graphics.visible=null===k||void 0===k||k,x&&(i.color=x,h&&f?i.graphics.add(new Yn({color:x,width:h,height:f})):p&&i.graphics.add(new Kn({color:x,radius:p}))),i}return(0,k.Z)(n,[{key:"body",get:function(){return this.get(On)}},{key:"transform",get:function(){return this.get(gn)}},{key:"motion",get:function(){return this.get(yn)}},{key:"graphics",get:function(){return this.get(qn)}},{key:"collider",get:function(){return this.get(Ln)}},{key:"pointer",get:function(){return this.get(Qn)}},{key:"actions",get:function(){return this.get(Ci)}},{key:"pos",get:function(){return this.transform.pos},set:function(t){this.transform.pos=t.clone()}},{key:"oldPos",get:function(){return this.body.oldPos},set:function(t){this.body.oldPos.setTo(t.x,t.y)}},{key:"vel",get:function(){return this.motion.vel},set:function(t){this.motion.vel=t.clone()}},{key:"oldVel",get:function(){return this.body.oldVel},set:function(t){this.body.oldVel.setTo(t.x,t.y)}},{key:"acc",get:function(){return this.motion.acc},set:function(t){this.motion.acc=t.clone()}},{key:"oldAcc",get:function(){return this.body.oldAcc},set:function(t){this.body.oldAcc.setTo(t.x,t.y)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t}},{key:"angularVelocity",get:function(){return this.motion.angularVelocity},set:function(t){this.motion.angularVelocity=t}},{key:"scale",get:function(){return this.get(gn).scale},set:function(t){this.get(gn).scale=t}},{key:"anchor",get:function(){return this._anchor},set:function(t){var e=this;this._anchor=Xt(t,(function(t){return e._handleAnchorChange(t)})),this._handleAnchorChange(t)}},{key:"_handleAnchorChange",value:function(t){this.graphics&&(this.graphics.anchor=t)}},{key:"isOffScreen",get:function(){return this.hasTag("ex.offscreen")}},{key:"draggable",get:function(){return this._draggable},set:function(t){t&&(t&&!this._draggable?(this.on("pointerdragstart",this._pointerDragStartHandler),this.on("pointerdragend",this._pointerDragEndHandler),this.on("pointerdragmove",this._pointerDragMoveHandler),this.on("pointerdragleave",this._pointerDragLeaveHandler)):!t&&this._draggable&&(this.off("pointerdragstart",this._pointerDragStartHandler),this.off("pointerdragend",this._pointerDragEndHandler),this.off("pointerdragmove",this._pointerDragMoveHandler),this.off("pointerdragleave",this._pointerDragLeaveHandler)),this._draggable=t)}},{key:"color",get:function(){return this._color},set:function(t){var e;this._color=t.clone();var n=null===(e=this.graphics.layers.default.graphics[0])||void 0===e?void 0:e.graphic;(n instanceof Le||n instanceof Ai)&&(n.color=this._color)}},{key:"onInitialize",value:function(t){}},{key:"_initialize",value:function(t){(0,f.Z)((0,y.Z)(n.prototype),"_initialize",this).call(this,t);var e,i=(0,m.Z)(this.children);try{for(i.s();!(e=i.n()).done;){e.value._initialize(t)}}catch(r){i.e(r)}finally{i.f()}}},{key:"on",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"off",this).call(this,t,e)}},{key:"_prekill",value:function(t){(0,f.Z)((0,y.Z)(n.prototype),"emit",this).call(this,"prekill",new ct(this)),this.onPreKill(t)}},{key:"onPreKill",value:function(t){}},{key:"_postkill",value:function(t){(0,f.Z)((0,y.Z)(n.prototype),"emit",this).call(this,"postkill",new ht(this)),this.onPostKill(t)}},{key:"onPostKill",value:function(t){}},{key:"kill",value:function(){this.scene?(this._prekill(this.scene),this.emit("kill",new ut(this)),(0,f.Z)((0,y.Z)(n.prototype),"kill",this).call(this),this._postkill(this.scene)):this.logger.warn("Cannot kill actor, it was never added to the Scene")}},{key:"unkill",value:function(){this.active=!0}},{key:"isKilled",value:function(){return!this.active}},{key:"z",get:function(){return this.get(gn).z},set:function(t){this.get(gn).z=t}},{key:"center",get:function(){var t=this.getGlobalPos();return new O(t.x+this.width/2-this.anchor.x*this.width,t.y+this.height/2-this.anchor.y*this.height)}},{key:"localCenter",get:function(){return new O(this.pos.x+this.width/2-this.anchor.x*this.width,this.pos.y+this.height/2-this.anchor.y*this.height)}},{key:"width",get:function(){return this.collider.localBounds.width*this.getGlobalScale().x}},{key:"height",get:function(){return this.collider.localBounds.height*this.getGlobalScale().y}},{key:"getGlobalRotation",value:function(){return this.get(gn).globalRotation}},{key:"getGlobalPos",value:function(){return this.get(gn).globalPos}},{key:"getGlobalScale",value:function(){return this.get(gn).globalScale}},{key:"contains",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=N(t,e),r=this.get(Ln);r.update();var o=r.get();if(!o)return!1;var a=o.contains(i);return n?a||this.children.some((function(n){return n.contains(t,e,!0)})):a}},{key:"within",value:function(t,e){var n=this.get(Ln),i=t.get(Ln),r=n.get(),o=i.get();return!(!r||!o)&&r.getClosestLineBetween(o).getLength()<=e}},{key:"update",value:function(t,e){this._initialize(t),this._preupdate(t,e),this._postupdate(t,e)}},{key:"onPreUpdate",value:function(t,e){}},{key:"onPostUpdate",value:function(t,e){}},{key:"_preupdate",value:function(t,e){this.emit("preupdate",new mt(t,e,this)),this.onPreUpdate(t,e)}},{key:"_postupdate",value:function(t,e){this.emit("postupdate",new mt(t,e,this)),this.onPostUpdate(t,e)}}]),n}(Vn);function Ti(t){return t instanceof Pi}Ei.defaults={anchor:O.Half};var Pi=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this,d({},t))).get(gn).coordPlane=ln.Screen,i.anchor=N(0,0),i.body.collisionType=je.PreventCollision,i.collider.useBoxCollider(i.width,i.height,i.anchor),i}return(0,k.Z)(n,[{key:"_initialize",value:function(t){this._engine=t,(0,f.Z)((0,y.Z)(n.prototype),"_initialize",this).call(this,t)}},{key:"contains",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(i)return(0,f.Z)((0,y.Z)(n.prototype),"contains",this).call(this,t,e);var r=this._engine.worldToScreenCoordinates(new O(t,e));return(0,f.Z)((0,y.Z)(n.prototype),"contains",this).call(this,r.x,r.y)}}]),n}(Ei),Ii=function(){function t(e,n,i,r,o,a){var s=this;if((0,b.Z)(this,t),this._logger=U.getInstance(),this.id=0,this._elapsedTime=0,this._totalTimeAlive=0,this._running=!1,this._numberOfTicks=0,this.interval=10,this.repeats=!1,this.maxNumberOfRepeats=-1,this.randomRange=[0,0],this._baseInterval=10,this._generateRandomInterval=function(){return s._baseInterval+s.random.integer(s.randomRange[0],s.randomRange[1])},this._complete=!1,this.scene=null,"function"!==typeof e){var l=e;e=l.fcn,n=l.interval,i=l.repeats,r=l.numberOfRepeats,o=l.randomRange,a=l.random}if(r&&r>=0&&(this.maxNumberOfRepeats=r,!i))throw new Error("repeats must be set to true if numberOfRepeats is set");if(this.id=t._MAX_ID++,this._callbacks=[],this._baseInterval=this.interval=n,o){if(o[0]>o[1])throw new Error("min value must be lower than max value for range");this.random=null!==a&&void 0!==a?a:new S,this.randomRange=o,this.interval=this._generateRandomInterval(),this.on((function(){s.interval=s._generateRandomInterval()}))}this.repeats=i||this.repeats,e&&this.on(e)}return(0,k.Z)(t,[{key:"complete",get:function(){return this._complete}},{key:"on",value:function(t){this._callbacks.push(t)}},{key:"off",value:function(t){var e=this._callbacks.indexOf(t);this._callbacks.splice(e,1)}},{key:"update",value:function(t){var e=this;this._running&&(this._totalTimeAlive+=t,this._elapsedTime+=t,this.maxNumberOfRepeats>-1&&this._numberOfTicks>=this.maxNumberOfRepeats&&(this._complete=!0,this._running=!1,this._elapsedTime=0),!this.complete&&this._elapsedTime>=this.interval&&(this._callbacks.forEach((function(t){t.call(e)})),this._numberOfTicks++,this.repeats||(this._complete=!0,this._running=!1),this._elapsedTime=0))}},{key:"reset",value:function(t,e){if(t&&t>=0&&(this._baseInterval=this.interval=t),this.maxNumberOfRepeats&&this.maxNumberOfRepeats>=0&&(this.maxNumberOfRepeats=e,!this.repeats))throw new Error("repeats must be set to true if numberOfRepeats is set");this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0}},{key:"timesRepeated",get:function(){return this._numberOfTicks}},{key:"getTimeRunning",value:function(){return this._totalTimeAlive}},{key:"timeToNextAction",get:function(){return this.complete?0:this.interval-this._elapsedTime}},{key:"timeElapsedTowardNextAction",get:function(){return this._elapsedTime}},{key:"isRunning",get:function(){return this._running}},{key:"pause",value:function(){return this._running=!1,this}},{key:"resume",value:function(){return this._running=!0,this}},{key:"start",value:function(){return this.scene||this._logger.warn("Cannot start a timer not part of a scene, timer wont start until added"),this._running=!0,this.complete&&(this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0),this}},{key:"stop",value:function(){return this._running=!1,this._elapsedTime=0,this._numberOfTicks=0,this}},{key:"cancel",value:function(){this.pause(),this.scene&&this.scene.cancelTimer(this)}}]),t}();Ii._MAX_ID=0;var Zi,Ri=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this)).type="ex.parallax",i.parallaxFactor=N(1,1),i.parallaxFactor=null!==t&&void 0!==t?t:i.parallaxFactor,i}return(0,k.Z)(n)}(fn),Mi=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(0,b.Z)(this,n),(i=e.call(this)).draw=t,i.useTransform=r,i.type="ex.debuggraphics",i}return(0,k.Z)(n)}(fn),Fi=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i,o,a;(0,b.Z)(this,n),(i=e.call(this,null,t.name))._token=0,i._onScreenXStart=0,i._onScreenXEnd=Number.MAX_VALUE,i._onScreenYStart=0,i._onScreenYEnd=Number.MAX_VALUE,i.logger=U.getInstance(),i.tiles=[],i._rows=[],i._cols=[],i.renderFromTopOfGraphic=!1,i._collidersDirty=!0,i._originalOffsets=new WeakMap,i.addComponent(new gn),i.addComponent(new yn),i.addComponent(new On({type:je.Fixed})),i.addComponent(new qn({onPostDraw:function(t,e){return i.draw(t,e)}})),i.addComponent(new Mi((function(t){return i.debug(t)}))),i.addComponent(new Ln),i._graphics=i.get(qn),i._transform=i.get(gn),i._motion=i.get(yn),i._collider=i.get(Ln),i._composite=i._collider.useCompositeCollider([]),i._transform.pos=null!==(o=t.pos)&&void 0!==o?o:O.Zero,i._oldPos=i._transform.pos,i.renderFromTopOfGraphic=null!==(a=t.renderFromTopOfGraphic)&&void 0!==a?a:i.renderFromTopOfGraphic,i.tileWidth=t.tileWidth,i.tileHeight=t.tileHeight,i.rows=t.rows,i.columns=t.columns,i.tiles=new Array(i.rows*i.columns),i._rows=new Array(i.rows),i._cols=new Array(i.columns);for(var s=[],l=0;l<i.columns;l++){for(var u=0;u<i.rows;u++){var c=new Di({x:l,y:u,map:(0,r.Z)(i)});c.map=(0,r.Z)(i),i.tiles[l+u*i.columns]=c,s.push(c),i._rows[u]||(i._rows[u]=[]),i._rows[u].push(c)}i._cols[l]=s,s=[]}return i._graphics.localBounds=new q({left:0,top:0,right:i.columns*i.tileWidth,bottom:i.rows*i.tileHeight}),i}return(0,k.Z)(n,[{key:"flagCollidersDirty",value:function(){this._collidersDirty=!0}},{key:"x",get:function(){var t;return null!==(t=this._transform.pos.x)&&void 0!==t?t:0},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.pos)&&(this.get(gn).pos=N(t,this.y))}},{key:"y",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.pos.y)&&void 0!==e?e:0},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.pos)&&(this._transform.pos=N(this.x,t))}},{key:"z",get:function(){var t;return null!==(t=this._transform.z)&&void 0!==t?t:0},set:function(t){this._transform&&(this._transform.z=t)}},{key:"rotation",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.rotation)&&void 0!==e?e:0},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.rotation)&&(this._transform.rotation=t)}},{key:"scale",get:function(){var t,e;return null!==(e=null===(t=this._transform)||void 0===t?void 0:t.scale)&&void 0!==e?e:O.One},set:function(t){var e;(null===(e=this._transform)||void 0===e?void 0:e.scale)&&(this._transform.scale=t)}},{key:"pos",get:function(){return this._transform.pos},set:function(t){this._transform.pos=t}},{key:"vel",get:function(){return this._motion.vel},set:function(t){this._motion.vel=t}},{key:"on",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"on",this).call(this,t,e)}},{key:"_initialize",value:function(t){(0,f.Z)((0,y.Z)(n.prototype),"_initialize",this).call(this,t)}},{key:"_getOrSetColliderOriginalOffset",value:function(t){if(this._originalOffsets.has(t))return this._originalOffsets.get(t);var e=t.offset;return this._originalOffsets.set(t,e),e}},{key:"_updateColliders",value:function(){this._composite.clearColliders();var t,e=[];this._composite=this._collider.useCompositeCollider([]);for(var n=0;n<this.columns;n++){for(var i=0;i<this.rows;i++){0===i&&(t=null);var r=this.tiles[n+i*this.columns];if(r.solid)if(r.getColliders().length>0){var o,a=(0,m.Z)(r.getColliders());try{for(a.s();!(o=a.n()).done;){var s=o.value,l=this._getOrSetColliderOriginalOffset(s);s.offset=N(r.x*this.tileWidth,r.y*this.tileHeight).add(l),s.owner=this,this._composite.addCollider(s)}}catch(p){a.e(p)}finally{a.f()}t=null}else t=t?t.combine(r.bounds):r.bounds;else t&&e.push(t),t=null}if(t){var u=e[e.length-1];u&&u.top===t.top&&u.bottom===t.bottom?e[e.length-1]=u.combine(t):e.push(t)}}for(var c=0,h=e;c<h.length;c++){var d=h[c],f=zn.Box(d.width,d.height,O.Zero,N(d.left-this.pos.x,d.top-this.pos.y));f.owner=this,this._composite.addCollider(f)}this._collider.update()}},{key:"getTileByIndex",value:function(t){return this.tiles[t]}},{key:"getTile",value:function(t,e){return t<0||e<0||t>=this.columns||e>=this.rows?null:this.tiles[t+e*this.columns]}},{key:"getTileByPoint",value:function(t){var e=Math.floor((t.x-this.pos.x)/this.tileWidth),n=Math.floor((t.y-this.pos.y)/this.tileHeight),i=this.getTile(e,n);return e>=0&&n>=0&&e<this.columns&&n<this.rows&&i?i:null}},{key:"getRows",value:function(){return this._rows}},{key:"getColumns",value:function(){return this._cols}},{key:"update",value:function(t,e){if(this.onPreUpdate(t,e),this.emit("preupdate",new mt(t,e,this)),!this._oldPos.equals(this.pos)){this.flagCollidersDirty();for(var n=0;n<this.tiles.length;n++)this.tiles[n]&&this.tiles[n].flagDirty()}this._collidersDirty&&(this._collidersDirty=!1,this._updateColliders()),this._token++;var i=t.getWorldBounds(),r=N(i.left,i.top),o=N(i.right,i.bottom),a=this.pos,s=this.get(Ri),l=O.One;if(s){var u=O.One.sub(s.parallaxFactor);l=t.currentScene.camera.pos.scale(u),a=a.add(l)}this._onScreenXStart=Math.max(Math.floor((r.x-a.x)/this.tileWidth)-2,0),this._onScreenYStart=Math.max(Math.floor((r.y-a.y)/this.tileHeight)-2,0),this._onScreenXEnd=Math.max(Math.floor((o.x-a.x)/this.tileWidth)+2,0),this._onScreenYEnd=Math.max(Math.floor((o.y-a.y)/this.tileHeight)+2,0),this._transform.pos=N(this.x,this.y),this.onPostUpdate(t,e),this.emit("postupdate",new _t(t,e,this))}},{key:"draw",value:function(t,e){this.emit("predraw",new pt(t,e,this));for(var n,i,r,o=this._onScreenXStart,a=Math.min(this._onScreenXEnd,this.columns),s=this._onScreenYStart,l=Math.min(this._onScreenYEnd,this.rows);o<a;o++){for(;s<l;s++)for(i=0,r=(n=this.getTile(o,s).getGraphics()).length;i<r;i++){var u=n[i];if(u){Xn(u)&&(null===u||void 0===u||u.tick(e,this._token));var c=this.renderFromTopOfGraphic?0:u.height-this.tileHeight;u.draw(t,o*this.tileWidth,s*this.tileHeight-c)}}s=this._onScreenYStart}this.emit("postdraw",new vt(t,e,this))}},{key:"debug",value:function(t){for(var e=this.tileWidth*this.columns,n=this.tileHeight*this.rows,i=O.Zero,r=0;r<this.rows+1;r++){var o=N(0,r*this.tileHeight);t.drawLine(i.add(o),i.add(N(e,o.y)),X.Red,2)}for(var a=0;a<this.columns+1;a++){var s=N(a*this.tileWidth,0);t.drawLine(i.add(s),i.add(N(s.x,n)),X.Red,2)}var l,u=this._composite.getColliders(),c=(0,m.Z)(u);try{for(c.s();!(l=c.n()).done;){var h=l.value,d=X.Gray;d.a=.5;var f=h.localBounds,p=h.worldPos.sub(this.pos);t.drawRectangle(p,f.width,f.height,d)}}catch(v){c.e(v)}finally{c.f()}}}]),n}(Vn),Di=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i,r,o;return(0,b.Z)(this,n),(i=e.call(this))._posDirty=!1,i._solid=!1,i._graphics=[],i._colliders=[],i.data=new Map,i.x=t.x,i.y=t.y,i.map=t.map,i.width=t.map.tileWidth,i.height=t.map.tileHeight,i.solid=null!==(r=t.solid)&&void 0!==r?r:i.solid,i._graphics=null!==(o=t.graphics)&&void 0!==o?o:[],i._recalculate(),i}return(0,k.Z)(n,[{key:"pos",get:function(){return this._posDirty&&(this._recalculate(),this._posDirty=!1),this._pos}},{key:"solid",get:function(){return this._solid},set:function(t){var e;null===(e=this.map)||void 0===e||e.flagCollidersDirty(),this._solid=t}},{key:"getGraphics",value:function(){return this._graphics}},{key:"addGraphic",value:function(t){this._graphics.push(t)}},{key:"removeGraphic",value:function(t){J(t,this._graphics)}},{key:"clearGraphics",value:function(){this._graphics.length=0}},{key:"getColliders",value:function(){return this._colliders}},{key:"addCollider",value:function(t){this._colliders.push(t),this.map.flagCollidersDirty()}},{key:"removeCollider",value:function(t){var e=this._colliders.indexOf(t);e>-1&&this._colliders.splice(e,1),this.map.flagCollidersDirty()}},{key:"clearColliders",value:function(){this._colliders.length=0,this.map.flagCollidersDirty()}},{key:"flagDirty",value:function(){return this._posDirty=!0}},{key:"_recalculate",value:function(){this._pos=this.map.pos.add(N(this.x*this.map.tileWidth,this.y*this.map.tileHeight)),this._bounds=new q(this._pos.x,this._pos.y,this._pos.x+this.width,this._pos.y+this.height),this._posDirty=!1}},{key:"bounds",get:function(){return this._posDirty&&this._recalculate(),this._bounds}},{key:"center",get:function(){return this._posDirty&&this._recalculate(),new O(this._pos.x+this.width/2,this._pos.y+this.height/2)}}]),n}(Vn),Bi=function(){function t(e){(0,b.Z)(this,t),this.camera=e}return(0,k.Z)(t,[{key:"lockToActor",value:function(t){this.camera.addStrategy(new Li(t))}},{key:"lockToActorAxis",value:function(t,e){this.camera.addStrategy(new Oi(t,e))}},{key:"elasticToActor",value:function(t,e,n){this.camera.addStrategy(new Ni(t,e,n))}},{key:"radiusAroundActor",value:function(t,e){this.camera.addStrategy(new Ui(t,e))}},{key:"limitCameraBounds",value:function(t){this.camera.addStrategy(new Hi(t))}}]),t}();!function(t){t[t.X=0]="X",t[t.Y=1]="Y"}(Zi||(Zi={}));var zi,Li=(0,k.Z)((function t(e){(0,b.Z)(this,t),this.target=e,this.action=function(t,e,n,i){return t.center}})),Oi=(0,k.Z)((function t(e,n){var i=this;(0,b.Z)(this,t),this.target=e,this.axis=n,this.action=function(t,e,n,r){var o=t.center,a=e.getFocus();return i.axis===Zi.X?new O(o.x,a.y):new O(a.x,o.y)}})),Ni=(0,k.Z)((function t(e,n,i){var r=this;(0,b.Z)(this,t),this.target=e,this.cameraElasticity=n,this.cameraFriction=i,this.action=function(t,e,n,i){var o=t.center,a=e.getFocus(),s=e.vel.clone(),l=o.sub(a).scale(r.cameraElasticity),u=(s=s.add(l)).scale(-1).scale(r.cameraFriction);return s=s.add(u),a=a.add(s)}})),Ui=(0,k.Z)((function t(e,n){var i=this;(0,b.Z)(this,t),this.target=e,this.radius=n,this.action=function(t,e,n,r){var o=t.center,a=e.getFocus(),s=o.sub(a),l=s.size;if(l>=i.radius){var u=l-i.radius;return a.add(s.normalize().scale(u))}return a}})),Hi=(0,k.Z)((function t(e){var n=this;(0,b.Z)(this,t),this.target=e,this.boundSizeChecked=!1,this.action=function(t,e,i,r){var o=e.getFocus();n.boundSizeChecked||((t.bottom-t.top<i.drawHeight||t.right-t.left<i.drawWidth)&&U.getInstance().warn("Camera bounds should not be smaller than the engine viewport"),n.boundSizeChecked=!0);var a=o.x,s=o.y;return o.x<t.left+i.halfDrawWidth?a=t.left+i.halfDrawWidth:o.x>t.right-i.halfDrawWidth&&(a=t.right-i.halfDrawWidth),o.y<t.top+i.halfDrawHeight?s=t.top+i.halfDrawHeight:o.y>t.bottom-i.halfDrawHeight&&(s=t.bottom-i.halfDrawHeight),N(a,s)}})),Wi=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.apply(this,arguments)).transform=ot.identity(),t.inverse=ot.identity(),t._cameraStrategies=[],t.strategy=new Bi((0,r.Z)(t)),t._z=1,t.dz=0,t.az=0,t.rotation=0,t._angularVelocity=0,t._posChanged=!1,t._pos=Gt(O.Zero,(function(){return t._posChanged=!0})),t.vel=O.Zero,t.acc=O.Zero,t._cameraMoving=!1,t._currentLerpTime=0,t._lerpDuration=1e3,t._lerpStart=null,t._lerpEnd=null,t._isShaking=!1,t._shakeMagnitudeX=0,t._shakeMagnitudeY=0,t._shakeDuration=0,t._elapsedShakeTime=0,t._xShake=0,t._yShake=0,t._isZooming=!1,t._zoomStart=1,t._zoomEnd=1,t._currentZoomTime=0,t._zoomDuration=0,t._zoomEasing=Jn.EaseInOutCubic,t._easing=Jn.EaseInOutCubic,t._halfWidth=0,t._halfHeight=0,t._viewport=null,t._isInitialized=!1,t}return(0,k.Z)(n,[{key:"zoom",get:function(){return this._z},set:function(t){this._z=t,this._engine&&(this._halfWidth=this._engine.halfDrawWidth,this._halfHeight=this._engine.halfDrawHeight)}},{key:"angularVelocity",get:function(){return this._angularVelocity},set:function(t){this._angularVelocity=t}},{key:"pos",get:function(){return this._pos},set:function(t){var e=this;this._pos=Gt(t,(function(){return e._posChanged=!0})),this._posChanged=!0}},{key:"x",get:function(){return this.pos.x},set:function(t){this._follow||this._cameraMoving||(this.pos=N(t,this.pos.y))}},{key:"y",get:function(){return this.pos.y},set:function(t){this._follow||this._cameraMoving||(this.pos=N(this.pos.x,t))}},{key:"dx",get:function(){return this.vel.x},set:function(t){this.vel=N(t,this.vel.y)}},{key:"dy",get:function(){return this.vel.y},set:function(t){this.vel=N(this.vel.x,t)}},{key:"ax",get:function(){return this.acc.x},set:function(t){this.acc=N(t,this.acc.y)}},{key:"ay",get:function(){return this.acc.y},set:function(t){this.acc=N(this.acc.x,t)}},{key:"getFocus",value:function(){return this.pos}},{key:"move",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jn.EaseInOutCubic;if("function"!==typeof i)throw"Please specify an EasingFunction";return this._follow?Promise.reject(t):(this._lerpPromise&&this._lerpResolve&&this._lerpResolve(t),this._lerpPromise=new Promise((function(t){n._lerpResolve=t})),this._lerpStart=this.getFocus().clone(),this._lerpDuration=e,this._lerpEnd=t,this._currentLerpTime=0,this._cameraMoving=!0,this._easing=i,this._lerpPromise)}},{key:"shake",value:function(t,e,n){this._isShaking=!0,this._shakeMagnitudeX=t,this._shakeMagnitudeY=e,this._shakeDuration=n}},{key:"zoomOverTime",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jn.EaseInOutCubic;return this._zoomPromise=new Promise((function(t){e._zoomResolve=t})),n?(this._isZooming=!0,this._zoomEasing=i,this._currentZoomTime=0,this._zoomDuration=n,this._zoomStart=this.zoom,this._zoomEnd=t,this._zoomPromise):(this._isZooming=!1,this.zoom=t,Promise.resolve(!0))}},{key:"viewport",get:function(){return this._viewport?this._viewport:new q(0,0,0,0)}},{key:"addStrategy",value:function(t){this._cameraStrategies.push(t)}},{key:"removeStrategy",value:function(t){J(t,this._cameraStrategies)}},{key:"clearAllStrategies",value:function(){this._cameraStrategies.length=0}},{key:"_preupdate",value:function(t,e){this.emit("preupdate",new mt(t,e,this)),this.onPreUpdate(t,e)}},{key:"onPreUpdate",value:function(t,e){}},{key:"_postupdate",value:function(t,e){this.emit("postupdate",new _t(t,e,this)),this.onPostUpdate(t,e)}},{key:"onPostUpdate",value:function(t,e){}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_initialize",value:function(t){if(!this.isInitialized){this._engine=t,this._screen=t.screen;var e=this._screen.resolution,i=N(e.width/2,e.height/2);if(!this._engine.loadingComplete){var r=this._screen.peekResolution();r&&(i=N(r.width/2,r.height/2))}this._halfWidth=i.x,this._halfHeight=i.y,this._posChanged||(this.pos=i),this.updateTransform(),this.runStrategies(t,t.clock.elapsed()),this.updateViewport(),this.updateTransform(),this.onInitialize(t),(0,f.Z)((0,y.Z)(n.prototype),"emit",this).call(this,"initialize",new Bt(t,this)),this._isInitialized=!0}}},{key:"onInitialize",value:function(t){}},{key:"on",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"off",this).call(this,t,e)}},{key:"once",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"once",this).call(this,t,e)}},{key:"runStrategies",value:function(t,e){var n,i=(0,m.Z)(this._cameraStrategies);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.pos=r.action.call(r,r.target,this,t,e)}}catch(o){i.e(o)}finally{i.f()}}},{key:"updateViewport",value:function(){this._viewport=new q(this.x-this._halfWidth,this.y-this._halfHeight,this.x+this._halfWidth,this.y+this._halfHeight)}},{key:"update",value:function(t,e){if(this._initialize(t),this._preupdate(t,e),this.pos=this.pos.add(this.vel.scale(e/1e3)),this.zoom+=this.dz*e/1e3,this.vel=this.vel.add(this.acc.scale(e/1e3)),this.dz+=this.az*e/1e3,this.rotation+=this.angularVelocity*e/1e3,this._isZooming)if(this._currentZoomTime<this._zoomDuration){var n=(0,this._zoomEasing)(this._currentZoomTime,this._zoomStart,this._zoomEnd,this._zoomDuration);this.zoom=n,this._currentZoomTime+=e}else this._isZooming=!1,this.zoom=this._zoomEnd,this._currentZoomTime=0,this._zoomResolve(!0);if(this._cameraMoving)if(this._currentLerpTime<this._lerpDuration){var i=Jn.CreateVectorEasingFunction(this._easing)(this._currentLerpTime,this._lerpStart,this._lerpEnd,this._lerpDuration);this.pos=i,this._currentLerpTime+=e}else{this.pos=this._lerpEnd;var r=this._lerpEnd.clone();this._lerpStart=null,this._lerpEnd=null,this._currentLerpTime=0,this._cameraMoving=!1,this._lerpResolve(r)}this._isDoneShaking()?(this._isShaking=!1,this._elapsedShakeTime=0,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._xShake=0,this._yShake=0):(this._elapsedShakeTime+=e,this._xShake=1+(Math.random()*this._shakeMagnitudeX|0),this._yShake=1+(Math.random()*this._shakeMagnitudeY|0)),this.runStrategies(t,e),this.updateViewport(),this.updateTransform(),this._postupdate(t,e)}},{key:"draw",value:function(t){t.multiply(this.transform)}},{key:"updateTransform",value:function(){var t=this._screen.resolution.width/this.zoom,e=this._screen.resolution.height/this.zoom,n=N(-this.x+t/2+this._xShake,-this.y+e/2+this._yShake);this.transform.reset(),this.transform.scale(this.zoom,this.zoom),this.transform.translate(n.x,n.y),this.transform.inverse(this.inverse)}},{key:"_isDoneShaking",value:function(){return!this._isShaking||this._elapsedShakeTime>=this._shakeDuration}}]),n}(Ze),Vi={pos:O.Zero,width:10,height:10,visible:!1,action:function(){},filter:function(){return!0},repeat:-1},Xi=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this,{x:t.pos.x,y:t.pos.y,width:t.width,height:t.height})).action=function(){},i.filter=function(){return!0},i.repeat=-1,t=d(d({},Vi),t),i.filter=t.filter||i.filter,i.repeat=t.repeat||i.repeat,i.action=t.action||i.action,t.target&&(i.target=t.target),i.graphics.visible=t.visible,i.body.collisionType=je.Passive,i.eventDispatcher=new Wt,i.events.on("collisionstart",(function(t){i.filter(t.other)&&(i.emit("enter",new Ut((0,r.Z)(i),t.other)),i._dispatchAction(),0===i.repeat&&i.kill())})),i.events.on("collisionend",(function(t){i.filter(t.other)&&i.emit("exit",new Ht((0,r.Z)(i),t.other))})),i}return(0,k.Z)(n,[{key:"target",get:function(){return this._target},set:function(t){this._target=t,this.filter=function(e){return e===t}}},{key:"_initialize",value:function(t){(0,f.Z)((0,y.Z)(n.prototype),"_initialize",this).call(this,t)}},{key:"_dispatchAction",value:function(){0!==this.repeat&&(this.action.call(this),this.repeat--)}}]),n}(Ei);!function(t){t.Update="update",t.Draw="draw"}(zi||(zi={}));var Gi=function(){function t(){(0,b.Z)(this,t),this.priority=0}return(0,k.Z)(t,[{key:"notify",value:function(t){}}]),t}(),ji=(0,k.Z)((function t(e){(0,b.Z)(this,t),this.data=e,this.type="Entity Added"}));function qi(t){return!!t&&"Entity Added"===t.type}var Yi=(0,k.Z)((function t(e){(0,b.Z)(this,t),this.data=e,this.type="Entity Removed"}));function Ki(t){return!!t&&"Entity Removed"===t.type}var Qi=function(){function t(e){(0,b.Z)(this,t),this._world=e,this.entities=[],this._entityIndex={},this._entitiesToRemove=[]}return(0,k.Z)(t,[{key:"updateEntities",value:function(t,e){var n,i=(0,m.Z)(this.entities);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.update(t.engine,e),r.active||this.removeEntity(r)}}catch(o){i.e(o)}finally{i.f()}}},{key:"findEntitiesForRemoval",value:function(){var t,e=(0,m.Z)(this.entities);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.active||this.removeEntity(n)}}catch(i){e.e(i)}finally{e.f()}}},{key:"notify",value:function(t){Un(t)&&this._world.queryManager.addEntity(t.data.entity),Wn(t)&&this._world.queryManager.removeComponent(t.data.entity,t.data.component)}},{key:"addEntity",value:function(t){var e=this;t.active=!0,t&&!this._entityIndex[t.id]&&(this._entityIndex[t.id]=t,this.entities.push(t),this._world.queryManager.addEntity(t),t.componentAdded$.register(this),t.componentRemoved$.register(this),t.children.forEach((function(t){return e.addEntity(t)})),t.childrenAdded$.register({notify:function(t){e.addEntity(t)}}),t.childrenRemoved$.register({notify:function(t){e.removeEntity(t,!1)}}))}},{key:"removeEntity",value:function(t){var e,n=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=0;r=t instanceof Vn?t.id:t;var o=this._entityIndex[r];o&&o.active&&o.kill(),o&&i?this._entitiesToRemove.push(o):(delete this._entityIndex[r],o&&(J(o,this.entities),this._world.queryManager.removeEntity(o),o.componentAdded$.unregister(this),o.componentRemoved$.unregister(this),o.children.forEach((function(t){return n.removeEntity(t,i)})),o.childrenAdded$.clear(),o.childrenRemoved$.clear(),(null===(e=this._world.context)||void 0===e?void 0:e.engine)&&this._world.context.engine.stats.currFrame.actors.killed++))}},{key:"processEntityRemovals",value:function(){var t,e=(0,m.Z)(this._entitiesToRemove);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.active||this.removeEntity(n,!1)}}catch(i){e.e(i)}finally{e.f()}}},{key:"processComponentRemovals",value:function(){var t,e=(0,m.Z)(this.entities);try{for(e.s();!(t=e.n()).done;){t.value.processComponentRemoval()}}catch(n){e.e(n)}finally{e.f()}}},{key:"getById",value:function(t){return this._entityIndex[t]}},{key:"getByName",value:function(t){return this.entities.filter((function(e){return e.name===t}))}},{key:"clear",value:function(){var t,e=(0,m.Z)(this.entities);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.removeEntity(n)}}catch(i){e.e(i)}finally{e.f()}}}]),t}(),Ji=function(t){return(0,x.Z)(t).sort((function(t,e){return t.localeCompare(e)})).join("+")},$i=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this))._entities=[],t[0]instanceof Function?i.types=t.map((function(t){return(new t).type})):i.types=t,i}return(0,k.Z)(n,[{key:"key",get:function(){return this._key?this._key:this._key=Ji(this.types)}},{key:"getEntities",value:function(t){return t&&this._entities.sort(t),this._entities}},{key:"addEntity",value:function(t){!$(this._entities,t)&&this.matches(t)&&(this._entities.push(t),this.notifyAll(new ji(t)))}},{key:"removeEntity",value:function(t){J(t,this._entities)&&this.notifyAll(new Yi(t))}},{key:"clear",value:function(){this._entities.length=0;var t,e=(0,m.Z)(this.observers);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.unregister(n)}}catch(i){e.e(i)}finally{e.f()}}},{key:"matches",value:function(t){var e=[];e=t instanceof Vn?t.types:t;var n,i=!0,r=(0,m.Z)(this.types);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(i=i&&e.indexOf(o)>-1,!i)return!1}}catch(a){r.e(a)}finally{r.f()}return i}},{key:"contain",value:function(t){return this.types.indexOf(t)>-1}}]),n}(vn),tr=function(){function t(e){(0,b.Z)(this,t),this._world=e,this._queries={}}return(0,k.Z)(t,[{key:"_addQuery",value:function(t){this._queries[Ji(t.types)]=t;var e,n=(0,m.Z)(this._world.entityManager.entities);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.addEntity(i)}}catch(r){n.e(r)}finally{n.f()}}},{key:"maybeRemoveQuery",value:function(t){0===t.observers.length&&(t.clear(),delete this._queries[Ji(t.types)])}},{key:"addEntity",value:function(t){for(var e in this._queries)this._queries[e]&&this._queries[e].addEntity(t)}},{key:"removeComponent",value:function(t,e){for(var n in this._queries)this._queries[n].contain(e.type)&&this._queries[n].removeEntity(t)}},{key:"removeEntity",value:function(t){for(var e in this._queries)this._queries[e].removeEntity(t)}},{key:"createQuery",value:function(t){var e=this.getQuery(t);if(e)return e;var n=new $i(t);return this._addQuery(n),n}},{key:"getQuery",value:function(t){var e=Ji(t);return this._queries[e]?this._queries[e]:null}}]),t}(),er=function(){function t(e){(0,b.Z)(this,t),this._world=e,this.systems=[],this.initialized=!1}return(0,k.Z)(t,[{key:"get",value:function(t){return this.systems.find((function(e){return e instanceof t}))}},{key:"addSystem",value:function(t){if(!t.types||0===t.types.length)throw new Error("Attempted to add a System without any types");var e=this._world.queryManager.createQuery(t.types);this.systems.push(t),this.systems.sort((function(t,e){return t.priority-e.priority})),e.register(t),this.initialized&&t.initialize&&t.initialize(this._world.context)}},{key:"removeSystem",value:function(t){J(t,this.systems);var e=this._world.queryManager.getQuery(t.types);e&&(e.unregister(t),this._world.queryManager.maybeRemoveQuery(e))}},{key:"initialize",value:function(){if(!this.initialized){this.initialized=!0;var t,e=(0,m.Z)(this.systems);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.initialize&&n.initialize(this._world.context)}}catch(i){e.e(i)}finally{e.f()}}}},{key:"updateSystems",value:function(t,e,n){var i,r=this.systems.filter((function(e){return e.systemType===t})),o=(0,m.Z)(r);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.preupdate&&a.preupdate(e,n)}}catch(g){o.e(g)}finally{o.f()}var s,l=(0,m.Z)(r);try{for(l.s();!(s=l.n()).done;){var u=s.value,c=this._world.queryManager.getQuery(u.types).getEntities(u.sort);if(e instanceof Sr){var h,d=(0,m.Z)(c);try{for(d.s();!(h=d.n()).done;){h.value._initialize(null===e||void 0===e?void 0:e.engine)}}catch(g){d.e(g)}finally{d.f()}}u.update(c,n)}}catch(g){l.e(g)}finally{l.f()}var f,p=(0,m.Z)(r);try{for(p.s();!(f=p.n()).done;){var v=f.value;v.postupdate&&v.postupdate(e,n)}}catch(g){p.e(g)}finally{p.f()}}},{key:"clear",value:function(){var t,e=(0,m.Z)(this.systems);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.removeSystem(n)}}catch(i){e.e(i)}finally{e.f()}}}]),t}(),nr=function(){function t(e){(0,b.Z)(this,t),this.context=e,this.queryManager=new tr(this),this.entityManager=new Qi(this),this.systemManager=new er(this)}return(0,k.Z)(t,[{key:"update",value:function(t,e){t===zi.Update&&this.entityManager.updateEntities(this.context,e),this.systemManager.updateSystems(t,this.context,e),this.entityManager.findEntitiesForRemoval(),this.entityManager.processComponentRemovals(),this.entityManager.processEntityRemovals()}},{key:"add",value:function(t){t instanceof Vn&&this.entityManager.addEntity(t),t instanceof Gi&&this.systemManager.addSystem(t)}},{key:"remove",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t instanceof Vn&&this.entityManager.removeEntity(t,e),t instanceof Gi&&this.systemManager.removeSystem(t)}},{key:"clearEntities",value:function(){this.entityManager.clear()}},{key:"clearSystems",value:function(){this.systemManager.clear()}}]),t}(),ir=function(){function t(){(0,b.Z)(this,t)}return(0,k.Z)(t,null,[{key:"integrate",value:function(e,n,i,r){var o=r/1e3;n.vel.addEqual(i.scale(o,t._ACC)),e.pos.add(n.vel.scale(o,t._VEL),t._POS).addEqual(i.scale(.5*o*o,t._VEL_ACC)),n.angularVelocity+=n.torque*(1/n.inertia)*o;var a=e.rotation+n.angularVelocity*o;e.scale.add(n.scaleFactor.scale(o,this._SCALE_FACTOR),t._SCALE),e.get().setTransform(t._POS,a,t._SCALE)}}]),t}();ir._POS=new O(0,0),ir._SCALE=new O(1,1),ir._ACC=new O(0,0),ir._VEL=new O(0,0),ir._VEL_ACC=new O(0,0),ir._SCALE_FACTOR=new O(0,0);var rr,or,ar=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.apply(this,arguments)).types=["ex.transform","ex.motion"],t.systemType=zi.Update,t.priority=-1,t}return(0,k.Z)(n,[{key:"update",value:function(t,e){for(var n,i,r=0;r<t.length;r++){n=t[r].get(gn),i=t[r].get(yn);var o=t[r].get(On);if(!(null===o||void 0===o?void 0:o.sleeping)){var a=i.acc.clone();(null===o||void 0===o?void 0:o.collisionType)===je.Active&&(null===o||void 0===o?void 0:o.useGravity)&&a.addEqual(un.gravity),null===o||void 0===o||o.captureOldTransform(),ir.integrate(n,i,a,e)}}}}]),n}(Gi),sr=function(){function t(){(0,b.Z)(this,t),this.directionMap=new Map,this.distanceMap=new Map}return(0,k.Z)(t,[{key:"solve",value:function(t){var e=this;this.preSolve(t),(t=t.filter((function(t){return!t.isCanceled()}))).sort((function(t,n){return e.distanceMap.get(t.id)-e.distanceMap.get(n.id)}));var n,i=(0,m.Z)(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.solvePosition(r),this.solveVelocity(r)}}catch(o){i.e(o)}finally{i.f()}return this.postSolve(t),t}},{key:"preSolve",value:function(t){var e,n=(0,m.Z)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=H.fromDirection(i.mtv),o=i.mtv.negate(),a=i.colliderA.worldPos.squareDistance(i.colliderB.worldPos);this.distanceMap.set(i.id,a),i.colliderA.events.emit("precollision",new Tt(i.colliderA,i.colliderB,r,o)),i.colliderB.events.emit("precollision",new Tt(i.colliderB,i.colliderA,H.getOpposite(r),o.negate()))}}catch(s){n.e(s)}finally{n.f()}}},{key:"postSolve",value:function(t){var e,n,i,r=(0,m.Z)(t);try{for(r.s();!(i=r.n()).done;){var o=i.value;if(!o.isCanceled()){var a=o.colliderA,s=o.colliderB,l=null===(e=a.owner)||void 0===e?void 0:e.get(On),u=null===(n=s.owner)||void 0===n?void 0:n.get(On);if(!l||!u||l.collisionType!==je.Passive&&u.collisionType!==je.Passive){var c=H.fromDirection(o.mtv),h=o.mtv.negate();o.colliderA.events.emit("postcollision",new Pt(o.colliderA,o.colliderB,c,h)),o.colliderB.events.emit("postcollision",new Pt(o.colliderB,o.colliderA,H.getOpposite(c),h.negate()))}}}}catch(d){r.e(d)}finally{r.f()}}},{key:"solvePosition",value:function(t){var e,n,i=1e-4;if(t.colliderA.bounds.overlaps(t.colliderB.bounds,i))if(Math.abs(t.mtv.x)<i&&Math.abs(t.mtv.y)<i)t.cancel();else{var r=t.mtv,o=t.colliderA,a=t.colliderB,s=null===(e=o.owner)||void 0===e?void 0:e.get(On),l=null===(n=a.owner)||void 0===n?void 0:n.get(On);if(s&&l){if(s.collisionType===je.Passive||l.collisionType===je.Passive)return;s.collisionType===je.Active&&l.collisionType===je.Active&&(r=r.scale(.5)),s.collisionType===je.Active&&(s.globalPos.x-=r.x,s.globalPos.y-=r.y,o.update(s.transform.get())),l.collisionType===je.Active&&(l.globalPos.x+=r.x,l.globalPos.y+=r.y,a.update(l.transform.get()))}}else t.cancel()}},{key:"solveVelocity",value:function(t){var e,n;if(!t.isCanceled()){var i=t.colliderA,r=t.colliderB,o=null===(e=i.owner)||void 0===e?void 0:e.get(On),a=null===(n=r.owner)||void 0===n?void 0:n.get(On);if(o&&a){if(o.collisionType===je.Passive||a.collisionType===je.Passive)return;var s=t.normal,l=s.negate();if(o.collisionType===je.Active&&o.vel.normalize().dot(l)<0){var u=s.scale(s.dot(o.vel.negate()));o.vel=o.vel.add(u)}if(a.collisionType===je.Active&&a.vel.normalize().dot(s)<0){var c=l.scale(l.dot(a.vel.negate()));a.vel=a.vel.add(c)}}}}}]),t}(),lr=function(){function t(e,n,i){(0,b.Z)(this,t),this.point=e,this.local=n,this.contact=i,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.aToContact=new O(0,0),this.bToContact=new O(0,0),this.originalVelocityAndRestitution=0,this.update()}return(0,k.Z)(t,[{key:"update",value:function(){var t,e,n=null===(t=this.contact.colliderA.owner)||void 0===t?void 0:t.get(On),i=null===(e=this.contact.colliderB.owner)||void 0===e?void 0:e.get(On);if(n&&i){var r=this.contact.normal,o=this.contact.tangent;this.aToContact=this.point.sub(n.globalPos),this.bToContact=this.point.sub(i.globalPos);var a=this.aToContact.cross(r),s=this.bToContact.cross(r);this.normalMass=n.inverseMass+i.inverseMass+n.inverseInertia*a*a+i.inverseInertia*s*s;var l=this.aToContact.cross(o),u=this.bToContact.cross(o);this.tangentMass=n.inverseMass+i.inverseMass+n.inverseInertia*l*l+i.inverseInertia*u*u}return this}},{key:"getRelativeVelocity",value:function(){var t,e,n=null===(t=this.contact.colliderA.owner)||void 0===t?void 0:t.get(On),i=null===(e=this.contact.colliderB.owner)||void 0===e?void 0:e.get(On);if(n&&i){var r=n.vel.add(O.cross(n.angularVelocity,this.aToContact));return i.vel.add(O.cross(i.angularVelocity,this.bToContact)).sub(r)}return O.Zero}}]),t}(),ur=function(){function t(){(0,b.Z)(this,t),this.lastFrameContacts=new Map,this.idToContactConstraint=new Map}return(0,k.Z)(t,[{key:"getContactConstraints",value:function(t){var e;return null!==(e=this.idToContactConstraint.get(t))&&void 0!==e?e:[]}},{key:"solve",value:function(t){return this.preSolve(t),t=t.filter((function(t){return!t.isCanceled()})),this.solveVelocity(t),this.solvePosition(t),this.postSolve(t),t}},{key:"preSolve",value:function(t){var e,n,i,r,o=(0,m.Z)(t);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=H.fromDirection(a.mtv);a.colliderA.events.emit("precollision",new Tt(a.colliderA,a.colliderB,s,a.mtv)),a.colliderA.events.emit("beforecollisionresolve",new Rt(a.colliderA,a.colliderB,s,a.mtv,a)),a.colliderB.events.emit("precollision",new Tt(a.colliderB,a.colliderA,H.getOpposite(s),a.mtv.negate())),a.colliderB.events.emit("beforecollisionresolve",new Rt(a.colliderB,a.colliderA,H.getOpposite(s),a.mtv.negate(),a)),a.matchAwake()}}catch(V){o.e(V)}finally{o.f()}var l,u=Array.from(this.idToContactConstraint.keys()),c=(0,m.Z)(t);try{for(c.s();!(l=c.n()).done;){var h=l.value,d=u.indexOf(h.id);d>-1&&u.splice(d,1);var f=null!==(e=this.idToContactConstraint.get(h.id))&&void 0!==e?e:[],p=0,v=h.colliderA.owner.get(On),g=h.colliderB.owner.get(On);if(v&&g){var y,_=(0,m.Z)(h.points);try{for(_.s();!(y=_.n()).done;){var w=y.value,x=h.normal,b=h.tangent,k=w.sub(v.globalPos),C=w.sub(g.globalPos),S=k.cross(x),A=C.cross(x),E=v.inverseMass+g.inverseMass+v.inverseInertia*S*S+g.inverseInertia*A*A,T=k.cross(b),P=C.cross(b),I=v.inverseMass+g.inverseMass+v.inverseInertia*T*T+g.inverseInertia*P*P;f[p]&&(null===(i=null===(n=f[p])||void 0===n?void 0:n.point)||void 0===i?void 0:i.squareDistance(w))<4?(f[p].point=w,f[p].local=h.localPoints[p]):f[p]=new lr(w,h.localPoints[p],h),f[p].aToContact=k,f[p].bToContact=C,f[p].normalMass=1/E,f[p].tangentMass=1/I;var Z=v.bounciness>g.bounciness?v.bounciness:g.bounciness,R=h.normal.dot(f[p].getRelativeVelocity());f[p].originalVelocityAndRestitution=0,R<-.1&&(f[p].originalVelocityAndRestitution=-Z*R),p++}}catch(V){_.e(V)}finally{_.f()}}this.idToContactConstraint.set(h.id,f)}}catch(V){c.e(V)}finally{c.f()}for(var M=0,F=u;M<F.length;M++){var D=F[M];this.idToContactConstraint.delete(D)}if(un.warmStart)this.warmStart(t);else{var B,z=(0,m.Z)(t);try{for(z.s();!(B=z.n()).done;){var L,O=B.value,N=this.getContactConstraints(O.id),U=(0,m.Z)(N);try{for(U.s();!(L=U.n()).done;){var W=L.value;W.normalImpulse=0,W.tangentImpulse=0}}catch(V){U.e(V)}finally{U.f()}}}catch(V){z.e(V)}finally{z.f()}}}},{key:"postSolve",value:function(t){var e,n=(0,m.Z)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=i.colliderA.owner.get(On),o=i.colliderB.owner.get(On);if(r&&o){if(r.collisionType===je.Passive||o.collisionType===je.Passive)continue;r.updateMotion(),o.updateMotion()}var a=H.fromDirection(i.mtv);i.colliderA.events.emit("postcollision",new Pt(i.colliderA,i.colliderB,a,i.mtv)),i.colliderA.events.emit("aftercollisionresolve",new Mt(i.colliderA,i.colliderB,a,i.mtv,i)),i.colliderB.events.emit("postcollision",new Pt(i.colliderB,i.colliderA,H.getOpposite(a),i.mtv.negate())),i.colliderB.events.emit("aftercollisionresolve",new Mt(i.colliderB,i.colliderA,H.getOpposite(a),i.mtv.negate(),i))}}catch(c){n.e(c)}finally{n.f()}this.lastFrameContacts.clear();var s,l=(0,m.Z)(t);try{for(l.s();!(s=l.n()).done;){var u=s.value;this.lastFrameContacts.set(u.id,u)}}catch(c){l.e(c)}finally{l.f()}}},{key:"warmStart",value:function(t){var e,n,i,r,o=(0,m.Z)(t);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=null===(e=a.colliderA.owner)||void 0===e?void 0:e.get(On),l=null===(n=a.colliderB.owner)||void 0===n?void 0:n.get(On);if(s&&l){var u,c=null!==(i=this.idToContactConstraint.get(a.id))&&void 0!==i?i:[],h=(0,m.Z)(c);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(un.warmStart){var f=a.normal.scale(d.normalImpulse),p=a.tangent.scale(d.tangentImpulse),v=f.add(p);s.applyImpulse(d.point,v.negate()),l.applyImpulse(d.point,v)}else d.normalImpulse=0,d.tangentImpulse=0}}catch(g){h.e(g)}finally{h.f()}}}}catch(g){o.e(g)}finally{o.f()}}},{key:"solvePosition",value:function(t){for(var e,n,i,r=0;r<un.positionIterations;r++){var o,a=(0,m.Z)(t);try{for(a.s();!(o=a.n()).done;){var s=o.value,l=null===(e=s.colliderA.owner)||void 0===e?void 0:e.get(On),u=null===(n=s.colliderB.owner)||void 0===n?void 0:n.get(On);if(l&&u){if(l.collisionType===je.Passive||u.collisionType===je.Passive)continue;var c,h=null!==(i=this.idToContactConstraint.get(s.id))&&void 0!==i?i:[],d=(0,m.Z)(h);try{for(d.s();!(c=d.n()).done;){var f=c.value,p=s.normal,v=Fn.FindContactSeparation(s,f.local),g=un.steeringFactor,y=I(g*(v+un.slop),-5,0),_=p.scale(-y*f.normalMass);if(l.collisionType===je.Active){var w=_.negate().scale(l.inverseMass);l.limitDegreeOfFreedom.includes(Pn.X)&&(w.x=0),l.limitDegreeOfFreedom.includes(Pn.Y)&&(w.y=0),l.globalPos=l.globalPos.add(w),l.limitDegreeOfFreedom.includes(Pn.Rotation)||(l.rotation-=f.aToContact.cross(_)*l.inverseInertia)}if(u.collisionType===je.Active){var x=_.scale(u.inverseMass);u.limitDegreeOfFreedom.includes(Pn.X)&&(x.x=0),u.limitDegreeOfFreedom.includes(Pn.Y)&&(x.y=0),u.globalPos=u.globalPos.add(x),u.limitDegreeOfFreedom.includes(Pn.Rotation)||(u.rotation+=f.bToContact.cross(_)*u.inverseInertia)}}}catch(b){d.e(b)}finally{d.f()}}}}catch(b){a.e(b)}finally{a.f()}}}},{key:"solveVelocity",value:function(t){for(var e,n,i,r=0;r<un.velocityIterations;r++){var o,a=(0,m.Z)(t);try{for(a.s();!(o=a.n()).done;){var s=o.value,l=null===(e=s.colliderA.owner)||void 0===e?void 0:e.get(On),u=null===(n=s.colliderB.owner)||void 0===n?void 0:n.get(On);if(l&&u){if(l.collisionType===je.Passive||u.collisionType===je.Passive)continue;var c,h=Math.min(l.friction,u.friction),d=null!==(i=this.idToContactConstraint.get(s.id))&&void 0!==i?i:[],f=(0,m.Z)(d);try{for(f.s();!(c=f.n()).done;){var p=c.value,v=-p.getRelativeVelocity().dot(s.tangent)*p.tangentMass,g=h*p.normalImpulse,y=I(p.tangentImpulse+v,-g,g);v=y-p.tangentImpulse,p.tangentImpulse=y;var _=s.tangent.scale(v);l.applyImpulse(p.point,_.negate()),u.applyImpulse(p.point,_)}}catch(E){f.e(E)}finally{f.f()}var w,x=(0,m.Z)(d);try{for(x.s();!(w=x.n()).done;){var b=w.value,k=b.getRelativeVelocity().dot(s.normal),C=-b.normalMass*(k-b.originalVelocityAndRestitution),S=Math.max(b.normalImpulse+C,0);C=S-b.normalImpulse,b.normalImpulse=S;var A=s.normal.scale(C);l.applyImpulse(b.point,A.negate()),u.applyImpulse(b.point,A)}}catch(E){x.e(E)}finally{x.f()}}}}catch(E){a.e(E)}finally{a.f()}}}}]),t}(),cr=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.apply(this,arguments)).types=["ex.transform","ex.motion","ex.collider"],t.systemType=zi.Update,t.priority=-1,t._realisticSolver=new ur,t._arcadeSolver=new sr,t._processor=new Cn,t._lastFrameContacts=new Map,t._currentFrameContacts=new Map,t._trackCollider=function(e){return t._processor.track(e)},t._untrackCollider=function(e){return t._processor.untrack(e)},t}return(0,k.Z)(n,[{key:"notify",value:function(t){if(qi(t)){var e=t.data.get(Ln);e.$colliderAdded.subscribe(this._trackCollider),e.$colliderRemoved.subscribe(this._untrackCollider);var n=e.get();n&&this._processor.track(n)}else{var i=t.data.get(Ln),r=i.get();i&&r&&this._processor.untrack(r)}}},{key:"initialize",value:function(t){this._engine=t.engine}},{key:"update",value:function(t,e){var n,i,r,o;if(un.enabled){var a,s=[],l=(0,m.Z)(t);try{for(l.s();!(a=l.n()).done;){var u=a.value.get(Ln),c=null===u||void 0===u?void 0:u.get();if(u&&(null===(n=u.owner)||void 0===n?void 0:n.active)&&c)if(u.update(),c instanceof An){var h=c.getColliders();s=s.concat(h)}else s.push(c)}}catch(w){l.e(w)}finally{l.f()}this._processor.update(s);var d=this._processor.broadphase(s,e);this._currentFrameContacts.clear();var f=this._processor.narrowphase(d,null===(o=null===(r=null===(i=this._engine)||void 0===i?void 0:i.debug)||void 0===r?void 0:r.stats)||void 0===o?void 0:o.currFrame);f=this.getSolver().solve(f);var p,v=(0,m.Z)(f);try{for(v.s();!(p=v.n()).done;){var g=p.value,y=g.id.indexOf("|");if(y>0){var _=g.id.substring(y+1);this._currentFrameContacts.set(_,g)}else this._currentFrameContacts.set(g.id,g)}}catch(w){v.e(w)}finally{v.f()}this.runContactStartEnd(),this._lastFrameContacts.clear(),this._lastFrameContacts=new Map(this._currentFrameContacts)}}},{key:"getSolver",value:function(){return un.collisionResolutionStrategy===rn.Realistic?this._realisticSolver:this._arcadeSolver}},{key:"debug",value:function(t){this._processor.debug(t)}},{key:"runContactStartEnd",value:function(){var t,e=(0,m.Z)(this._currentFrameContacts);try{for(e.s();!(t=e.n()).done;){var n=(0,o.Z)(t.value,2),i=n[0],r=n[1];if(!this._lastFrameContacts.has(i)){var a=r.colliderA,s=r.colliderB;a.events.emit("collisionstart",new Ft(a,s,r)),a.events.emit("contactstart",new It(a,s,r)),s.events.emit("collisionstart",new Ft(s,a,r)),s.events.emit("contactstart",new It(s,a,r))}}}catch(v){e.e(v)}finally{e.f()}var l,u=(0,m.Z)(this._lastFrameContacts);try{for(u.s();!(l=u.n()).done;){var c=(0,o.Z)(l.value,2),h=c[0],d=c[1];if(!this._currentFrameContacts.has(h)){var f=d.colliderA,p=d.colliderB;f.events.emit("collisionend",new Dt(f,p)),f.events.emit("contactend",new Zt(f,p)),p.events.emit("collisionend",new Dt(p,f)),p.events.emit("contactend",new Zt(p,f))}}}catch(v){u.e(v)}finally{u.f()}}}]),n}(Gi);!function(t){t.Forward="forward",t.Backward="backward"}(rr||(rr={})),function(t){t.End="end",t.Loop="loop",t.PingPong="pingpong",t.Freeze="freeze"}(or||(or={}));var hr=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i,r,o;return(0,b.Z)(this,n),(i=e.call(this,t)).events=new Wt,i.frames=[],i.strategy=or.Loop,i.frameDuration=100,i.timeScale=1,i._idempotencyToken=-1,i._firstTick=!0,i._currentFrame=0,i._timeLeftInFrame=0,i._direction=1,i._done=!1,i._playing=!0,i._reversed=!1,i.frames=t.frames,i.strategy=null!==(r=t.strategy)&&void 0!==r?r:i.strategy,i.frameDuration=t.totalDuration?t.totalDuration/i.frames.length:null!==(o=t.frameDuration)&&void 0!==o?o:i.frameDuration,t.reverse&&i.reverse(),i.goToFrame(0),i}return(0,k.Z)(n,[{key:"clone",value:function(){return new n(d({frames:this.frames.map((function(t){return d({},t)})),frameDuration:this.frameDuration,reverse:this._reversed,strategy:this.strategy},this.cloneGraphicOptions()))}},{key:"width",get:function(){var t=this.currentFrame;return t?Math.abs(t.graphic.width*this.scale.x):0}},{key:"height",get:function(){var t=this.currentFrame;return t?Math.abs(t.graphic.height*this.scale.y):0}},{key:"currentFrame",get:function(){return this._currentFrame>=0&&this._currentFrame<this.frames.length?this.frames[this._currentFrame]:null}},{key:"currentFrameIndex",get:function(){return this._currentFrame}},{key:"isPlaying",get:function(){return this._playing}},{key:"reverse",value:function(){this.frames=this.frames.slice().reverse(),this._reversed=!this._reversed}},{key:"direction",get:function(){return!(!this._reversed||1!==this._direction)?rr.Backward:rr.Forward}},{key:"play",value:function(){this._playing=!0}},{key:"pause",value:function(){this._playing=!1,this._firstTick=!0}},{key:"reset",value:function(){this._done=!1,this._firstTick=!0,this._currentFrame=0}},{key:"canFinish",get:function(){switch(this.strategy){case or.End:case or.Freeze:return!0;default:return!1}}},{key:"done",get:function(){return this._done}},{key:"goToFrame",value:function(t){this._currentFrame=t,this._timeLeftInFrame=this.frameDuration;var e=this.frames[this._currentFrame];e&&!this._done&&(this._timeLeftInFrame=(null===e||void 0===e?void 0:e.duration)||this.frameDuration,this.events.emit("frame",e))}},{key:"_nextFrame",value:function(){var t=this._currentFrame;if(this._done)return t;var e=-1;switch(this.strategy){case or.Loop:0===(e=(t+1)%this.frames.length)&&this.events.emit("loop",this);break;case or.End:(e=t+1)>=this.frames.length&&(this._done=!0,this._currentFrame=this.frames.length,this.events.emit("end",this));break;case or.Freeze:(e=I(t+1,0,this.frames.length-1))>=this.frames.length-1&&(this._done=!0,this.events.emit("end",this));break;case or.PingPong:t+this._direction>=this.frames.length&&(this._direction=-1,this.events.emit("loop",this)),t+this._direction<0&&(this._direction=1,this.events.emit("loop",this)),e=t+this._direction%this.frames.length}return e}},{key:"tick",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._idempotencyToken!==e&&(this._idempotencyToken=e,this._playing&&(this._firstTick&&(this._firstTick=!1,this.events.emit("frame",this.currentFrame)),this._timeLeftInFrame-=t*this.timeScale,this._timeLeftInFrame<=0&&this.goToFrame(this._nextFrame())))}},{key:"_drawImage",value:function(t,e,n){this.currentFrame&&this.currentFrame.graphic.draw(t,e,n)}}],[{key:"fromSpriteSheet",value:function(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:or.Loop,o=t.sprites.length-1,a=e.filter((function(t){return t<0||t>o}));return a.length&&n._LOGGER.warn("Indices into SpriteSheet were provided that don't exist: ".concat(a.join(",")," no frame will be shown")),new n({frames:t.sprites.filter((function(t,n){return e.indexOf(n)>-1})).map((function(t){return{graphic:t,duration:i}})),strategy:r})}}]),n}(jt);hr._LOGGER=U.getInstance();var dr,fr=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this,t)).members=[],i.members=t.members,i._updateDimensions(),i}return(0,k.Z)(n,[{key:"clone",value:function(){return new n(d({members:(0,x.Z)(this.members)},this.cloneGraphicOptions()))}},{key:"_updateDimensions",value:function(){var t,e=new q,n=(0,m.Z)(this.members);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=i.graphic,o=i.pos;e=r.localBounds.translate(o).combine(e)}}catch(a){n.e(a)}finally{n.f()}return this.width=e.width,this.height=e.height,e}},{key:"localBounds",get:function(){var t,e=new q,n=(0,m.Z)(this.members);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=i.graphic,o=i.pos;e=r.localBounds.translate(o).combine(e)}}catch(a){n.e(a)}finally{n.f()}return e}},{key:"_isAnimationOrGroup",value:function(t){return t instanceof hr||t instanceof n}},{key:"tick",value:function(t,e){var n,i=(0,m.Z)(this.members);try{for(i.s();!(n=i.n()).done;){var r=n.value.graphic;this._isAnimationOrGroup(r)&&r.tick(t,e)}}catch(o){i.e(o)}finally{i.f()}}},{key:"reset",value:function(){var t,e=(0,m.Z)(this.members);try{for(e.s();!(t=e.n()).done;){var n=t.value.graphic;this._isAnimationOrGroup(n)&&n.reset()}}catch(i){e.e(i)}finally{e.f()}}},{key:"_preDraw",value:function(t,e,i){this._updateDimensions(),(0,f.Z)((0,y.Z)(n.prototype),"_preDraw",this).call(this,t,e,i)}},{key:"_drawImage",value:function(t,e,n){var i,r=(0,m.Z)(this.members);try{for(r.s();!(i=r.n()).done;){var o=i.value;t.save(),t.translate(e,n),o.graphic.draw(t,o.pos.x,o.pos.y),this.showDebug&&t.debug.drawRect(0,0,this.width,this.height),t.restore()}}catch(a){r.e(a)}finally{r.f()}}}]),n}(jt);function pr(t){return function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;(0,b.Z)(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];t=e.call.apply(e,[this].concat(r));var a=r.filter((function(t){return void 0!==t})).length;return 1!==a||!r[0]||"object"!==typeof r[0]||r[0]instanceof Array||t.assign(r[0]),t}return(0,k.Z)(n,[{key:"assign",value:function(t){for(var e in t)"function"!==typeof this[e]&&(this[e]=t[e])}}]),n}(t)}!function(t){t[t.Circle=0]="Circle",t[t.Rectangle=1]="Rectangle"}(dr||(dr={}));var vr,gr=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i,r,o,a,s,l,u,c,h){return(0,b.Z)(this,n),e.call(this,t,i,r,o,a,s,l,u,c,h)}return(0,k.Z)(n)}(pr(function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i,r,o,a,s,l,u,c,h){var d;(0,b.Z)(this,n),(d=e.call(this)).position=new O(0,0),d.velocity=new O(0,0),d.acceleration=new O(0,0),d.particleRotationalVelocity=0,d.currentRotation=0,d.focus=null,d.focusAccel=0,d.opacity=1,d.beginColor=X.White,d.endColor=X.White,d.life=300,d.fadeFlag=!1,d._rRate=1,d._gRate=1,d._bRate=1,d._aRate=0,d._currentColor=X.White,d.emitter=null,d.particleSize=5,d.particleSprite=null,d.sizeRate=0,d.elapsedMultiplier=0,d.visible=!0,d.isOffscreen=!1;var f=t;if(f&&!(t instanceof yr)){var p=t;f=p.emitter,i=p.life,r=p.opacity,a=p.endColor,o=p.beginColor,s=p.position,l=p.velocity,u=p.acceleration,c=p.startSize,h=p.endSize}return d.emitter=f,d.life=i||d.life,d.opacity=r||d.opacity,d.endColor=a||d.endColor.clone(),d.beginColor=o||d.beginColor.clone(),d._currentColor=d.beginColor.clone(),d.position=(s||d.position).add(d.emitter.pos),d.velocity=l||d.velocity,d.acceleration=u||d.acceleration,d._rRate=(d.endColor.r-d.beginColor.r)/d.life,d._gRate=(d.endColor.g-d.beginColor.g)/d.life,d._bRate=(d.endColor.b-d.beginColor.b)/d.life,d._aRate=d.opacity/d.life,d.startSize=c||0,d.endSize=h||0,d.endSize>0&&d.startSize>0&&(d.sizeRate=(d.endSize-d.startSize)/d.life,d.particleSize=d.startSize),d.addComponent(d.transform=new gn),d.addComponent(d.graphics=new qn),d.transform.pos=d.position,d.transform.rotation=d.currentRotation,d.transform.scale=N(1,1),d.particleSprite?(d.graphics.opacity=d.opacity,d.graphics.use(d.particleSprite)):(d.graphics.localBounds=q.fromDimension(d.particleSize,d.particleSize,O.Half),d.graphics.onPostDraw=function(t){t.save(),d.graphics.opacity=d.opacity;var e=d._currentColor.clone();e.a=1,t.debug.drawPoint(N(0,0),{color:e,size:d.particleSize}),t.restore()}),d}return(0,k.Z)(n,[{key:"kill",value:function(){this.emitter.removeParticle(this)}},{key:"update",value:function(t,e){if(this.life=this.life-e,this.elapsedMultiplier=this.elapsedMultiplier+e,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=I(this._aRate*this.life,1e-4,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=I(this.sizeRate*e+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this._currentColor.r=I(this._currentColor.r+this._rRate*e,0,255),this._currentColor.g=I(this._currentColor.g+this._gRate*e,0,255),this._currentColor.b=I(this._currentColor.b+this._bRate*e,0,255),this._currentColor.a=I(this.opacity,1e-4,1),this.focus){var n=this.focus.sub(this.position).normalize().scale(this.focusAccel).scale(e/1e3);this.velocity=this.velocity.add(n)}else this.velocity=this.velocity.add(this.acceleration.scale(e/1e3));this.position=this.position.add(this.velocity.scale(e/1e3)),this.particleRotationalVelocity&&(this.currentRotation=(this.currentRotation+this.particleRotationalVelocity*e/1e3)%(2*Math.PI)),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=N(1,1),this.graphics.opacity=this.opacity}}]),n}(Vn))),yr=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i,r,o;(0,b.Z)(this,n),(i=e.call(this,{width:null!==(r=t.width)&&void 0!==r?r:0,height:null!==(o=t.height)&&void 0!==o?o:0}))._particlesToEmit=0,i.numParticles=0,i.isEmitting=!0,i.particles=[],i.deadParticles=[],i.minVel=0,i.maxVel=0,i.acceleration=new O(0,0),i.minAngle=0,i.maxAngle=0,i.emitRate=1,i.particleLife=2e3,i.fadeFlag=!1,i.focus=null,i.focusAccel=null,i.startSize=null,i.endSize=null,i.minSize=5,i.maxSize=5,i.beginColor=X.White,i.endColor=X.White,i._sprite=null,i.emitterType=dr.Rectangle,i.radius=0,i.particleRotationalVelocity=0,i.randomRotation=!1;var a=d({},t),s=a.x,l=a.y,u=a.pos,c=a.isEmitting,h=a.minVel,f=a.maxVel,p=a.acceleration,v=a.minAngle,g=a.maxAngle,y=a.emitRate,m=a.particleLife,_=a.opacity,w=a.fadeFlag,x=a.focus,k=a.focusAccel,C=a.startSize,A=a.endSize,E=a.minSize,T=a.maxSize,P=a.beginColor,I=a.endColor,Z=a.particleSprite,R=a.emitterType,M=a.radius,F=a.particleRotationalVelocity,D=a.randomRotation,B=a.random;return i.pos=null!==u&&void 0!==u?u:N(null!==s&&void 0!==s?s:0,null!==l&&void 0!==l?l:0),i.isEmitting=null!==c&&void 0!==c?c:i.isEmitting,i.minVel=null!==h&&void 0!==h?h:i.minVel,i.maxVel=null!==f&&void 0!==f?f:i.maxVel,i.acceleration=null!==p&&void 0!==p?p:i.acceleration,i.minAngle=null!==v&&void 0!==v?v:i.minAngle,i.maxAngle=null!==g&&void 0!==g?g:i.maxAngle,i.emitRate=null!==y&&void 0!==y?y:i.emitRate,i.particleLife=null!==m&&void 0!==m?m:i.particleLife,i.opacity=null!==_&&void 0!==_?_:i.opacity,i.fadeFlag=null!==w&&void 0!==w?w:i.fadeFlag,i.focus=null!==x&&void 0!==x?x:i.focus,i.focusAccel=null!==k&&void 0!==k?k:i.focusAccel,i.startSize=null!==C&&void 0!==C?C:i.startSize,i.endSize=null!==A&&void 0!==A?A:i.endSize,i.minSize=null!==E&&void 0!==E?E:i.minSize,i.maxSize=null!==T&&void 0!==T?T:i.maxSize,i.beginColor=null!==P&&void 0!==P?P:i.beginColor,i.endColor=null!==I&&void 0!==I?I:i.endColor,i.particleSprite=null!==Z&&void 0!==Z?Z:i.particleSprite,i.emitterType=null!==R&&void 0!==R?R:i.emitterType,i.radius=null!==M&&void 0!==M?M:i.radius,i.particleRotationalVelocity=null!==F&&void 0!==F?F:i.particleRotationalVelocity,i.randomRotation=null!==D&&void 0!==D?D:i.randomRotation,i.body.collisionType=je.PreventCollision,i.random=null!==B&&void 0!==B?B:new S,i}return(0,k.Z)(n,[{key:"opacity",get:function(){return(0,f.Z)((0,y.Z)(n.prototype),"graphics",this).opacity},set:function(t){(0,f.Z)((0,y.Z)(n.prototype),"graphics",this).opacity=t}},{key:"particleSprite",get:function(){return this._sprite},set:function(t){t&&(this._sprite=t)}},{key:"removeParticle",value:function(t){this.deadParticles.push(t)}},{key:"emitParticles",value:function(t){for(var e,n=0;n<t;n++){var i=this._createParticle();this.particles.push(i),(null===(e=null===this||void 0===this?void 0:this.scene)||void 0===e?void 0:e.world)&&this.scene.world.add(i)}}},{key:"clearParticles",value:function(){this.particles.length=0}},{key:"_createParticle",value:function(){var t=0,e=0,n=D(this.minAngle,this.maxAngle,this.random),i=D(this.minVel,this.maxVel,this.random),r=this.startSize||D(this.minSize,this.maxSize,this.random),o=i*Math.cos(n),a=i*Math.sin(n);if(this.emitterType===dr.Rectangle)t=D(0,this.width,this.random),e=D(0,this.height,this.random);else if(this.emitterType===dr.Circle){var s=D(0,this.radius,this.random);t=s*Math.cos(n),e=s*Math.sin(n)}var l=new gr(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new O(t,e),new O(o,a),this.acceleration,this.startSize,this.endSize);return l.fadeFlag=this.fadeFlag,l.particleSize=r,this.particleSprite&&(l.particleSprite=this.particleSprite,l.graphics.opacity=this.opacity,l.graphics.use(this._sprite)),l.particleRotationalVelocity=this.particleRotationalVelocity,this.randomRotation&&(l.currentRotation=D(0,2*Math.PI,this.random)),this.focus&&(l.focus=this.focus.add(new O(this.pos.x,this.pos.y)),l.focusAccel=this.focusAccel),l}},{key:"update",value:function(t,e){var i;(0,f.Z)((0,y.Z)(n.prototype),"update",this).call(this,t,e),this.isEmitting&&(this._particlesToEmit+=this.emitRate*(e/1e3),this._particlesToEmit>1&&(this.emitParticles(Math.floor(this._particlesToEmit)),this._particlesToEmit=this._particlesToEmit-Math.floor(this._particlesToEmit)));for(var r=0;r<this.deadParticles.length;r++)J(this.deadParticles[r],this.particles),(null===(i=null===this||void 0===this?void 0:this.scene)||void 0===i?void 0:i.world)&&this.scene.world.remove(this.deadParticles[r],!1);this.deadParticles.length=0}}]),n}(Ei),mr=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.apply(this,arguments)).types=["ex.transform","ex.graphics"],t.systemType=zi.Draw,t.priority=0,t._token=0,t._sortedTransforms=[],t._zHasChanged=!1,t._zIndexUpdate=function(){t._zHasChanged=!0},t}return(0,k.Z)(n,[{key:"sortedTransforms",get:function(){return this._sortedTransforms}},{key:"initialize",value:function(t){this._camera=t.camera,this._engine=t.engine}},{key:"preupdate",value:function(){this._graphicsContext=this._engine.graphicsContext,this._zHasChanged&&(this._sortedTransforms.sort((function(t,e){return t.z-e.z})),this._zHasChanged=!1)}},{key:"notify",value:function(t){if(qi(t)){var e=t.data.get(gn);this._sortedTransforms.push(e),e.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}else{var n=t.data.get(gn);n.zIndexChanged$.unsubscribe(this._zIndexUpdate);var i=this._sortedTransforms.indexOf(n);i>-1&&this._sortedTransforms.splice(i,1)}}},{key:"update",value:function(t,e){var n;this._token++,this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext);var i,r=(0,m.Z)(this._sortedTransforms);try{for(r.s();!(i=r.n()).done;){var o=i.value,a=o.owner;if(!a.hasTag("ex.offscreen")&&(n=a.get(qn)).visible){o.coordPlane===ln.Screen&&this._graphicsContext.restore(),this._graphicsContext.save(),n.update(e,this._token);var s=a.get(Ri);if(s){var l=O.One.sub(s.parallaxFactor),u=this._camera.pos.scale(l);this._graphicsContext.translate(u.x,u.y)}this._applyTransform(a),n.onPreDraw&&n.onPreDraw(this._graphicsContext,e);var c=a instanceof gr?a.opacity:1;this._graphicsContext.opacity=n.opacity*c,this._drawGraphicsComponent(n),n.onPostDraw&&n.onPostDraw(this._graphicsContext,e),this._graphicsContext.restore(),o.coordPlane===ln.Screen&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}}}catch(h){r.e(h)}finally{r.f()}this._graphicsContext.restore()}},{key:"_drawGraphicsComponent",value:function(t){var e,n;if(t.visible){var i,r=(0,m.Z)(t.layers.get());try{for(r.s();!(i=r.n()).done;){var o,a=i.value,s=(0,m.Z)(a.graphics);try{for(s.s();!(o=s.n()).done;){var l=o.value,u=l.graphic,c=l.options,h=t.anchor,d=t.offset;(null===c||void 0===c?void 0:c.anchor)&&(h=c.anchor),(null===c||void 0===c?void 0:c.offset)&&(d=c.offset);var f=-u.width*h.x+d.x,p=-u.height*h.y+d.y;if(null===u||void 0===u||u.draw(this._graphicsContext,f+a.offset.x,p+a.offset.y),(null===(e=this._engine)||void 0===e?void 0:e.isDebug)&&this._engine.debug.graphics.showBounds){var v=N(f+a.offset.x,p+a.offset.y);if(u instanceof fr){var g,y=(0,m.Z)(u.members);try{for(y.s();!(g=y.n()).done;){var _=g.value;null===(n=_.graphic)||void 0===n||n.localBounds.translate(v.add(_.pos)).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}}catch(w){y.e(w)}finally{y.f()}}else null===u||void 0===u||u.localBounds.translate(v).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}}}catch(w){s.e(w)}finally{s.f()}}}catch(w){r.e(w)}finally{r.f()}}}},{key:"_applyTransform",value:function(t){var e,n=t.getAncestors(),i=(0,m.Z)(n);try{for(i.s();!(e=i.n()).done;){var r=e.value,o=null===r||void 0===r?void 0:r.get(gn),a=null===r||void 0===r?void 0:r.get(On),s=o.pos,l=o.scale,u=o.rotation;if(a&&this._engine.fixedUpdateFps&&a.__oldTransformCaptured&&a.enableFixedUpdateInterpolate){var c=this._engine.currentFrameLagMs/(1e3/this._engine.fixedUpdateFps);s=o.pos.scale(c).add(a.oldPos.scale(1-c)),l=o.scale.scale(c).add(a.oldScale.scale(1-c));var h=(1-c)*Math.cos(a.oldRotation)+c*Math.cos(o.rotation),d=(1-c)*Math.sin(a.oldRotation)+c*Math.sin(o.rotation);u=Math.atan2(d,h)}o&&(this._graphicsContext.z=o.z,this._graphicsContext.translate(s.x,s.y),this._graphicsContext.scale(l.x,l.y),this._graphicsContext.rotate(u))}}catch(f){i.e(f)}finally{i.f()}}}]),n}(Gi),_r=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.apply(this,arguments)).types=["ex.transform"],t.systemType=zi.Draw,t.priority=999,t}return(0,k.Z)(n,[{key:"initialize",value:function(t){this._graphicsContext=t.engine.graphicsContext,this._camera=t.camera,this._engine=t.engine,this._collisionSystem=t.world.systemManager.get(cr)}},{key:"update",value:function(t,e){var n;if(this._engine.isDebug){var i,r,a,s,l,u,c,h,d,f=this._engine.debug.filter,p=this._engine.debug.entity,v=this._engine.debug.transform,g=this._engine.debug.motion,y=this._engine.debug.collider,_=this._engine.debug.physics,w=this._engine.debug.graphics,x=this._engine.debug.body,b=this._engine.debug.camera,k=(0,m.Z)(t);try{for(k.s();!(d=k.n()).done;){var C=d.value;if(!C.hasTag("offscreen")&&!(C instanceof gr)){if(f.useFilter){if(!(0===f.ids.length||f.ids.includes(C.id)))continue;if(!(""===f.nameQuery||C.name.includes(f.nameQuery)))continue}var S=O.Zero,A=N(0,16);if(i=C.id,r=C.name,a=C.get(gn),this._pushCameraTransform(a),this._graphicsContext.save(),this._applyTransform(C),a&&((v.showAll||v.showPosition)&&this._graphicsContext.debug.drawPoint(O.Zero,{size:4,color:v.positionColor}),(v.showAll||v.showPositionLabel)&&(this._graphicsContext.debug.drawText("pos".concat(a.pos.toString(2)),S),S=S.add(A)),(v.showAll||v.showZIndex)&&(this._graphicsContext.debug.drawText("z(".concat(a.z.toFixed(1),")"),S),S=S.add(A)),(p.showAll||p.showId)&&(this._graphicsContext.debug.drawText("id(".concat(i,") ").concat(C.parent?"child of id("+(null===(n=C.parent)||void 0===n?void 0:n.id)+")":""),S),S=S.add(A)),(p.showAll||p.showName)&&(this._graphicsContext.debug.drawText("name(".concat(r,")"),S),S=S.add(A)),(v.showAll||v.showRotation)&&(this._graphicsContext.drawLine(O.Zero,O.fromAngle(a.rotation).scale(50).add(O.Zero),v.rotationColor,2),this._graphicsContext.debug.drawText("rot deg(".concat(R(a.rotation).toFixed(2),")"),S),S=S.add(A)),(v.showAll||v.showScale)&&this._graphicsContext.drawLine(O.Zero,a.scale.add(O.Zero),v.scaleColor,2)),u=C.get(qn))if(w.showAll||w.showBounds)u.localBounds.draw(this._graphicsContext,w.boundsColor);if((c=C.get(Mi))&&(c.useTransform||this._graphicsContext.restore(),c.draw(this._graphicsContext),c.useTransform||(this._graphicsContext.save(),this._applyTransform(C))),(h=C.get(On))&&((x.showAll||x.showCollisionGroup)&&(this._graphicsContext.debug.drawText("collision group(".concat(h.group.name,")"),S),S=S.add(A)),(x.showAll||x.showCollisionType)&&(this._graphicsContext.debug.drawText("collision type(".concat(h.collisionType,")"),S),S=S.add(A)),(x.showAll||x.showMass)&&(this._graphicsContext.debug.drawText("mass(".concat(h.mass,")"),S),S=S.add(A)),(x.showAll||x.showMotion)&&(this._graphicsContext.debug.drawText("motion(".concat(h.sleepMotion,")"),S),S=S.add(A)),(x.showAll||x.showSleeping)&&(this._graphicsContext.debug.drawText("sleeping(".concat(h.canSleep?h.sleeping:"cant sleep",")"),S),S=S.add(A))),this._graphicsContext.restore(),(s=C.get(yn))&&((g.showAll||g.showVelocity)&&(this._graphicsContext.debug.drawText("vel".concat(s.vel.toString(2)),S.add(a.globalPos)),this._graphicsContext.drawLine(a.globalPos,a.globalPos.add(s.vel),g.velocityColor,2),S=S.add(A)),(g.showAll||g.showAcceleration)&&this._graphicsContext.drawLine(a.globalPos,a.globalPos.add(s.acc),g.accelerationColor,2)),l=C.get(Ln)){var E=l.get();if((y.showAll||y.showGeometry)&&E&&E.debug(this._graphicsContext,y.geometryColor),y.showAll||y.showBounds)if(E instanceof An){var T,P=E.getColliders(),I=(0,m.Z)(P);try{for(I.s();!(T=I.n()).done;){var Z=T.value,M=Z.bounds,F=N(M.left,M.top);this._graphicsContext.debug.drawRect(F.x,F.y,M.width,M.height,{color:y.boundsColor}),(y.showAll||y.showOwner)&&this._graphicsContext.debug.drawText("owner id(".concat(Z.owner.id,")"),F)}}catch(Y){I.e(Y)}finally{I.f()}l.bounds.draw(this._graphicsContext,y.boundsColor)}else if(E){var D=l.bounds,B=N(D.left,D.top);this._graphicsContext.debug.drawRect(B.x,B.y,D.width,D.height,{color:y.boundsColor}),(y.showAll||y.showOwner)&&this._graphicsContext.debug.drawText("owner id(".concat(l.owner.id,")"),B)}}this._popCameraTransform(a)}}}catch(Y){k.e(Y)}finally{k.f()}if(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(_.showAll||_.showBroadphaseSpacePartitionDebug)&&this._collisionSystem.debug(this._graphicsContext),_.showAll||_.showCollisionContacts||_.showCollisionNormals){var z,L=(0,m.Z)(this._engine.debug.stats.currFrame.physics.contacts);try{for(L.s();!(z=L.n()).done;){var U=(0,o.Z)(z.value,2),H=(U[0],U[1]);if(_.showAll||_.showCollisionContacts){var W,V=(0,m.Z)(H.points);try{for(V.s();!(W=V.n()).done;){var X=W.value;this._graphicsContext.debug.drawPoint(X,{size:5,color:_.collisionContactColor})}}catch(Y){V.e(Y)}finally{V.f()}}if(_.showAll||_.showCollisionNormals){var G,j=(0,m.Z)(H.points);try{for(j.s();!(G=j.n()).done;){var q=G.value;this._graphicsContext.debug.drawLine(q,H.normal.scale(30).add(q),{color:_.collisionNormalColor})}}catch(Y){j.e(Y)}finally{j.f()}}}}catch(Y){L.e(Y)}finally{L.f()}}this._graphicsContext.restore(),b&&(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(b.showAll||b.showFocus)&&this._graphicsContext.drawCircle(this._camera.pos,4,b.focusColor),(b.showAll||b.showZoom)&&this._graphicsContext.debug.drawText("zoom(".concat(this._camera.zoom,")"),this._camera.pos),this._graphicsContext.restore()),this._graphicsContext.flush()}}},{key:"_applyTransform",value:function(t){var e,n=t.getAncestors(),i=(0,m.Z)(n);try{for(i.s();!(e=i.n()).done;){var r=e.value,o=null===r||void 0===r?void 0:r.get(gn);o&&(this._graphicsContext.translate(o.pos.x,o.pos.y),this._graphicsContext.scale(o.scale.x,o.scale.y),this._graphicsContext.rotate(o.rotation))}}catch(a){i.e(a)}finally{i.f()}}},{key:"_pushCameraTransform",value:function(t){t.coordPlane===ln.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}},{key:"_popCameraTransform",value:function(t){t.coordPlane===ln.World&&this._graphicsContext.restore()}}]),n}(Gi),wr=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.apply(this,arguments)).types=["ex.transform","ex.pointer"],t.systemType=zi.Update,t.priority=-1,t.overrideUseColliderShape=!1,t.overrideUseGraphicsBounds=!1,t.lastFrameEntityToPointers=new Map,t.currentFrameEntityToPointers=new Map,t._sortedTransforms=[],t._sortedEntities=[],t._zHasChanged=!1,t._zIndexUpdate=function(){t._zHasChanged=!0},t}return(0,k.Z)(n,[{key:"initialize",value:function(t){this._engine=t.engine}},{key:"preupdate",value:function(){this._receiver=this._engine.input.pointers,this._zHasChanged&&(this._sortedTransforms.sort((function(t,e){return e.z-t.z})),this._sortedEntities=this._sortedTransforms.map((function(t){return t.owner})),this._zHasChanged=!1)}},{key:"notify",value:function(t){if(qi(t)){var e=t.data.get(gn);this._sortedTransforms.push(e),this._sortedEntities.push(e.owner),e.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}else{var n=t.data.get(gn);n.zIndexChanged$.unsubscribe(this._zIndexUpdate);var i=this._sortedTransforms.indexOf(n);i>-1&&(this._sortedTransforms.splice(i,1),this._sortedEntities.splice(i,1))}}},{key:"entityCurrentlyUnderPointer",value:function(t,e){return this.currentFrameEntityToPointers.has(t.id)&&this.currentFrameEntityToPointers.get(t.id).includes(e)}},{key:"entityWasUnderPointer",value:function(t,e){return this.lastFrameEntityToPointers.has(t.id)&&this.lastFrameEntityToPointers.get(t.id).includes(e)}},{key:"entered",value:function(t,e){return this.entityCurrentlyUnderPointer(t,e)&&!this.lastFrameEntityToPointers.has(t.id)}},{key:"left",value:function(t,e){return!this.currentFrameEntityToPointers.has(t.id)&&this.entityWasUnderPointer(t,e)}},{key:"addPointerToEntity",value:function(t,e){if(this.currentFrameEntityToPointers.has(t.id)){var n=this.currentFrameEntityToPointers.get(t.id);this.currentFrameEntityToPointers.set(t.id,n.concat(e))}else this.currentFrameEntityToPointers.set(t.id,[e])}},{key:"update",value:function(t){this._processPointerToEntity(this._sortedEntities),this._dispatchEvents(this._sortedEntities),this._receiver.update(),this.lastFrameEntityToPointers.clear(),this.lastFrameEntityToPointers=new Map(this.currentFrameEntityToPointers),this.currentFrameEntityToPointers.clear(),this._receiver.clear()}},{key:"_processPointerToEntity",value:function(t){var e,n,i,r,a,s,l=(0,m.Z)(t);try{for(l.s();!(s=l.n()).done;){var u=s.value;if(n=u.get(gn),a=null!==(e=u.get(Qn))&&void 0!==e?e:new Qn,(i=u.get(Ln))&&(a.useColliderShape||this.overrideUseColliderShape)){i.update();var c=i.get();if(c){var h,d=(0,m.Z)(this._receiver.currentFramePointerCoords.entries());try{for(d.s();!(h=d.n()).done;){var f=(0,o.Z)(h.value,2),p=f[0],v=f[1];c.contains(n.coordPlane===ln.World?v.worldPos:v.screenPos)&&this.addPointerToEntity(u,p)}}catch(k){d.e(k)}finally{d.f()}}}if((r=u.get(qn))&&(a.useGraphicsBounds||this.overrideUseGraphicsBounds)){var g,y=r.localBounds.transform(n.get().matrix),_=(0,m.Z)(this._receiver.currentFramePointerCoords.entries());try{for(_.s();!(g=_.n()).done;){var w=(0,o.Z)(g.value,2),x=w[0],b=w[1];y.contains(n.coordPlane===ln.World?b.worldPos:b.screenPos)&&this.addPointerToEntity(u,x)}}catch(k){_.e(k)}finally{_.f()}}}}catch(k){l.e(k)}finally{l.f()}}},{key:"_processDownAndEmit",value:function(t){var e,n=new Map,i=(0,m.Z)(this._receiver.currentFrameDown);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.active&&t.active&&this.entityCurrentlyUnderPointer(t,r.pointerId)&&(t.events.emit("pointerdown",r),this._receiver.isDragStart(r.pointerId)&&t.events.emit("pointerdragstart",r)),n.set(r.pointerId,r)}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"_processUpAndEmit",value:function(t){var e,n=new Map,i=(0,m.Z)(this._receiver.currentFrameUp);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.active&&t.active&&this.entityCurrentlyUnderPointer(t,r.pointerId)&&(t.events.emit("pointerup",r),this._receiver.isDragEnd(r.pointerId)&&t.events.emit("pointerdragend",r)),n.set(r.pointerId,r)}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"_processMoveAndEmit",value:function(t){var e,n=new Map,i=(0,m.Z)(this._receiver.currentFrameMove);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.active&&t.active&&this.entityCurrentlyUnderPointer(t,r.pointerId)&&(t.events.emit("pointermove",r),this._receiver.isDragging(r.pointerId)&&t.events.emit("pointerdragmove",r)),n.set(r.pointerId,r)}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"_processEnterLeaveAndEmit",value:function(t,e){var n,i=(0,m.Z)(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.active&&t.active&&this.entered(t,r.pointerId)){t.events.emit("pointerenter",r),this._receiver.isDragging(r.pointerId)&&t.events.emit("pointerdragenter",r);break}if(r.active&&t.active&&(this.left(t,r.pointerId)||this.entityCurrentlyUnderPointer(t,r.pointerId)&&"up"===r.type)){t.events.emit("pointerleave",r),this._receiver.isDragging(r.pointerId)&&t.events.emit("pointerdragleave",r);break}}}catch(o){i.e(o)}finally{i.f()}}},{key:"_processCancelAndEmit",value:function(t){var e,n=(0,m.Z)(this._receiver.currentFrameCancel);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.active&&t.active&&this.entityCurrentlyUnderPointer(t,i.pointerId)&&t.events.emit("pointercancel",i)}}catch(r){n.e(r)}finally{n.f()}}},{key:"_processWheelAndEmit",value:function(t){var e,n=(0,m.Z)(this._receiver.currentFrameWheel);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.active&&t.active&&this.entityCurrentlyUnderPointer(t,0)&&t.events.emit("pointerwheel",i)}}catch(r){n.e(r)}finally{n.f()}}},{key:"_dispatchEvents",value:function(t){var e,n,i,r,o=new Set(this.lastFrameEntityToPointers.keys()),a=new Set(this.currentFrameEntityToPointers.keys()),s=t.filter((function(t){return o.has(t.id)||a.has(t.id)})),l=(0,m.Z)(s);try{for(l.s();!(r=l.n()).done;){var u=r.value;i=this._processDownAndEmit(u),n=this._processUpAndEmit(u),e=this._processMoveAndEmit(u);var c=[].concat((0,x.Z)(e.values()),(0,x.Z)(i.values()),(0,x.Z)(n.values()));this._processEnterLeaveAndEmit(u,c),this._processCancelAndEmit(u),this._processWheelAndEmit(u)}}catch(h){l.e(h)}finally{l.f()}}}]),n}(Gi),xr=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.apply(this,arguments)).types=["ex.actions"],t.systemType=zi.Update,t.priority=-1,t._actions=[],t}return(0,k.Z)(n,[{key:"notify",value:function(t){if(qi(t)){var e=t.data.get(Ci);this._actions.push(e)}else{var n=t.data.get(Ci),i=this._actions.indexOf(n);i>-1&&this._actions.splice(i,1)}}},{key:"update",value:function(t,e){var n,i=(0,m.Z)(this._actions);try{for(i.s();!(n=i.n()).done;){n.value.update(e)}}catch(r){i.e(r)}finally{i.f()}}}]),n}(Gi),br=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this)).type="ex.isometricentity",i.elevation=0,i.map=t,i}return(0,k.Z)(n)}(fn),kr=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.apply(this,arguments)).types=["ex.transform","ex.isometricentity"],t.systemType=zi.Update,t.priority=99,t}return(0,k.Z)(n,[{key:"update",value:function(t,e){var n,i,r,o=(0,m.Z)(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;n=a.get(gn),i=a.get(br);var s=Math.max(i.map.columns*i.map.tileWidth,i.map.rows*i.map.tileHeight)*i.elevation+n.pos.y;n.z=s}}catch(l){o.e(l)}finally{o.f()}}}]),n}(Gi),Cr=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.apply(this,arguments)).types=["ex.transform","ex.graphics"],t.systemType=zi.Draw,t.priority=-1,t}return(0,k.Z)(n,[{key:"initialize",value:function(t){this._camera=t.camera}},{key:"update",value:function(t){var e,n,i,r,o=(0,m.Z)(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;n=a.get(qn),e=a.get(gn),i=a.get(Ri);var s=void 0;if(i){var l=O.One.sub(i.parallaxFactor);s=this._camera.pos.scale(l)}var u=this._isOffscreen(e,n,s);u&&!a.hasTag("ex.offscreen")&&(a.eventDispatcher.emit("exitviewport",new Ot(a)),a.addTag("ex.offscreen")),!u&&a.hasTag("ex.offscreen")&&(a.eventDispatcher.emit("enterviewport",new Nt(a)),a.removeTag("ex.offscreen"))}}catch(c){o.e(c)}finally{o.f()}}},{key:"_isOffscreen",value:function(t,e,n){if(t.coordPlane===ln.World){var i=e.localBounds;n&&(i=i.translate(n));var r=i.transform(t.get().matrix);return!this._camera.viewport.overlaps(r)}return!1}}]),n}(Gi),Sr=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.call(this))._logger=U.getInstance(),t.camera=new Wi,t.world=new nr((0,r.Z)(t)),t._isInitialized=!1,t._timers=[],t._cancelQueue=[],t.world.add(new xr),t.world.add(new ar),t.world.add(new cr),t.world.add(new wr),t.world.add(new kr),t.world.add(new Cr),t.world.add(new mr),t.world.add(new _r),t}return(0,k.Z)(n,[{key:"actors",get:function(){return this.world.entityManager.entities.filter((function(t){return t instanceof Ei}))}},{key:"entities",get:function(){return this.world.entityManager.entities}},{key:"triggers",get:function(){return this.world.entityManager.entities.filter((function(t){return t instanceof Xi}))}},{key:"tileMaps",get:function(){return this.world.entityManager.entities.filter((function(t){return t instanceof Fi}))}},{key:"timers",get:function(){return this._timers}},{key:"on",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"off",this).call(this,t,e)}},{key:"onInitialize",value:function(t){}},{key:"onActivate",value:function(t){}},{key:"onDeactivate",value:function(t){}},{key:"onPreUpdate",value:function(t,e){}},{key:"onPostUpdate",value:function(t,e){}},{key:"onPreDraw",value:function(t,e){}},{key:"onPostDraw",value:function(t,e){}},{key:"_initializeChildren",value:function(){var t,e=(0,m.Z)(this.entities);try{for(e.s();!(t=e.n()).done;){t.value._initialize(this.engine)}}catch(n){e.e(n)}finally{e.f()}}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_initialize",value:function(t){this.isInitialized||(this.engine=t,this.camera._initialize(t),this.world.systemManager.initialize(),this.onInitialize.call(this,t),this._initializeChildren(),this._logger.debug("Scene.onInitialize",this,t),this.eventDispatcher.emit("initialize",new Bt(t,this)),this._isInitialized=!0)}},{key:"_activate",value:function(t){this._logger.debug("Scene.onActivate",this),this.onActivate(t)}},{key:"_deactivate",value:function(t){this._logger.debug("Scene.onDeactivate",this),this.onDeactivate(t)}},{key:"_preupdate",value:function(t,e){this.emit("preupdate",new mt(t,e,this)),this.onPreUpdate(t,e)}},{key:"_postupdate",value:function(t,e){this.emit("postupdate",new _t(t,e,this)),this.onPostUpdate(t,e)}},{key:"_predraw",value:function(t,e){this.emit("predraw",new pt(t,e,this)),this.onPreDraw(t,e)}},{key:"_postdraw",value:function(t,e){this.emit("postdraw",new vt(t,e,this)),this.onPostDraw(t,e)}},{key:"update",value:function(t,e){var n,i;for(this._preupdate(t,e),n=0,i=this._cancelQueue.length;n<i;n++)this.removeTimer(this._cancelQueue[n]);this._cancelQueue.length=0;var r,o=(0,m.Z)(this._timers);try{for(o.s();!(r=o.n()).done;){r.value.update(e)}}catch(a){o.e(a)}finally{o.f()}this.world.update(zi.Update,e),this.camera&&this.camera.update(t,e),this._collectActorStats(t),this._postupdate(t,e)}},{key:"draw",value:function(t,e){var n;this._predraw(t,e),this.world.update(zi.Draw,e),(null===(n=this.engine)||void 0===n?void 0:n.isDebug)&&this.debugDraw(t),this._postdraw(t,e)}},{key:"debugDraw",value:function(t){this.emit("predebugdraw",new gt(t,this)),this.emit("postdebugdraw",new yt(t,this))}},{key:"contains",value:function(t){return this.actors.indexOf(t)>-1}},{key:"add",value:function(t){this.emit("entityadded",{target:t}),this.world.add(t),t.scene=this,t instanceof Ii&&($(this._timers,t)||this.addTimer(t))}},{key:"remove",value:function(t){t instanceof Vn&&(this.emit("entityremoved",{target:t}),this.world.remove(t)),t instanceof Ii&&this.removeTimer(t)}},{key:"clear",value:function(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=(0,m.Z)(this.entities);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.world.remove(i,e)}}catch(s){n.e(s)}finally{n.f()}var r,o=(0,m.Z)(this.timers);try{for(o.s();!(r=o.n()).done;){var a=r.value;this.removeTimer(a)}}catch(s){o.e(s)}finally{o.f()}}},{key:"addTimer",value:function(t){return this._timers.push(t),t.scene=this,t}},{key:"removeTimer",value:function(t){var e=this._timers.indexOf(t);return-1!==e&&this._timers.splice(e,1),t}},{key:"cancelTimer",value:function(t){return this._cancelQueue.push(t),t}},{key:"isTimerActive",value:function(t){return this._timers.indexOf(t)>-1&&!t.complete}},{key:"isCurrentScene",value:function(){return!!this.engine&&this.engine.currentScene===this}},{key:"_collectActorStats",value:function(t){var e,n=this.actors.filter((function(t){return t instanceof Pi})),i=(0,m.Z)(n);try{for(i.s();!(e=i.n()).done;){e.value;t.stats.currFrame.actors.ui++}}catch(u){i.e(u)}finally{i.f()}var r,o=(0,m.Z)(this.actors);try{for(o.s();!(r=o.n()).done;){var a=r.value;t.stats.currFrame.actors.alive++;var s,l=(0,m.Z)(a.children);try{for(l.s();!(s=l.n()).done;){Ti(s.value)?t.stats.currFrame.actors.ui++:t.stats.currFrame.actors.alive++}}catch(u){l.e(u)}finally{l.f()}}}catch(u){o.e(u)}finally{o.f()}}}]),n}(Ze);!function(t){t.Protanope="Protanope",t.Deuteranope="Deuteranope",t.Tritanope="Tritanope"}(vr||(vr={}));var Ar,Er,Tr,Pr,Ir=function(){function t(e){(0,b.Z)(this,t),this._shader=new se({vertexSource:"#version 300 es\n      in vec2 a_position;\n      in vec2 a_texcoord;\n      out vec2 v_texcoord;\n\n      void main() {\n        gl_Position = vec4(a_position, 0.0, 1.0);\n        // Pass the texcoord to the fragment shader.\n        v_texcoord = a_texcoord;\n      }",fragmentSource:e}),this._shader.compile(),this._buffer=new le({type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new ue({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}return(0,k.Z)(t,[{key:"getShader",value:function(){return this._shader}},{key:"getLayout",value:function(){return this._layout}}]),t}(),Zr=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,b.Z)(this,t),this._colorBlindnessMode=e,this._simulate=!1,this._simulate=n}return(0,k.Z)(t,[{key:"initialize",value:function(t){this._shader=new Ir("#version 300 es\r\nprecision mediump float;\r\n// our texture\r\nuniform sampler2D u_image;\r\n// the texCoords passed in from the vertex shader.\r\nin vec2 v_texcoord;\r\n\r\n// color blind type\r\nuniform int u_type;\r\n\r\n// simulation?\r\nuniform bool u_simulate;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n  vec4 o =  texture(u_image, v_texcoord);\r\n  // RGB to LMS matrix conversion\r\n  float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);\r\n  float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);\r\n  float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);\r\n  // Simulate color blindness\r\n  float l;\r\n  float m;\r\n  float s;\r\n  //MODE CODE//\r\n  if (u_type == 0) {\r\n    // Protanope\r\n    l = 0.0 * L + 2.02344 * M + -2.52581 * S;\r\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\r\n    s = 0.0 * L + 0.0 * M + 1.0 * S;;\r\n  } else if (u_type == 1) {\r\n    // Deuteranope\r\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\r\n    m = 0.494207 * L + 0.0 * M + 1.24827 * S;\r\n    s = 0.0 * L + 0.0 * M + 1.0 * S;\r\n  } else if (u_type == 2) {\r\n    // Tritanope\r\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\r\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\r\n    s = -0.395913 * L + 0.801109 * M + 0.0 * S;\r\n  }\r\n\r\n  // LMS to RGB matrix conversion\r\n  vec4 error; // simulate the colors\r\n  error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);\r\n  error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);\r\n  error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\r\n  error.a = 1.0;\r\n  vec4 diff = o - error;\r\n  vec4 correction; // correct the colors\r\n  correction.r = 0.0;\r\n  correction.g =  (diff.r * 0.7) + (diff.g * 1.0);\r\n  correction.b =  (diff.r * 0.7) + (diff.b * 1.0);\r\n  correction = o + correction;\r\n  correction.a = o.a;\r\n  //SIMULATE//\r\n\r\n  // sim \r\n  if (u_simulate) {\r\n    fragColor = error.rgba;\r\n  } else {\r\n    fragColor = correction.rgba;\r\n  }\r\n}"),this.simulate=this._simulate,this.colorBlindnessMode=this._colorBlindnessMode}},{key:"getShader",value:function(){return this._shader.getShader()}},{key:"getLayout",value:function(){return this._shader.getLayout()}},{key:"colorBlindnessMode",get:function(){return this._colorBlindnessMode},set:function(t){if(this._colorBlindnessMode=t,this._shader){var e=this._shader.getShader();e.use(),this._colorBlindnessMode===vr.Protanope?e.setUniformInt("u_type",0):this._colorBlindnessMode===vr.Deuteranope?e.setUniformInt("u_type",1):this._colorBlindnessMode===vr.Tritanope&&e.setUniformInt("u_type",2)}}},{key:"simulate",get:function(){return this._simulate},set:function(t){if(this._simulate=t,this._shader){var e=this._shader.getShader();e.use(),e.setUniformBoolean("u_simulate",t)}}}]),t}(),Rr=function(){function t(e){(0,b.Z)(this,t),this._engine=e,this._colorBlindPostProcessor=new Zr(vr.Protanope)}return(0,k.Z)(t,[{key:"correct",value:function(t){this._engine.graphicsContext instanceof ke&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=t,this._colorBlindPostProcessor.simulate=!1,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}},{key:"simulate",value:function(t){this._engine.graphicsContext instanceof ke&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=t,this._colorBlindPostProcessor.simulate=!0,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}},{key:"clear",value:function(){this._engine.graphicsContext.removePostProcessor(this._colorBlindPostProcessor)}}]),t}(),Mr=function(){function t(e){(0,b.Z)(this,t),this.stats={currFrame:new Fr,prevFrame:new Fr},this.filter={useFilter:!1,nameQuery:"",ids:[]},this.entity={showAll:!1,showId:!0,showName:!1},this.transform={showAll:!1,showPosition:!1,showPositionLabel:!1,positionColor:X.Yellow,showZIndex:!1,showScale:!1,scaleColor:X.Green,showRotation:!1,rotationColor:X.Blue},this.graphics={showAll:!1,showBounds:!0,boundsColor:X.Yellow},this.collider={showAll:!1,showBounds:!0,boundsColor:X.Blue,showOwner:!1,showGeometry:!0,geometryColor:X.Green},this.physics={showAll:!1,showBroadphaseSpacePartitionDebug:!1,showCollisionNormals:!1,collisionNormalColor:X.Cyan,showCollisionContacts:!0,collisionContactColor:X.Red},this.motion={showAll:!1,showVelocity:!1,velocityColor:X.Yellow,showAcceleration:!1,accelerationColor:X.Red},this.body={showAll:!1,showCollisionGroup:!1,showCollisionType:!1,showSleeping:!1,showMotion:!1,showMass:!1},this.camera={showAll:!1,showFocus:!1,focusColor:X.Red,showZoom:!1},this._engine=e,this.colorBlindMode=new Rr(this._engine)}return(0,k.Z)(t,[{key:"useTestClock",value:function(){var t=this._engine.clock,e=t.isRunning();t.stop();var n=t.toTestClock();return e&&n.start(),this._engine.clock=n,n}},{key:"useStandardClock",value:function(){var t=this._engine.clock,e=t.isRunning();t.stop();var n=t.toStandardClock();return e&&n.start(),this._engine.clock=n,n}}]),t}(),Fr=function(){function t(){(0,b.Z)(this,t),this._id=0,this._delta=0,this._fps=0,this._actorStats={alive:0,killed:0,ui:0,get remaining(){return this.alive-this.killed},get total(){return this.remaining+this.ui}},this._durationStats={update:0,draw:0,get total(){return this.update+this.draw}},this._physicsStats=new Dr,this._graphicsStats={drawCalls:0,drawnImages:0}}return(0,k.Z)(t,[{key:"reset",value:function(t){t?(this.id=t.id,this.delta=t.delta,this.fps=t.fps,this.actors.alive=t.actors.alive,this.actors.killed=t.actors.killed,this.actors.ui=t.actors.ui,this.duration.update=t.duration.update,this.duration.draw=t.duration.draw,this._physicsStats.reset(t.physics),this.graphics.drawCalls=t.graphics.drawCalls,this.graphics.drawnImages=t.graphics.drawnImages):(this.id=this.delta=this.fps=0,this.actors.alive=this.actors.killed=this.actors.ui=0,this.duration.update=this.duration.draw=0,this._physicsStats.reset(),this.graphics.drawnImages=this.graphics.drawCalls=0)}},{key:"clone",value:function(){var e=new t;return e.reset(this),e}},{key:"id",get:function(){return this._id},set:function(t){this._id=t}},{key:"delta",get:function(){return this._delta},set:function(t){this._delta=t}},{key:"fps",get:function(){return this._fps},set:function(t){this._fps=t}},{key:"actors",get:function(){return this._actorStats}},{key:"duration",get:function(){return this._durationStats}},{key:"physics",get:function(){return this._physicsStats}},{key:"graphics",get:function(){return this._graphicsStats}}]),t}(),Dr=function(){function t(){(0,b.Z)(this,t),this._pairs=0,this._collisions=0,this._contacts=new Map,this._fastBodies=0,this._fastBodyCollisions=0,this._broadphase=0,this._narrowphase=0}return(0,k.Z)(t,[{key:"reset",value:function(t){t?(this.pairs=t.pairs,this.collisions=t.collisions,this.contacts=t.contacts,this.fastBodies=t.fastBodies,this.fastBodyCollisions=t.fastBodyCollisions,this.broadphase=t.broadphase,this.narrowphase=t.narrowphase):(this.pairs=this.collisions=this.fastBodies=0,this.fastBodyCollisions=this.broadphase=this.narrowphase=0,this.contacts.clear())}},{key:"clone",value:function(){var e=new t;return e.reset(this),e}},{key:"pairs",get:function(){return this._pairs},set:function(t){this._pairs=t}},{key:"collisions",get:function(){return this._collisions},set:function(t){this._collisions=t}},{key:"contacts",get:function(){return this._contacts},set:function(t){this._contacts=t}},{key:"fastBodies",get:function(){return this._fastBodies},set:function(t){this._fastBodies=t}},{key:"fastBodyCollisions",get:function(){return this._fastBodyCollisions},set:function(t){this._fastBodyCollisions=t}},{key:"broadphase",get:function(){return this._broadphase},set:function(t){this._broadphase=t}},{key:"narrowphase",get:function(){return this._narrowphase},set:function(t){this._narrowphase=t}}]),t}();(Er=Ar||(Ar={})).Canvas="Canvas",Er.Document="Document",(Pr=Tr||(Tr={})).Num0="Numpad0",Pr.Num1="Numpad1",Pr.Num2="Numpad2",Pr.Num3="Numpad3",Pr.Num4="Numpad4",Pr.Num5="Numpad5",Pr.Num6="Numpad6",Pr.Num7="Numpad7",Pr.Num8="Numpad8",Pr.Num9="Numpad9",Pr.NumAdd="NumpadAdd",Pr.NumSubtract="NumpadSubtract",Pr.NumMultiply="NumpadMultiply",Pr.NumDivide="NumpadDivide",Pr.NumDecimal="NumpadDecimal",Pr.Numpad0="Numpad0",Pr.Numpad1="Numpad1",Pr.Numpad2="Numpad2",Pr.Numpad3="Numpad3",Pr.Numpad4="Numpad4",Pr.Numpad5="Numpad5",Pr.Numpad6="Numpad6",Pr.Numpad7="Numpad7",Pr.Numpad8="Numpad8",Pr.Numpad9="Numpad9",Pr.NumpadAdd="NumpadAdd",Pr.NumpadSubtract="NumpadSubtract",Pr.NumpadMultiply="NumpadMultiply",Pr.NumpadDivide="NumpadDivide",Pr.NumpadDecimal="NumpadDecimal",Pr.NumLock="NumLock",Pr.ShiftLeft="ShiftLeft",Pr.ShiftRight="ShiftRight",Pr.AltLeft="AltLeft",Pr.AltRight="AltRight",Pr.ControlLeft="ControlLeft",Pr.ControlRight="ControlRight",Pr.MetaLeft="MetaLeft",Pr.MetaRight="MetaRight",Pr.Key0="Digit0",Pr.Key1="Digit1",Pr.Key2="Digit2",Pr.Key3="Digit3",Pr.Key4="Digit4",Pr.Key5="Digit5",Pr.Key6="Digit6",Pr.Key7="Digit7",Pr.Key8="Digit8",Pr.Key9="Digit9",Pr.Digit0="Digit0",Pr.Digit1="Digit1",Pr.Digit2="Digit2",Pr.Digit3="Digit3",Pr.Digit4="Digit4",Pr.Digit5="Digit5",Pr.Digit6="Digit6",Pr.Digit7="Digit7",Pr.Digit8="Digit8",Pr.Digit9="Digit9",Pr.F1="F1",Pr.F2="F2",Pr.F3="F3",Pr.F4="F4",Pr.F5="F5",Pr.F6="F6",Pr.F7="F7",Pr.F8="F8",Pr.F9="F9",Pr.F10="F10",Pr.F11="F11",Pr.F12="F12",Pr.A="KeyA",Pr.B="KeyB",Pr.C="KeyC",Pr.D="KeyD",Pr.E="KeyE",Pr.F="KeyF",Pr.G="KeyG",Pr.H="KeyH",Pr.I="KeyI",Pr.J="KeyJ",Pr.K="KeyK",Pr.L="KeyL",Pr.M="KeyM",Pr.N="KeyN",Pr.O="KeyO",Pr.P="KeyP",Pr.Q="KeyQ",Pr.R="KeyR",Pr.S="KeyS",Pr.T="KeyT",Pr.U="KeyU",Pr.V="KeyV",Pr.W="KeyW",Pr.X="KeyX",Pr.Y="KeyY",Pr.Z="KeyZ",Pr.KeyA="KeyA",Pr.KeyB="KeyB",Pr.KeyC="KeyC",Pr.KeyD="KeyD",Pr.KeyE="KeyE",Pr.KeyF="KeyF",Pr.KeyG="KeyG",Pr.KeyH="KeyH",Pr.KeyI="KeyI",Pr.KeyJ="KeyJ",Pr.KeyK="KeyK",Pr.KeyL="KeyL",Pr.KeyM="KeyM",Pr.KeyN="KeyN",Pr.KeyO="KeyO",Pr.KeyP="KeyP",Pr.KeyQ="KeyQ",Pr.KeyR="KeyR",Pr.KeyS="KeyS",Pr.KeyT="KeyT",Pr.KeyU="KeyU",Pr.KeyV="KeyV",Pr.KeyW="KeyW",Pr.KeyX="KeyX",Pr.KeyY="KeyY",Pr.KeyZ="KeyZ",Pr.Semicolon="Semicolon",Pr.Quote="Quote",Pr.Comma="Comma",Pr.Minus="Minus",Pr.Period="Period",Pr.Slash="Slash",Pr.Equal="Equal",Pr.BracketLeft="BracketLeft",Pr.Backslash="Backslash",Pr.BracketRight="BracketRight",Pr.Backquote="Backquote",Pr.Up="ArrowUp",Pr.Down="ArrowDown",Pr.Left="ArrowLeft",Pr.Right="ArrowRight",Pr.ArrowUp="ArrowUp",Pr.ArrowDown="ArrowDown",Pr.ArrowLeft="ArrowLeft",Pr.ArrowRight="ArrowRight",Pr.Space="Space",Pr.Backspace="Backspace",Pr.Delete="Delete",Pr.Esc="Escape",Pr.Escape="Escape",Pr.Enter="Enter",Pr.NumpadEnter="NumpadEnter",Pr.ContextMenu="ContextMenu";var Br=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i,r){var o;return(0,b.Z)(this,n),(o=e.call(this)).key=t,o.value=i,o.originalEvent=r,o}return(0,k.Z)(n)}(lt),zr=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.call(this))._keys=[],t._keysUp=[],t._keysDown=[],t._handleKeyDown=function(e){var n=e.code;if(-1===t._keys.indexOf(n)){t._keys.push(n),t._keysDown.push(n);var i=new Br(n,e.key,e);t.eventDispatcher.emit("down",i),t.eventDispatcher.emit("press",i)}},t._handleKeyUp=function(e){var n=e.code,i=t._keys.indexOf(n);t._keys.splice(i,1),t._keysUp.push(n);var r=new Br(n,e.key,e);t.eventDispatcher.emit("up",r),t.eventDispatcher.emit("release",r)},t}return(0,k.Z)(n,[{key:"on",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"on",this).call(this,t,e)}},{key:"init",value:function(t){var e=this;if(!t)try{var n=function(){};window.top.addEventListener("blur",n),window.top.removeEventListener("blur",n),t=window.top}catch(i){t=window,U.getInstance().warn("Failed to bind to keyboard events to top frame. If you are trying to embed Excalibur in a cross-origin iframe, keyboard events will not fire.")}t.addEventListener("blur",(function(){e._keys.length=0})),t.addEventListener("keyup",this._handleKeyUp),t.addEventListener("keydown",this._handleKeyDown)}},{key:"update",value:function(){this._keysDown.length=0,this._keysUp.length=0;for(var t=0;t<this._keys.length;t++)this.eventDispatcher.emit("hold",new Br(this._keys[t]))}},{key:"getKeys",value:function(){return this._keys}},{key:"wasPressed",value:function(t){return this._keysDown.indexOf(t)>-1}},{key:"isHeld",value:function(t){return this._keys.indexOf(t)>-1}},{key:"wasReleased",value:function(t){return this._keysUp.indexOf(t)>-1}},{key:"triggerEvent",value:function(t,e,n){"down"===t&&this._handleKeyDown(new KeyboardEvent("keydown",{code:e,key:null!==n&&void 0!==n?n:null})),"up"===t&&this._handleKeyUp(new KeyboardEvent("keyup",{code:e,key:null!==n&&void 0!==n?n:null}))}}]),n}(Ze),Lr=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.call(this)).enabled=!1,t.supported=!!navigator.getGamepads,t._gamePadTimeStamps=[0,0,0,0],t._oldPads=[],t._pads=[],t._initSuccess=!1,t._navigator=navigator,t._minimumConfiguration=null,t}return(0,k.Z)(n,[{key:"init",value:function(){this.supported&&(this._initSuccess||(this._oldPads=this._clonePads(this._navigator.getGamepads()),this._oldPads.length&&this._oldPads[0]&&(this._initSuccess=!0)))}},{key:"setMinimumGamepadConfiguration",value:function(t){this._enableAndUpdate(),this._minimumConfiguration=t}},{key:"_enableAndUpdate",value:function(){this.enabled||(this.enabled=!0,this.update())}},{key:"_isGamepadValid",value:function(t){if(!this._minimumConfiguration)return!0;if(!t)return!1;var e=t.axes.filter((function(t){return void 0!==typeof t})).length,n=t.buttons.filter((function(t){return void 0!==typeof t})).length;return e>=this._minimumConfiguration.axis&&n>=this._minimumConfiguration.buttons&&t.connected}},{key:"on",value:function(t,e){this._enableAndUpdate(),(0,f.Z)((0,y.Z)(n.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){this._enableAndUpdate(),(0,f.Z)((0,y.Z)(n.prototype),"off",this).call(this,t,e)}},{key:"update",value:function(){if(this.enabled&&this.supported){this.init();for(var t=this._navigator.getGamepads(),e=0;e<t.length;e++)if(t[e]){if(!this.at(e).connected&&this._isGamepadValid(t[e])&&this.eventDispatcher.emit("connect",new bt(e,this.at(e))),this.at(e).connected=!0,!t[e].timestamp||t[e].timestamp!==this._gamePadTimeStamps[e]){this._gamePadTimeStamps[e]=t[e].timestamp,this.at(e).navigatorGamepad=t[e];var n=void 0,i=void 0,r=void 0,o=void 0,a=void 0;for(n in Or)"number"===typeof(i=Or[n])&&t[e].buttons[i]&&(a=t[e].buttons[i].value)!==this._oldPads[e].getButton(i)&&(t[e].buttons[i].pressed?(this.at(e).updateButton(i,a),this.at(e).eventDispatcher.emit("button",new Ct(i,a,this.at(e)))):this.at(e).updateButton(i,0));for(r in Ur)"number"===typeof(o=Ur[r])&&(a=t[e].axes[o])!==this._oldPads[e].getAxes(o)&&(this.at(e).updateAxes(o,a),this.at(e).eventDispatcher.emit("axis",new St(o,a,this.at(e))));this._oldPads[e]=this._clonePad(t[e])}}else{var s=this.at(e);s.connected&&this.eventDispatcher.emit("disconnect",new kt(e,s)),s.connected=!1}}}},{key:"at",value:function(t){if(this._enableAndUpdate(),t>=this._pads.length)for(var e=this._pads.length-1,n=t;e<n;e++)this._pads.push(new Wr),this._oldPads.push(new Wr);return this._pads[t]}},{key:"getValidGamepads",value:function(){this._enableAndUpdate();for(var t=[],e=0;e<this._pads.length;e++)this._isGamepadValid(this.at(e).navigatorGamepad)&&this.at(e).connected&&t.push(this.at(e));return t}},{key:"count",value:function(){return this._pads.filter((function(t){return t.connected})).length}},{key:"_clonePads",value:function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(this._clonePad(t[n]));return e}},{key:"_clonePad",value:function(t){var e,n,i=new Wr;if(!t)return i;for(e=0,n=t.buttons.length;e<n;e++)t.buttons[e]&&i.updateButton(e,t.buttons[e].value);for(e=0,n=t.axes.length;e<n;e++)i.updateAxes(e,t.axes[e]);return i}}]),n}(Ze);Lr.MinAxisMoveThreshold=.05;var Or,Nr,Ur,Hr,Wr=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;(0,b.Z)(this,n),(t=e.call(this)).connected=!1,t._buttons=new Array(16),t._axes=new Array(4);for(var i=0;i<t._buttons.length;i++)t._buttons[i]=0;for(var r=0;r<t._axes.length;r++)t._axes[r]=0;return t}return(0,k.Z)(n,[{key:"isButtonPressed",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._buttons[t]>=e}},{key:"getButton",value:function(t){return this._buttons[t]}},{key:"getAxes",value:function(t){var e=this._axes[t];return Math.abs(e)<Lr.MinAxisMoveThreshold?0:e}},{key:"updateButton",value:function(t,e){this._buttons[t]=e}},{key:"updateAxes",value:function(t,e){this._axes[t]=e}}]),n}(Ze);(Nr=Or||(Or={}))[Nr.Face1=0]="Face1",Nr[Nr.Face2=1]="Face2",Nr[Nr.Face3=2]="Face3",Nr[Nr.Face4=3]="Face4",Nr[Nr.LeftBumper=4]="LeftBumper",Nr[Nr.RightBumper=5]="RightBumper",Nr[Nr.LeftTrigger=6]="LeftTrigger",Nr[Nr.RightTrigger=7]="RightTrigger",Nr[Nr.Select=8]="Select",Nr[Nr.Start=9]="Start",Nr[Nr.LeftStick=10]="LeftStick",Nr[Nr.RightStick=11]="RightStick",Nr[Nr.DpadUp=12]="DpadUp",Nr[Nr.DpadDown=13]="DpadDown",Nr[Nr.DpadLeft=14]="DpadLeft",Nr[Nr.DpadRight=15]="DpadRight",(Hr=Ur||(Ur={}))[Hr.LeftStickX=0]="LeftStickX",Hr[Hr.LeftStickY=1]="LeftStickY",Hr[Hr.RightStickX=2]="RightStickX",Hr[Hr.RightStickY=3]="RightStickY";var Vr,Xr,Gr,jr,qr,Yr,Kr,Qr,Jr=function(){function t(e){(0,b.Z)(this,t),this.nativeComponent=e,this._paused=!1,this._nativeHandlers={}}return(0,k.Z)(t,[{key:"on",value:function(t,e){this._nativeHandlers[t]&&this.off(t,this._nativeHandlers[t]),this._nativeHandlers[t]=this._decorate(e),this.nativeComponent.addEventListener(t,this._nativeHandlers[t])}},{key:"off",value:function(t,e){e||(e=this._nativeHandlers[t]),this.nativeComponent.removeEventListener(t,e),this._nativeHandlers[t]=null}},{key:"_decorate",value:function(t){var e=this;return function(n){e._paused||t(n)}}},{key:"pause",value:function(){this._paused=!0}},{key:"resume",value:function(){this._paused=!1}},{key:"clear",value:function(){for(var t in this._nativeHandlers)this.off(t)}}]),t}(),$r=function(){function t(e,n){(0,b.Z)(this,t),this._windowGlobal=e,this._documentGlobal=n,this._windowComponent=new Jr(this._windowGlobal),this._documentComponent=new Jr(this._documentGlobal)}return(0,k.Z)(t,[{key:"window",get:function(){return this._windowComponent}},{key:"document",get:function(){return this._documentComponent}},{key:"pause",value:function(){this.window.pause(),this.document.pause()}},{key:"resume",value:function(){this.window.resume(),this.document.resume()}},{key:"clear",value:function(){this.window.clear(),this.document.clear()}}]),t}(),to=function(){function t(e,n,i){(0,b.Z)(this,t),this.worldPos=e,this.pagePos=n,this.screenPos=i}return(0,k.Z)(t,null,[{key:"fromPagePosition",value:function(e,n,i){var r,o;3===arguments.length?(r=new O(e,n),o=i):((r=e).x,r.y,o=n);var a=o.screen.pageToScreenCoordinates(r),s=o.screen.screenToWorldCoordinates(a);return new t(s,r,a)}}]),t}(),eo=function(){function t(e,n,i,r,o,a){(0,b.Z)(this,t),this.type=e,this.pointerId=n,this.button=i,this.pointerType=r,this.coordinates=o,this.nativeEvent=a,this.active=!0}return(0,k.Z)(t,[{key:"cancel",value:function(){this.active=!1}},{key:"pagePos",get:function(){return this.coordinates.pagePos}},{key:"screenPos",get:function(){return this.coordinates.screenPos}},{key:"worldPos",get:function(){return this.coordinates.worldPos}}]),t}(),no=function(){function t(e,n,i,r,o,a,s,l,u,c,h,d){(0,b.Z)(this,t),this.x=e,this.y=n,this.pageX=i,this.pageY=r,this.screenX=o,this.screenY=a,this.index=s,this.deltaX=l,this.deltaY=u,this.deltaZ=c,this.deltaMode=h,this.ev=d,this.active=!0}return(0,k.Z)(t,[{key:"cancel",value:function(){this.active=!1}}]),t}(),io=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(){var t;return(0,b.Z)(this,n),(t=e.call(this)).lastPagePos=O.Zero,t.lastScreenPos=O.Zero,t.lastWorldPos=O.Zero,t._onPointerMove=function(e){t.lastPagePos=new O(e.pagePos.x,e.pagePos.y),t.lastScreenPos=new O(e.screenPos.x,e.screenPos.y),t.lastWorldPos=new O(e.worldPos.x,e.worldPos.y)},t._onPointerDown=function(e){t.lastPagePos=new O(e.pagePos.x,e.pagePos.y),t.lastScreenPos=new O(e.screenPos.x,e.screenPos.y),t.lastWorldPos=new O(e.worldPos.x,e.worldPos.y)},t.on("move",t._onPointerMove),t.on("down",t._onPointerDown),t}return(0,k.Z)(n,[{key:"on",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"off",this).call(this,t,e)}}]),n}(Ze);(Xr=Vr||(Vr={})).Pixel="Pixel",Xr.Line="Line",Xr.Page="Page",(jr=Gr||(Gr={}))[jr.NoButton=-1]="NoButton",jr[jr.Left=0]="Left",jr[jr.Middle=1]="Middle",jr[jr.Right=2]="Right",jr[jr.Unknown=3]="Unknown",(Yr=qr||(qr={})).Left="Left",Yr.Middle="Middle",Yr.Right="Right",Yr.Unknown="Unknown",Yr.NoButton="NoButton",(Qr=Kr||(Kr={})).Touch="Touch",Qr.Mouse="Mouse",Qr.Pen="Pen",Qr.Unknown="Unknown";var ro,oo=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i){var o;return(0,b.Z)(this,n),(o=e.call(this)).target=t,o.engine=i,o.primary=new io,o._activeNativePointerIdsToNormalized=new Map,o.lastFramePointerCoords=new Map,o.currentFramePointerCoords=new Map,o.currentFramePointerDown=new Map,o.lastFramePointerDown=new Map,o.currentFrameDown=[],o.currentFrameUp=[],o.currentFrameMove=[],o.currentFrameCancel=[],o.currentFrameWheel=[],o._pointers=[o.primary],o._boundHandle=o._handle.bind((0,r.Z)(o)),o._boundWheel=o._handleWheel.bind((0,r.Z)(o)),o}return(0,k.Z)(n,[{key:"recreate",value:function(t,e){var i=new n(t,e);return i.primary=this.primary,i._pointers=this._pointers,i}},{key:"at",value:function(t){if(t>=this._pointers.length)for(var e=this._pointers.length-1,n=t;e<n;e++)this._pointers.push(new io);return this._pointers[t]}},{key:"count",value:function(){return this._pointers.length}},{key:"isDown",value:function(t){var e;return null!==(e=this.currentFramePointerDown.get(t))&&void 0!==e&&e}},{key:"wasDown",value:function(t){var e;return null!==(e=this.lastFramePointerDown.get(t))&&void 0!==e&&e}},{key:"isDragging",value:function(t){return this.isDown(t)}},{key:"isDragStart",value:function(t){return this.isDown(t)&&!this.wasDown(t)}},{key:"isDragEnd",value:function(t){return!this.isDown(t)&&this.wasDown(t)}},{key:"on",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"off",this).call(this,t,e)}},{key:"update",value:function(){this.lastFramePointerDown=new Map(this.currentFramePointerDown),this.lastFramePointerCoords=new Map(this.currentFramePointerCoords);var t,e=(0,m.Z)(this.currentFrameDown);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.emit("down",n),this.at(n.pointerId).emit("down",n),this.primary.emit("pointerdown",n)}}catch(v){e.e(v)}finally{e.f()}var i,r=(0,m.Z)(this.currentFrameUp);try{for(r.s();!(i=r.n()).done;){var o=i.value;this.emit("up",o),this.at(o.pointerId).emit("up",o)}}catch(v){r.e(v)}finally{r.f()}var a,s=(0,m.Z)(this.currentFrameMove);try{for(s.s();!(a=s.n()).done;){var l=a.value;this.emit("move",l),this.at(l.pointerId).emit("move",l)}}catch(v){s.e(v)}finally{s.f()}var u,c=(0,m.Z)(this.currentFrameCancel);try{for(c.s();!(u=c.n()).done;){var h=u.value;this.emit("cancel",h),this.at(h.pointerId).emit("cancel",h)}}catch(v){c.e(v)}finally{c.f()}var d,f=(0,m.Z)(this.currentFrameWheel);try{for(f.s();!(d=f.n()).done;){var p=d.value;this.emit("wheel",p),this.primary.emit("pointerwheel",p)}}catch(v){f.e(v)}finally{f.f()}}},{key:"clear",value:function(){var t,e=(0,m.Z)(this.currentFrameUp);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.currentFramePointerCoords.delete(n.pointerId);var i,r=this._activeNativePointerIdsToNormalized.entries(),a=(0,m.Z)(r);try{for(a.s();!(i=a.n()).done;){var s=(0,o.Z)(i.value,2),l=s[0];s[1]===n.pointerId&&this._activeNativePointerIdsToNormalized.delete(l)}}catch(u){a.e(u)}finally{a.f()}}}catch(u){e.e(u)}finally{e.f()}this.currentFrameDown.length=0,this.currentFrameUp.length=0,this.currentFrameMove.length=0,this.currentFrameCancel.length=0,this.currentFrameWheel.length=0}},{key:"init",value:function(){this.target===this.engine.canvas?this.engine.canvas.style.touchAction="none":document.body.style.touchAction="none",window.PointerEvent?(this.target.addEventListener("pointerdown",this._boundHandle),this.target.addEventListener("pointerup",this._boundHandle),this.target.addEventListener("pointermove",this._boundHandle),this.target.addEventListener("pointercancel",this._boundHandle)):(this.target.addEventListener("touchstart",this._boundHandle),this.target.addEventListener("touchend",this._boundHandle),this.target.addEventListener("touchmove",this._boundHandle),this.target.addEventListener("touchcancel",this._boundHandle),this.target.addEventListener("mousedown",this._boundHandle),this.target.addEventListener("mouseup",this._boundHandle),this.target.addEventListener("mousemove",this._boundHandle));var t={passive:!(this.engine.pageScrollPreventionMode===ro.All||this.engine.pageScrollPreventionMode===ro.Canvas)};"onwheel"in document.createElement("div")?this.target.addEventListener("wheel",this._boundWheel,t):void 0!==document.onmousewheel?this.target.addEventListener("mousewheel",this._boundWheel,t):this.target.addEventListener("MozMousePixelScroll",this._boundWheel,t)}},{key:"detach",value:function(){window.PointerEvent?(this.target.removeEventListener("pointerdown",this._boundHandle),this.target.removeEventListener("pointerup",this._boundHandle),this.target.removeEventListener("pointermove",this._boundHandle),this.target.removeEventListener("pointercancel",this._boundHandle)):(this.target.removeEventListener("touchstart",this._boundHandle),this.target.removeEventListener("touchend",this._boundHandle),this.target.removeEventListener("touchmove",this._boundHandle),this.target.removeEventListener("touchcancel",this._boundHandle),this.target.removeEventListener("mousedown",this._boundHandle),this.target.removeEventListener("mouseup",this._boundHandle),this.target.removeEventListener("mousemove",this._boundHandle)),"onwheel"in document.createElement("div")?this.target.removeEventListener("wheel",this._boundWheel):void 0!==document.onmousewheel?this.target.addEventListener("mousewheel",this._boundWheel):this.target.addEventListener("MozMousePixelScroll",this._boundWheel)}},{key:"_normalizePointerId",value:function(t){this._activeNativePointerIdsToNormalized.set(t,-1);var e=Array.from(this._activeNativePointerIdsToNormalized.keys()).sort((function(t,e){return t-e})).findIndex((function(e){return e===t}));return this._activeNativePointerIdsToNormalized.set(t,e),e}},{key:"_handle",value:function(t){t.preventDefault();var e,n,i,r=new Map;if(i=t,globalThis.TouchEvent&&i instanceof globalThis.TouchEvent){e=qr.Unknown,n=Kr.Touch;for(var a=0;a<t.changedTouches.length;a++){var s=t.changedTouches[a],l=to.fromPagePosition(s.pageX,s.pageY,this.engine),u=a+1,c=this._normalizePointerId(u);this.currentFramePointerCoords.set(c,l),r.set(c,l)}}else{e=this._nativeButtonToPointerButton(t.button),n=Kr.Mouse;var h=to.fromPagePosition(t.pageX,t.pageY,this.engine),d=1;(function(t){return globalThis.PointerEvent&&t instanceof globalThis.PointerEvent})(t)&&(d=t.pointerId,n=this._stringToPointerType(t.pointerType));var f=this._normalizePointerId(d);this.currentFramePointerCoords.set(f,h),r.set(f,h)}var p,v=(0,m.Z)(r.entries());try{for(v.s();!(p=v.n()).done;){var g=(0,o.Z)(p.value,2),y=g[0],_=g[1];switch(t.type){case"mousedown":case"pointerdown":case"touchstart":this.currentFrameDown.push(new eo("down",y,e,n,_,t)),this.currentFramePointerDown.set(y,!0);break;case"mouseup":case"pointerup":case"touchend":this.currentFrameUp.push(new eo("up",y,e,n,_,t)),this.currentFramePointerDown.set(y,!1);break;case"mousemove":case"pointermove":case"touchmove":this.currentFrameMove.push(new eo("move",y,e,n,_,t));break;case"touchcancel":case"pointercancel":this.currentFrameCancel.push(new eo("cancel",y,e,n,_,t))}}}catch(w){v.e(w)}finally{v.f()}}},{key:"_handleWheel",value:function(t){(this.engine.pageScrollPreventionMode===ro.All||this.engine.pageScrollPreventionMode===ro.Canvas&&t.target===this.engine.canvas)&&t.preventDefault();var e=this.engine.screen.pageToScreenCoordinates(N(t.pageX,t.pageY)),n=this.engine.screen.screenToWorldCoordinates(e),i=-1/40,r=t.deltaX||t.wheelDeltaX*i||0,o=t.deltaY||t.wheelDeltaY*i||t.wheelDelta*i||t.detail||0,a=t.deltaZ||0,s=Vr.Pixel;t.deltaMode&&(1===t.deltaMode?s=Vr.Line:2===t.deltaMode&&(s=Vr.Page));var l=new no(n.x,n.y,t.pageX,t.pageY,e.x,e.y,0,r,o,a,s,t);this.currentFrameWheel.push(l)}},{key:"triggerEvent",value:function(t,e){var n=this.engine.screen.worldToPageCoordinates(e);window.PointerEvent?this._handle(new window.PointerEvent("pointer"+t,{pointerId:0,clientX:n.x,clientY:n.y})):this._handle(new window.MouseEvent("mouse"+t,{clientX:n.x,clientY:n.y}));var i=this.engine.currentScene.world.systemManager.get(wr),r=this.engine.currentScene.world.queryManager.createQuery(i.types);i.preupdate(),i.update(r.getEntities())}},{key:"_nativeButtonToPointerButton",value:function(t){switch(t){case Gr.NoButton:return qr.NoButton;case Gr.Left:return qr.Left;case Gr.Middle:return qr.Middle;case Gr.Right:return qr.Right;case Gr.Unknown:return qr.Unknown;default:return tt(t)}}},{key:"_stringToPointerType",value:function(t){switch(t){case"touch":return Kr.Touch;case"mouse":return Kr.Mouse;case"pen":return Kr.Pen;default:return Kr.Unknown}}}]),n}(Ze),ao=function(){function t(e){var n;(0,b.Z)(this,t),this._samplePeriod=100,this._currentFrameTime=0,this._frames=0,this._previousSampleTime=0,this._beginFrameTime=0,this._fps=e.initialFps,this._samplePeriod=null!==(n=e.samplePeriod)&&void 0!==n?n:this._samplePeriod,this._currentFrameTime=1e3/e.initialFps,this._nowFn=e.nowFn,this._previousSampleTime=this._nowFn()}return(0,k.Z)(t,[{key:"start",value:function(){this._beginFrameTime=this._nowFn()}},{key:"end",value:function(){this._frames++;var t=this._nowFn();this._currentFrameTime=t-this._beginFrameTime,t>=this._previousSampleTime+this._samplePeriod&&(this._fps=1e3*this._frames/(t-this._previousSampleTime),this._previousSampleTime=t,this._frames=0)}},{key:"fps",get:function(){return this._fps}},{key:"instant",get:function(){return 1e3/this._currentFrameTime}}]),t}(),so=function(){function t(e){var n,i,r,o=this;(0,b.Z)(this,t),this._onFatalException=function(){},this._maxFps=1/0,this._lastTime=0,this._elapsed=1,this._scheduledCbs=[],this._totalElapsed=0,this._options=e,this.tick=e.tick,this._lastTime=null!==(n=this.now())&&void 0!==n?n:0,this._maxFps=null!==(i=e.maxFps)&&void 0!==i?i:this._maxFps,this._onFatalException=null!==(r=e.onFatalException)&&void 0!==r?r:this._onFatalException,this.fpsSampler=new ao({initialFps:60,nowFn:function(){return o.now()}})}return(0,k.Z)(t,[{key:"elapsed",value:function(){return this._elapsed}},{key:"now",value:function(){return performance.now()}},{key:"toTestClock",value:function(){return new uo(d(d({},this._options),{},{defaultUpdateMs:16.6}))}},{key:"toStandardClock",value:function(){return new lo(d({},this._options))}},{key:"setFatalExceptionHandler",value:function(t){this._onFatalException=t}},{key:"schedule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._totalElapsed+e;this._scheduledCbs.push([t,n])}},{key:"_runScheduledCbs",value:function(){for(var t=this._scheduledCbs.length-1;t>-1;t--)this._scheduledCbs[t][1]<=this._totalElapsed&&(this._scheduledCbs[t][0](),this._scheduledCbs.splice(t,1))}},{key:"update",value:function(t){try{this.fpsSampler.start();var e=this.now(),n=e-this._lastTime||1,i=1e3/this._maxFps;if(n>=i){var r=0;0!==i&&(n-=r=n%i),n>200&&(n=1),this._elapsed=t||n,this._totalElapsed+=this._elapsed,this._runScheduledCbs(),this.tick(t||n),this._lastTime=0!==i?e-r:e,this.fpsSampler.end()}}catch(o){this._onFatalException(o),this.stop()}}}]),t}(),lo=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this,t))._running=!1,i}return(0,k.Z)(n,[{key:"isRunning",value:function(){return this._running}},{key:"start",value:function(){var t=this;if(!this._running){this._running=!0;!function e(){if(t._running)try{t._requestId=window.requestAnimationFrame(e),t.update()}catch(n){throw window.cancelAnimationFrame(t._requestId),n}}()}}},{key:"stop",value:function(){this._running=!1}}]),n}(so),uo=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this,d({},t)))._logger=U.getInstance(),i._running=!1,i._currentTime=0,i._updateMs=t.defaultUpdateMs,i}return(0,k.Z)(n,[{key:"now",value:function(){var t;return null!==(t=this._currentTime)&&void 0!==t?t:0}},{key:"isRunning",value:function(){return this._running}},{key:"start",value:function(){this._running=!0}},{key:"stop",value:function(){this._running=!1}},{key:"step",value:function(t){var e=null!==t&&void 0!==t?t:this._updateMs;this._running?(this.update(e),this._currentTime+=e):this._logger.warn("The clock is not running, no step will be performed")}},{key:"run",value:function(t,e){for(var n=0;n<t;n++)this.step(null!==e&&void 0!==e?e:this._updateMs)}}]),n}(so),co=A(7379),ho=function(){function t(){(0,b.Z)(this,t),this._toasterCss=co.Z.toString(),this._isInitialized=!1}return(0,k.Z)(t,[{key:"_initialize",value:function(){this._isInitialized||(this._container=document.createElement("div"),this._container.id="ex-toast-container",document.body.appendChild(this._container),this._isInitialized=!0,this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._toasterCss,document.head.appendChild(this._styleBlock))}},{key:"dispose",value:function(){this._container.parentElement.removeChild(this._container),this._styleBlock.parentElement.removeChild(this._styleBlock),this._isInitialized=!1}},{key:"_createFragment",value:function(t){var e=document.createElement("span");return e.innerText=t,e}},{key:"toast",value:function(t,e,n){var i=this;this._initialize();var r=document.createElement("div");r.className="ex-toast-message";var o=t.split("[LINK]").map((function(t){return i._createFragment(t)}));if(e){var a=document.createElement("a");a.href=e,a.innerText=n||e,o.splice(1,0,a)}var s=document.createElement("div");o.forEach((function(t){s.appendChild(t)})),r.appendChild(s);var l=document.createElement("button");l.innerText="x",l.addEventListener("click",(function(){i._container.removeChild(r)})),r.appendChild(l);document.addEventListener("keydown",(function t(e){if("Escape"===e.key)try{i._container.removeChild(r)}catch(n){}document.removeEventListener("keydown",t)}));var u=this._container.firstChild;this._container.insertBefore(r,u)}}]),t}();h(),function(t){t[t.None=0]="None",t[t.Canvas=1]="Canvas",t[t.All=2]="All"}(ro||(ro={}));var fo=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var o,a,s,l,u,c,h;(0,b.Z)(this,n),(o=e.call(this)).maxFps=Number.POSITIVE_INFINITY,o.scenes={},o._suppressPlayButton=!1,o.pauseAudioWhenHidden=!0,o._isDebug=!1,o.enableCanvasTransparency=!0,o.onFatalException=function(t){U.getInstance().fatal(t)},o._toaster=new ho,o._timescale=1,o._isInitialized=!1,o._deferredGoTo=null,o._originalOptions={},o._performanceThresholdTriggered=!1,o._fpsSamples=[],o._loadingComplete=!1,o._isReady=!1,o._isReadyPromise=new Promise((function(t){o._isReadyResolve=t})),o.currentFrameElapsedMs=0,o.currentFrameLagMs=0,o._lagMs=0,o._screenShotRequests=[],t=d(d({},n._DEFAULT_ENGINE_OPTIONS),t),o._originalOptions=t,p.freeze(),o.browser=new $r(window,document);var f=new Qe;if(!t.suppressMinimumBrowserFeatureDetection&&!(o._compatible=f.test())){var v=document.createElement("div");if(v.innerText="Sorry, your browser does not support all the features needed for Excalibur",document.body.appendChild(v),f.failedTests.forEach((function(t){var e=document.createElement("div");e.innerText="Browser feature missing "+t,document.body.appendChild(e)})),t.canvasElementId){var g=document.getElementById(t.canvasElementId);g&&g.parentElement.removeChild(g)}return(0,i.Z)(o)}o._compatible=!0,console.log&&!t.suppressConsoleBootMessage&&(console.log("%cPowered by Excalibur.js (v".concat(Lo,")"),"background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;"),console.log("\n      /| ________________\nO|===|* >________________>\n      \\|"),console.log("Visit","http://excaliburjs.com","for more information")),t.suppressPlayButton&&(o._suppressPlayButton=!0),o._logger=U.getInstance(),o._logger.defaultLevel===z.Debug&&f.logBrowserFeatures(),o._logger.debug("Building engine..."),o.canvasElementId=t.canvasElementId,t.canvasElementId?(o._logger.debug("Using Canvas element specified: "+t.canvasElementId),o.canvas=document.getElementById(t.canvasElementId)):t.canvasElement?(o._logger.debug("Using Canvas element specified:",t.canvasElement),o.canvas=t.canvasElement):(o._logger.debug("Using generated canvas element"),o.canvas=document.createElement("canvas"));var y=null!==(a=t.displayMode)&&void 0!==a?a:he.Fixed;t.width&&t.height||t.viewport?(void 0===t.displayMode&&(y=he.Fixed),o._logger.debug("Engine viewport is size "+t.width+" x "+t.height)):t.displayMode||(o._logger.debug("Engine viewport is fit"),y=he.FitScreen),o._originalDisplayMode=y;var m=p.isEnabled("use-canvas-context");if(!m)try{o.graphicsContext=new ke({canvasElement:o.canvas,enableTransparency:o.enableCanvasTransparency,smoothing:t.antialiasing,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel,useDrawSorting:t.useDrawSorting})}catch(_){o._logger.warn("Excalibur could not load webgl for some reason (".concat(_.message,") and loaded a Canvas 2D fallback. ")+"Some features of Excalibur will not work in this mode. \n\nRead more about this issue at https://excaliburjs.com/docs/webgl"),m=!0}return m&&(o.graphicsContext=new Ae({canvasElement:o.canvas,enableTransparency:o.enableCanvasTransparency,smoothing:t.antialiasing,backgroundColor:t.backgroundColor,snapToPixel:t.snapToPixel,useDrawSorting:t.useDrawSorting})),o.screen=new Te({canvas:o.canvas,context:o.graphicsContext,antialiasing:null===(s=t.antialiasing)||void 0===s||s,browser:o.browser,viewport:null!==(l=t.viewport)&&void 0!==l?l:t.width&&t.height?{width:t.width,height:t.height}:Ee.SVGA,resolution:t.resolution,displayMode:y,pixelRatio:t.suppressHiDPIScaling?1:null!==(u=t.pixelRatio)&&void 0!==u?u:null}),Kt.filtering=t.antialiasing?qt.Blended:qt.Pixel,t.backgroundColor&&(o.backgroundColor=t.backgroundColor.clone()),o.maxFps=null!==(c=t.maxFps)&&void 0!==c?c:o.maxFps,o.fixedUpdateFps=null!==(h=t.fixedUpdateFps)&&void 0!==h?h:o.fixedUpdateFps,o.clock=new lo({maxFps:o.maxFps,tick:o._mainloop.bind((0,r.Z)(o)),onFatalException:function(t){return o.onFatalException(t)}}),o.enableCanvasTransparency=t.enableCanvasTransparency,o._loader=new Ye,o._loader.wireEngine((0,r.Z)(o)),o.debug=new Mr((0,r.Z)(o)),o._initialize(t),o.rootScene=o.currentScene=new Sr,o.addScene("root",o.rootScene),window.___EXCALIBUR_DEVTOOL=(0,r.Z)(o),o}return(0,k.Z)(n,[{key:"canvasWidth",get:function(){return this.screen.canvasWidth}},{key:"halfCanvasWidth",get:function(){return this.screen.halfCanvasWidth}},{key:"canvasHeight",get:function(){return this.screen.canvasHeight}},{key:"halfCanvasHeight",get:function(){return this.screen.halfCanvasHeight}},{key:"drawWidth",get:function(){return this.screen.drawWidth}},{key:"halfDrawWidth",get:function(){return this.screen.halfDrawWidth}},{key:"drawHeight",get:function(){return this.screen.drawHeight}},{key:"halfDrawHeight",get:function(){return this.screen.halfDrawHeight}},{key:"isHiDpi",get:function(){return this.screen.isHiDpi}},{key:"stats",get:function(){return this.debug.stats}},{key:"isFullscreen",get:function(){return this.screen.isFullScreen}},{key:"displayMode",get:function(){return this.screen.displayMode}},{key:"pixelRatio",get:function(){return this.screen.pixelRatio}},{key:"isDebug",get:function(){return this._isDebug}},{key:"snapToPixel",get:function(){return this.graphicsContext.snapToPixel},set:function(t){this.graphicsContext.snapToPixel=t}},{key:"on",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"on",this).call(this,t,e)}},{key:"once",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"once",this).call(this,t,e)}},{key:"off",value:function(t,e){(0,f.Z)((0,y.Z)(n.prototype),"off",this).call(this,t,e)}},{key:"_monitorPerformanceThresholdAndTriggerFallback",value:function(){var t=this._originalOptions.configurePerformanceCanvas2DFallback.allow,e=this._originalOptions.configurePerformanceCanvas2DFallback,i=e.threshold,r=e.showPlayerMessage;if(void 0===i&&(i=n._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.threshold),void 0===r&&(r=n._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.showPlayerMessage),!p.isEnabled("use-canvas-context")&&t&&this.ready&&!this._performanceThresholdTriggered){this._fpsSamples.length===i.numberOfFrames&&this._fpsSamples.splice(0,1),this._fpsSamples.push(this.clock.fpsSampler.fps);for(var o=0,a=0;a<this._fpsSamples.length;a++)o+=this._fpsSamples[a];var s=o/this._fpsSamples.length;this._fpsSamples.length===i.numberOfFrames&&s<=i.fps&&(this._performanceThresholdTriggered=!0,this._logger.warn('Switching to browser 2D Canvas fallback due to performance. Some features of Excalibur will not work in this mode.\nthis might mean your browser doesn\'t have webgl enabled or hardware acceleration is unavailable.\n\nIf in Chrome:\n  * Visit Settings > Advanced > System, and ensure "Use Hardware Acceleration" is checked.\n  * Visit chrome://flags/#ignore-gpu-blocklist and ensure "Override software rendering list" is "enabled"\nIf in Firefox, visit about:config\n  * Ensure webgl.disabled = false\n  * Ensure webgl.force-enabled = true\n  * Ensure layers.acceleration.force-enabled = true\n\nRead more about this issue at https://excaliburjs.com/docs/performance'),r&&this._toaster.toast("Excalibur is encountering performance issues. It's possible that your browser doesn't have hardware acceleration enabled. Visit [LINK] for more information and potential solutions.","https://excaliburjs.com/docs/performance"),this.useCanvas2DFallback(),this.emit("fallbackgraphicscontext",this.graphicsContext))}}},{key:"useCanvas2DFallback",value:function(){var t,e,n,i=this.canvas.cloneNode(!1);this.canvas.parentNode.replaceChild(i,this.canvas),this.canvas=i;var r=this._originalOptions,o=this._originalDisplayMode;this.graphicsContext=new Ae({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,smoothing:r.antialiasing,backgroundColor:r.backgroundColor,snapToPixel:r.snapToPixel,useDrawSorting:r.useDrawSorting}),this.screen&&this.screen.dispose(),this.screen=new Te({canvas:this.canvas,context:this.graphicsContext,antialiasing:null===(t=r.antialiasing)||void 0===t||t,browser:this.browser,viewport:null!==(e=r.viewport)&&void 0!==e?e:r.width&&r.height?{width:r.width,height:r.height}:Ee.SVGA,resolution:r.resolution,displayMode:o,pixelRatio:r.suppressHiDPIScaling?1:null!==(n=r.pixelRatio)&&void 0!==n?n:null}),this.screen.setCurrentCamera(this.currentScene.camera),this.input.pointers.detach();var a=r&&r.pointerScope===Ar.Document?document:this.canvas;this.input.pointers=this.input.pointers.recreate(a,this),this.input.pointers.init()}},{key:"getWorldBounds",value:function(){return this.screen.getWorldBounds()}},{key:"timescale",get:function(){return this._timescale},set:function(t){t<=0?U.getInstance().error("Cannot set engine.timescale to a value of 0 or less than 0."):this._timescale=t}},{key:"addTimer",value:function(t){return this.currentScene.addTimer(t)}},{key:"removeTimer",value:function(t){return this.currentScene.removeTimer(t)}},{key:"addScene",value:function(t,e){this.scenes[t]&&this._logger.warn("Scene",t,"already exists overwriting"),this.scenes[t]=e}},{key:"removeScene",value:function(t){if(t instanceof Sr)for(var e in this.scenes)this.scenes.hasOwnProperty(e)&&this.scenes[e]===t&&delete this.scenes[e];"string"===typeof t&&delete this.scenes[t]}},{key:"add",value:function(t){2!==arguments.length?this._deferredGoTo&&this.scenes[this._deferredGoTo]?this.scenes[this._deferredGoTo].add(t):this.currentScene.add(t):this.addScene(arguments[0],arguments[1])}},{key:"remove",value:function(t){t instanceof Vn&&this.currentScene.remove(t),t instanceof Sr&&this.removeScene(t),"string"===typeof t&&this.removeScene(t)}},{key:"goToScene",value:function(t,e){if(this.isInitialized)if(this.scenes[t]){var n=this.currentScene,i=this.scenes[t];if(this._logger.debug("Going to scene:",t),this.currentScene.isInitialized){var r={engine:this,previousScene:n,nextScene:i};this.currentScene._deactivate.apply(this.currentScene,[r,i]),this.currentScene.eventDispatcher.emit("deactivate",new Lt(r,this.currentScene))}this.currentScene=i,this.screen.setCurrentCamera(i.camera),this.currentScene._initialize(this);var o={engine:this,previousScene:n,nextScene:i,data:e};this.currentScene._activate.apply(this.currentScene,[o,i]),this.currentScene.eventDispatcher.emit("activate",new zt(o,this.currentScene))}else this._logger.error("Scene",t,"does not exist!");else this._deferredGoTo=t}},{key:"screenToWorldCoordinates",value:function(t){return this.screen.screenToWorldCoordinates(t)}},{key:"worldToScreenCoordinates",value:function(t){return this.screen.worldToScreenCoordinates(t)}},{key:"_initialize",value:function(t){var e=this;this.pageScrollPreventionMode=t.scrollPreventionMode;var n,i,r=t&&t.pointerScope===Ar.Document?document:this.canvas;this.input={keyboard:new zr,pointers:new oo(r,this),gamepads:new Lr},this.input.keyboard.init(),this.input.pointers.init(),this.input.gamepads.init(),"undefined"!==typeof document.hidden?(n="hidden",i="visibilitychange"):"msHidden"in document?(n="msHidden",i="msvisibilitychange"):"webkitHidden"in document&&(n="webkitHidden",i="webkitvisibilitychange"),this.browser.document.on(i,(function(){document[n]?(e.eventDispatcher.emit("hidden",new Et(e)),e._logger.debug("Window hidden")):(e.eventDispatcher.emit("visible",new At(e)),e._logger.debug("Window visible"))})),this.canvasElementId||t.canvasElement||document.body.appendChild(this.canvas)}},{key:"onInitialize",value:function(t){}},{key:"setAntialiasing",value:function(t){this.screen.antialiasing=t}},{key:"getAntialiasing",value:function(){return this.screen.antialiasing}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"_overrideInitialize",value:function(t){if(!this.isInitialized)if(this.onInitialize(t),(0,f.Z)((0,y.Z)(n.prototype),"emit",this).call(this,"initialize",new Bt(t,this)),this._isInitialized=!0,this._deferredGoTo){var e=this._deferredGoTo;this._deferredGoTo=null,this.goToScene(e)}else this.goToScene("root")}},{key:"_update",value:function(t){if(!this.ready)return this._loader.update(this,t),this.input.keyboard.update(),void this.input.gamepads.update();this._preupdate(t),this.currentScene.update(this,t),this._postupdate(t),this.input.keyboard.update(),this.input.gamepads.update()}},{key:"_preupdate",value:function(t){this.emit("preupdate",new mt(this,t,this)),this.onPreUpdate(this,t)}},{key:"onPreUpdate",value:function(t,e){}},{key:"_postupdate",value:function(t){this.emit("postupdate",new _t(this,t,this)),this.onPostUpdate(this,t)}},{key:"onPostUpdate",value:function(t,e){}},{key:"_draw",value:function(t){if(this.graphicsContext.beginDrawLifecycle(),this.graphicsContext.clear(),this._predraw(this.graphicsContext,t),!this._isReady)return this._loader.canvas.draw(this.graphicsContext,0,0),void this.graphicsContext.flush();this.graphicsContext.backgroundColor=this.backgroundColor,this.currentScene.draw(this.graphicsContext,t),this._postdraw(this.graphicsContext,t),this.graphicsContext.flush(),this.graphicsContext.endDrawLifecycle(),this._checkForScreenShots()}},{key:"_predraw",value:function(t,e){this.emit("predraw",new pt(t,e,this)),this.onPreDraw(t,e)}},{key:"onPreDraw",value:function(t,e){}},{key:"_postdraw",value:function(t,e){this.emit("postdraw",new vt(t,e,this)),this.onPostDraw(t,e)}},{key:"onPostDraw",value:function(t,e){}},{key:"showDebug",value:function(t){this._isDebug=t}},{key:"toggleDebug",value:function(){return this._isDebug=!this._isDebug,this._isDebug}},{key:"loadingComplete",get:function(){return this._loadingComplete}},{key:"ready",get:function(){return this._isReady}},{key:"isReady",value:function(){return this._isReadyPromise}},{key:"start",value:function(){var t=u(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._compatible){t.next=2;break}throw new Error("Excalibur is incompatible with your browser");case 2:if(e&&(this.screen.pushResolutionAndViewport(),this.screen.resolution=this.screen.viewport,this.screen.applyResolutionAndViewport(),this._loader=e,this._loader.suppressPlayButton=this._suppressPlayButton||this._loader.suppressPlayButton,this._loader.wireEngine(this)),this._logger.debug("Starting game clock..."),this.browser.resume(),this.clock.start(),this._logger.debug("Game clock started"),!e){t.next=13;break}return t.next=10,this.load(this._loader);case 10:this._loadingComplete=!0,this.screen.popResolutionAndViewport(),this.screen.applyResolutionAndViewport();case 13:return this._loadingComplete=!0,this._overrideInitialize(this),this._isReady=!0,this._isReadyResolve(),this.emit("start",new dt(this)),t.abrupt("return",this._isReadyPromise);case 19:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"_mainloop",value:function(t){this.emit("preframe",new wt(this,this.stats.prevFrame));var e=t*this.timescale;this.currentFrameElapsedMs=e;var n=this.stats.prevFrame.id+1;this.stats.currFrame.reset(),this.stats.currFrame.id=n,this.stats.currFrame.delta=e,this.stats.currFrame.fps=this.clock.fpsSampler.fps,ce.clear();var i=this.clock.now(),r=1e3/this.fixedUpdateFps;if(this.fixedUpdateFps)for(this._lagMs+=e;this._lagMs>=r;)this._update(r),this._lagMs-=r;else this._update(e);var o=this.clock.now();this.currentFrameLagMs=this._lagMs,this._draw(e);var a=this.clock.now();this.stats.currFrame.duration.update=o-i,this.stats.currFrame.duration.draw=a-o,this.stats.currFrame.graphics.drawnImages=ce.DrawnImagesCount,this.stats.currFrame.graphics.drawCalls=ce.DrawCallCount,this.emit("postframe",new xt(this,this.stats.currFrame)),this.stats.prevFrame.reset(this.stats.currFrame),this._monitorPerformanceThresholdAndTriggerFallback()}},{key:"stop",value:function(){this.clock.isRunning()&&(this.emit("stop",new ft(this)),this.browser.pause(),this.clock.stop(),this._logger.debug("Game stopped"))}},{key:"isRunning",value:function(){return this.clock.isRunning()}},{key:"screenshot",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=new Promise((function(n){t._screenShotRequests.push({preserveHiDPIResolution:e,resolve:n})}));return n}},{key:"_checkForScreenShots",value:function(){var t,e=(0,m.Z)(this._screenShotRequests);try{for(e.s();!(t=e.n()).done;){var n=t.value,i=n.preserveHiDPIResolution?this.canvas.width:this.screen.resolution.width,r=n.preserveHiDPIResolution?this.canvas.height:this.screen.resolution.height,o=document.createElement("canvas");o.width=i,o.height=r,o.getContext("2d").drawImage(this.canvas,0,0,i,r);var a=new Image,s=o.toDataURL("image/png");a.src=s,n.resolve(a)}}catch(l){e.e(l)}finally{e.f()}this._screenShotRequests.length=0}},{key:"load",value:function(){var t=u(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.load();case 3:t.next=10;break;case 5:return t.prev=5,t.t0=t.catch(0),this._logger.error("Error loading resources, things may not behave properly",t.t0),t.next=10,Promise.resolve();case 10:case"end":return t.stop()}}),t,this,[[0,5]])})));return function(e){return t.apply(this,arguments)}}()}]),n}(Ze);fo._DEFAULT_ENGINE_OPTIONS={width:0,height:0,enableCanvasTransparency:!0,useDrawSorting:!0,configurePerformanceCanvas2DFallback:{allow:!0,showPlayerMessage:!1,threshold:{fps:20,numberOfFrames:100}},canvasElementId:"",canvasElement:void 0,snapToPixel:!1,pointerScope:Ar.Canvas,suppressConsoleBootMessage:null,suppressMinimumBrowserFeatureDetection:null,suppressHiDPIScaling:null,suppressPlayButton:null,scrollPreventionMode:ro.Canvas,backgroundColor:X.fromHex("#2185d0")};var po=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;(0,b.Z)(this,n),(i=e.call(this,t))._font=new Si,i._text=new Ai({text:"",font:i._font});var r=t.text,o=t.pos,a=t.x,s=t.y,l=t.spriteFont,u=t.font,c=t.color;i.pos=null!==o&&void 0!==o?o:a&&s?N(a,s):i.pos,i.text=null!==r&&void 0!==r?r:i.text,i.font=null!==u&&void 0!==u?u:i.font,i.spriteFont=null!==l&&void 0!==l?l:i.spriteFont,i._text.color=null!==c&&void 0!==c?c:i.color;var h=i.get(qn);return h.anchor=O.Zero,h.use(i._text),i}return(0,k.Z)(n,[{key:"font",get:function(){return this._font},set:function(t){this._font=t,this._text.font=t}},{key:"text",get:function(){return this._text.text},set:function(t){this._text.text=t}},{key:"color",get:function(){return this._text.color},set:function(t){this._text&&(this._text.color=t)}},{key:"opacity",get:function(){return this._text.opacity},set:function(t){this._text.opacity=t}},{key:"spriteFont",get:function(){return this._spriteFont},set:function(t){t&&(this._spriteFont=t,this._text.font=this._spriteFont)}},{key:"_initialize",value:function(t){(0,f.Z)((0,y.Z)(n.prototype),"_initialize",this).call(this,t)}},{key:"getTextWidth",value:function(){return this._text.width}}]),n}(Ei),vo=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t,i,r,o){var a;(0,b.Z)(this,n),(a=e.call(this,[new gn,new qn({offset:null!==r&&void 0!==r?r:O.Zero,onPostDraw:function(t,e){return a.draw(t,e)}}),new br(o)])).solid=!1,a._tileBounds=new q,a._graphics=[],a._colliders=[],a.x=t,a.y=i,a.map=o,a._transform=a.get(gn),a._isometricEntityComponent=a.get(br);var s=a.map.tileWidth/2,l=a.map.tileHeight/2,u=(a.x-a.y)*s,c=(a.x+a.y)*l;a._transform.pos=N(u,c),a._isometricEntityComponent.elevation=0,a._gfx=a.get(qn),a._gfx.visible=!1;var h=a.map.tileWidth,d=a.map.tileHeight,f=N(0,a.map.renderFromTopOfGraphic?d:0);return a._gfx.localBounds=a._tileBounds=new q({left:-h/2,top:-d,right:h/2,bottom:d}).translate(f),a}return(0,k.Z)(n,[{key:"getGraphics",value:function(){return this._graphics}},{key:"addGraphic",value:function(t){this._graphics.push(t),this._gfx.visible=!0,this._gfx.localBounds=this._recalculateBounds()}},{key:"_recalculateBounds",value:function(){var t,e=this._tileBounds.clone(),n=(0,m.Z)(this._graphics);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=N(this.map.graphicsOffset.x-this.map.tileWidth/2,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:i.height-this.map.tileHeight));e=e.combine(i.localBounds.translate(r))}}catch(o){n.e(o)}finally{n.f()}return e}},{key:"removeGraphic",value:function(t){var e=this._graphics.indexOf(t);e>-1&&this._graphics.splice(e,1),this._gfx.localBounds=this._recalculateBounds()}},{key:"clearGraphics",value:function(){this._graphics.length=0,this._gfx.visible=!1,this._gfx.localBounds=this._recalculateBounds()}},{key:"getColliders",value:function(){return this._colliders}},{key:"addCollider",value:function(t){this._colliders.push(t),this.map.flagCollidersDirty()}},{key:"removeCollider",value:function(t){var e=this._colliders.indexOf(t);e>-1&&this._colliders.splice(e,1),this.map.flagCollidersDirty()}},{key:"clearColliders",value:function(){this._colliders.length=0,this.map.flagCollidersDirty()}},{key:"pos",get:function(){return this.map.tileToWorld(N(this.x,this.y))}},{key:"center",get:function(){return this.pos.add(N(0,this.map.tileHeight/2))}},{key:"draw",value:function(t,e){var n=this.map.tileWidth/2;t.save(),t.translate(-n,0);var i,r=(0,m.Z)(this._graphics);try{for(r.s();!(i=r.n()).done;){var o=i.value;o.draw(t,this.map.graphicsOffset.x,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:o.height-this.map.tileHeight))}}catch(a){r.e(a)}finally{r.f()}t.restore()}}]),n}(Vn),go=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;(0,b.Z)(this,n),(i=e.call(this,[new gn,new On({type:je.Fixed}),new Ln,new Mi((function(t){return i.debug(t)}),!1)],t.name)).renderFromTopOfGraphic=!1,i.graphicsOffset=N(0,0),i._collidersDirty=!1,i._originalOffsets=new WeakMap;var o=t.pos,a=t.tileWidth,s=t.tileHeight,l=t.columns,u=t.rows,c=t.renderFromTopOfGraphic,h=t.graphicsOffset;i.transform=i.get(gn),o&&(i.transform.pos=o),i.collider=i.get(Ln),i.collider&&i.collider.set(i._composite=new An([])),i.renderFromTopOfGraphic=null!==c&&void 0!==c?c:i.renderFromTopOfGraphic,i.graphicsOffset=null!==h&&void 0!==h?h:i.graphicsOffset,i.tileWidth=a,i.tileHeight=s,i.columns=l,i.rows=u,i.tiles=new Array(l*u);for(var d=0;d<u;d++)for(var f=0;f<l;f++){var p=new vo(f,d,i.graphicsOffset,(0,r.Z)(i));i.tiles[f+d*l]=p,i.addChild(p)}return i}return(0,k.Z)(n,[{key:"update",value:function(){this._collidersDirty&&(this.updateColliders(),this._collidersDirty=!1)}},{key:"flagCollidersDirty",value:function(){this._collidersDirty=!0}},{key:"_getOrSetColliderOriginalOffset",value:function(t){if(this._originalOffsets.has(t))return this._originalOffsets.get(t);var e=t.offset;return this._originalOffsets.set(t,e),e}},{key:"updateColliders",value:function(){this._composite.clearColliders();var t,e=this.get(gn).pos,n=(0,m.Z)(this.tiles);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.solid){var r,o=(0,m.Z)(i.getColliders());try{for(o.s();!(r=o.n()).done;){var a=r.value,s=this._getOrSetColliderOriginalOffset(a);a.offset=this.tileToWorld(N(i.x,i.y)).sub(e).add(s).sub(N(this.tileWidth/2,this.tileHeight)),a.owner=this,this._composite.addCollider(a)}}catch(l){o.e(l)}finally{o.f()}}}}catch(l){n.e(l)}finally{n.f()}this.collider.update()}},{key:"worldToTile",value:function(t){t=t.sub(this.transform.globalPos);var e=this.tileWidth/2,n=this.tileHeight/2;return N(~~((t.x/e+t.y/n)/2),~~((t.y/n-t.x/e)/2))}},{key:"tileToWorld",value:function(t){var e=this.tileWidth/2,n=this.tileHeight/2;return N((t.x-t.y)*e,(t.x+t.y)*n).add(this.transform.pos)}},{key:"getTile",value:function(t,e){return t<0||e<0||t>=this.columns||e>=this.rows?null:this.tiles[t+e*this.columns]}},{key:"getTileByPoint",value:function(t){var e=this.worldToTile(t);return this.getTile(e.x,e.y)}},{key:"_getMaxZIndex",value:function(){var t,e=Number.NEGATIVE_INFINITY,n=(0,m.Z)(this.tiles);try{for(n.s();!(t=n.n()).done;){var i=t.value.get(gn).z;i>e&&(e=i)}}catch(r){n.e(r)}finally{n.f()}return e}},{key:"debug",value:function(t){t.save(),t.z=this._getMaxZIndex()+.5;for(var e=0;e<this.rows+1;e++){var n=this.tileToWorld(N(0,e)),i=this.tileToWorld(N(this.columns,e));t.drawLine(n,i,X.Red,2)}for(var r=0;r<this.columns+1;r++){var o=this.tileToWorld(N(r,0)),a=this.tileToWorld(N(r,this.rows));t.drawLine(o,a,X.Red,2)}var s,l=(0,m.Z)(this.tiles);try{for(l.s();!(s=l.n()).done;){var u=s.value;t.drawCircle(this.tileToWorld(N(u.x,u.y)),3,X.Yellow)}}catch(c){l.e(c)}finally{l.f()}t.restore()}}]),n}(Vn),yo=function(){function t(e,n){(0,b.Z)(this,t),this._stopped=!1,this._sequenceBuilder=n,this._sequenceContext=new ki(e),this._actionQueue=this._sequenceContext.getQueue(),this._sequenceBuilder(this._sequenceContext)}return(0,k.Z)(t,[{key:"update",value:function(t){this._actionQueue.update(t)}},{key:"isComplete",value:function(){return this._stopped||this._actionQueue.isComplete()}},{key:"stop",value:function(){this._stopped=!0}},{key:"reset",value:function(){this._stopped=!1,this._actionQueue.reset()}},{key:"clone",value:function(e){return new t(e,this._sequenceBuilder)}}]),t}(),mo=function(){function t(e){(0,b.Z)(this,t),this._actions=e}return(0,k.Z)(t,[{key:"update",value:function(t){for(var e=0;e<this._actions.length;e++)this._actions[e].update(t)}},{key:"isComplete",value:function(t){return this._actions.every((function(e){return e.isComplete(t)}))}},{key:"reset",value:function(){this._actions.forEach((function(t){return t.reset()}))}},{key:"stop",value:function(){this._actions.forEach((function(t){return t.stop()}))}}]),t}(),_o=function(){function t(){(0,b.Z)(this,t)}return(0,k.Z)(t,null,[{key:"create",value:function(t,e){if(this._CURRENT_GROUP>this._MAX_GROUPS)throw new Error("Cannot have more than ".concat(this._MAX_GROUPS," collision groups"));if(this._GROUPS.get(t))throw new Error("Collision group ".concat(t," already exists"));var n=new mn(t,this._CURRENT_BIT,void 0!==e?e:~this._CURRENT_BIT);return this._CURRENT_BIT=this._CURRENT_BIT<<1|0,this._CURRENT_GROUP++,this._GROUPS.set(t,n),n}},{key:"groups",get:function(){return Array.from(this._GROUPS.values())}},{key:"groupByName",value:function(t){return this._GROUPS.get(t)}},{key:"reset",value:function(){this._GROUPS=new Map,this._CURRENT_BIT=this._STARTING_BIT,this._CURRENT_GROUP=1}}]),t}();function wo(t){return!!t._initialize}function xo(t){return!!t.onInitialize}function bo(t){return!!t._preupdate}function ko(t){return!!t.onPreUpdate}function Co(t){return!!t.onPostUpdate}function So(t){return!!t.onPostUpdate}function Ao(t){return!!t.onPreDraw}function Eo(t){return!!t.onPostDraw}_o._STARTING_BIT=1,_o._MAX_GROUPS=32,_o._CURRENT_GROUP=1,_o._CURRENT_BIT=_o._STARTING_BIT,_o._GROUPS=new Map;var To=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X.Magenta,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,b.Z)(this,t),this.path=e,this.color=n,this.bustCache=i,this._stream=null,this._gif=null,this._textures=[],this._animation=null,this._transparentColor=null,this._resource=new Vt(e,"arraybuffer",i),this._transparentColor=n}return(0,k.Z)(t,[{key:"load",value:function(){var t=u(s().mark((function t(){var e,n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._resource.load();case 2:return e=t.sent,this._stream=new Zo(e),this._gif=new Mo(this._stream,this._transparentColor),n=this._gif.images.map((function(t){return new Qt(t.src,!1)})),t.next=8,Promise.all(n.map((function(t){return t.load()})));case 8:return t.abrupt("return",this.data=this._textures=n);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"isLoaded",value:function(){return!!this.data}},{key:"toSprite",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._textures[t].toSprite();return e}},{key:"toSpriteSheet",value:function(){var t=this._textures.map((function(t){return t.toSprite()}));return new Jt({sprites:t})}},{key:"toAnimation",value:function(t){var e=this.toSpriteSheet(),n=e.sprites.length;return this._animation=hr.fromSpriteSheet(e,F(0,n),t),this._animation}},{key:"readCheckBytes",get:function(){return this._gif.checkBytes}}]),t}(),Po=function(t){return t.reduce((function(t,e){return 2*t+e}),0)},Io=function(t){for(var e=[],n=7;n>=0;n--)e.push(!!(t&1<<n));return e},Zo=(0,k.Z)((function t(e){var n=this;if((0,b.Z)(this,t),this.data=null,this.len=0,this.position=0,this.readByte=function(){if(n.position>=n.data.byteLength)throw new Error("Attempted to read past end of stream.");return n.data[n.position++]},this.readBytes=function(t){for(var e=[],i=0;i<t;i++)e.push(n.readByte());return e},this.read=function(t){for(var e="",i=0;i<t;i++)e+=String.fromCharCode(n.readByte());return e},this.readUnsigned=function(){var t=n.readBytes(2);return(t[1]<<8)+t[0]},this.data=new Uint8Array(e),this.len=this.data.byteLength,0===this.len)throw new Error("No data loaded from file")})),Ro=function(t,e){for(var n,i,r=0,o=function(t){for(var n=0,i=0;i<t;i++)e.charCodeAt(r>>3)&1<<(7&r)&&(n|=1<<i),r++;return n},a=[],s=1<<t,l=s+1,u=t+1,c=[],h=function(){c=[],u=t+1;for(var e=0;e<s;e++)c[e]=[e];c[s]=[],c[l]=null};;)if(i=n,(n=o(u))!==s){if(n===l)break;if(n<c.length)i!==s&&c.push(c[i].concat(c[n][0]));else{if(n!==c.length)throw new Error("Invalid LZW code.");c.push(c[i].concat(c[i][0]))}a.push.apply(a,c[n]),c.length===1<<u&&u<12&&u++}else h();return a},Mo=(0,k.Z)((function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X.Magenta;(0,b.Z)(this,t),this._st=null,this._handler={},this._transparentColor=null,this.frames=[],this.images=[],this.globalColorTable=[],this.checkBytes=[],this.parseColorTable=function(t){for(var e=[],i=0;i<t;i++){var r="#"+n._st.readBytes(3).map((function(t){var e=t.toString(16);return 1===e.length?"0"+e:e})).join("");e.push(r)}return e},this.readSubBlocks=function(){var t,e;e="";do{t=n._st.readByte(),e+=n._st.read(t)}while(0!==t);return e},this.parseHeader=function(){var t={sig:null,ver:null,width:null,height:null,colorRes:null,globalColorTableSize:null,gctFlag:null,sorted:null,globalColorTable:[],bgColor:null,pixelAspectRatio:null};if(t.sig=n._st.read(3),t.ver=n._st.read(3),"GIF"!==t.sig)throw new Error("Not a GIF file.");t.width=n._st.readUnsigned(),t.height=n._st.readUnsigned();var e=Io(n._st.readByte());t.gctFlag=e.shift(),t.colorRes=Po(e.splice(0,3)),t.sorted=e.shift(),t.globalColorTableSize=Po(e.splice(0,3)),t.bgColor=n._st.readByte(),t.pixelAspectRatio=n._st.readByte(),t.gctFlag&&(t.globalColorTable=n.parseColorTable(1<<t.globalColorTableSize+1),n.globalColorTable=t.globalColorTable),n._handler.hdr&&n._handler.hdr(t)&&n.checkBytes.push(n._handler.hdr)},this.parseExt=function(t){switch(t.label=n._st.readByte(),t.label){case 249:t.extType="gce",function(t){n.checkBytes.push(n._st.readByte());var e=Io(n._st.readByte());t.reserved=e.splice(0,3),t.disposalMethod=Po(e.splice(0,3)),t.userInput=e.shift(),t.transparencyGiven=e.shift(),t.delayTime=n._st.readUnsigned(),t.transparencyIndex=n._st.readByte(),t.terminator=n._st.readByte(),n._handler.gce&&n._handler.gce(t)&&n.checkBytes.push(n._handler.gce)}(t);break;case 254:t.extType="com",function(t){t.comment=n.readSubBlocks(),n._handler.com&&n._handler.com(t)&&n.checkBytes.push(n._handler.com)}(t);break;case 1:t.extType="pte",function(t){n.checkBytes.push(n._st.readByte()),t.ptHeader=n._st.readBytes(12),t.ptData=n.readSubBlocks(),n._handler.pte&&n._handler.pte(t)&&n.checkBytes.push(n._handler.pte)}(t);break;case 255:t.extType="app",function(t){n.checkBytes.push(n._st.readByte()),t.identifier=n._st.read(8),t.authCode=n._st.read(3),"NETSCAPE"===t.identifier?function(t){n.checkBytes.push(n._st.readByte()),t.unknown=n._st.readByte(),t.iterations=n._st.readUnsigned(),t.terminator=n._st.readByte(),n._handler.app&&n._handler.app.NETSCAPE&&n._handler.app.NETSCAPE(t)&&n.checkBytes.push(n._handler.app)}(t):function(t){t.appData=n.readSubBlocks(),n._handler.app&&n._handler.app[t.identifier]&&n._handler.app[t.identifier](t)&&n.checkBytes.push(n._handler.app[t.identifier])}(t)}(t);break;default:t.extType="unknown",function(t){t.data=n.readSubBlocks(),n._handler.unknown&&n._handler.unknown(t)&&n.checkBytes.push(n._handler.unknown)}(t)}},this.parseImg=function(t){t.leftPos=n._st.readUnsigned(),t.topPos=n._st.readUnsigned(),t.width=n._st.readUnsigned(),t.height=n._st.readUnsigned();var e=Io(n._st.readByte());t.lctFlag=e.shift(),t.interlaced=e.shift(),t.sorted=e.shift(),t.reserved=e.splice(0,2),t.lctSize=Po(e.splice(0,3)),t.lctFlag&&(t.lct=n.parseColorTable(1<<t.lctSize+1)),t.lzwMinCodeSize=n._st.readByte();var i=n.readSubBlocks();t.pixels=Ro(t.lzwMinCodeSize,i),t.interlaced&&(t.pixels=function(t,e){for(var n=new Array(t.length),i=t.length/e,r=function(i,r){var o=t.slice(r*e,(r+1)*e);n.splice.apply(n,[i*e,e].concat(o))},o=[0,4,2,1],a=[8,8,4,2],s=0,l=0;l<4;l++)for(var u=o[l];u<i;u+=a[l])r(u,s),s++;return n}(t.pixels,t.width)),n.frames.push(t),n.arrayToImage(t),n._handler.img&&n._handler.img(t)&&n.checkBytes.push(n._handler)},this.parseBlock=function(){var t={sentinel:n._st.readByte(),type:""};switch(String.fromCharCode(t.sentinel)){case"!":t.type="ext",n.parseExt(t);break;case",":t.type="img",n.parseImg(t);break;case";":t.type="eof",n._handler.eof&&n._handler.eof(t)&&n.checkBytes.push(n._handler.eof);break;default:throw new Error("Unknown block: 0x"+t.sentinel.toString(16))}"eof"!==t.type&&n.parseBlock()},this.arrayToImage=function(t){var e=0,i=document.createElement("canvas");i.id=e.toString(),i.width=t.width,i.height=t.height,e++;for(var r=i.getContext("2d"),o=0,a=0,s=0;s<t.pixels.length;s++)a%t.width===0&&(o++,a=0),n.globalColorTable[t.pixels[s]]===n._transparentColor.toHex()?r.fillStyle="rgba(0, 0, 0, 0)":r.fillStyle=n.globalColorTable[t.pixels[s]],r.fillRect(a,o,1,1),a++;var l=new Image;l.src=i.toDataURL(),n.images.push(l)},this._st=e,this._handler={},this._transparentColor=i,this.parseHeader(),this.parseBlock()})),Fo=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;(0,b.Z)(this,n),(i=e.call(this)).color=X.Black,i.thickness=1;var r=t.start,o=t.end,a=t.color,s=t.thickness;i.start=r,i.end=o,i.color=null!==a&&void 0!==a?a:i.color,i.thickness=null!==s&&void 0!==s?s:i.thickness;var l=q.fromPoints([r,o]),u=l.width,c=l.height;return i.width=u,i.height=c,i}return(0,k.Z)(n,[{key:"_drawImage",value:function(t,e,n){t.drawLine(this.start,this.end,this.color,this.thickness)}},{key:"clone",value:function(){return new n({start:this.start,end:this.end,color:this.color,thickness:this.thickness})}}]),n}(jt),Do=function(t){(0,_.Z)(n,t);var e=(0,w.Z)(n);function n(t){var i;return(0,b.Z)(this,n),(i=e.call(this,t)).points=t.points,i.filtering=qt.Blended,i.rasterize(),i}return(0,k.Z)(n,[{key:"points",get:function(){return this._points},set:function(t){this._points=t;var e=this.minPoint;this.width=this._points.reduce((function(t,e){return Math.max(e.x,t)}),0)-e.x,this.height=this._points.reduce((function(t,e){return Math.max(e.y,t)}),0)-e.y,this.flagDirty()}},{key:"minPoint",get:function(){return N(this._points.reduce((function(t,e){return Math.min(e.x,t)}),1/0),this._points.reduce((function(t,e){return Math.min(e.y,t)}),1/0))}},{key:"clone",value:function(){return new n(d(d({points:this.points.map((function(t){return t.clone()}))},this.cloneGraphicOptions()),this.cloneRasterOptions()))}},{key:"execute",value:function(t){if(this.points&&this.points.length){t.beginPath();var e=this.minPoint.negate(),n=this.points[0].add(e);t.moveTo(n.x,n.y),this.points.forEach((function(n){t.lineTo(n.x+e.x,n.y+e.y)})),t.lineTo(n.x,n.y),t.closePath(),this.color&&t.fill(),this.strokeColor&&t.stroke()}}}]),n}(Le),Bo=function(){function t(){(0,b.Z)(this,t),this._queue=[]}return(0,k.Z)(t,[{key:"length",get:function(){return this._queue.length}},{key:"enqueue",value:function(){var t=new Y;return this._queue.push(t),t.promise}},{key:"dequeue",value:function(t){this._queue.shift().resolve(t)}}]),t}(),zo=function(){function t(e){(0,b.Z)(this,t),this._count=e,this._waitQueue=new Bo}return(0,k.Z)(t,[{key:"count",get:function(){return this._count}},{key:"waiting",get:function(){return this._waitQueue.length}},{key:"enter",value:function(){var t=u(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0===this._count){t.next=3;break}return this._count--,t.abrupt("return",Promise.resolve());case 3:return t.abrupt("return",this._waitQueue.enqueue());case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"exit",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(0!==t){for(;0!==t&&0!==this._waitQueue.length;)this._waitQueue.dequeue(null),t--;this._count+=t}}}]),t}(),Lo="0.27.0";h()}();var E=e.fWn,T=e.Ia8,P=e.rqv,I=e.hLI,Z=e.yyv,R=e.tX5,M=e.vtX,F=e.r7K,D=e.lCh,B=e.cE4,z=e.fwF,L=e.sce,O=e._c7,N=e.KUs,U=e.Ajp,H=e.RDh,W=e._H9,V=e.mxs,X=e.OmD,G=e.kBf,j=e.C4F,q=e.NQt,Y=e.JjN,K=e.V1s,Q=e.Xz7,J=e.Cdc,$=e.FKn,tt=e.wTW,et=e.SUY,nt=e.ab2,it=e.GfZ,rt=e.YMS,ot=e.oyv,at=e.aUb,st=e.SdD,lt=e.JUv,ut=e.jEj,ct=e.TFq,ht=e.HDU,dt=e.R_y,ft=e.ydN,pt=e.t50,vt=e.s$$,gt=e.v2G,yt=e.Ilk,mt=e.s9i,_t=e.dxL,wt=e.LLX,xt=e.wA2,bt=e.R_p,kt=e.IQ$,Ct=e.I5F,St=e.X8$,At=e.FR6,Et=e.U8o,Tt=e.kbG,Pt=e.iS_,It=e.cGG,Zt=e.RPN,Rt=e.skb,Mt=e.SLU,Ft=e.RdJ,Dt=e.cNu,Bt=e.gU7,zt=e.LSk,Lt=e.Nmp,Ot=e.d1Y,Nt=e.xrL,Ut=e.sRW,Ht=e.cmV,Wt=e.qWz,Vt=e.N0Q,Xt=e.q8b,Gt=e.ynB,jt=e.jT9,qt=e.wAz,Yt=e.D4V,Kt=e.N6H,Qt=e.W1A,Jt=e.JHW,$t=e.v2K,te=e.pBf,ee=e.GMl,ne=e.zW2,ie=e.B0K,re=e.Nv7,oe=e.C_p,ae=e.iqw,se=e.MUA,le=e.xqU,ue=e.pTp,ce=e.vUK,he=e.j9l,de=e.Zxw,fe=e.Hdx,pe=e.Z$d,ve=e.iqV,ge=e.o$7,ye=e.olM,me=e.Zm$,_e=e.$QH,we=e.i78,xe=e.h6u,be=e.hts,ke=e.j88,Ce=e.VME,Se=e.nt,Ae=e.Ukr,Ee=e.zsu,Te=e.oA6,Pe=e.TVh,Ie=e.TwZ,Ze=e.GTT,Re=e.xxj,Me=e.XdK,Fe=e.Jmb,De=e.cXo,Be=e.Dm5,ze=e.IIB,Le=e.zI0,Oe=e.LYD,Ne=e.cEG,Ue=e.SEl,He=e.t9V,We=e.SKZ,Ve=e.__J,Xe=e.RI$,Ge=e.x12,je=e.ccz,qe=e.aNw,Ye=e.xwn,Ke=e.dNK,Qe=e.ini,Je=e.YdH,$e=e.y3G,tn=e.l57,en=e.xn0,nn=e.t2V,rn=e.uxB,on=e.cpd,an=e.fiy,sn=e.$XZ,ln=e.uqK,un=e.STE,cn=e.y$z,hn=e.mAD,dn=e.sOq,fn=e.hUw,pn=e._0G,vn=e.Sqs,gn=e.hpZ,yn=e.Vol,mn=e.wIZ,_n=e.cBi,wn=e.RFv,xn=e.kfC,bn=e.mgq,kn=e.YVA,Cn=e.Kgp,Sn=e.HH$,An=e.M_d,En=e.rgh,Tn=e.Ra6,Pn=e.KhR,In=e.BS5,Zn=e.xhz,Rn=e.xOq,Mn=e.a9j,Fn=e.bHk,Dn=e.CgK,Bn=e.cuY,zn=e.kvE,Ln=e.SBu,On=e.AE_,Nn=e.ctO,Un=e.OLH,Hn=e.kky,Wn=e.nSF,Vn=e.zHn,Xn=e.zwx,Gn=e.AeJ,jn=e.hLz,qn=e.D9g,Yn=e.wA,Kn=e.jhr,Qn=e.GVs,Jn=e._zO,$n=e.w6$,ti=e.mhV,ei=e.MOD,ni=e.kwd,ii=e.Lmr,ri=e.xsS,oi=e.lLr,ai=e.Z$r,si=e.IXb,li=e.SGH,ui=e.SMj,ci=e.L34,hi=e.exe,di=e.bnF,fi=e.MFA,pi=e.$uU,vi=e.jyi,gi=e.E03,yi=e.V6q,mi=e.rg2,_i=e.DVW,wi=e.nVo,xi=e.F6N,bi=e.xP7,ki=e.Odq,Ci=e.Zif,Si=e.ZGJ,Ai=e.MJk,Ei=e.xvT,Ti=e.PHM,Pi=e.dpR,Ii=e.n9L,Zi=e.KwO,Ri=e.B7y,Mi=e.x7r,Fi=e.wx7,Di=e.Uvn,Bi=e.OFT,zi=e.xzN,Li=e.M5Z,Oi=e.ZrN,Ni=e.OWs,Ui=e.dF9,Hi=e.oZy,Wi=e.rD2,Vi=e.VHo,Xi=e.ohE,Gi=e.R$E,ji=e.q3I,qi=e.Pab,Yi=e.uZ5,Ki=e.McK,Qi=e.F9c,Ji=e.k0b,$i=e.hnT,tr=e.RSJ,er=e.Mku,nr=e.h90,ir=e.rms,rr=e.ErP,or=e.aVg,ar=e.lPc,sr=e.Z8E,lr=e._N2,ur=e.yFn,cr=e.lNv,hr=e.cu9,dr=e.MZQ,fr=e.FUM,pr=e.BxR,vr=e.vdf,gr=e.iaL,yr=e.w6H,mr=e.Q4c,_r=e.Xxe,wr=e.Uxb,xr=e.Yr5,br=e.Bhw,kr=e.yOA},463:function(t,e,n){"use strict";var i=n(791),r=n(296);function o(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function l(t,e){u(t,e),u(t+"Capture",e)}function u(t,e){for(s[t]=e,t=0;t<e.length;t++)a.add(e[t])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function v(t,e,n,i,r,o,a){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){g[t]=new v(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];g[e]=new v(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){g[t]=new v(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){g[t]=new v(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){g[t]=new v(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){g[t]=new v(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){g[t]=new v(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){g[t]=new v(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){g[t]=new v(t,5,!1,t.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function m(t){return t[1].toUpperCase()}function _(t,e,n,i){var r=g.hasOwnProperty(e)?g[e]:null;(null!==r?0!==r.type:i||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,i){if(null===e||"undefined"===typeof e||function(t,e,n,i){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,r,i)&&(n=null),i||null===r?function(t){return!!h.call(p,t)||!h.call(f,t)&&(d.test(t)?p[t]=!0:(f[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=null===n?3!==r.type&&"":n:(e=r.attributeName,i=r.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(y,m);g[e]=new v(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(y,m);g[e]=new v(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(y,m);g[e]=new v(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){g[t]=new v(t,1,!1,t.toLowerCase(),null,!1,!1)})),g.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){g[t]=new v(t,1,!1,t.toLowerCase(),null,!0,!0)}));var w=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),b=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),E=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),Z=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var F=Symbol.iterator;function D(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=F&&t[F]||t["@@iterator"])?t:null}var B,z=Object.assign;function L(t){if(void 0===B)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);B=e&&e[1]||""}return"\n"+B+t}var O=!1;function N(t,e){if(!t||O)return"";O=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){i=u}t.call(e.prototype)}else{try{throw Error()}catch(u){i=u}t()}}catch(u){if(u&&i&&"string"===typeof u.stack){for(var r=u.stack.split("\n"),o=i.stack.split("\n"),a=r.length-1,s=o.length-1;1<=a&&0<=s&&r[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(r[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||r[a]!==o[s]){var l="\n"+r[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=a&&0<=s);break}}}finally{O=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?L(t):""}function U(t){switch(t.tag){case 5:return L(t.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return t=N(t.type,!1);case 11:return t=N(t.type.render,!1);case 1:return t=N(t.type,!0);default:return""}}function H(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case k:return"Fragment";case b:return"Portal";case S:return"Profiler";case C:return"StrictMode";case P:return"Suspense";case I:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case E:return(t.displayName||"Context")+".Consumer";case A:return(t._context.displayName||"Context")+".Provider";case T:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case Z:return null!==(e=t.displayName||null)?e:H(t.type)||"Memo";case R:e=t._payload,t=t._init;try{return H(t(e))}catch(n){}}return null}function W(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(e);case 8:return e===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function V(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function X(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function G(t){t._valueTracker||(t._valueTracker=function(t){var e=X(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){i=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function j(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=X(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function q(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Y(t,e){var n=e.checked;return z({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function K(t,e){var n=null==e.defaultValue?"":e.defaultValue,i=null!=e.checked?e.checked:e.defaultChecked;n=V(null!=e.value?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function Q(t,e){null!=(e=e.checked)&&_(t,"checked",e,!1)}function J(t,e){Q(t,e);var n=V(e.value),i=e.type;if(null!=n)"number"===i?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===i||"reset"===i)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,V(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function $(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!("submit"!==i&&"reset"!==i||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&q(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+V(n),e=null,r=0;r<t.length;r++){if(t[r].value===n)return t[r].selected=!0,void(i&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function it(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(o(91));return z({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function rt(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(o(92));if(et(n)){if(1<n.length)throw Error(o(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:V(n)}}function ot(t,e){var n=V(e.value),i=V(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=i&&(t.defaultValue=""+i)}function at(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function st(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?st(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ut,ct,ht=(ct=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ut=ut||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ut.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,i){MSApp.execUnsafeLocalFunction((function(){return ct(t,e)}))}:ct);function dt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var ft={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pt=["Webkit","ms","Moz","O"];function vt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||ft.hasOwnProperty(t)&&ft[t]?(""+e).trim():e+"px"}function gt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=vt(n,e[n],i);"float"===n&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}Object.keys(ft).forEach((function(t){pt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ft[e]=ft[t]}))}));var yt=z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mt(t,e){if(e){if(yt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(o(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(o(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(o(62))}}function _t(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wt=null;function xt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var bt=null,kt=null,Ct=null;function St(t){if(t=_r(t)){if("function"!==typeof bt)throw Error(o(280));var e=t.stateNode;e&&(e=xr(e),bt(t.stateNode,t.type,e))}}function At(t){kt?Ct?Ct.push(t):Ct=[t]:kt=t}function Et(){if(kt){var t=kt,e=Ct;if(Ct=kt=null,St(t),e)for(t=0;t<e.length;t++)St(e[t])}}function Tt(t,e){return t(e)}function Pt(){}var It=!1;function Zt(t,e,n){if(It)return t(e,n);It=!0;try{return Tt(t,e,n)}finally{It=!1,(null!==kt||null!==Ct)&&(Pt(),Et())}}function Rt(t,e){var n=t.stateNode;if(null===n)return null;var i=xr(n);if(null===i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(o(231,e,typeof n));return n}var Mt=!1;if(c)try{var Ft={};Object.defineProperty(Ft,"passive",{get:function(){Mt=!0}}),window.addEventListener("test",Ft,Ft),window.removeEventListener("test",Ft,Ft)}catch(ct){Mt=!1}function Dt(t,e,n,i,r,o,a,s,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var Bt=!1,zt=null,Lt=!1,Ot=null,Nt={onError:function(t){Bt=!0,zt=t}};function Ut(t,e,n,i,r,o,a,s,l){Bt=!1,zt=null,Dt.apply(Nt,arguments)}function Ht(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Wt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Vt(t){if(Ht(t)!==t)throw Error(o(188))}function Xt(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Ht(t)))throw Error(o(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(i=r.return)){n=i;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return Vt(r),t;if(a===i)return Vt(r),e;a=a.sibling}throw Error(o(188))}if(n.return!==i.return)n=r,i=a;else{for(var s=!1,l=r.child;l;){if(l===n){s=!0,n=r,i=a;break}if(l===i){s=!0,i=r,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,i=r;break}if(l===i){s=!0,i=a,n=r;break}l=l.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==i)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?t:e}(t))?Gt(t):null}function Gt(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=Gt(t);if(null!==e)return e;t=t.sibling}return null}var jt=r.unstable_scheduleCallback,qt=r.unstable_cancelCallback,Yt=r.unstable_shouldYield,Kt=r.unstable_requestPaint,Qt=r.unstable_now,Jt=r.unstable_getCurrentPriorityLevel,$t=r.unstable_ImmediatePriority,te=r.unstable_UserBlockingPriority,ee=r.unstable_NormalPriority,ne=r.unstable_LowPriority,ie=r.unstable_IdlePriority,re=null,oe=null;var ae=Math.clz32?Math.clz32:function(t){return 0===(t>>>=0)?32:31-(se(t)/le|0)|0},se=Math.log,le=Math.LN2;var ue=64,ce=4194304;function he(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function de(t,e){var n=t.pendingLanes;if(0===n)return 0;var i=0,r=t.suspendedLanes,o=t.pingedLanes,a=268435455&n;if(0!==a){var s=a&~r;0!==s?i=he(s):0!==(o&=a)&&(i=he(o))}else 0!==(a=n&~r)?i=he(a):0!==o&&(i=he(o));if(0===i)return 0;if(0!==e&&e!==i&&0===(e&r)&&((r=i&-i)>=(o=e&-e)||16===r&&0!==(4194240&o)))return e;if(0!==(4&i)&&(i|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=i;0<e;)r=1<<(n=31-ae(e)),i|=t[n],e&=~r;return i}function fe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function pe(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function ve(){var t=ue;return 0===(4194240&(ue<<=1))&&(ue=64),t}function ge(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ye(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-ae(e)]=n}function me(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-ae(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var _e=0;function we(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var xe,be,ke,Ce,Se,Ae=!1,Ee=[],Te=null,Pe=null,Ie=null,Ze=new Map,Re=new Map,Me=[],Fe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function De(t,e){switch(t){case"focusin":case"focusout":Te=null;break;case"dragenter":case"dragleave":Pe=null;break;case"mouseover":case"mouseout":Ie=null;break;case"pointerover":case"pointerout":Ze.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Re.delete(e.pointerId)}}function Be(t,e,n,i,r,o){return null===t||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},null!==e&&(null!==(e=_r(e))&&be(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,null!==r&&-1===e.indexOf(r)&&e.push(r),t)}function ze(t){var e=mr(t.target);if(null!==e){var n=Ht(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Wt(n)))return t.blockedOn=e,void Se(t.priority,(function(){ke(n)}))}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Le(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ye(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=_r(n))&&be(e),t.blockedOn=n,!1;var i=new(n=t.nativeEvent).constructor(n.type,n);wt=i,n.target.dispatchEvent(i),wt=null,e.shift()}return!0}function Oe(t,e,n){Le(t)&&n.delete(e)}function Ne(){Ae=!1,null!==Te&&Le(Te)&&(Te=null),null!==Pe&&Le(Pe)&&(Pe=null),null!==Ie&&Le(Ie)&&(Ie=null),Ze.forEach(Oe),Re.forEach(Oe)}function Ue(t,e){t.blockedOn===e&&(t.blockedOn=null,Ae||(Ae=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ne)))}function He(t){function e(e){return Ue(e,t)}if(0<Ee.length){Ue(Ee[0],t);for(var n=1;n<Ee.length;n++){var i=Ee[n];i.blockedOn===t&&(i.blockedOn=null)}}for(null!==Te&&Ue(Te,t),null!==Pe&&Ue(Pe,t),null!==Ie&&Ue(Ie,t),Ze.forEach(e),Re.forEach(e),n=0;n<Me.length;n++)(i=Me[n]).blockedOn===t&&(i.blockedOn=null);for(;0<Me.length&&null===(n=Me[0]).blockedOn;)ze(n),null===n.blockedOn&&Me.shift()}var We=w.ReactCurrentBatchConfig,Ve=!0;function Xe(t,e,n,i){var r=_e,o=We.transition;We.transition=null;try{_e=1,je(t,e,n,i)}finally{_e=r,We.transition=o}}function Ge(t,e,n,i){var r=_e,o=We.transition;We.transition=null;try{_e=4,je(t,e,n,i)}finally{_e=r,We.transition=o}}function je(t,e,n,i){if(Ve){var r=Ye(t,e,n,i);if(null===r)Vi(t,e,i,qe,n),De(t,i);else if(function(t,e,n,i,r){switch(e){case"focusin":return Te=Be(Te,t,e,n,i,r),!0;case"dragenter":return Pe=Be(Pe,t,e,n,i,r),!0;case"mouseover":return Ie=Be(Ie,t,e,n,i,r),!0;case"pointerover":var o=r.pointerId;return Ze.set(o,Be(Ze.get(o)||null,t,e,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,Re.set(o,Be(Re.get(o)||null,t,e,n,i,r)),!0}return!1}(r,t,e,n,i))i.stopPropagation();else if(De(t,i),4&e&&-1<Fe.indexOf(t)){for(;null!==r;){var o=_r(r);if(null!==o&&xe(o),null===(o=Ye(t,e,n,i))&&Vi(t,e,i,qe,n),o===r)break;r=o}null!==r&&i.stopPropagation()}else Vi(t,e,i,null,n)}}var qe=null;function Ye(t,e,n,i){if(qe=null,null!==(t=mr(t=xt(i))))if(null===(e=Ht(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=Wt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return qe=t,null}function Ke(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Jt()){case $t:return 1;case te:return 4;case ee:case ne:return 16;case ie:return 536870912;default:return 16}default:return 16}}var Qe=null,Je=null,$e=null;function tn(){if($e)return $e;var t,e,n=Je,i=n.length,r="value"in Qe?Qe.value:Qe.textContent,o=r.length;for(t=0;t<i&&n[t]===r[t];t++);var a=i-t;for(e=1;e<=a&&n[i-e]===r[o-e];e++);return $e=r.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function rn(){return!1}function on(t){function e(e,n,i,r,o){for(var a in this._reactName=e,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,t)t.hasOwnProperty(a)&&(e=t[a],this[a]=e?e(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return z(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var an,sn,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=on(un),hn=z({},un,{view:0,detail:0}),dn=on(hn),fn=z({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ln&&(ln&&"mousemove"===t.type?(an=t.screenX-ln.screenX,sn=t.screenY-ln.screenY):sn=an=0,ln=t),an)},movementY:function(t){return"movementY"in t?t.movementY:sn}}),pn=on(fn),vn=on(z({},fn,{dataTransfer:0})),gn=on(z({},hn,{relatedTarget:0})),yn=on(z({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),mn=z({},un,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_n=on(mn),wn=on(z({},un,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=kn[t])&&!!e[t]}function Sn(){return Cn}var An=z({},hn,{key:function(t){if(t.key){var e=xn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?bn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),En=on(An),Tn=on(z({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=on(z({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),In=on(z({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Zn=z({},fn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=on(Zn),Mn=[9,13,27,32],Fn=c&&"CompositionEvent"in window,Dn=null;c&&"documentMode"in document&&(Dn=document.documentMode);var Bn=c&&"TextEvent"in window&&!Dn,zn=c&&(!Fn||Dn&&8<Dn&&11>=Dn),Ln=String.fromCharCode(32),On=!1;function Nn(t,e){switch(t){case"keyup":return-1!==Mn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Hn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Wn[t.type]:"textarea"===e}function Xn(t,e,n,i){At(i),0<(e=Gi(e,"onChange")).length&&(n=new cn("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Gn=null,jn=null;function qn(t){Li(t,0)}function Yn(t){if(j(wr(t)))return t}function Kn(t,e){if("change"===t)return e}var Qn=!1;if(c){var Jn;if(c){var $n="oninput"in document;if(!$n){var ti=document.createElement("div");ti.setAttribute("oninput","return;"),$n="function"===typeof ti.oninput}Jn=$n}else Jn=!1;Qn=Jn&&(!document.documentMode||9<document.documentMode)}function ei(){Gn&&(Gn.detachEvent("onpropertychange",ni),jn=Gn=null)}function ni(t){if("value"===t.propertyName&&Yn(jn)){var e=[];Xn(e,jn,t,xt(t)),Zt(qn,e)}}function ii(t,e,n){"focusin"===t?(ei(),jn=n,(Gn=e).attachEvent("onpropertychange",ni)):"focusout"===t&&ei()}function ri(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Yn(jn)}function oi(t,e){if("click"===t)return Yn(e)}function ai(t,e){if("input"===t||"change"===t)return Yn(e)}var si="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function li(t,e){if(si(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(e,r)||!si(t[r],e[r]))return!1}return!0}function ui(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ci(t,e){var n,i=ui(t);for(t=0;i;){if(3===i.nodeType){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=ui(i)}}function hi(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?hi(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function di(){for(var t=window,e=q();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(i){n=!1}if(!n)break;e=q((t=e.contentWindow).document)}return e}function fi(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function pi(t){var e=di(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&fi(n))if(e=i.start,void 0===(t=i.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var r=n.textContent.length,o=Math.min(i.start,r);i=void 0===i.end?o:Math.min(i.end,r),!t.extend&&o>i&&(r=i,i=o,o=r),r=ci(n,o);var a=ci(n,i);r&&a&&(1!==t.rangeCount||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&((e=e.createRange()).setStart(r.node,r.offset),t.removeAllRanges(),o>i?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var vi=c&&"documentMode"in document&&11>=document.documentMode,gi=null,yi=null,mi=null,_i=!1;function wi(t,e,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_i||null==gi||gi!==q(i)||("selectionStart"in(i=gi)&&fi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},mi&&li(mi,i)||(mi=i,0<(i=Gi(yi,"onSelect")).length&&(e=new cn("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=gi)))}function xi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var bi={animationend:xi("Animation","AnimationEnd"),animationiteration:xi("Animation","AnimationIteration"),animationstart:xi("Animation","AnimationStart"),transitionend:xi("Transition","TransitionEnd")},ki={},Ci={};function Si(t){if(ki[t])return ki[t];if(!bi[t])return t;var e,n=bi[t];for(e in n)if(n.hasOwnProperty(e)&&e in Ci)return ki[t]=n[e];return t}c&&(Ci=document.createElement("div").style,"AnimationEvent"in window||(delete bi.animationend.animation,delete bi.animationiteration.animation,delete bi.animationstart.animation),"TransitionEvent"in window||delete bi.transitionend.transition);var Ai=Si("animationend"),Ei=Si("animationiteration"),Ti=Si("animationstart"),Pi=Si("transitionend"),Ii=new Map,Zi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ri(t,e){Ii.set(t,e),l(e,[t])}for(var Mi=0;Mi<Zi.length;Mi++){var Fi=Zi[Mi];Ri(Fi.toLowerCase(),"on"+(Fi[0].toUpperCase()+Fi.slice(1)))}Ri(Ai,"onAnimationEnd"),Ri(Ei,"onAnimationIteration"),Ri(Ti,"onAnimationStart"),Ri("dblclick","onDoubleClick"),Ri("focusin","onFocus"),Ri("focusout","onBlur"),Ri(Pi,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Di="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bi=new Set("cancel close invalid load scroll toggle".split(" ").concat(Di));function zi(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,i,r,a,s,l,u){if(Ut.apply(this,arguments),Bt){if(!Bt)throw Error(o(198));var c=zt;Bt=!1,zt=null,Lt||(Lt=!0,Ot=c)}}(i,e,void 0,t),t.currentTarget=null}function Li(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;t:{var o=void 0;if(e)for(var a=i.length-1;0<=a;a--){var s=i[a],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==o&&r.isPropagationStopped())break t;zi(r,s,u),o=l}else for(a=0;a<i.length;a++){if(l=(s=i[a]).instance,u=s.currentTarget,s=s.listener,l!==o&&r.isPropagationStopped())break t;zi(r,s,u),o=l}}}if(Lt)throw t=Ot,Lt=!1,Ot=null,t}function Oi(t,e){var n=e[vr];void 0===n&&(n=e[vr]=new Set);var i=t+"__bubble";n.has(i)||(Wi(e,t,2,!1),n.add(i))}function Ni(t,e,n){var i=0;e&&(i|=4),Wi(n,t,i,e)}var Ui="_reactListening"+Math.random().toString(36).slice(2);function Hi(t){if(!t[Ui]){t[Ui]=!0,a.forEach((function(e){"selectionchange"!==e&&(Bi.has(e)||Ni(e,!1,t),Ni(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Ui]||(e[Ui]=!0,Ni("selectionchange",!1,e))}}function Wi(t,e,n,i){switch(Ke(e)){case 1:var r=Xe;break;case 4:r=Ge;break;default:r=je}n=r.bind(null,e,n,t),r=void 0,!Mt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(r=!0),i?void 0!==r?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):void 0!==r?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Vi(t,e,n,i,r){var o=i;if(0===(1&e)&&0===(2&e)&&null!==i)t:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var s=i.stateNode.containerInfo;if(s===r||8===s.nodeType&&s.parentNode===r)break;if(4===a)for(a=i.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;a=a.return}for(;null!==s;){if(null===(a=mr(s)))return;if(5===(l=a.tag)||6===l){i=o=a;continue t}s=s.parentNode}}i=i.return}Zt((function(){var i=o,r=xt(n),a=[];t:{var s=Ii.get(t);if(void 0!==s){var l=cn,u=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":l=En;break;case"focusin":u="focus",l=gn;break;case"focusout":u="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Pn;break;case Ai:case Ei:case Ti:l=yn;break;case Pi:l=In;break;case"scroll":l=dn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=_n;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var c=0!==(4&e),h=!c&&"scroll"===t,d=c?null!==s?s+"Capture":null:s;c=[];for(var f,p=i;null!==p;){var v=(f=p).stateNode;if(5===f.tag&&null!==v&&(f=v,null!==d&&(null!=(v=Rt(p,d))&&c.push(Xi(p,v,f)))),h)break;p=p.return}0<c.length&&(s=new l(s,u,null,n,r),a.push({event:s,listeners:c}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(s="mouseover"===t||"pointerover"===t)||n===wt||!(u=n.relatedTarget||n.fromElement)||!mr(u)&&!u[pr])&&(l||s)&&(s=r.window===r?r:(s=r.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=i,null!==(u=(u=n.relatedTarget||n.toElement)?mr(u):null)&&(u!==(h=Ht(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=i),l!==u)){if(c=pn,v="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==t&&"pointerover"!==t||(c=Tn,v="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?s:wr(l),f=null==u?s:wr(u),(s=new c(v,p+"leave",l,n,r)).target=h,s.relatedTarget=f,v=null,mr(r)===i&&((c=new c(d,p+"enter",u,n,r)).target=f,c.relatedTarget=h,v=c),h=v,l&&u)t:{for(d=u,p=0,f=c=l;f;f=ji(f))p++;for(f=0,v=d;v;v=ji(v))f++;for(;0<p-f;)c=ji(c),p--;for(;0<f-p;)d=ji(d),f--;for(;p--;){if(c===d||null!==d&&c===d.alternate)break t;c=ji(c),d=ji(d)}c=null}else c=null;null!==l&&qi(a,s,l,c,!1),null!==u&&null!==h&&qi(a,h,u,c,!0)}if("select"===(l=(s=i?wr(i):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Kn;else if(Vn(s))if(Qn)g=ai;else{g=ri;var y=ii}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=oi);switch(g&&(g=g(t,i))?Xn(a,g,n,r):(y&&y(t,s,i),"focusout"===t&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&tt(s,"number",s.value)),y=i?wr(i):window,t){case"focusin":(Vn(y)||"true"===y.contentEditable)&&(gi=y,yi=i,mi=null);break;case"focusout":mi=yi=gi=null;break;case"mousedown":_i=!0;break;case"contextmenu":case"mouseup":case"dragend":_i=!1,wi(a,n,r);break;case"selectionchange":if(vi)break;case"keydown":case"keyup":wi(a,n,r)}var m;if(Fn)t:{switch(t){case"compositionstart":var _="onCompositionStart";break t;case"compositionend":_="onCompositionEnd";break t;case"compositionupdate":_="onCompositionUpdate";break t}_=void 0}else Hn?Nn(t,n)&&(_="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(_="onCompositionStart");_&&(zn&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Hn&&(m=tn()):(Je="value"in(Qe=r)?Qe.value:Qe.textContent,Hn=!0)),0<(y=Gi(i,_)).length&&(_=new wn(_,t,null,n,r),a.push({event:_,listeners:y}),m?_.data=m:null!==(m=Un(n))&&(_.data=m))),(m=Bn?function(t,e){switch(t){case"compositionend":return Un(e);case"keypress":return 32!==e.which?null:(On=!0,Ln);case"textInput":return(t=e.data)===Ln&&On?null:t;default:return null}}(t,n):function(t,e){if(Hn)return"compositionend"===t||!Fn&&Nn(t,e)?(t=tn(),$e=Je=Qe=null,Hn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return zn&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(i=Gi(i,"onBeforeInput")).length&&(r=new wn("onBeforeInput","beforeinput",null,n,r),a.push({event:r,listeners:i}),r.data=m))}Li(a,e)}))}function Xi(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Gi(t,e){for(var n=e+"Capture",i=[];null!==t;){var r=t,o=r.stateNode;5===r.tag&&null!==o&&(r=o,null!=(o=Rt(t,n))&&i.unshift(Xi(t,o,r)),null!=(o=Rt(t,e))&&i.push(Xi(t,o,r))),t=t.return}return i}function ji(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function qi(t,e,n,i,r){for(var o=e._reactName,a=[];null!==n&&n!==i;){var s=n,l=s.alternate,u=s.stateNode;if(null!==l&&l===i)break;5===s.tag&&null!==u&&(s=u,r?null!=(l=Rt(n,o))&&a.unshift(Xi(n,l,s)):r||null!=(l=Rt(n,o))&&a.push(Xi(n,l,s))),n=n.return}0!==a.length&&t.push({event:e,listeners:a})}var Yi=/\r\n?/g,Ki=/\u0000|\uFFFD/g;function Qi(t){return("string"===typeof t?t:""+t).replace(Yi,"\n").replace(Ki,"")}function Ji(t,e,n){if(e=Qi(e),Qi(t)!==e&&n)throw Error(o(425))}function $i(){}var tr=null,er=null;function nr(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,or="function"===typeof Promise?Promise:void 0,ar="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof or?function(t){return or.resolve(null).then(t).catch(sr)}:ir;function sr(t){setTimeout((function(){throw t}))}function lr(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return t.removeChild(r),void He(e);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);He(e)}function ur(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function cr(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var hr=Math.random().toString(36).slice(2),dr="__reactFiber$"+hr,fr="__reactProps$"+hr,pr="__reactContainer$"+hr,vr="__reactEvents$"+hr,gr="__reactListeners$"+hr,yr="__reactHandles$"+hr;function mr(t){var e=t[dr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[pr]||n[dr]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=cr(t);null!==t;){if(n=t[dr])return n;t=cr(t)}return e}n=(t=n).parentNode}return null}function _r(t){return!(t=t[dr]||t[pr])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function wr(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(o(33))}function xr(t){return t[fr]||null}var br=[],kr=-1;function Cr(t){return{current:t}}function Sr(t){0>kr||(t.current=br[kr],br[kr]=null,kr--)}function Ar(t,e){kr++,br[kr]=t.current,t.current=e}var Er={},Tr=Cr(Er),Pr=Cr(!1),Ir=Er;function Zr(t,e){var n=t.type.contextTypes;if(!n)return Er;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=e[r];return i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function Rr(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Mr(){Sr(Pr),Sr(Tr)}function Fr(t,e,n){if(Tr.current!==Er)throw Error(o(168));Ar(Tr,e),Ar(Pr,n)}function Dr(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in e))throw Error(o(108,W(t)||"Unknown",r));return z({},n,i)}function Br(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Er,Ir=Tr.current,Ar(Tr,t),Ar(Pr,Pr.current),!0}function zr(t,e,n){var i=t.stateNode;if(!i)throw Error(o(169));n?(t=Dr(t,e,Ir),i.__reactInternalMemoizedMergedChildContext=t,Sr(Pr),Sr(Tr),Ar(Tr,t)):Sr(Pr),Ar(Pr,n)}var Lr=null,Or=!1,Nr=!1;function Ur(t){null===Lr?Lr=[t]:Lr.push(t)}function Hr(){if(!Nr&&null!==Lr){Nr=!0;var t=0,e=_e;try{var n=Lr;for(_e=1;t<n.length;t++){var i=n[t];do{i=i(!0)}while(null!==i)}Lr=null,Or=!1}catch(r){throw null!==Lr&&(Lr=Lr.slice(t+1)),jt($t,Hr),r}finally{_e=e,Nr=!1}}return null}var Wr=[],Vr=0,Xr=null,Gr=0,jr=[],qr=0,Yr=null,Kr=1,Qr="";function Jr(t,e){Wr[Vr++]=Gr,Wr[Vr++]=Xr,Xr=t,Gr=e}function $r(t,e,n){jr[qr++]=Kr,jr[qr++]=Qr,jr[qr++]=Yr,Yr=t;var i=Kr;t=Qr;var r=32-ae(i)-1;i&=~(1<<r),n+=1;var o=32-ae(e)+r;if(30<o){var a=r-r%5;o=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Kr=1<<32-ae(e)+r|n<<r|i,Qr=o+t}else Kr=1<<o|n<<r|i,Qr=t}function to(t){null!==t.return&&(Jr(t,1),$r(t,1,0))}function eo(t){for(;t===Xr;)Xr=Wr[--Vr],Wr[Vr]=null,Gr=Wr[--Vr],Wr[Vr]=null;for(;t===Yr;)Yr=jr[--qr],jr[qr]=null,Qr=jr[--qr],jr[qr]=null,Kr=jr[--qr],jr[qr]=null}var no=null,io=null,ro=!1,oo=null;function ao(t,e){var n=Zu(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function so(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,no=t,io=ur(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,no=t,io=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==Yr?{id:Kr,overflow:Qr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Zu(18,null,null,0)).stateNode=e,n.return=t,t.child=n,no=t,io=null,!0);default:return!1}}function lo(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function uo(t){if(ro){var e=io;if(e){var n=e;if(!so(t,e)){if(lo(t))throw Error(o(418));e=ur(n.nextSibling);var i=no;e&&so(t,e)?ao(i,n):(t.flags=-4097&t.flags|2,ro=!1,no=t)}}else{if(lo(t))throw Error(o(418));t.flags=-4097&t.flags|2,ro=!1,no=t}}}function co(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;no=t}function ho(t){if(t!==no)return!1;if(!ro)return co(t),ro=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!nr(t.type,t.memoizedProps)),e&&(e=io)){if(lo(t))throw fo(),Error(o(418));for(;e;)ao(t,e),e=ur(e.nextSibling)}if(co(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(o(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){io=ur(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}io=null}}else io=no?ur(t.stateNode.nextSibling):null;return!0}function fo(){for(var t=io;t;)t=ur(t.nextSibling)}function po(){io=no=null,ro=!1}function vo(t){null===oo?oo=[t]:oo.push(t)}var go=w.ReactCurrentBatchConfig;function yo(t,e){if(t&&t.defaultProps){for(var n in e=z({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}var mo=Cr(null),_o=null,wo=null,xo=null;function bo(){xo=wo=_o=null}function ko(t){var e=mo.current;Sr(mo),t._currentValue=e}function Co(t,e,n){for(;null!==t;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==i&&(i.childLanes|=e)):null!==i&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function So(t,e){_o=t,xo=wo=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(ws=!0),t.firstContext=null)}function Ao(t){var e=t._currentValue;if(xo!==t)if(t={context:t,memoizedValue:e,next:null},null===wo){if(null===_o)throw Error(o(308));wo=t,_o.dependencies={lanes:0,firstContext:t}}else wo=wo.next=t;return e}var Eo=null;function To(t){null===Eo?Eo=[t]:Eo.push(t)}function Po(t,e,n,i){var r=e.interleaved;return null===r?(n.next=n,To(e)):(n.next=r.next,r.next=n),e.interleaved=n,Io(t,i)}function Io(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}var Zo=!1;function Ro(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mo(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Fo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Do(t,e,n){var i=t.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Tl)){var r=i.pending;return null===r?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Io(t,n)}return null===(r=i.interleaved)?(e.next=e,To(i)):(e.next=r.next,r.next=e),i.interleaved=e,Io(t,n)}function Bo(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&n))){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,me(t,n)}}function zo(t,e){var n=t.updateQueue,i=t.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?r=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?r=o=e:o=o.next=e}else r=o=e;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Lo(t,e,n,i){var r=t.updateQueue;Zo=!1;var o=r.firstBaseUpdate,a=r.lastBaseUpdate,s=r.shared.pending;if(null!==s){r.shared.pending=null;var l=s,u=l.next;l.next=null,null===a?o=u:a.next=u,a=l;var c=t.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==a&&(null===s?c.firstBaseUpdate=u:s.next=u,c.lastBaseUpdate=l))}if(null!==o){var h=r.baseState;for(a=0,c=u=l=null,s=o;;){var d=s.lane,f=s.eventTime;if((i&d)===d){null!==c&&(c=c.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var p=t,v=s;switch(d=e,f=n,v.tag){case 1:if("function"===typeof(p=v.payload)){h=p.call(f,h,d);break t}h=p;break t;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=v.payload)?p.call(f,h,d):p)||void 0===d)break t;h=z({},h,d);break t;case 2:Zo=!0}}null!==s.callback&&0!==s.lane&&(t.flags|=64,null===(d=r.effects)?r.effects=[s]:d.push(s))}else f={eventTime:f,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(u=c=f,l=h):c=c.next=f,a|=d;if(null===(s=s.next)){if(null===(s=r.shared.pending))break;s=(d=s).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===c&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,null!==(e=r.shared.interleaved)){r=e;do{a|=r.lane,r=r.next}while(r!==e)}else null===o&&(r.shared.lanes=0);Bl|=a,t.lanes=a,t.memoizedState=h}}function Oo(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(o(191,r));r.call(i)}}}var No=(new i.Component).refs;function Uo(t,e,n,i){n=null===(n=n(i,e=t.memoizedState))||void 0===n?e:z({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var Ho={isMounted:function(t){return!!(t=t._reactInternals)&&Ht(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=tu(),r=eu(t),o=Fo(i,r);o.payload=e,void 0!==n&&null!==n&&(o.callback=n),null!==(e=Do(t,o,r))&&(nu(e,t,r,i),Bo(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=tu(),r=eu(t),o=Fo(i,r);o.tag=1,o.payload=e,void 0!==n&&null!==n&&(o.callback=n),null!==(e=Do(t,o,r))&&(nu(e,t,r,i),Bo(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=tu(),i=eu(t),r=Fo(n,i);r.tag=2,void 0!==e&&null!==e&&(r.callback=e),null!==(e=Do(t,r,i))&&(nu(e,t,i,n),Bo(e,t,i))}};function Wo(t,e,n,i,r,o,a){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(i,o,a):!e.prototype||!e.prototype.isPureReactComponent||(!li(n,i)||!li(r,o))}function Vo(t,e,n){var i=!1,r=Er,o=e.contextType;return"object"===typeof o&&null!==o?o=Ao(o):(r=Rr(e)?Ir:Tr.current,o=(i=null!==(i=e.contextTypes)&&void 0!==i)?Zr(t,r):Er),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=Ho,t.stateNode=e,e._reactInternals=t,i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=o),e}function Xo(t,e,n,i){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,i),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&Ho.enqueueReplaceState(e,e.state,null)}function Go(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=No,Ro(t);var o=e.contextType;"object"===typeof o&&null!==o?r.context=Ao(o):(o=Rr(e)?Ir:Tr.current,r.context=Zr(t,o)),r.state=t.memoizedState,"function"===typeof(o=e.getDerivedStateFromProps)&&(Uo(t,e,o,n),r.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(e=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),e!==r.state&&Ho.enqueueReplaceState(r,r.state,null),Lo(t,n,r,i),r.state=t.memoizedState),"function"===typeof r.componentDidMount&&(t.flags|=4194308)}function jo(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var i=n.stateNode}if(!i)throw Error(o(147,t));var r=i,a=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===a?e.ref:(e=function(t){var e=r.refs;e===No&&(e=r.refs={}),null===t?delete e[a]:e[a]=t},e._stringRef=a,e)}if("string"!==typeof t)throw Error(o(284));if(!n._owner)throw Error(o(290,t))}return t}function qo(t,e){throw t=Object.prototype.toString.call(e),Error(o(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Yo(t){return(0,t._init)(t._payload)}function Ko(t){function e(e,n){if(t){var i=e.deletions;null===i?(e.deletions=[n],e.flags|=16):i.push(n)}}function n(n,i){if(!t)return null;for(;null!==i;)e(n,i),i=i.sibling;return null}function i(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(t,e){return(t=Mu(t,e)).index=0,t.sibling=null,t}function a(e,n,i){return e.index=i,t?null!==(i=e.alternate)?(i=i.index)<n?(e.flags|=2,n):i:(e.flags|=2,n):(e.flags|=1048576,n)}function s(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,n,i){return null===e||6!==e.tag?((e=zu(n,t.mode,i)).return=t,e):((e=r(e,n)).return=t,e)}function u(t,e,n,i){var o=n.type;return o===k?h(t,e,n.props.children,i,n.key):null!==e&&(e.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===R&&Yo(o)===e.type)?((i=r(e,n.props)).ref=jo(t,e,n),i.return=t,i):((i=Fu(n.type,n.key,n.props,null,t.mode,i)).ref=jo(t,e,n),i.return=t,i)}function c(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Lu(n,t.mode,i)).return=t,e):((e=r(e,n.children||[])).return=t,e)}function h(t,e,n,i,o){return null===e||7!==e.tag?((e=Du(n,t.mode,i,o)).return=t,e):((e=r(e,n)).return=t,e)}function d(t,e,n){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=zu(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case x:return(n=Fu(e.type,e.key,e.props,null,t.mode,n)).ref=jo(t,null,e),n.return=t,n;case b:return(e=Lu(e,t.mode,n)).return=t,e;case R:return d(t,(0,e._init)(e._payload),n)}if(et(e)||D(e))return(e=Du(e,t.mode,n,null)).return=t,e;qo(t,e)}return null}function f(t,e,n,i){var r=null!==e?e.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(t,e,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===r?u(t,e,n,i):null;case b:return n.key===r?c(t,e,n,i):null;case R:return f(t,e,(r=n._init)(n._payload),i)}if(et(n)||D(n))return null!==r?null:h(t,e,n,i,null);qo(t,n)}return null}function p(t,e,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(e,t=t.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case x:return u(e,t=t.get(null===i.key?n:i.key)||null,i,r);case b:return c(e,t=t.get(null===i.key?n:i.key)||null,i,r);case R:return p(t,e,n,(0,i._init)(i._payload),r)}if(et(i)||D(i))return h(e,t=t.get(n)||null,i,r,null);qo(e,i)}return null}function v(r,o,s,l){for(var u=null,c=null,h=o,v=o=0,g=null;null!==h&&v<s.length;v++){h.index>v?(g=h,h=null):g=h.sibling;var y=f(r,h,s[v],l);if(null===y){null===h&&(h=g);break}t&&h&&null===y.alternate&&e(r,h),o=a(y,o,v),null===c?u=y:c.sibling=y,c=y,h=g}if(v===s.length)return n(r,h),ro&&Jr(r,v),u;if(null===h){for(;v<s.length;v++)null!==(h=d(r,s[v],l))&&(o=a(h,o,v),null===c?u=h:c.sibling=h,c=h);return ro&&Jr(r,v),u}for(h=i(r,h);v<s.length;v++)null!==(g=p(h,r,v,s[v],l))&&(t&&null!==g.alternate&&h.delete(null===g.key?v:g.key),o=a(g,o,v),null===c?u=g:c.sibling=g,c=g);return t&&h.forEach((function(t){return e(r,t)})),ro&&Jr(r,v),u}function g(r,s,l,u){var c=D(l);if("function"!==typeof c)throw Error(o(150));if(null==(l=c.call(l)))throw Error(o(151));for(var h=c=null,v=s,g=s=0,y=null,m=l.next();null!==v&&!m.done;g++,m=l.next()){v.index>g?(y=v,v=null):y=v.sibling;var _=f(r,v,m.value,u);if(null===_){null===v&&(v=y);break}t&&v&&null===_.alternate&&e(r,v),s=a(_,s,g),null===h?c=_:h.sibling=_,h=_,v=y}if(m.done)return n(r,v),ro&&Jr(r,g),c;if(null===v){for(;!m.done;g++,m=l.next())null!==(m=d(r,m.value,u))&&(s=a(m,s,g),null===h?c=m:h.sibling=m,h=m);return ro&&Jr(r,g),c}for(v=i(r,v);!m.done;g++,m=l.next())null!==(m=p(v,r,g,m.value,u))&&(t&&null!==m.alternate&&v.delete(null===m.key?g:m.key),s=a(m,s,g),null===h?c=m:h.sibling=m,h=m);return t&&v.forEach((function(t){return e(r,t)})),ro&&Jr(r,g),c}return function t(i,o,a,l){if("object"===typeof a&&null!==a&&a.type===k&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case x:t:{for(var u=a.key,c=o;null!==c;){if(c.key===u){if((u=a.type)===k){if(7===c.tag){n(i,c.sibling),(o=r(c,a.props.children)).return=i,i=o;break t}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===R&&Yo(u)===c.type){n(i,c.sibling),(o=r(c,a.props)).ref=jo(i,c,a),o.return=i,i=o;break t}n(i,c);break}e(i,c),c=c.sibling}a.type===k?((o=Du(a.props.children,i.mode,l,a.key)).return=i,i=o):((l=Fu(a.type,a.key,a.props,null,i.mode,l)).ref=jo(i,o,a),l.return=i,i=l)}return s(i);case b:t:{for(c=a.key;null!==o;){if(o.key===c){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(i,o.sibling),(o=r(o,a.children||[])).return=i,i=o;break t}n(i,o);break}e(i,o),o=o.sibling}(o=Lu(a,i.mode,l)).return=i,i=o}return s(i);case R:return t(i,o,(c=a._init)(a._payload),l)}if(et(a))return v(i,o,a,l);if(D(a))return g(i,o,a,l);qo(i,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(n(i,o.sibling),(o=r(o,a)).return=i,i=o):(n(i,o),(o=zu(a,i.mode,l)).return=i,i=o),s(i)):n(i,o)}}var Qo=Ko(!0),Jo=Ko(!1),$o={},ta=Cr($o),ea=Cr($o),na=Cr($o);function ia(t){if(t===$o)throw Error(o(174));return t}function ra(t,e){switch(Ar(na,e),Ar(ea,t),Ar(ta,$o),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lt(null,"");break;default:e=lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Sr(ta),Ar(ta,e)}function oa(){Sr(ta),Sr(ea),Sr(na)}function aa(t){ia(na.current);var e=ia(ta.current),n=lt(e,t.type);e!==n&&(Ar(ea,t),Ar(ta,n))}function sa(t){ea.current===t&&(Sr(ta),Sr(ea))}var la=Cr(0);function ua(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ca=[];function ha(){for(var t=0;t<ca.length;t++)ca[t]._workInProgressVersionPrimary=null;ca.length=0}var da=w.ReactCurrentDispatcher,fa=w.ReactCurrentBatchConfig,pa=0,va=null,ga=null,ya=null,ma=!1,_a=!1,wa=0,xa=0;function ba(){throw Error(o(321))}function ka(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!si(t[n],e[n]))return!1;return!0}function Ca(t,e,n,i,r,a){if(pa=a,va=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,da.current=null===t||null===t.memoizedState?ss:ls,t=n(i,r),_a){a=0;do{if(_a=!1,wa=0,25<=a)throw Error(o(301));a+=1,ya=ga=null,e.updateQueue=null,da.current=us,t=n(i,r)}while(_a)}if(da.current=as,e=null!==ga&&null!==ga.next,pa=0,ya=ga=va=null,ma=!1,e)throw Error(o(300));return t}function Sa(){var t=0!==wa;return wa=0,t}function Aa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ya?va.memoizedState=ya=t:ya=ya.next=t,ya}function Ea(){if(null===ga){var t=va.alternate;t=null!==t?t.memoizedState:null}else t=ga.next;var e=null===ya?va.memoizedState:ya.next;if(null!==e)ya=e,ga=t;else{if(null===t)throw Error(o(310));t={memoizedState:(ga=t).memoizedState,baseState:ga.baseState,baseQueue:ga.baseQueue,queue:ga.queue,next:null},null===ya?va.memoizedState=ya=t:ya=ya.next=t}return ya}function Ta(t,e){return"function"===typeof e?e(t):e}function Pa(t){var e=Ea(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var i=ga,r=i.baseQueue,a=n.pending;if(null!==a){if(null!==r){var s=r.next;r.next=a.next,a.next=s}i.baseQueue=r=a,n.pending=null}if(null!==r){a=r.next,i=i.baseState;var l=s=null,u=null,c=a;do{var h=c.lane;if((pa&h)===h)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:t(i,c.action);else{var d={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=d,s=i):u=u.next=d,va.lanes|=h,Bl|=h}c=c.next}while(null!==c&&c!==a);null===u?s=i:u.next=l,si(i,e.memoizedState)||(ws=!0),e.memoizedState=i,e.baseState=s,e.baseQueue=u,n.lastRenderedState=i}if(null!==(t=n.interleaved)){r=t;do{a=r.lane,va.lanes|=a,Bl|=a,r=r.next}while(r!==t)}else null===r&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ia(t){var e=Ea(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,a=e.memoizedState;if(null!==r){n.pending=null;var s=r=r.next;do{a=t(a,s.action),s=s.next}while(s!==r);si(a,e.memoizedState)||(ws=!0),e.memoizedState=a,null===e.baseQueue&&(e.baseState=a),n.lastRenderedState=a}return[a,i]}function Za(){}function Ra(t,e){var n=va,i=Ea(),r=e(),a=!si(i.memoizedState,r);if(a&&(i.memoizedState=r,ws=!0),i=i.queue,Va(Da.bind(null,n,i,t),[t]),i.getSnapshot!==e||a||null!==ya&&1&ya.memoizedState.tag){if(n.flags|=2048,Oa(9,Fa.bind(null,n,i,r,e),void 0,null),null===Pl)throw Error(o(349));0!==(30&pa)||Ma(n,e,r)}return r}function Ma(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=va.updateQueue)?(e={lastEffect:null,stores:null},va.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function Fa(t,e,n,i){e.value=n,e.getSnapshot=i,Ba(e)&&za(t)}function Da(t,e,n){return n((function(){Ba(e)&&za(t)}))}function Ba(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!si(t,n)}catch(i){return!0}}function za(t){var e=Io(t,1);null!==e&&nu(e,t,1,-1)}function La(t){var e=Aa();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ta,lastRenderedState:t},e.queue=t,t=t.dispatch=ns.bind(null,va,t),[e.memoizedState,t]}function Oa(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},null===(e=va.updateQueue)?(e={lastEffect:null,stores:null},va.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function Na(){return Ea().memoizedState}function Ua(t,e,n,i){var r=Aa();va.flags|=t,r.memoizedState=Oa(1|e,n,void 0,void 0===i?null:i)}function Ha(t,e,n,i){var r=Ea();i=void 0===i?null:i;var o=void 0;if(null!==ga){var a=ga.memoizedState;if(o=a.destroy,null!==i&&ka(i,a.deps))return void(r.memoizedState=Oa(e,n,o,i))}va.flags|=t,r.memoizedState=Oa(1|e,n,o,i)}function Wa(t,e){return Ua(8390656,8,t,e)}function Va(t,e){return Ha(2048,8,t,e)}function Xa(t,e){return Ha(4,2,t,e)}function Ga(t,e){return Ha(4,4,t,e)}function ja(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function qa(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Ha(4,4,ja.bind(null,e,t),n)}function Ya(){}function Ka(t,e){var n=Ea();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&ka(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function Qa(t,e){var n=Ea();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&ka(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function Ja(t,e,n){return 0===(21&pa)?(t.baseState&&(t.baseState=!1,ws=!0),t.memoizedState=n):(si(n,e)||(n=ve(),va.lanes|=n,Bl|=n,t.baseState=!0),e)}function $a(t,e){var n=_e;_e=0!==n&&4>n?n:4,t(!0);var i=fa.transition;fa.transition={};try{t(!1),e()}finally{_e=n,fa.transition=i}}function ts(){return Ea().memoizedState}function es(t,e,n){var i=eu(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},is(t))rs(e,n);else if(null!==(n=Po(t,e,n,i))){nu(n,t,i,tu()),os(n,e,i)}}function ns(t,e,n){var i=eu(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(is(t))rs(e,r);else{var o=t.alternate;if(0===t.lanes&&(null===o||0===o.lanes)&&null!==(o=e.lastRenderedReducer))try{var a=e.lastRenderedState,s=o(a,n);if(r.hasEagerState=!0,r.eagerState=s,si(s,a)){var l=e.interleaved;return null===l?(r.next=r,To(e)):(r.next=l.next,l.next=r),void(e.interleaved=r)}}catch(u){}null!==(n=Po(t,e,r,i))&&(nu(n,t,i,r=tu()),os(n,e,i))}}function is(t){var e=t.alternate;return t===va||null!==e&&e===va}function rs(t,e){_a=ma=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function os(t,e,n){if(0!==(4194240&n)){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,me(t,n)}}var as={readContext:Ao,useCallback:ba,useContext:ba,useEffect:ba,useImperativeHandle:ba,useInsertionEffect:ba,useLayoutEffect:ba,useMemo:ba,useReducer:ba,useRef:ba,useState:ba,useDebugValue:ba,useDeferredValue:ba,useTransition:ba,useMutableSource:ba,useSyncExternalStore:ba,useId:ba,unstable_isNewReconciler:!1},ss={readContext:Ao,useCallback:function(t,e){return Aa().memoizedState=[t,void 0===e?null:e],t},useContext:Ao,useEffect:Wa,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Ua(4194308,4,ja.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ua(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ua(4,2,t,e)},useMemo:function(t,e){var n=Aa();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=Aa();return e=void 0!==n?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=es.bind(null,va,t),[i.memoizedState,t]},useRef:function(t){return t={current:t},Aa().memoizedState=t},useState:La,useDebugValue:Ya,useDeferredValue:function(t){return Aa().memoizedState=t},useTransition:function(){var t=La(!1),e=t[0];return t=$a.bind(null,t[1]),Aa().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=va,r=Aa();if(ro){if(void 0===n)throw Error(o(407));n=n()}else{if(n=e(),null===Pl)throw Error(o(349));0!==(30&pa)||Ma(i,e,n)}r.memoizedState=n;var a={value:n,getSnapshot:e};return r.queue=a,Wa(Da.bind(null,i,a,t),[t]),i.flags|=2048,Oa(9,Fa.bind(null,i,a,n,e),void 0,null),n},useId:function(){var t=Aa(),e=Pl.identifierPrefix;if(ro){var n=Qr;e=":"+e+"R"+(n=(Kr&~(1<<32-ae(Kr)-1)).toString(32)+n),0<(n=wa++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=xa++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ls={readContext:Ao,useCallback:Ka,useContext:Ao,useEffect:Va,useImperativeHandle:qa,useInsertionEffect:Xa,useLayoutEffect:Ga,useMemo:Qa,useReducer:Pa,useRef:Na,useState:function(){return Pa(Ta)},useDebugValue:Ya,useDeferredValue:function(t){return Ja(Ea(),ga.memoizedState,t)},useTransition:function(){return[Pa(Ta)[0],Ea().memoizedState]},useMutableSource:Za,useSyncExternalStore:Ra,useId:ts,unstable_isNewReconciler:!1},us={readContext:Ao,useCallback:Ka,useContext:Ao,useEffect:Va,useImperativeHandle:qa,useInsertionEffect:Xa,useLayoutEffect:Ga,useMemo:Qa,useReducer:Ia,useRef:Na,useState:function(){return Ia(Ta)},useDebugValue:Ya,useDeferredValue:function(t){var e=Ea();return null===ga?e.memoizedState=t:Ja(e,ga.memoizedState,t)},useTransition:function(){return[Ia(Ta)[0],Ea().memoizedState]},useMutableSource:Za,useSyncExternalStore:Ra,useId:ts,unstable_isNewReconciler:!1};function cs(t,e){try{var n="",i=e;do{n+=U(i),i=i.return}while(i);var r=n}catch(o){r="\nError generating stack: "+o.message+"\n"+o.stack}return{value:t,source:e,stack:r,digest:null}}function hs(t,e,n){return{value:t,source:null,stack:null!=n?n:null,digest:null!=e?e:null}}function ds(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}var fs="function"===typeof WeakMap?WeakMap:Map;function ps(t,e,n){(n=Fo(-1,n)).tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Vl||(Vl=!0,Xl=i),ds(0,e)},n}function vs(t,e,n){(n=Fo(-1,n)).tag=3;var i=t.type.getDerivedStateFromError;if("function"===typeof i){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){ds(0,e)}}var o=t.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){ds(0,e),"function"!==typeof i&&(null===Gl?Gl=new Set([this]):Gl.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function gs(t,e,n){var i=t.pingCache;if(null===i){i=t.pingCache=new fs;var r=new Set;i.set(e,r)}else void 0===(r=i.get(e))&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=Su.bind(null,t,e,n),e.then(t,t))}function ys(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function ms(t,e,n,i,r){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=Fo(-1,1)).tag=2,Do(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=r,t)}var _s=w.ReactCurrentOwner,ws=!1;function xs(t,e,n,i){e.child=null===t?Jo(e,null,n,i):Qo(e,t.child,n,i)}function bs(t,e,n,i,r){n=n.render;var o=e.ref;return So(e,r),i=Ca(t,e,n,i,o,r),n=Sa(),null===t||ws?(ro&&n&&to(e),e.flags|=1,xs(t,e,i,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Vs(t,e,r))}function ks(t,e,n,i,r){if(null===t){var o=n.type;return"function"!==typeof o||Ru(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Fu(n.type,null,i,e,e.mode,r)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,Cs(t,e,o,i,r))}if(o=t.child,0===(t.lanes&r)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:li)(a,i)&&t.ref===e.ref)return Vs(t,e,r)}return e.flags|=1,(t=Mu(o,i)).ref=e.ref,t.return=e,e.child=t}function Cs(t,e,n,i,r){if(null!==t){var o=t.memoizedProps;if(li(o,i)&&t.ref===e.ref){if(ws=!1,e.pendingProps=i=o,0===(t.lanes&r))return e.lanes=t.lanes,Vs(t,e,r);0!==(131072&t.flags)&&(ws=!0)}}return Es(t,e,n,i,r)}function Ss(t,e,n){var i=e.pendingProps,r=i.children,o=null!==t?t.memoizedState:null;if("hidden"===i.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ar(Ml,Rl),Rl|=n;else{if(0===(1073741824&n))return t=null!==o?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ar(Ml,Rl),Rl|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==o?o.baseLanes:n,Ar(Ml,Rl),Rl|=i}else null!==o?(i=o.baseLanes|n,e.memoizedState=null):i=n,Ar(Ml,Rl),Rl|=i;return xs(t,e,r,n),e.child}function As(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Es(t,e,n,i,r){var o=Rr(n)?Ir:Tr.current;return o=Zr(e,o),So(e,r),n=Ca(t,e,n,i,o,r),i=Sa(),null===t||ws?(ro&&i&&to(e),e.flags|=1,xs(t,e,n,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Vs(t,e,r))}function Ts(t,e,n,i,r){if(Rr(n)){var o=!0;Br(e)}else o=!1;if(So(e,r),null===e.stateNode)Ws(t,e),Vo(e,n,i),Go(e,n,i,r),i=!0;else if(null===t){var a=e.stateNode,s=e.memoizedProps;a.props=s;var l=a.context,u=n.contextType;"object"===typeof u&&null!==u?u=Ao(u):u=Zr(e,u=Rr(n)?Ir:Tr.current);var c=n.getDerivedStateFromProps,h="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==i||l!==u)&&Xo(e,a,i,u),Zo=!1;var d=e.memoizedState;a.state=d,Lo(e,i,a,r),l=e.memoizedState,s!==i||d!==l||Pr.current||Zo?("function"===typeof c&&(Uo(e,n,c,i),l=e.memoizedState),(s=Zo||Wo(e,n,s,i,d,l,u))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(e.flags|=4194308)):("function"===typeof a.componentDidMount&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),a.props=i,a.state=l,a.context=u,i=s):("function"===typeof a.componentDidMount&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,Mo(t,e),s=e.memoizedProps,u=e.type===e.elementType?s:yo(e.type,s),a.props=u,h=e.pendingProps,d=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ao(l):l=Zr(e,l=Rr(n)?Ir:Tr.current);var f=n.getDerivedStateFromProps;(c="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||d!==l)&&Xo(e,a,i,l),Zo=!1,d=e.memoizedState,a.state=d,Lo(e,i,a,r);var p=e.memoizedState;s!==h||d!==p||Pr.current||Zo?("function"===typeof f&&(Uo(e,n,f,i),p=e.memoizedState),(u=Zo||Wo(e,n,u,i,d,p,l)||!1)?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(i,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,p,l)),"function"===typeof a.componentDidUpdate&&(e.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=p),a.props=i,a.state=p,a.context=l,i=u):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return Ps(t,e,n,i,o,r)}function Ps(t,e,n,i,r,o){As(t,e);var a=0!==(128&e.flags);if(!i&&!a)return r&&zr(e,n,!1),Vs(t,e,o);i=e.stateNode,_s.current=e;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return e.flags|=1,null!==t&&a?(e.child=Qo(e,t.child,null,o),e.child=Qo(e,null,s,o)):xs(t,e,s,o),e.memoizedState=i.state,r&&zr(e,n,!0),e.child}function Is(t){var e=t.stateNode;e.pendingContext?Fr(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Fr(0,e.context,!1),ra(t,e.containerInfo)}function Zs(t,e,n,i,r){return po(),vo(r),e.flags|=256,xs(t,e,n,i),e.child}var Rs,Ms,Fs,Ds={dehydrated:null,treeContext:null,retryLane:0};function Bs(t){return{baseLanes:t,cachePool:null,transitions:null}}function zs(t,e,n){var i,r=e.pendingProps,a=la.current,s=!1,l=0!==(128&e.flags);if((i=l)||(i=(null===t||null!==t.memoizedState)&&0!==(2&a)),i?(s=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(a|=1),Ar(la,1&a),null===t)return uo(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(l=r.children,t=r.fallback,s?(r=e.mode,s=e.child,l={mode:"hidden",children:l},0===(1&r)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Bu(l,r,0,null),t=Du(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Bs(n),e.memoizedState=Ds,t):Ls(e,l));if(null!==(a=t.memoizedState)&&null!==(i=a.dehydrated))return function(t,e,n,i,r,a,s){if(n)return 256&e.flags?(e.flags&=-257,Os(t,e,s,i=hs(Error(o(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(a=i.fallback,r=e.mode,i=Bu({mode:"visible",children:i.children},r,0,null),(a=Du(a,r,s,null)).flags|=2,i.return=e,a.return=e,i.sibling=a,e.child=i,0!==(1&e.mode)&&Qo(e,t.child,null,s),e.child.memoizedState=Bs(s),e.memoizedState=Ds,a);if(0===(1&e.mode))return Os(t,e,s,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Os(t,e,s,i=hs(a=Error(o(419)),i,void 0))}if(l=0!==(s&t.childLanes),ws||l){if(null!==(i=Pl)){switch(s&-s){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|s))?0:r)&&r!==a.retryLane&&(a.retryLane=r,Io(t,r),nu(i,t,r,-1))}return vu(),Os(t,e,s,i=hs(Error(o(421))))}return"$?"===r.data?(e.flags|=128,e.child=t.child,e=Eu.bind(null,t),r._reactRetry=e,null):(t=a.treeContext,io=ur(r.nextSibling),no=e,ro=!0,oo=null,null!==t&&(jr[qr++]=Kr,jr[qr++]=Qr,jr[qr++]=Yr,Kr=t.id,Qr=t.overflow,Yr=e),(e=Ls(e,i.children)).flags|=4096,e)}(t,e,l,r,i,a,n);if(s){s=r.fallback,l=e.mode,i=(a=t.child).sibling;var u={mode:"hidden",children:r.children};return 0===(1&l)&&e.child!==a?((r=e.child).childLanes=0,r.pendingProps=u,e.deletions=null):(r=Mu(a,u)).subtreeFlags=14680064&a.subtreeFlags,null!==i?s=Mu(i,s):(s=Du(s,l,n,null)).flags|=2,s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,l=null===(l=t.child.memoizedState)?Bs(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=t.childLanes&~n,e.memoizedState=Ds,r}return t=(s=t.child).sibling,r=Mu(s,{mode:"visible",children:r.children}),0===(1&e.mode)&&(r.lanes=n),r.return=e,r.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ls(t,e){return(e=Bu({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Os(t,e,n,i){return null!==i&&vo(i),Qo(e,t.child,null,n),(t=Ls(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function Ns(t,e,n){t.lanes|=e;var i=t.alternate;null!==i&&(i.lanes|=e),Co(t.return,e,n)}function Us(t,e,n,i,r){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=r)}function Hs(t,e,n){var i=e.pendingProps,r=i.revealOrder,o=i.tail;if(xs(t,e,i.children,n),0!==(2&(i=la.current)))i=1&i|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Ns(t,n,e);else if(19===t.tag)Ns(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Ar(la,i),0===(1&e.mode))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;null!==n;)null!==(t=n.alternate)&&null===ua(t)&&(r=n),n=n.sibling;null===(n=r)?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Us(e,!1,r,n,o);break;case"backwards":for(n=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===ua(t)){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Us(e,!0,n,null,o);break;case"together":Us(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ws(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Vs(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Bl|=e.lanes,0===(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(o(153));if(null!==e.child){for(n=Mu(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Mu(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Xs(t,e){if(!ro)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e||null===t.tail?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Gs(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=t,r=r.sibling;else for(r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function js(t,e,n){var i=e.pendingProps;switch(eo(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gs(e),null;case 1:case 17:return Rr(e.type)&&Mr(),Gs(e),null;case 3:return i=e.stateNode,oa(),Sr(Pr),Sr(Tr),ha(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==t&&null!==t.child||(ho(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==oo&&(au(oo),oo=null))),Gs(e),null;case 5:sa(e);var r=ia(na.current);if(n=e.type,null!==t&&null!=e.stateNode)Ms(t,e,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(null===e.stateNode)throw Error(o(166));return Gs(e),null}if(t=ia(ta.current),ho(e)){i=e.stateNode,n=e.type;var a=e.memoizedProps;switch(i[dr]=e,i[fr]=a,t=0!==(1&e.mode),n){case"dialog":Oi("cancel",i),Oi("close",i);break;case"iframe":case"object":case"embed":Oi("load",i);break;case"video":case"audio":for(r=0;r<Di.length;r++)Oi(Di[r],i);break;case"source":Oi("error",i);break;case"img":case"image":case"link":Oi("error",i),Oi("load",i);break;case"details":Oi("toggle",i);break;case"input":K(i,a),Oi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},Oi("invalid",i);break;case"textarea":rt(i,a),Oi("invalid",i)}for(var l in mt(n,a),r=null,a)if(a.hasOwnProperty(l)){var u=a[l];"children"===l?"string"===typeof u?i.textContent!==u&&(!0!==a.suppressHydrationWarning&&Ji(i.textContent,u,t),r=["children",u]):"number"===typeof u&&i.textContent!==""+u&&(!0!==a.suppressHydrationWarning&&Ji(i.textContent,u,t),r=["children",""+u]):s.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Oi("scroll",i)}switch(n){case"input":G(i),$(i,a,!0);break;case"textarea":G(i),at(i);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(i.onclick=$i)}i=r,e.updateQueue=i,null!==i&&(e.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=st(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof i.is?t=l.createElement(n,{is:i.is}):(t=l.createElement(n),"select"===n&&(l=t,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):t=l.createElementNS(t,n),t[dr]=e,t[fr]=i,Rs(t,e),e.stateNode=t;t:{switch(l=_t(n,i),n){case"dialog":Oi("cancel",t),Oi("close",t),r=i;break;case"iframe":case"object":case"embed":Oi("load",t),r=i;break;case"video":case"audio":for(r=0;r<Di.length;r++)Oi(Di[r],t);r=i;break;case"source":Oi("error",t),r=i;break;case"img":case"image":case"link":Oi("error",t),Oi("load",t),r=i;break;case"details":Oi("toggle",t),r=i;break;case"input":K(t,i),r=Y(t,i),Oi("invalid",t);break;case"option":default:r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=z({},i,{value:void 0}),Oi("invalid",t);break;case"textarea":rt(t,i),r=it(t,i),Oi("invalid",t)}for(a in mt(n,r),u=r)if(u.hasOwnProperty(a)){var c=u[a];"style"===a?gt(t,c):"dangerouslySetInnerHTML"===a?null!=(c=c?c.__html:void 0)&&ht(t,c):"children"===a?"string"===typeof c?("textarea"!==n||""!==c)&&dt(t,c):"number"===typeof c&&dt(t,""+c):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=c&&"onScroll"===a&&Oi("scroll",t):null!=c&&_(t,a,c,l))}switch(n){case"input":G(t),$(t,i,!1);break;case"textarea":G(t),at(t);break;case"option":null!=i.value&&t.setAttribute("value",""+V(i.value));break;case"select":t.multiple=!!i.multiple,null!=(a=i.value)?nt(t,!!i.multiple,a,!1):null!=i.defaultValue&&nt(t,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(t.onclick=$i)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break t;case"img":i=!0;break t;default:i=!1}}i&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return Gs(e),null;case 6:if(t&&null!=e.stateNode)Fs(0,e,t.memoizedProps,i);else{if("string"!==typeof i&&null===e.stateNode)throw Error(o(166));if(n=ia(na.current),ia(ta.current),ho(e)){if(i=e.stateNode,n=e.memoizedProps,i[dr]=e,(a=i.nodeValue!==n)&&null!==(t=no))switch(t.tag){case 3:Ji(i.nodeValue,n,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Ji(i.nodeValue,n,0!==(1&t.mode))}a&&(e.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[dr]=e,e.stateNode=i}return Gs(e),null;case 13:if(Sr(la),i=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(ro&&null!==io&&0!==(1&e.mode)&&0===(128&e.flags))fo(),po(),e.flags|=98560,a=!1;else if(a=ho(e),null!==i&&null!==i.dehydrated){if(null===t){if(!a)throw Error(o(318));if(!(a=null!==(a=e.memoizedState)?a.dehydrated:null))throw Error(o(317));a[dr]=e}else po(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;Gs(e),a=!1}else null!==oo&&(au(oo),oo=null),a=!0;if(!a)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=n,e):((i=null!==i)!==(null!==t&&null!==t.memoizedState)&&i&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&la.current)?0===Fl&&(Fl=3):vu())),null!==e.updateQueue&&(e.flags|=4),Gs(e),null);case 4:return oa(),null===t&&Hi(e.stateNode.containerInfo),Gs(e),null;case 10:return ko(e.type._context),Gs(e),null;case 19:if(Sr(la),null===(a=e.memoizedState))return Gs(e),null;if(i=0!==(128&e.flags),null===(l=a.rendering))if(i)Xs(a,!1);else{if(0!==Fl||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(l=ua(t))){for(e.flags|=128,Xs(a,!1),null!==(i=l.updateQueue)&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;null!==n;)t=i,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,t=l.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ar(la,1&la.current|2),e.child}t=t.sibling}null!==a.tail&&Qt()>Hl&&(e.flags|=128,i=!0,Xs(a,!1),e.lanes=4194304)}else{if(!i)if(null!==(t=ua(l))){if(e.flags|=128,i=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),Xs(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!ro)return Gs(e),null}else 2*Qt()-a.renderingStartTime>Hl&&1073741824!==n&&(e.flags|=128,i=!0,Xs(a,!1),e.lanes=4194304);a.isBackwards?(l.sibling=e.child,e.child=l):(null!==(n=a.last)?n.sibling=l:e.child=l,a.last=l)}return null!==a.tail?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Qt(),e.sibling=null,n=la.current,Ar(la,i?1&n|2:1&n),e):(Gs(e),null);case 22:case 23:return hu(),i=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==i&&(e.flags|=8192),i&&0!==(1&e.mode)?0!==(1073741824&Rl)&&(Gs(e),6&e.subtreeFlags&&(e.flags|=8192)):Gs(e),null;case 24:case 25:return null}throw Error(o(156,e.tag))}function qs(t,e){switch(eo(e),e.tag){case 1:return Rr(e.type)&&Mr(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return oa(),Sr(Pr),Sr(Tr),ha(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return sa(e),null;case 13:if(Sr(la),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(o(340));po()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Sr(la),null;case 4:return oa(),null;case 10:return ko(e.type._context),null;case 22:case 23:return hu(),null;default:return null}}Rs=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ms=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,ia(ta.current);var o,a=null;switch(n){case"input":r=Y(t,r),i=Y(t,i),a=[];break;case"select":r=z({},r,{value:void 0}),i=z({},i,{value:void 0}),a=[];break;case"textarea":r=it(t,r),i=it(t,i),a=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(t.onclick=$i)}for(c in mt(n,i),n=null,r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&null!=r[c])if("style"===c){var l=r[c];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in i){var u=i[c];if(l=null!=r?r[c]:void 0,i.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(a||(a=[]),a.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(a=a||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(a=a||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&Oi("scroll",t),a||l===u||(a=[])):(a=a||[]).push(c,u))}n&&(a=a||[]).push("style",n);var c=a;(e.updateQueue=c)&&(e.flags|=4)}},Fs=function(t,e,n,i){n!==i&&(e.flags|=4)};var Ys=!1,Ks=!1,Qs="function"===typeof WeakSet?WeakSet:Set,Js=null;function $s(t,e){var n=t.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Cu(t,e,i)}else n.current=null}function tl(t,e,n){try{n()}catch(i){Cu(t,e,i)}}var el=!1;function nl(t,e,n){var i=e.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&t)===t){var o=r.destroy;r.destroy=void 0,void 0!==o&&tl(e,n,o)}r=r.next}while(r!==i)}}function il(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function rl(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"===typeof e?e(t):e.current=t}}function ol(t){var e=t.alternate;null!==e&&(t.alternate=null,ol(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[dr],delete e[fr],delete e[vr],delete e[gr],delete e[yr])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function al(t){return 5===t.tag||3===t.tag||4===t.tag}function sl(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||al(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ll(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=$i));else if(4!==i&&null!==(t=t.child))for(ll(t,e,n),t=t.sibling;null!==t;)ll(t,e,n),t=t.sibling}function ul(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==i&&null!==(t=t.child))for(ul(t,e,n),t=t.sibling;null!==t;)ul(t,e,n),t=t.sibling}var cl=null,hl=!1;function dl(t,e,n){for(n=n.child;null!==n;)fl(t,e,n),n=n.sibling}function fl(t,e,n){if(oe&&"function"===typeof oe.onCommitFiberUnmount)try{oe.onCommitFiberUnmount(re,n)}catch(s){}switch(n.tag){case 5:Ks||$s(n,e);case 6:var i=cl,r=hl;cl=null,dl(t,e,n),hl=r,null!==(cl=i)&&(hl?(t=cl,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(hl?(t=cl,n=n.stateNode,8===t.nodeType?lr(t.parentNode,n):1===t.nodeType&&lr(t,n),He(t)):lr(cl,n.stateNode));break;case 4:i=cl,r=hl,cl=n.stateNode.containerInfo,hl=!0,dl(t,e,n),cl=i,hl=r;break;case 0:case 11:case 14:case 15:if(!Ks&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var o=r,a=o.destroy;o=o.tag,void 0!==a&&(0!==(2&o)||0!==(4&o))&&tl(n,e,a),r=r.next}while(r!==i)}dl(t,e,n);break;case 1:if(!Ks&&($s(n,e),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(s){Cu(n,e,s)}dl(t,e,n);break;case 21:dl(t,e,n);break;case 22:1&n.mode?(Ks=(i=Ks)||null!==n.memoizedState,dl(t,e,n),Ks=i):dl(t,e,n);break;default:dl(t,e,n)}}function pl(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Qs),e.forEach((function(e){var i=Tu.bind(null,t,e);n.has(e)||(n.add(e),e.then(i,i))}))}}function vl(t,e){var n=e.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var a=t,s=e,l=s;t:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,hl=!1;break t;case 3:case 4:cl=l.stateNode.containerInfo,hl=!0;break t}l=l.return}if(null===cl)throw Error(o(160));fl(a,s,r),cl=null,hl=!1;var u=r.alternate;null!==u&&(u.return=null),r.return=null}catch(c){Cu(r,e,c)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)gl(e,t),e=e.sibling}function gl(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(vl(e,t),yl(t),4&i){try{nl(3,t,t.return),il(3,t)}catch(g){Cu(t,t.return,g)}try{nl(5,t,t.return)}catch(g){Cu(t,t.return,g)}}break;case 1:vl(e,t),yl(t),512&i&&null!==n&&$s(n,n.return);break;case 5:if(vl(e,t),yl(t),512&i&&null!==n&&$s(n,n.return),32&t.flags){var r=t.stateNode;try{dt(r,"")}catch(g){Cu(t,t.return,g)}}if(4&i&&null!=(r=t.stateNode)){var a=t.memoizedProps,s=null!==n?n.memoizedProps:a,l=t.type,u=t.updateQueue;if(t.updateQueue=null,null!==u)try{"input"===l&&"radio"===a.type&&null!=a.name&&Q(r,a),_t(l,s);var c=_t(l,a);for(s=0;s<u.length;s+=2){var h=u[s],d=u[s+1];"style"===h?gt(r,d):"dangerouslySetInnerHTML"===h?ht(r,d):"children"===h?dt(r,d):_(r,h,d,c)}switch(l){case"input":J(r,a);break;case"textarea":ot(r,a);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?nt(r,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?nt(r,!!a.multiple,a.defaultValue,!0):nt(r,!!a.multiple,a.multiple?[]:"",!1))}r[fr]=a}catch(g){Cu(t,t.return,g)}}break;case 6:if(vl(e,t),yl(t),4&i){if(null===t.stateNode)throw Error(o(162));r=t.stateNode,a=t.memoizedProps;try{r.nodeValue=a}catch(g){Cu(t,t.return,g)}}break;case 3:if(vl(e,t),yl(t),4&i&&null!==n&&n.memoizedState.isDehydrated)try{He(e.containerInfo)}catch(g){Cu(t,t.return,g)}break;case 4:default:vl(e,t),yl(t);break;case 13:vl(e,t),yl(t),8192&(r=t.child).flags&&(a=null!==r.memoizedState,r.stateNode.isHidden=a,!a||null!==r.alternate&&null!==r.alternate.memoizedState||(Ul=Qt())),4&i&&pl(t);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&t.mode?(Ks=(c=Ks)||h,vl(e,t),Ks=c):vl(e,t),yl(t),8192&i){if(c=null!==t.memoizedState,(t.stateNode.isHidden=c)&&!h&&0!==(1&t.mode))for(Js=t,h=t.child;null!==h;){for(d=Js=h;null!==Js;){switch(p=(f=Js).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:$s(f,f.return);var v=f.stateNode;if("function"===typeof v.componentWillUnmount){i=f,n=f.return;try{e=i,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(g){Cu(i,n,g)}}break;case 5:$s(f,f.return);break;case 22:if(null!==f.memoizedState){xl(d);continue}}null!==p?(p.return=f,Js=p):xl(d)}h=h.sibling}t:for(h=null,d=t;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,c?"function"===typeof(a=r.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,s=void 0!==(u=d.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=vt("display",s))}catch(g){Cu(t,t.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Cu(t,t.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:vl(e,t),yl(t),4&i&&pl(t);case 21:}}function yl(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(al(n)){var i=n;break t}n=n.return}throw Error(o(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(dt(r,""),i.flags&=-33),ul(t,sl(t),r);break;case 3:case 4:var a=i.stateNode.containerInfo;ll(t,sl(t),a);break;default:throw Error(o(161))}}catch(s){Cu(t,t.return,s)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function ml(t,e,n){Js=t,_l(t,e,n)}function _l(t,e,n){for(var i=0!==(1&t.mode);null!==Js;){var r=Js,o=r.child;if(22===r.tag&&i){var a=null!==r.memoizedState||Ys;if(!a){var s=r.alternate,l=null!==s&&null!==s.memoizedState||Ks;s=Ys;var u=Ks;if(Ys=a,(Ks=l)&&!u)for(Js=r;null!==Js;)l=(a=Js).child,22===a.tag&&null!==a.memoizedState?bl(r):null!==l?(l.return=a,Js=l):bl(r);for(;null!==o;)Js=o,_l(o,e,n),o=o.sibling;Js=r,Ys=s,Ks=u}wl(t)}else 0!==(8772&r.subtreeFlags)&&null!==o?(o.return=r,Js=o):wl(t)}}function wl(t){for(;null!==Js;){var e=Js;if(0!==(8772&e.flags)){var n=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Ks||il(5,e);break;case 1:var i=e.stateNode;if(4&e.flags&&!Ks)if(null===n)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:yo(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;null!==a&&Oo(e,a,i);break;case 3:var s=e.updateQueue;if(null!==s){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}Oo(e,s,n)}break;case 5:var l=e.stateNode;if(null===n&&4&e.flags){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var c=e.alternate;if(null!==c){var h=c.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&He(d)}}}break;default:throw Error(o(163))}Ks||512&e.flags&&rl(e)}catch(f){Cu(e,e.return,f)}}if(e===t){Js=null;break}if(null!==(n=e.sibling)){n.return=e.return,Js=n;break}Js=e.return}}function xl(t){for(;null!==Js;){var e=Js;if(e===t){Js=null;break}var n=e.sibling;if(null!==n){n.return=e.return,Js=n;break}Js=e.return}}function bl(t){for(;null!==Js;){var e=Js;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{il(4,e)}catch(l){Cu(e,n,l)}break;case 1:var i=e.stateNode;if("function"===typeof i.componentDidMount){var r=e.return;try{i.componentDidMount()}catch(l){Cu(e,r,l)}}var o=e.return;try{rl(e)}catch(l){Cu(e,o,l)}break;case 5:var a=e.return;try{rl(e)}catch(l){Cu(e,a,l)}}}catch(l){Cu(e,e.return,l)}if(e===t){Js=null;break}var s=e.sibling;if(null!==s){s.return=e.return,Js=s;break}Js=e.return}}var kl,Cl=Math.ceil,Sl=w.ReactCurrentDispatcher,Al=w.ReactCurrentOwner,El=w.ReactCurrentBatchConfig,Tl=0,Pl=null,Il=null,Zl=0,Rl=0,Ml=Cr(0),Fl=0,Dl=null,Bl=0,zl=0,Ll=0,Ol=null,Nl=null,Ul=0,Hl=1/0,Wl=null,Vl=!1,Xl=null,Gl=null,jl=!1,ql=null,Yl=0,Kl=0,Ql=null,Jl=-1,$l=0;function tu(){return 0!==(6&Tl)?Qt():-1!==Jl?Jl:Jl=Qt()}function eu(t){return 0===(1&t.mode)?1:0!==(2&Tl)&&0!==Zl?Zl&-Zl:null!==go.transition?(0===$l&&($l=ve()),$l):0!==(t=_e)?t:t=void 0===(t=window.event)?16:Ke(t.type)}function nu(t,e,n,i){if(50<Kl)throw Kl=0,Ql=null,Error(o(185));ye(t,n,i),0!==(2&Tl)&&t===Pl||(t===Pl&&(0===(2&Tl)&&(zl|=n),4===Fl&&su(t,Zl)),iu(t,i),1===n&&0===Tl&&0===(1&e.mode)&&(Hl=Qt()+500,Or&&Hr()))}function iu(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-ae(o),s=1<<a,l=r[a];-1===l?0!==(s&n)&&0===(s&i)||(r[a]=fe(s,e)):l<=e&&(t.expiredLanes|=s),o&=~s}}(t,e);var i=de(t,t===Pl?Zl:0);if(0===i)null!==n&&qt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(null!=n&&qt(n),1===e)0===t.tag?function(t){Or=!0,Ur(t)}(lu.bind(null,t)):Ur(lu.bind(null,t)),ar((function(){0===(6&Tl)&&Hr()})),n=null;else{switch(we(i)){case 1:n=$t;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=ie}n=Pu(n,ru.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ru(t,e){if(Jl=-1,$l=0,0!==(6&Tl))throw Error(o(327));var n=t.callbackNode;if(bu()&&t.callbackNode!==n)return null;var i=de(t,t===Pl?Zl:0);if(0===i)return null;if(0!==(30&i)||0!==(i&t.expiredLanes)||e)e=gu(t,i);else{e=i;var r=Tl;Tl|=2;var a=pu();for(Pl===t&&Zl===e||(Wl=null,Hl=Qt()+500,du(t,e));;)try{mu();break}catch(l){fu(t,l)}bo(),Sl.current=a,Tl=r,null!==Il?e=0:(Pl=null,Zl=0,e=Fl)}if(0!==e){if(2===e&&(0!==(r=pe(t))&&(i=r,e=ou(t,r))),1===e)throw n=Dl,du(t,0),su(t,i),iu(t,Qt()),n;if(6===e)su(t,i);else{if(r=t.current.alternate,0===(30&i)&&!function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!si(o(),r))return!1}catch(s){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(r)&&(2===(e=gu(t,i))&&(0!==(a=pe(t))&&(i=a,e=ou(t,a))),1===e))throw n=Dl,du(t,0),su(t,i),iu(t,Qt()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(o(345));case 2:case 5:xu(t,Nl,Wl);break;case 3:if(su(t,i),(130023424&i)===i&&10<(e=Ul+500-Qt())){if(0!==de(t,0))break;if(((r=t.suspendedLanes)&i)!==i){tu(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ir(xu.bind(null,t,Nl,Wl),e);break}xu(t,Nl,Wl);break;case 4:if(su(t,i),(4194240&i)===i)break;for(e=t.eventTimes,r=-1;0<i;){var s=31-ae(i);a=1<<s,(s=e[s])>r&&(r=s),i&=~a}if(i=r,10<(i=(120>(i=Qt()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Cl(i/1960))-i)){t.timeoutHandle=ir(xu.bind(null,t,Nl,Wl),i);break}xu(t,Nl,Wl);break;default:throw Error(o(329))}}}return iu(t,Qt()),t.callbackNode===n?ru.bind(null,t):null}function ou(t,e){var n=Ol;return t.current.memoizedState.isDehydrated&&(du(t,e).flags|=256),2!==(t=gu(t,e))&&(e=Nl,Nl=n,null!==e&&au(e)),t}function au(t){null===Nl?Nl=t:Nl.push.apply(Nl,t)}function su(t,e){for(e&=~Ll,e&=~zl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ae(e),i=1<<n;t[n]=-1,e&=~i}}function lu(t){if(0!==(6&Tl))throw Error(o(327));bu();var e=de(t,0);if(0===(1&e))return iu(t,Qt()),null;var n=gu(t,e);if(0!==t.tag&&2===n){var i=pe(t);0!==i&&(e=i,n=ou(t,i))}if(1===n)throw n=Dl,du(t,0),su(t,e),iu(t,Qt()),n;if(6===n)throw Error(o(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xu(t,Nl,Wl),iu(t,Qt()),null}function uu(t,e){var n=Tl;Tl|=1;try{return t(e)}finally{0===(Tl=n)&&(Hl=Qt()+500,Or&&Hr())}}function cu(t){null!==ql&&0===ql.tag&&0===(6&Tl)&&bu();var e=Tl;Tl|=1;var n=El.transition,i=_e;try{if(El.transition=null,_e=1,t)return t()}finally{_e=i,El.transition=n,0===(6&(Tl=e))&&Hr()}}function hu(){Rl=Ml.current,Sr(Ml)}function du(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,rr(n)),null!==Il)for(n=Il.return;null!==n;){var i=n;switch(eo(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Mr();break;case 3:oa(),Sr(Pr),Sr(Tr),ha();break;case 5:sa(i);break;case 4:oa();break;case 13:case 19:Sr(la);break;case 10:ko(i.type._context);break;case 22:case 23:hu()}n=n.return}if(Pl=t,Il=t=Mu(t.current,null),Zl=Rl=e,Fl=0,Dl=null,Ll=zl=Bl=0,Nl=Ol=null,null!==Eo){for(e=0;e<Eo.length;e++)if(null!==(i=(n=Eo[e]).interleaved)){n.interleaved=null;var r=i.next,o=n.pending;if(null!==o){var a=o.next;o.next=r,i.next=a}n.pending=i}Eo=null}return t}function fu(t,e){for(;;){var n=Il;try{if(bo(),da.current=as,ma){for(var i=va.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}ma=!1}if(pa=0,ya=ga=va=null,_a=!1,wa=0,Al.current=null,null===n||null===n.return){Fl=1,Dl=e,Il=null;break}t:{var a=t,s=n.return,l=n,u=e;if(e=Zl,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ys(s);if(null!==p){p.flags&=-257,ms(p,s,l,0,e),1&p.mode&&gs(a,c,e),u=c;var v=(e=p).updateQueue;if(null===v){var g=new Set;g.add(u),e.updateQueue=g}else v.add(u);break t}if(0===(1&e)){gs(a,c,e),vu();break t}u=Error(o(426))}else if(ro&&1&l.mode){var y=ys(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ms(y,s,l,0,e),vo(cs(u,l));break t}}a=u=cs(u,l),4!==Fl&&(Fl=2),null===Ol?Ol=[a]:Ol.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e,zo(a,ps(0,u,e));break t;case 1:l=u;var m=a.type,_=a.stateNode;if(0===(128&a.flags)&&("function"===typeof m.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===Gl||!Gl.has(_)))){a.flags|=65536,e&=-e,a.lanes|=e,zo(a,vs(a,l,e));break t}}a=a.return}while(null!==a)}wu(n)}catch(w){e=w,Il===n&&null!==n&&(Il=n=n.return);continue}break}}function pu(){var t=Sl.current;return Sl.current=as,null===t?as:t}function vu(){0!==Fl&&3!==Fl&&2!==Fl||(Fl=4),null===Pl||0===(268435455&Bl)&&0===(268435455&zl)||su(Pl,Zl)}function gu(t,e){var n=Tl;Tl|=2;var i=pu();for(Pl===t&&Zl===e||(Wl=null,du(t,e));;)try{yu();break}catch(r){fu(t,r)}if(bo(),Tl=n,Sl.current=i,null!==Il)throw Error(o(261));return Pl=null,Zl=0,Fl}function yu(){for(;null!==Il;)_u(Il)}function mu(){for(;null!==Il&&!Yt();)_u(Il)}function _u(t){var e=kl(t.alternate,t,Rl);t.memoizedProps=t.pendingProps,null===e?wu(t):Il=e,Al.current=null}function wu(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(n=js(n,e,Rl)))return void(Il=n)}else{if(null!==(n=qs(n,e)))return n.flags&=32767,void(Il=n);if(null===t)return Fl=6,void(Il=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Il=e);Il=e=t}while(null!==e);0===Fl&&(Fl=5)}function xu(t,e,n){var i=_e,r=El.transition;try{El.transition=null,_e=1,function(t,e,n,i){do{bu()}while(null!==ql);if(0!==(6&Tl))throw Error(o(327));n=t.finishedWork;var r=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(o(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-ae(n),o=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~o}}(t,a),t===Pl&&(Il=Pl=null,Zl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||jl||(jl=!0,Pu(ee,(function(){return bu(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=El.transition,El.transition=null;var s=_e;_e=1;var l=Tl;Tl|=4,Al.current=null,function(t,e){if(tr=Ve,fi(t=di())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var i=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{n.nodeType,a.nodeType}catch(x){n=null;break t}var s=0,l=-1,u=-1,c=0,h=0,d=t,f=null;e:for(;;){for(var p;d!==n||0!==r&&3!==d.nodeType||(l=s+r),d!==a||0!==i&&3!==d.nodeType||(u=s+i),3===d.nodeType&&(s+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===t)break e;if(f===n&&++c===r&&(l=s),f===a&&++h===i&&(u=s),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(er={focusedElem:t,selectionRange:n},Ve=!1,Js=e;null!==Js;)if(t=(e=Js).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,Js=t;else for(;null!==Js;){e=Js;try{var v=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var g=v.memoizedProps,y=v.memoizedState,m=e.stateNode,_=m.getSnapshotBeforeUpdate(e.elementType===e.type?g:yo(e.type,g),y);m.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var w=e.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(o(163))}}catch(x){Cu(e,e.return,x)}if(null!==(t=e.sibling)){t.return=e.return,Js=t;break}Js=e.return}v=el,el=!1}(t,n),gl(n,t),pi(er),Ve=!!tr,er=tr=null,t.current=n,ml(n,t,r),Kt(),Tl=l,_e=s,El.transition=a}else t.current=n;if(jl&&(jl=!1,ql=t,Yl=r),0===(a=t.pendingLanes)&&(Gl=null),function(t){if(oe&&"function"===typeof oe.onCommitFiberRoot)try{oe.onCommitFiberRoot(re,t,void 0,128===(128&t.current.flags))}catch(e){}}(n.stateNode),iu(t,Qt()),null!==e)for(i=t.onRecoverableError,n=0;n<e.length;n++)i((r=e[n]).value,{componentStack:r.stack,digest:r.digest});if(Vl)throw Vl=!1,t=Xl,Xl=null,t;0!==(1&Yl)&&0!==t.tag&&bu(),0!==(1&(a=t.pendingLanes))?t===Ql?Kl++:(Kl=0,Ql=t):Kl=0,Hr()}(t,e,n,i)}finally{El.transition=r,_e=i}return null}function bu(){if(null!==ql){var t=we(Yl),e=El.transition,n=_e;try{if(El.transition=null,_e=16>t?16:t,null===ql)var i=!1;else{if(t=ql,ql=null,Yl=0,0!==(6&Tl))throw Error(o(331));var r=Tl;for(Tl|=4,Js=t.current;null!==Js;){var a=Js,s=a.child;if(0!==(16&Js.flags)){var l=a.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Js=c;null!==Js;){var h=Js;switch(h.tag){case 0:case 11:case 15:nl(8,h,a)}var d=h.child;if(null!==d)d.return=h,Js=d;else for(;null!==Js;){var f=(h=Js).sibling,p=h.return;if(ol(h),h===c){Js=null;break}if(null!==f){f.return=p,Js=f;break}Js=p}}}var v=a.alternate;if(null!==v){var g=v.child;if(null!==g){v.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Js=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Js=s;else t:for(;null!==Js;){if(0!==(2048&(a=Js).flags))switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var m=a.sibling;if(null!==m){m.return=a.return,Js=m;break t}Js=a.return}}var _=t.current;for(Js=_;null!==Js;){var w=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==w)w.return=s,Js=w;else t:for(s=_;null!==Js;){if(0!==(2048&(l=Js).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(b){Cu(l,l.return,b)}if(l===s){Js=null;break t}var x=l.sibling;if(null!==x){x.return=l.return,Js=x;break t}Js=l.return}}if(Tl=r,Hr(),oe&&"function"===typeof oe.onPostCommitFiberRoot)try{oe.onPostCommitFiberRoot(re,t)}catch(b){}i=!0}return i}finally{_e=n,El.transition=e}}return!1}function ku(t,e,n){t=Do(t,e=ps(0,e=cs(n,e),1),1),e=tu(),null!==t&&(ye(t,1,e),iu(t,e))}function Cu(t,e,n){if(3===t.tag)ku(t,t,n);else for(;null!==e;){if(3===e.tag){ku(e,t,n);break}if(1===e.tag){var i=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Gl||!Gl.has(i))){e=Do(e,t=vs(e,t=cs(n,t),1),1),t=tu(),null!==e&&(ye(e,1,t),iu(e,t));break}}e=e.return}}function Su(t,e,n){var i=t.pingCache;null!==i&&i.delete(e),e=tu(),t.pingedLanes|=t.suspendedLanes&n,Pl===t&&(Zl&n)===n&&(4===Fl||3===Fl&&(130023424&Zl)===Zl&&500>Qt()-Ul?du(t,0):Ll|=n),iu(t,e)}function Au(t,e){0===e&&(0===(1&t.mode)?e=1:(e=ce,0===(130023424&(ce<<=1))&&(ce=4194304)));var n=tu();null!==(t=Io(t,e))&&(ye(t,e,n),iu(t,n))}function Eu(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),Au(t,n)}function Tu(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(o(314))}null!==i&&i.delete(e),Au(t,n)}function Pu(t,e){return jt(t,e)}function Iu(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zu(t,e,n,i){return new Iu(t,e,n,i)}function Ru(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Mu(t,e){var n=t.alternate;return null===n?((n=Zu(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Fu(t,e,n,i,r,a){var s=2;if(i=t,"function"===typeof t)Ru(t)&&(s=1);else if("string"===typeof t)s=5;else t:switch(t){case k:return Du(n.children,r,a,e);case C:s=8,r|=8;break;case S:return(t=Zu(12,n,e,2|r)).elementType=S,t.lanes=a,t;case P:return(t=Zu(13,n,e,r)).elementType=P,t.lanes=a,t;case I:return(t=Zu(19,n,e,r)).elementType=I,t.lanes=a,t;case M:return Bu(n,r,a,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case A:s=10;break t;case E:s=9;break t;case T:s=11;break t;case Z:s=14;break t;case R:s=16,i=null;break t}throw Error(o(130,null==t?t:typeof t,""))}return(e=Zu(s,n,e,r)).elementType=t,e.type=i,e.lanes=a,e}function Du(t,e,n,i){return(t=Zu(7,t,i,e)).lanes=n,t}function Bu(t,e,n,i){return(t=Zu(22,t,i,e)).elementType=M,t.lanes=n,t.stateNode={isHidden:!1},t}function zu(t,e,n){return(t=Zu(6,t,null,e)).lanes=n,t}function Lu(t,e,n){return(e=Zu(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ou(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ge(0),this.expirationTimes=ge(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ge(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Nu(t,e,n,i,r,o,a,s,l){return t=new Ou(t,e,n,s,l),1===e?(e=1,!0===o&&(e|=8)):e=0,o=Zu(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ro(o),t}function Uu(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:b,key:null==i?null:""+i,children:t,containerInfo:e,implementation:n}}function Hu(t){if(!t)return Er;t:{if(Ht(t=t._reactInternals)!==t||1!==t.tag)throw Error(o(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Rr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(o(171))}if(1===t.tag){var n=t.type;if(Rr(n))return Dr(t,n,e)}return e}function Wu(t,e,n,i,r,o,a,s,l){return(t=Nu(n,i,!0,t,0,o,0,s,l)).context=Hu(null),n=t.current,(o=Fo(i=tu(),r=eu(n))).callback=void 0!==e&&null!==e?e:null,Do(n,o,r),t.current.lanes=r,ye(t,r,i),iu(t,i),t}function Vu(t,e,n,i){var r=e.current,o=tu(),a=eu(r);return n=Hu(n),null===e.context?e.context=n:e.pendingContext=n,(e=Fo(o,a)).payload={element:t},null!==(i=void 0===i?null:i)&&(e.callback=i),null!==(t=Do(r,e,a))&&(nu(t,r,a,o),Bo(t,r,a)),a}function Xu(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Gu(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function ju(t,e){Gu(t,e),(t=t.alternate)&&Gu(t,e)}kl=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||Pr.current)ws=!0;else{if(0===(t.lanes&n)&&0===(128&e.flags))return ws=!1,function(t,e,n){switch(e.tag){case 3:Is(e),po();break;case 5:aa(e);break;case 1:Rr(e.type)&&Br(e);break;case 4:ra(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Ar(mo,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=e.memoizedState))return null!==i.dehydrated?(Ar(la,1&la.current),e.flags|=128,null):0!==(n&e.child.childLanes)?zs(t,e,n):(Ar(la,1&la.current),null!==(t=Vs(t,e,n))?t.sibling:null);Ar(la,1&la.current);break;case 19:if(i=0!==(n&e.childLanes),0!==(128&t.flags)){if(i)return Hs(t,e,n);e.flags|=128}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ar(la,la.current),i)break;return null;case 22:case 23:return e.lanes=0,Ss(t,e,n)}return Vs(t,e,n)}(t,e,n);ws=0!==(131072&t.flags)}else ws=!1,ro&&0!==(1048576&e.flags)&&$r(e,Gr,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Ws(t,e),t=e.pendingProps;var r=Zr(e,Tr.current);So(e,n),r=Ca(null,e,i,t,r,n);var a=Sa();return e.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Rr(i)?(a=!0,Br(e)):a=!1,e.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Ro(e),r.updater=Ho,e.stateNode=r,r._reactInternals=e,Go(e,i,t,n),e=Ps(null,e,i,!0,a,n)):(e.tag=0,ro&&a&&to(e),xs(null,e,r,n),e=e.child),e;case 16:i=e.elementType;t:{switch(Ws(t,e),t=e.pendingProps,i=(r=i._init)(i._payload),e.type=i,r=e.tag=function(t){if("function"===typeof t)return Ru(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===T)return 11;if(t===Z)return 14}return 2}(i),t=yo(i,t),r){case 0:e=Es(null,e,i,t,n);break t;case 1:e=Ts(null,e,i,t,n);break t;case 11:e=bs(null,e,i,t,n);break t;case 14:e=ks(null,e,i,yo(i.type,t),n);break t}throw Error(o(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,Es(t,e,i,r=e.elementType===i?r:yo(i,r),n);case 1:return i=e.type,r=e.pendingProps,Ts(t,e,i,r=e.elementType===i?r:yo(i,r),n);case 3:t:{if(Is(e),null===t)throw Error(o(387));i=e.pendingProps,r=(a=e.memoizedState).element,Mo(t,e),Lo(e,i,null,n);var s=e.memoizedState;if(i=s.element,a.isDehydrated){if(a={element:i,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=a,e.memoizedState=a,256&e.flags){e=Zs(t,e,i,n,r=cs(Error(o(423)),e));break t}if(i!==r){e=Zs(t,e,i,n,r=cs(Error(o(424)),e));break t}for(io=ur(e.stateNode.containerInfo.firstChild),no=e,ro=!0,oo=null,n=Jo(e,null,i,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(po(),i===r){e=Vs(t,e,n);break t}xs(t,e,i,n)}e=e.child}return e;case 5:return aa(e),null===t&&uo(e),i=e.type,r=e.pendingProps,a=null!==t?t.memoizedProps:null,s=r.children,nr(i,r)?s=null:null!==a&&nr(i,a)&&(e.flags|=32),As(t,e),xs(t,e,s,n),e.child;case 6:return null===t&&uo(e),null;case 13:return zs(t,e,n);case 4:return ra(e,e.stateNode.containerInfo),i=e.pendingProps,null===t?e.child=Qo(e,null,i,n):xs(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,bs(t,e,i,r=e.elementType===i?r:yo(i,r),n);case 7:return xs(t,e,e.pendingProps,n),e.child;case 8:case 12:return xs(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(i=e.type._context,r=e.pendingProps,a=e.memoizedProps,s=r.value,Ar(mo,i._currentValue),i._currentValue=s,null!==a)if(si(a.value,s)){if(a.children===r.children&&!Pr.current){e=Vs(t,e,n);break t}}else for(null!==(a=e.child)&&(a.return=e);null!==a;){var l=a.dependencies;if(null!==l){s=a.child;for(var u=l.firstContext;null!==u;){if(u.context===i){if(1===a.tag){(u=Fo(-1,n&-n)).tag=2;var c=a.updateQueue;if(null!==c){var h=(c=c.shared).pending;null===h?u.next=u:(u.next=h.next,h.next=u),c.pending=u}}a.lanes|=n,null!==(u=a.alternate)&&(u.lanes|=n),Co(a.return,n,e),l.lanes|=n;break}u=u.next}}else if(10===a.tag)s=a.type===e.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Co(s,n,e),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===e){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}xs(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,So(e,n),i=i(r=Ao(r)),e.flags|=1,xs(t,e,i,n),e.child;case 14:return r=yo(i=e.type,e.pendingProps),ks(t,e,i,r=yo(i.type,r),n);case 15:return Cs(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:yo(i,r),Ws(t,e),e.tag=1,Rr(i)?(t=!0,Br(e)):t=!1,So(e,n),Vo(e,i,r),Go(e,i,r,n),Ps(null,e,i,!0,t,n);case 19:return Hs(t,e,n);case 22:return Ss(t,e,n)}throw Error(o(156,e.tag))};var qu="function"===typeof reportError?reportError:function(t){console.error(t)};function Yu(t){this._internalRoot=t}function Ku(t){this._internalRoot=t}function Qu(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Ju(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function $u(){}function tc(t,e,n,i,r){var o=n._reactRootContainer;if(o){var a=o;if("function"===typeof r){var s=r;r=function(){var t=Xu(a);s.call(t)}}Vu(e,a,t,r)}else a=function(t,e,n,i,r){if(r){if("function"===typeof i){var o=i;i=function(){var t=Xu(a);o.call(t)}}var a=Wu(e,i,t,0,null,!1,0,"",$u);return t._reactRootContainer=a,t[pr]=a.current,Hi(8===t.nodeType?t.parentNode:t),cu(),a}for(;r=t.lastChild;)t.removeChild(r);if("function"===typeof i){var s=i;i=function(){var t=Xu(l);s.call(t)}}var l=Nu(t,0,!1,null,0,!1,0,"",$u);return t._reactRootContainer=l,t[pr]=l.current,Hi(8===t.nodeType?t.parentNode:t),cu((function(){Vu(e,l,n,i)})),l}(n,e,t,r,i);return Xu(a)}Ku.prototype.render=Yu.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(o(409));Vu(t,e,null,null)},Ku.prototype.unmount=Yu.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;cu((function(){Vu(null,t,null,null)})),e[pr]=null}},Ku.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ce();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Me.length&&0!==e&&e<Me[n].priority;n++);Me.splice(n,0,t),0===n&&ze(t)}},xe=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=he(e.pendingLanes);0!==n&&(me(e,1|n),iu(e,Qt()),0===(6&Tl)&&(Hl=Qt()+500,Hr()))}break;case 13:cu((function(){var e=Io(t,1);if(null!==e){var n=tu();nu(e,t,1,n)}})),ju(t,1)}},be=function(t){if(13===t.tag){var e=Io(t,134217728);if(null!==e)nu(e,t,134217728,tu());ju(t,134217728)}},ke=function(t){if(13===t.tag){var e=eu(t),n=Io(t,e);if(null!==n)nu(n,t,e,tu());ju(t,e)}},Ce=function(){return _e},Se=function(t,e){var n=_e;try{return _e=t,e()}finally{_e=n}},bt=function(t,e,n){switch(e){case"input":if(J(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=xr(i);if(!r)throw Error(o(90));j(i),J(i,r)}}}break;case"textarea":ot(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},Tt=uu,Pt=cu;var ec={usingClientEntryPoint:!1,Events:[_r,wr,xr,At,Et,uu]},nc={findFiberByHostInstance:mr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ic={bundleType:nc.bundleType,version:nc.version,rendererPackageName:nc.rendererPackageName,rendererConfig:nc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Xt(t))?null:t.stateNode},findFiberByHostInstance:nc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rc.isDisabled&&rc.supportsFiber)try{re=rc.inject(ic),oe=rc}catch(ct){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ec,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qu(e))throw Error(o(200));return Uu(t,e,null,n)},e.createRoot=function(t,e){if(!Qu(t))throw Error(o(299));var n=!1,i="",r=qu;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(i=e.identifierPrefix),void 0!==e.onRecoverableError&&(r=e.onRecoverableError)),e=Nu(t,1,!1,null,0,n,0,i,r),t[pr]=e.current,Hi(8===t.nodeType?t.parentNode:t),new Yu(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(o(188));throw t=Object.keys(t).join(","),Error(o(268,t))}return t=null===(t=Xt(e))?null:t.stateNode},e.flushSync=function(t){return cu(t)},e.hydrate=function(t,e,n){if(!Ju(e))throw Error(o(200));return tc(null,t,e,!0,n)},e.hydrateRoot=function(t,e,n){if(!Qu(t))throw Error(o(405));var i=null!=n&&n.hydratedSources||null,r=!1,a="",s=qu;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),e=Wu(e,null,t,1,null!=n?n:null,r,0,a,s),t[pr]=e.current,Hi(t),i)for(t=0;t<i.length;t++)r=(r=(n=i[t])._getVersion)(n._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Ku(e)},e.render=function(t,e,n){if(!Ju(e))throw Error(o(200));return tc(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Ju(t))throw Error(o(40));return!!t._reactRootContainer&&(cu((function(){tc(null,null,t,!1,(function(){t._reactRootContainer=null,t[pr]=null}))})),!0)},e.unstable_batchedUpdates=uu,e.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!Ju(n))throw Error(o(200));if(null==t||void 0===t._reactInternals)throw Error(o(38));return tc(t,e,n,!1,i)},e.version="18.2.0-next-9e3b772b8-20220608"},250:function(t,e,n){"use strict";var i=n(164);e.createRoot=i.createRoot,e.hydrateRoot=i.hydrateRoot},164:function(t,e,n){"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(463)},374:function(t,e,n){"use strict";var i=n(791),r=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(t,e,n){var i,o={},u=null,c=null;for(i in void 0!==n&&(u=""+n),void 0!==e.key&&(u=""+e.key),void 0!==e.ref&&(c=e.ref),e)a.call(e,i)&&!l.hasOwnProperty(i)&&(o[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps)void 0===o[i]&&(o[i]=e[i]);return{$$typeof:r,type:t,key:u,ref:c,props:o,_owner:s.current}}e.jsx=u},117:function(t,e){"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,g={};function y(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||p}function m(){}function _(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},m.prototype=y.prototype;var w=_.prototype=new m;w.constructor=_,v(w,y.prototype),w.isPureReactComponent=!0;var x=Array.isArray,b=Object.prototype.hasOwnProperty,k={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function S(t,e,i){var r,o={},a=null,s=null;if(null!=e)for(r in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)b.call(e,r)&&!C.hasOwnProperty(r)&&(o[r]=e[r]);var l=arguments.length-2;if(1===l)o.children=i;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];o.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:n,type:t,key:a,ref:s,props:o,_owner:k.current}}function A(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var E=/\/+/g;function T(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function P(t,e,r,o,a){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var l=!1;if(null===t)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case n:case i:l=!0}}if(l)return a=a(l=t),t=""===o?"."+T(l,0):o,x(a)?(r="",null!=t&&(r=t.replace(E,"$&/")+"/"),P(a,e,r,"",(function(t){return t}))):null!=a&&(A(a)&&(a=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(E,"$&/")+"/")+t)),e.push(a)),1;if(l=0,o=""===o?".":o+":",x(t))for(var u=0;u<t.length;u++){var c=o+T(s=t[u],u);l+=P(s,e,r,c,a)}else if(c=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"===typeof c)for(t=c.call(t),u=0;!(s=t.next()).done;)l+=P(s=s.value,e,r,c=o+T(s,u++),a);else if("object"===s)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function I(t,e,n){if(null==t)return t;var i=[],r=0;return P(t,i,"","",(function(t){return e.call(n,t,r++)})),i}function Z(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var R={current:null},M={transition:null},F={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:M,ReactCurrentOwner:k};e.Children={map:I,forEach:function(t,e,n){I(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return I(t,(function(){e++})),e},toArray:function(t){return I(t,(function(t){return t}))||[]},only:function(t){if(!A(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=y,e.Fragment=r,e.Profiler=a,e.PureComponent=_,e.StrictMode=o,e.Suspense=c,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F,e.cloneElement=function(t,e,i){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=v({},t.props),o=t.key,a=t.ref,s=t._owner;if(null!=e){if(void 0!==e.ref&&(a=e.ref,s=k.current),void 0!==e.key&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)b.call(e,u)&&!C.hasOwnProperty(u)&&(r[u]=void 0===e[u]&&void 0!==l?l[u]:e[u])}var u=arguments.length-2;if(1===u)r.children=i;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:n,type:t.type,key:o,ref:a,props:r,_owner:s}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:t},t.Consumer=t},e.createElement=S,e.createFactory=function(t){var e=S.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:u,render:t}},e.isValidElement=A,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:Z}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=M.transition;M.transition={};try{t()}finally{M.transition=e}},e.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},e.useCallback=function(t,e){return R.current.useCallback(t,e)},e.useContext=function(t){return R.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return R.current.useDeferredValue(t)},e.useEffect=function(t,e){return R.current.useEffect(t,e)},e.useId=function(){return R.current.useId()},e.useImperativeHandle=function(t,e,n){return R.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return R.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return R.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return R.current.useMemo(t,e)},e.useReducer=function(t,e,n){return R.current.useReducer(t,e,n)},e.useRef=function(t){return R.current.useRef(t)},e.useState=function(t){return R.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return R.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return R.current.useTransition()},e.version="18.2.0"},791:function(t,e,n){"use strict";t.exports=n(117)},184:function(t,e,n){"use strict";t.exports=n(374)},677:function(t){var e=0,n=1,i=2,r=3,o=4,a=5,s=6,l=21,u=21,c=3,h=7,d=3,f=7,p=10;function v(t){t||(t={}),t.room||(t.room={}),this.max_width=t.width||l,this.max_height=t.height||u,this.room_min_width=t.room.min_width||c,this.room_max_width=t.room.max_width||h,this.room_min_height=t.room.min_height||d,this.room_max_height=t.room.max_height||f,this.room_ideal_count=t.room.ideal||p,this.retry_count=t.retry||p,this.want_special=!!t.special}function g(t,e){var n=Math.floor(t),i=Math.floor(e);return Math.floor(Math.random()*(i+1-n)+n)}function y(t,e){var n=Math.floor(t),i=Math.floor(e);n%2===0&&n++,i%2===0&&i--,n-=1,i-=1,n/=2,i/=2;var r=Math.floor(Math.random()*(i+1-n)+n);return r*=2,r+=1}v.prototype.build=function(){return this.world=null,this.rooms={},this.doors={},this.walls=[],this.enter=null,this.exit=null,this.special=null,this.deadends=[],this.room_id=0,this.door_id=0,this.createVoid(),this.addStarterRoom(),this.generateRooms(),this.addSpecialRooms(),this.buildWalls(),{width:this.max_width,height:this.max_height,enter:this.enter,exit:this.exit,deadends:this.deadends,special:this.special,door_count:this.door_id,doors:this.doors,room_count:this.room_id,rooms:this.rooms,walls:this.walls,world:this.world}},v.prototype.createVoid=function(){for(var t=[],n=0;n<this.max_height;n++){t[n]=[];for(var i=0;i<this.max_width;i++)t[n][i]=e}this.world=t},v.prototype.addStarterRoom=function(){var t=this.getRoomDimensions(),e=this.max_width-(t.width+2)+1,n=this.max_height-(t.height+2)+1,i=y(1,e),r=y(1,n);this.addRoom(i,r,t.width,t.height)},v.prototype.getRoomDimensions=function(){return{width:y(this.room_min_width,this.room_max_width),height:y(this.room_min_height,this.room_max_height)}},v.prototype.addRoom=function(t,e,i,r){var o=this.room_id++;this.rooms[o]={left:t,top:e,width:i,height:r,id:o,walls:[],neighbors:[],doors:[]};for(var a=e;a<e+r;a++)for(var s=t;s<t+i;s++)this.world[a][s]=n;return o},v.prototype.addFloor=function(t,e){this.world[e][t]=n},v.prototype.generateRooms=function(){for(var t=this.retry_count;this.room_id<this.room_ideal_count&&(this.generateRoom()||!(--t<=0)););},v.prototype.generateRoom=function(){var t,e,n=g(0,3),i=1===n?1:3===n?-1:0,r=0===n?1:2===n?-1:0,o=this.getRoomDimensions();if(0===n?("south",t=1,e=y(1,this.max_width-o.width-2)):1===n?("east",t=y(1,this.max_height-o.height-2),e=1):2===n?("north",t=this.max_height-o.height-1,e=y(1,this.max_width-o.width-2)):3===n&&("west",t=y(1,this.max_height-o.height-2),e=this.max_width-o.width-1),!1!==this.collides(t,e,o.width,o.height))return!1;for(var a=null;!1===(a=this.collides(t+r,e+i,o.width,o.height));)if(t+=r,e+=i,this.invalid(t,e,o.width,o.height))return!1;var s=this.addRoom(e,t,o.width,o.height);return this.addDoorBetweenRooms(i,r,a,s),!0},v.prototype.collides=function(t,e,n,i){for(var r=t,o=e,a=n,s=i,l=0;l<this.room_id;l++){var u=this.rooms[l];if(!(o>u.left+u.width||o+a<u.left||r>u.top+u.height||r+s<u.top))return u.id}return!1},v.prototype.invalid=function(t,e,n,i){return t<=1||(e<=1||(t+i>=this.max_height-1||e+n>=this.max_width-1))},v.prototype.buildWalls=function(){for(var t=this.rooms,e=(this.world,0);e<this.room_id;e++){for(var n=t[e],i=n.left-1;i<n.left+n.width+1;i++)this.addWall(i,n.top-1,n);for(var r=n.top;r<n.top+n.height;r++)this.addWall(n.left+n.width,r,n);for(var o=n.left-1;o<n.left+n.width+1;o++)this.addWall(o,n.top+n.height,n);for(var a=n.top;a<n.top+n.height;a++)this.addWall(n.left-1,a,n)}},v.prototype.addWall=function(t,n,r){this.world[n][t]===e&&(this.world[n][t]=i,this.walls.push([t,n])),this.world[n][t]!==e&&this.world[n][t]!==i||r.walls.push([t,n])},v.prototype.addDoorBetweenRooms=function(t,e,n,i){var r,o,a,s=this.rooms[n],l=this.rooms[i];1===t?(r=s.left-1,o=g(Math.max(s.top,l.top)+1,Math.min(s.top+s.height,l.top+l.height)-2),a="h"):-1===t?(r=l.left-1,o=g(Math.max(l.top,s.top)+1,Math.min(l.top+l.height,s.top+s.height)-2),a="h"):-1===e?(r=g(Math.max(s.left,l.left)+1,Math.min(s.left+s.width,l.left+l.width)-2),o=l.top-1,a="v"):1===e&&(r=g(Math.max(l.left,s.left)+1,Math.min(l.left+l.width,s.left+s.width)-2),o=s.top-1,a="v"),this.addDoor(r,o,n,i,a),this.rooms[n].neighbors.push(i),this.rooms[i].neighbors.push(n)},v.prototype.addSpecialRooms=function(){for(var t,e=[],n={id:null,area:1/0},i=0;i<this.room_id;i++)1===(t=this.rooms[i]).neighbors.length&&(this.rooms[i].deadend=!0,e.push(i),t.width*t.height<n.area&&(n.id=i));if(this.want_special&&e.length>=2){var r=e.indexOf(n.id);e.splice(r,1);var l=this.rooms[n.id].doors[0],u=n.id;this.special={room_id:u,door_id:l};var c=this.doors[l];c.special=!0,this.rooms[u].special=!0,this.world[c.y][c.x]=o}!function(t){for(var e,n,i=t.length;i;e=Math.floor(Math.random()*i),n=t[--i],t[i]=t[e],t[e]=n);}(e);var h=e.pop();if("undefined"===typeof h)throw new Error("Unable to find a dead end room for Enter!");var d=this.randomNonEdgeInRoom(h);this.world[d.y][d.x]=a,this.enter={x:d.x,y:d.y,room_id:h},this.rooms[h].enter=!0;var f=this.rooms[h].doors[0];this.doors[f].enter=!0;var p=e.pop();if("undefined"===typeof p)throw new Error("Unable to find a dead end room for Exit!");var v=this.randomNonEdgeInRoom(p);this.world[v.y][v.x]=s,this.exit={x:v.x,y:v.y,room_id:p},this.rooms[p].exit=!0;var g=this.rooms[p].doors[0];this.doors[g].exit=!0,this.deadends=e},v.prototype.randomNonEdgeInRoom=function(t){var e=this.rooms[t];return{x:g(e.left+1,e.left+e.width-2),y:g(e.top+1,e.top+e.height-2)}},v.prototype.addDoor=function(t,e,n,i,o){this.world[e][t]=r;var a=this.door_id++;return this.doors[a]={x:t,y:e,id:a,orientation:o,rooms:[n,i]},this.rooms[n].doors.push(a),this.rooms[i].doors.push(a),a},t.exports=function(t){return new v(t).build()}},813:function(t,e){"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var i=n-1>>>1,r=t[i];if(!(0<o(r,e)))break t;t[i]=e,t[n]=r,n=i}}function i(t){return 0===t.length?null:t[0]}function r(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,r=t.length,a=r>>>1;i<a;){var s=2*(i+1)-1,l=t[s],u=s+1,c=t[u];if(0>o(l,n))u<r&&0>o(c,l)?(t[i]=c,t[u]=n,i=u):(t[i]=l,t[s]=n,i=s);else{if(!(u<r&&0>o(c,n)))break t;t[i]=c,t[u]=n,i=u}}}return e}function o(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var u=[],c=[],h=1,d=null,f=3,p=!1,v=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,m="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function w(t){for(var e=i(c);null!==e;){if(null===e.callback)r(c);else{if(!(e.startTime<=t))break;r(c),e.sortIndex=e.expirationTime,n(u,e)}e=i(c)}}function x(t){if(g=!1,w(t),!v)if(null!==i(u))v=!0,M(b);else{var e=i(c);null!==e&&F(x,e.startTime-t)}}function b(t,n){v=!1,g&&(g=!1,m(A),A=-1),p=!0;var o=f;try{for(w(n),d=i(u);null!==d&&(!(d.expirationTime>n)||t&&!P());){var a=d.callback;if("function"===typeof a){d.callback=null,f=d.priorityLevel;var s=a(d.expirationTime<=n);n=e.unstable_now(),"function"===typeof s?d.callback=s:d===i(u)&&r(u),w(n)}else r(u);d=i(u)}if(null!==d)var l=!0;else{var h=i(c);null!==h&&F(x,h.startTime-n),l=!1}return l}finally{d=null,f=o,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,C=!1,S=null,A=-1,E=5,T=-1;function P(){return!(e.unstable_now()-T<E)}function I(){if(null!==S){var t=e.unstable_now();T=t;var n=!0;try{n=S(!0,t)}finally{n?k():(C=!1,S=null)}}else C=!1}if("function"===typeof _)k=function(){_(I)};else if("undefined"!==typeof MessageChannel){var Z=new MessageChannel,R=Z.port2;Z.port1.onmessage=I,k=function(){R.postMessage(null)}}else k=function(){y(I,0)};function M(t){S=t,C||(C=!0,k())}function F(t,n){A=y((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){v||p||(v=!0,M(b))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return i(u)},e.unstable_next=function(t){switch(f){case 1:case 2:case 3:var e=3;break;default:e=f}var n=f;f=e;try{return t()}finally{f=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=f;f=t;try{return e()}finally{f=n}},e.unstable_scheduleCallback=function(t,r,o){var a=e.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,t){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return t={id:h++,callback:r,priorityLevel:t,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(t.sortIndex=o,n(c,t),null===i(u)&&t===i(c)&&(g?(m(A),A=-1):g=!0,F(x,o-a))):(t.sortIndex=s,n(u,t),v||p||(v=!0,M(b))),t},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(t){var e=f;return function(){var n=f;f=e;try{return t.apply(this,arguments)}finally{f=n}}}},296:function(t,e,n){"use strict";t.exports=n(813)},897:function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.__esModule=!0,t.exports.default=t.exports},690:function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},728:function(t){function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},704:function(t,e,n){var i=n(116);t.exports=function(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=i(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}},t.exports.__esModule=!0,t.exports.default=t.exports},61:function(t,e,n){var i=n(698).default;function r(){"use strict";t.exports=r=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},n=Object.prototype,o=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(P){c=function(t,e,n){return t[e]=n}}function h(t,e,n,i){var r=e&&e.prototype instanceof p?e:p,o=Object.create(r.prototype),a=new A(i||[]);return o._invoke=function(t,e,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return T()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=k(a,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=d(t,e,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}(t,n,a),o}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(P){return{type:"throw",arg:P}}}e.wrap=h;var f={};function p(){}function v(){}function g(){}var y={};c(y,s,(function(){return this}));var m=Object.getPrototypeOf,_=m&&m(m(E([])));_&&_!==n&&o.call(_,s)&&(y=_);var w=g.prototype=p.prototype=Object.create(y);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function n(r,a,s,l){var u=d(t[r],t,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&o.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var r;this._invoke=function(t,i){function o(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(o,o):o()}}function k(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method))return f;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var i=d(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function E(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(o.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return v.prototype=g,c(w,"constructor",g),c(g,"constructor",v),v.displayName=c(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,u,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},x(b.prototype),c(b.prototype,l,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,i,r,o){void 0===o&&(o=Promise);var a=new b(h(t,n,i,r),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(w),c(w,u,"Generator"),c(w,s,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=E,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return a.type="throw",a.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],a=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var s=o.call(r,"catchLoc"),l=o.call(r,"finallyLoc");if(s&&l){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=t,a.arg=e,r?(this.method="next",this.next=r.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;S(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:E(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},e}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},698:function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},116:function(t,e,n){var i=n(897);t.exports=function(t,e){if(t){if("string"===typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},907:function(t,e,n){"use strict";function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}n.d(e,{Z:function(){return i}})},326:function(t,e,n){"use strict";function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,{Z:function(){return i}})},671:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,{Z:function(){return i}})},144:function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}n.d(e,{Z:function(){return r}})},762:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var i=n(181);function r(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=(0,i.Z)(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}}},62:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var i=n(120);var r=n(963);function o(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=(0,i.Z)(t);if(e){var a=(0,i.Z)(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return(0,r.Z)(this,n)}}},942:function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{Z:function(){return i}})},301:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var i=n(415);function r(){return r="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=(0,i.Z)(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},r.apply(this,arguments)}},120:function(t,e,n){"use strict";function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}n.d(e,{Z:function(){return i}})},340:function(t,e,n){"use strict";function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}function r(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}n.d(e,{Z:function(){return r}})},963:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var i=n(2),r=n(326);function o(t,e){if(e&&("object"===(0,i.Z)(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return(0,r.Z)(t)}},885:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var i=n(181);function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(l){s=!0,r=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(t,e)||(0,i.Z)(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},415:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var i=n(120);function r(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=(0,i.Z)(t)););return t}},982:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var i=n(907);var r=n(181);function o(t){return function(t){if(Array.isArray(t))return(0,i.Z)(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||(0,r.Z)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},2:function(t,e,n){"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}n.d(e,{Z:function(){return i}})},181:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var i=n(907);function r(t,e){if(t){if("string"===typeof t)return(0,i.Z)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,i.Z)(t,e):void 0}}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,n),o.exports}n.m=t,n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.f={},n.e=function(t){return Promise.all(Object.keys(n.f).reduce((function(e,i){return n.f[i](t,e),e}),[]))},n.u=function(t){return"static/js/"+t+".e75f7d45.chunk.js"},n.miniCssF=function(t){},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t={},e="kollapse:";n.l=function(i,r,o,a){if(t[i])t[i].push(r);else{var s,l;if(void 0!==o)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var h=u[c];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==e+o){s=h;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",e+o),s.src=i),t[i]=[r];var d=function(e,n){s.onerror=s.onload=null,clearTimeout(f);var r=t[i];if(delete t[i],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach((function(t){return t(n)})),e)return e(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),l&&document.head.appendChild(s)}}}(),n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.p="/seekers-of-byergur/",function(){var t={179:0};n.f.j=function(e,i){var r=n.o(t,e)?t[e]:void 0;if(0!==r)if(r)i.push(r[2]);else{var o=new Promise((function(n,i){r=t[e]=[n,i]}));i.push(r[2]=o);var a=n.p+n.u(e),s=new Error;n.l(a,(function(i){if(n.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var o=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;s.message="Loading chunk "+e+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,r[1](s)}}),"chunk-"+e,e)}};var e=function(e,i){var r,o,a=i[0],s=i[1],l=i[2],u=0;if(a.some((function(e){return 0!==t[e]}))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(l)l(n)}for(e&&e(i);u<a.length;u++)o=a[u],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0},i=self.webpackChunkkollapse=self.webpackChunkkollapse||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}(),function(){"use strict";var t=n(791),e=n(250),i=n(885),r=n(942),o=n(982),a=n(144),s=n(671),l=n(340),u=n(62),c=n(470),h=2.3283064365386963e-10,d=function(){function t(){(0,s.Z)(this,t),this._seed=0,this._s0=0,this._s1=0,this._s2=0,this._c=0}return(0,a.Z)(t,[{key:"getSeed",value:function(){return this._seed}},{key:"setSeed",value:function(t){return t=t<1?1/t:t,this._seed=t,this._s0=(t>>>0)*h,t=69069*t+1>>>0,this._s1=t*h,t=69069*t+1>>>0,this._s2=t*h,this._c=1,this}},{key:"getUniform",value:function(){var t=2091639*this._s0+this._c*h;return this._s0=this._s1,this._s1=this._s2,this._c=0|t,this._s2=t-this._c,this._s2}},{key:"getUniformInt",value:function(t,e){var n=Math.max(t,e),i=Math.min(t,e);return Math.floor(this.getUniform()*(n-i+1))+i}},{key:"getNormal",value:function(){var t,e,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;do{n=(t=2*this.getUniform()-1)*t+(e=2*this.getUniform()-1)*e}while(n>1||0==n);var o=t*Math.sqrt(-2*Math.log(n)/n);return i+o*r}},{key:"getPercentage",value:function(){return 1+Math.floor(100*this.getUniform())}},{key:"getItem",value:function(t){return t.length?t[Math.floor(this.getUniform()*t.length)]:null}},{key:"shuffle",value:function(t){for(var e=[],n=t.slice();n.length;){var i=n.indexOf(this.getItem(n));e.push(n.splice(i,1)[0])}return e}},{key:"getWeightedValue",value:function(t){var e=0;for(var n in t)e+=t[n];var i,r=this.getUniform()*e,o=0;for(i in t)if(r<(o+=t[i]))return i;return i}},{key:"getState",value:function(){return[this._s0,this._s1,this._s2,this._c]}},{key:"setState",value:function(t){return this._s0=t[0],this._s1=t[1],this._s2=t[2],this._c=t[3],this}},{key:"clone",value:function(){var e=new t;return e.setState(this.getState())}}]),t}(),f=(new d).setSeed(Date.now()),p=n(301),v=n(120),g=function(){function t(){(0,s.Z)(this,t)}return(0,a.Z)(t,[{key:"getContainer",value:function(){return null}},{key:"setOptions",value:function(t){this._options=t}}]),t}(),y=function(t){(0,l.Z)(n,t);var e=(0,u.Z)(n);function n(){var t;return(0,s.Z)(this,n),(t=e.call(this))._ctx=document.createElement("canvas").getContext("2d"),t}return(0,a.Z)(n,[{key:"schedule",value:function(t){requestAnimationFrame(t)}},{key:"getContainer",value:function(){return this._ctx.canvas}},{key:"setOptions",value:function(t){(0,p.Z)((0,v.Z)(n.prototype),"setOptions",this).call(this,t);var e=t.fontStyle?"".concat(t.fontStyle," "):"",i="".concat(e," ").concat(t.fontSize,"px ").concat(t.fontFamily);this._ctx.font=i,this._updateSize(),this._ctx.font=i,this._ctx.textAlign="center",this._ctx.textBaseline="middle"}},{key:"clear",value:function(){this._ctx.fillStyle=this._options.bg,this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}},{key:"eventToPosition",value:function(t,e){var n=this._ctx.canvas,i=n.getBoundingClientRect();return t-=i.left,e-=i.top,t*=n.width/i.width,e*=n.height/i.height,t<0||e<0||t>=n.width||e>=n.height?[-1,-1]:this._normalizedEventToPosition(t,e)}}]),n}(g);function m(t,e){return(t%e+e)%e}var _=function(t){(0,l.Z)(n,t);var e=(0,u.Z)(n);function n(){var t;return(0,s.Z)(this,n),(t=e.call(this))._spacingX=0,t._spacingY=0,t._hexSize=0,t}return(0,a.Z)(n,[{key:"draw",value:function(t,e){var n=(0,i.Z)(t,5),r=n[0],o=n[1],a=n[2],s=n[3],l=n[4],u=[(r+1)*this._spacingX,o*this._spacingY+this._hexSize];if(this._options.transpose&&u.reverse(),e&&(this._ctx.fillStyle=l,this._fill(u[0],u[1])),a){this._ctx.fillStyle=s;for(var c=[].concat(a),h=0;h<c.length;h++)this._ctx.fillText(c[h],u[0],Math.ceil(u[1]))}}},{key:"computeSize",value:function(t,e){return this._options.transpose&&(t+=e,t-=e=t-e),[Math.floor(t/this._spacingX)-1,Math.floor((e-2*this._hexSize)/this._spacingY+1)]}},{key:"computeFontSize",value:function(t,e){this._options.transpose&&(t+=e,t-=e=t-e);var n=2*t/((this._options.width+1)*Math.sqrt(3))-1,i=e/(2+1.5*(this._options.height-1)),r=Math.min(n,i),o=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;var a=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=o;var s=a/100,l=2*(r=Math.floor(r)+1)/(this._options.spacing*(1+s/Math.sqrt(3)));return Math.ceil(l)-1}},{key:"_normalizedEventToPosition",value:function(t,e){var n;this._options.transpose?(t+=e,t-=e=t-e,n=this._ctx.canvas.width):n=this._ctx.canvas.height;var i=n/this._options.height;return m(e=Math.floor(e/i),2)?(t-=this._spacingX,t=1+2*Math.floor(t/(2*this._spacingX))):t=2*Math.floor(t/(2*this._spacingX)),[t,e]}},{key:"_fill",value:function(t,e){var n=this._hexSize,i=this._options.border,r=this._ctx;r.beginPath(),this._options.transpose?(r.moveTo(t-n+i,e),r.lineTo(t-n/2+i,e+this._spacingX-i),r.lineTo(t+n/2-i,e+this._spacingX-i),r.lineTo(t+n-i,e),r.lineTo(t+n/2-i,e-this._spacingX+i),r.lineTo(t-n/2+i,e-this._spacingX+i),r.lineTo(t-n+i,e)):(r.moveTo(t,e-n+i),r.lineTo(t+this._spacingX-i,e-n/2+i),r.lineTo(t+this._spacingX-i,e+n/2-i),r.lineTo(t,e+n-i),r.lineTo(t-this._spacingX+i,e+n/2-i),r.lineTo(t-this._spacingX+i,e-n/2+i),r.lineTo(t,e-n+i)),r.fill()}},{key:"_updateSize",value:function(){var t,e,n=this._options,i=Math.ceil(this._ctx.measureText("W").width);this._hexSize=Math.floor(n.spacing*(n.fontSize+i/Math.sqrt(3))/2),this._spacingX=this._hexSize*Math.sqrt(3)/2,this._spacingY=1.5*this._hexSize,n.transpose?(t="height",e="width"):(t="width",e="height"),this._ctx.canvas[t]=Math.ceil((n.width+1)*this._spacingX),this._ctx.canvas[e]=Math.ceil((n.height-1)*this._spacingY+2*this._hexSize)}}]),n}(y),w=function(){var t=function(t){(0,l.Z)(n,t);var e=(0,u.Z)(n);function n(){var t;return(0,s.Z)(this,n),(t=e.call(this))._spacingX=0,t._spacingY=0,t._canvasCache={},t}return(0,a.Z)(n,[{key:"setOptions",value:function(t){(0,p.Z)((0,v.Z)(n.prototype),"setOptions",this).call(this,t),this._canvasCache={}}},{key:"draw",value:function(t,e){n.cache?this._drawWithCache(t):this._drawNoCache(t,e)}},{key:"_drawWithCache",value:function(t){var e,n=(0,i.Z)(t,5),r=n[0],o=n[1],a=n[2],s=n[3],l=n[4],u=""+a+s+l;if(u in this._canvasCache)e=this._canvasCache[u];else{var c=this._options.border,h=(e=document.createElement("canvas")).getContext("2d");if(e.width=this._spacingX,e.height=this._spacingY,h.fillStyle=l,h.fillRect(c,c,e.width-c,e.height-c),a){h.fillStyle=s,h.font=this._ctx.font,h.textAlign="center",h.textBaseline="middle";for(var d=[].concat(a),f=0;f<d.length;f++)h.fillText(d[f],this._spacingX/2,Math.ceil(this._spacingY/2))}this._canvasCache[u]=e}this._ctx.drawImage(e,r*this._spacingX,o*this._spacingY)}},{key:"_drawNoCache",value:function(t,e){var n=(0,i.Z)(t,5),r=n[0],o=n[1],a=n[2],s=n[3],l=n[4];if(e){var u=this._options.border;this._ctx.fillStyle=l,this._ctx.fillRect(r*this._spacingX+u,o*this._spacingY+u,this._spacingX-u,this._spacingY-u)}if(a){this._ctx.fillStyle=s;for(var c=[].concat(a),h=0;h<c.length;h++)this._ctx.fillText(c[h],(r+.5)*this._spacingX,Math.ceil((o+.5)*this._spacingY))}}},{key:"computeSize",value:function(t,e){return[Math.floor(t/this._spacingX),Math.floor(e/this._spacingY)]}},{key:"computeFontSize",value:function(t,e){var n=Math.floor(t/this._options.width),i=Math.floor(e/this._options.height),r=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;var o=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=r;var a=o/100*i/n;return a>1&&(i=Math.floor(i/a)),Math.floor(i/this._options.spacing)}},{key:"_normalizedEventToPosition",value:function(t,e){return[Math.floor(t/this._spacingX),Math.floor(e/this._spacingY)]}},{key:"_updateSize",value:function(){var t=this._options,e=Math.ceil(this._ctx.measureText("W").width);this._spacingX=Math.ceil(t.spacing*e),this._spacingY=Math.ceil(t.spacing*t.fontSize),t.forceSquareRatio&&(this._spacingX=this._spacingY=Math.max(this._spacingX,this._spacingY)),this._ctx.canvas.width=t.width*this._spacingX,this._ctx.canvas.height=t.height*this._spacingY}}]),n}(y);return t.cache=!1,t}(),x=function(t){(0,l.Z)(n,t);var e=(0,u.Z)(n);function n(){var t;return(0,s.Z)(this,n),(t=e.call(this))._colorCanvas=document.createElement("canvas"),t}return(0,a.Z)(n,[{key:"draw",value:function(t,e){var n=(0,i.Z)(t,5),r=n[0],o=n[1],a=n[2],s=n[3],l=n[4],u=this._options.tileWidth,c=this._options.tileHeight;if(e&&(this._options.tileColorize?this._ctx.clearRect(r*u,o*c,u,c):(this._ctx.fillStyle=l,this._ctx.fillRect(r*u,o*c,u,c))),a)for(var h=[].concat(a),d=[].concat(s),f=[].concat(l),p=0;p<h.length;p++){var v=this._options.tileMap[h[p]];if(!v)throw new Error('Char "'.concat(h[p],'" not found in tileMap'));if(this._options.tileColorize){var g=this._colorCanvas,y=g.getContext("2d");y.globalCompositeOperation="source-over",y.clearRect(0,0,u,c);var m=d[p],_=f[p];y.drawImage(this._options.tileSet,v[0],v[1],u,c,0,0,u,c),"transparent"!=m&&(y.fillStyle=m,y.globalCompositeOperation="source-atop",y.fillRect(0,0,u,c)),"transparent"!=_&&(y.fillStyle=_,y.globalCompositeOperation="destination-over",y.fillRect(0,0,u,c)),this._ctx.drawImage(g,r*u,o*c,u,c)}else this._ctx.drawImage(this._options.tileSet,v[0],v[1],u,c,r*u,o*c,u,c)}}},{key:"computeSize",value:function(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}},{key:"computeFontSize",value:function(){throw new Error("Tile backend does not understand font size")}},{key:"_normalizedEventToPosition",value:function(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}},{key:"_updateSize",value:function(){var t=this._options;this._ctx.canvas.width=t.width*t.tileWidth,this._ctx.canvas.height=t.height*t.tileHeight,this._colorCanvas.width=t.tileWidth,this._colorCanvas.height=t.tileHeight}}]),n}(y);function b(t){var e,n;if(t in k)e=k[t];else{if("#"==t.charAt(0)){var i=(t.match(/[0-9a-f]/gi)||[]).map((function(t){return parseInt(t,16)}));if(3==i.length)e=i.map((function(t){return 17*t}));else{for(var r=0;r<3;r++)i[r+1]+=16*i[r],i.splice(r,1);e=i}}else e=(n=t.match(/rgb\(([0-9, ]+)\)/i))?n[1].split(/\s*,\s*/).map((function(t){return parseInt(t)})):[0,0,0];k[t]=e}return e.slice()}var k={black:[0,0,0],navy:[0,0,128],darkblue:[0,0,139],mediumblue:[0,0,205],blue:[0,0,255],darkgreen:[0,100,0],green:[0,128,0],teal:[0,128,128],darkcyan:[0,139,139],deepskyblue:[0,191,255],darkturquoise:[0,206,209],mediumspringgreen:[0,250,154],lime:[0,255,0],springgreen:[0,255,127],aqua:[0,255,255],cyan:[0,255,255],midnightblue:[25,25,112],dodgerblue:[30,144,255],forestgreen:[34,139,34],seagreen:[46,139,87],darkslategray:[47,79,79],darkslategrey:[47,79,79],limegreen:[50,205,50],mediumseagreen:[60,179,113],turquoise:[64,224,208],royalblue:[65,105,225],steelblue:[70,130,180],darkslateblue:[72,61,139],mediumturquoise:[72,209,204],indigo:[75,0,130],darkolivegreen:[85,107,47],cadetblue:[95,158,160],cornflowerblue:[100,149,237],mediumaquamarine:[102,205,170],dimgray:[105,105,105],dimgrey:[105,105,105],slateblue:[106,90,205],olivedrab:[107,142,35],slategray:[112,128,144],slategrey:[112,128,144],lightslategray:[119,136,153],lightslategrey:[119,136,153],mediumslateblue:[123,104,238],lawngreen:[124,252,0],chartreuse:[127,255,0],aquamarine:[127,255,212],maroon:[128,0,0],purple:[128,0,128],olive:[128,128,0],gray:[128,128,128],grey:[128,128,128],skyblue:[135,206,235],lightskyblue:[135,206,250],blueviolet:[138,43,226],darkred:[139,0,0],darkmagenta:[139,0,139],saddlebrown:[139,69,19],darkseagreen:[143,188,143],lightgreen:[144,238,144],mediumpurple:[147,112,216],darkviolet:[148,0,211],palegreen:[152,251,152],darkorchid:[153,50,204],yellowgreen:[154,205,50],sienna:[160,82,45],brown:[165,42,42],darkgray:[169,169,169],darkgrey:[169,169,169],lightblue:[173,216,230],greenyellow:[173,255,47],paleturquoise:[175,238,238],lightsteelblue:[176,196,222],powderblue:[176,224,230],firebrick:[178,34,34],darkgoldenrod:[184,134,11],mediumorchid:[186,85,211],rosybrown:[188,143,143],darkkhaki:[189,183,107],silver:[192,192,192],mediumvioletred:[199,21,133],indianred:[205,92,92],peru:[205,133,63],chocolate:[210,105,30],tan:[210,180,140],lightgray:[211,211,211],lightgrey:[211,211,211],palevioletred:[216,112,147],thistle:[216,191,216],orchid:[218,112,214],goldenrod:[218,165,32],crimson:[220,20,60],gainsboro:[220,220,220],plum:[221,160,221],burlywood:[222,184,135],lightcyan:[224,255,255],lavender:[230,230,250],darksalmon:[233,150,122],violet:[238,130,238],palegoldenrod:[238,232,170],lightcoral:[240,128,128],khaki:[240,230,140],aliceblue:[240,248,255],honeydew:[240,255,240],azure:[240,255,255],sandybrown:[244,164,96],wheat:[245,222,179],beige:[245,245,220],whitesmoke:[245,245,245],mintcream:[245,255,250],ghostwhite:[248,248,255],salmon:[250,128,114],antiquewhite:[250,235,215],linen:[250,240,230],lightgoldenrodyellow:[250,250,210],oldlace:[253,245,230],red:[255,0,0],fuchsia:[255,0,255],magenta:[255,0,255],deeppink:[255,20,147],orangered:[255,69,0],tomato:[255,99,71],hotpink:[255,105,180],coral:[255,127,80],darkorange:[255,140,0],lightsalmon:[255,160,122],orange:[255,165,0],lightpink:[255,182,193],pink:[255,192,203],gold:[255,215,0],peachpuff:[255,218,185],navajowhite:[255,222,173],moccasin:[255,228,181],bisque:[255,228,196],mistyrose:[255,228,225],blanchedalmond:[255,235,205],papayawhip:[255,239,213],lavenderblush:[255,240,245],seashell:[255,245,238],cornsilk:[255,248,220],lemonchiffon:[255,250,205],floralwhite:[255,250,240],snow:[255,250,250],yellow:[255,255,0],lightyellow:[255,255,224],ivory:[255,255,240],white:[255,255,255]},C=function(t){(0,l.Z)(n,t);var e=(0,u.Z)(n);function n(){var t;(0,s.Z)(this,n),(t=e.call(this))._uniforms={};try{t._gl=t._initWebGL()}catch(i){alert(i.message)}return t}return(0,a.Z)(n,[{key:"schedule",value:function(t){requestAnimationFrame(t)}},{key:"getContainer",value:function(){return this._gl.canvas}},{key:"setOptions",value:function(t){var e=this;(0,p.Z)((0,v.Z)(n.prototype),"setOptions",this).call(this,t),this._updateSize();var i=this._options.tileSet;i&&"complete"in i&&!i.complete?i.addEventListener("load",(function(){return e._updateTexture(i)})):this._updateTexture(i)}},{key:"draw",value:function(t,e){var n=this._gl,r=this._options,a=(0,i.Z)(t,5),s=a[0],l=a[1],u=a[2],c=a[3],h=a[4],d=n.canvas.height-(l+1)*r.tileHeight;if(n.scissor(s*r.tileWidth,d,r.tileWidth,r.tileHeight),e&&(r.tileColorize?n.clearColor(0,0,0,0):n.clearColor.apply(n,(0,o.Z)(P(h))),n.clear(n.COLOR_BUFFER_BIT)),u){var f=[].concat(u),p=[].concat(h),v=[].concat(c);n.uniform2fv(this._uniforms.targetPosRel,[s,l]);for(var g=0;g<f.length;g++){var y=this._options.tileMap[f[g]];if(!y)throw new Error('Char "'.concat(f[g],'" not found in tileMap'));n.uniform1f(this._uniforms.colorize,r.tileColorize?1:0),n.uniform2fv(this._uniforms.tilesetPosAbs,y),r.tileColorize&&(n.uniform4fv(this._uniforms.tint,P(v[g])),n.uniform4fv(this._uniforms.bg,P(p[g]))),n.drawArrays(n.TRIANGLE_STRIP,0,4)}}}},{key:"clear",value:function(){var t=this._gl;t.clearColor.apply(t,(0,o.Z)(P(this._options.bg))),t.scissor(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT)}},{key:"computeSize",value:function(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}},{key:"computeFontSize",value:function(){throw new Error("Tile backend does not understand font size")}},{key:"eventToPosition",value:function(t,e){var n=this._gl.canvas,i=n.getBoundingClientRect();return t-=i.left,e-=i.top,t*=n.width/i.width,e*=n.height/i.height,t<0||e<0||t>=n.width||e>=n.height?[-1,-1]:this._normalizedEventToPosition(t,e)}},{key:"_initWebGL",value:function(){var t=this,e=document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0});window.gl=e;var n=function(t,e,n){var i=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(i)||"");var r=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(r)||"");var o=t.createProgram();if(t.attachShader(o,i),t.attachShader(o,r),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw new Error(t.getProgramInfoLog(o)||"");return o}(e,A,E);return e.useProgram(n),function(t){var e=new Float32Array([0,0,1,0,0,1,1,1]),n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,2,t.FLOAT,!1,0,0)}(e),S.forEach((function(i){return t._uniforms[i]=e.getUniformLocation(n,i)})),this._program=n,e.enable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.enable(e.SCISSOR_TEST),e}},{key:"_normalizedEventToPosition",value:function(t,e){return[Math.floor(t/this._options.tileWidth),Math.floor(e/this._options.tileHeight)]}},{key:"_updateSize",value:function(){var t=this._gl,e=this._options,n=[e.width*e.tileWidth,e.height*e.tileHeight];t.canvas.width=n[0],t.canvas.height=n[1],t.viewport(0,0,n[0],n[1]),t.uniform2fv(this._uniforms.tileSize,[e.tileWidth,e.tileHeight]),t.uniform2fv(this._uniforms.targetSize,n)}},{key:"_updateTexture",value:function(t){!function(t,e){var n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)}(this._gl,t)}}],[{key:"isSupported",value:function(){return!!document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0})}}]),n}(g),S=["targetPosRel","tilesetPosAbs","tileSize","targetSize","colorize","bg","tint"],A="\n#version 300 es\n\nin vec2 tilePosRel;\nout vec2 tilesetPosPx;\n\nuniform vec2 tilesetPosAbs;\nuniform vec2 tileSize;\nuniform vec2 targetSize;\nuniform vec2 targetPosRel;\n\nvoid main() {\n\tvec2 targetPosPx = (targetPosRel + tilePosRel) * tileSize;\n\tvec2 targetPosNdc = ((targetPosPx / targetSize)-0.5)*2.0;\n\ttargetPosNdc.y *= -1.0;\n\n\tgl_Position = vec4(targetPosNdc, 0.0, 1.0);\n\ttilesetPosPx = tilesetPosAbs + tilePosRel * tileSize;\n}".trim(),E="\n#version 300 es\nprecision highp float;\n\nin vec2 tilesetPosPx;\nout vec4 fragColor;\nuniform sampler2D image;\nuniform bool colorize;\nuniform vec4 bg;\nuniform vec4 tint;\n\nvoid main() {\n\tfragColor = vec4(0, 0, 0, 1);\n\n\tvec4 texel = texelFetch(image, ivec2(tilesetPosPx), 0);\n\n\tif (colorize) {\n\t\ttexel.rgb = tint.a * tint.rgb + (1.0-tint.a) * texel.rgb;\n\t\tfragColor.rgb = texel.a*texel.rgb + (1.0-texel.a)*bg.rgb;\n\t\tfragColor.a = texel.a + (1.0-texel.a)*bg.a;\n\t} else {\n\t\tfragColor = texel;\n\t}\n}".trim();var T={};function P(t){if(!(t in T)){var e;if("transparent"==t)e=[0,0,0,0];else if(t.indexOf("rgba")>-1){e=(t.match(/[\d.]+/g)||[]).map(Number);for(var n=0;n<3;n++)e[n]=e[n]/255}else(e=b(t).map((function(t){return t/255}))).push(1);T[t]=e}return T[t]}function I(t){var e=6/256,n=b(t);return 36*Math.floor(n[0]*e)+6*Math.floor(n[1]*e)+1*Math.floor(n[2]*e)+16}var Z=function(t){(0,l.Z)(n,t);var e=(0,u.Z)(n);function n(){var t;return(0,s.Z)(this,n),(t=e.call(this))._offset=[0,0],t._cursor=[-1,-1],t._lastColor="",t}return(0,a.Z)(n,[{key:"schedule",value:function(t){setTimeout(t,1e3/60)}},{key:"setOptions",value:function(t){(0,p.Z)((0,v.Z)(n.prototype),"setOptions",this).call(this,t);var e=[t.width,t.height],i=this.computeSize();this._offset=i.map((function(t,n){return Math.floor((t-e[n])/2)}))}},{key:"clear",value:function(){var t;process.stdout.write((t=this._options.bg,"\x1b[0;48;5;".concat(I(t),"m\x1b[2J")))}},{key:"draw",value:function(t,e){var n=(0,i.Z)(t,5),r=n[0],o=n[1],a=n[2],s=n[3],l=n[4],u=this._offset[0]+r,c=this._offset[1]+o,h=this.computeSize();if(!(u<0||u>=h[0])&&!(c<0||c>=h[1])&&(u===this._cursor[0]&&c===this._cursor[1]||(process.stdout.write(function(t,e){return"\x1b[".concat(e+1,";").concat(t+1,"H")}(u,c)),this._cursor[0]=u,this._cursor[1]=c),e&&(a||(a=" ")),a)){var d=function(t,e){return"\x1b[0;38;5;".concat(I(t),";48;5;").concat(I(e),"m")}(s,l);if(d!==this._lastColor&&(process.stdout.write(d),this._lastColor=d),"\t"!=a){var f=[].concat(a);process.stdout.write(f[0])}this._cursor[0]++,this._cursor[0]>=h[0]&&(this._cursor[0]=0,this._cursor[1]++)}}},{key:"computeFontSize",value:function(){throw new Error("Terminal backend has no notion of font size")}},{key:"eventToPosition",value:function(t,e){return[t,e]}},{key:"computeSize",value:function(){return[process.stdout.columns,process.stdout.rows]}}]),n}(g),R=/%([bc]){([^}]*)}/g;function M(t,e){var n=[],i=0;t.replace(R,(function(e,r,o,a){var s=t.substring(i,a);return s.length&&n.push({type:0,value:s}),n.push({type:"c"==r?2:3,value:o.trim()}),i=a+e.length,""}));var r=t.substring(i);return r.length&&n.push({type:0,value:r}),function(t,e){e||(e=1/0);var n=0,i=0,r=-1;for(;n<t.length;){var o=t[n];if(1==o.type&&(i=0,r=-1),0==o.type){for(;0==i&&" "==o.value.charAt(0);)o.value=o.value.substring(1);var a=o.value.indexOf("\n");if(-1!=a){o.value=F(t,n,a,!0);for(var s=o.value.split("");s.length&&" "==s[s.length-1];)s.pop();o.value=s.join("")}if(o.value.length){if(i+o.value.length>e){for(var l=-1;;){var u=o.value.indexOf(" ",l+1);if(-1==u)break;if(i+u>e)break;l=u}if(-1!=l)o.value=F(t,n,l,!0);else if(-1!=r){var c=t[r],h=c.value.lastIndexOf(" ");c.value=F(t,r,h,!0),n=r}else o.value=F(t,n,e-i,!1)}else i+=o.value.length,-1!=o.value.indexOf(" ")&&(r=n);n++}else t.splice(n,1)}else n++}t.push({type:1});for(var d=null,f=0;f<t.length;f++){var p=t[f];switch(p.type){case 0:d=p;break;case 1:if(d){for(var v=d.value.split("");v.length&&" "==v[v.length-1];)v.pop();d.value=v.join("")}d=null}}return t.pop(),t}(n,e)}function F(t,e,n,i){var r={type:1},o={type:0,value:t[e].value.substring(n+(i?1:0))};return t.splice(e+1,0,r,o),t[e].value.substring(0,n)}var D={hex:_,rect:w,tile:x,"tile-gl":C,term:Z},B={width:80,height:25,transpose:!1,layout:"rect",fontSize:15,spacing:1,border:0,forceSquareRatio:!1,fontFamily:"monospace",fontStyle:"",fg:"#ccc",bg:"#000",tileWidth:32,tileHeight:32,tileMap:{},tileSet:null,tileColorize:!1};(function(){var t=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,s.Z)(this,t),this._data={},this._dirty=!1,this._options={},e=Object.assign({},B,e),this.setOptions(e),this.DEBUG=this.DEBUG.bind(this),this._tick=this._tick.bind(this),this._backend.schedule(this._tick)}return(0,a.Z)(t,[{key:"DEBUG",value:function(t,e,n){var i=[this._options.bg,this._options.fg];this.draw(t,e,null,null,i[n%i.length])}},{key:"clear",value:function(){this._data={},this._dirty=!0}},{key:"setOptions",value:function(t){if(Object.assign(this._options,t),t.width||t.height||t.fontSize||t.fontFamily||t.spacing||t.layout){if(t.layout){var e=D[t.layout];this._backend=new e}this._backend.setOptions(this._options),this._dirty=!0}return this}},{key:"getOptions",value:function(){return this._options}},{key:"getContainer",value:function(){return this._backend.getContainer()}},{key:"computeSize",value:function(t,e){return this._backend.computeSize(t,e)}},{key:"computeFontSize",value:function(t,e){return this._backend.computeFontSize(t,e)}},{key:"computeTileSize",value:function(t,e){return[Math.floor(t/this._options.width),Math.floor(e/this._options.height)]}},{key:"eventToPosition",value:function(t){var e,n;return"touches"in t?(e=t.touches[0].clientX,n=t.touches[0].clientY):(e=t.clientX,n=t.clientY),this._backend.eventToPosition(e,n)}},{key:"draw",value:function(t,e,n,i,r){i||(i=this._options.fg),r||(r=this._options.bg);var o="".concat(t,",").concat(e);this._data[o]=[t,e,n,i,r],!0!==this._dirty&&(this._dirty||(this._dirty={}),this._dirty[o]=!0)}},{key:"drawOver",value:function(t,e,n,i,r){var o="".concat(t,",").concat(e),a=this._data[o];a?(a[2]=n||a[2],a[3]=i||a[3],a[4]=r||a[4]):this.draw(t,e,n,i,r)}},{key:"drawText",value:function(t,e,n,i){var r=null,o=null,a=t,s=e,l=1;i||(i=this._options.width-t);for(var u=M(n,i);u.length;){var c=u.shift();switch(c.type){case 0:for(var h=!1,d=!1,f=!1,p=!1,v=0;v<c.value.length;v++){var g=c.value.charCodeAt(v),y=c.value.charAt(v);if("term"===this._options.layout){var m=g>>8;if(17===m||m>=46&&m<=159||m>=172&&m<=215||g>=43360&&g<=43391){this.draw(a+0,s,y,r,o),this.draw(a+1,s,"\t",r,o),a+=2;continue}}f=g>65280&&g<65377||g>65500&&g<65512||g>65518,h=32==y.charCodeAt(0)||12288==y.charCodeAt(0),!p||f||h||a++,f&&!d&&a++,this.draw(a++,s,y,r,o),d=h,p=f}break;case 2:r=c.value||null;break;case 3:o=c.value||null;break;case 1:a=t,s++,l++}}return l}},{key:"_tick",value:function(){if(this._backend.schedule(this._tick),this._dirty){if(!0===this._dirty)for(var t in this._backend.clear(),this._data)this._draw(t,!1);else for(var e in this._dirty)this._draw(e,!0);this._dirty=!1}}},{key:"_draw",value:function(t,e){var n=this._data[t];n[4]!=this._options.bg&&(e=!0),this._backend.draw(n,e)}}]),t}();t.Rect=w,t.Hex=_,t.Tile=x,t.TileGL=C,t.Term=Z})(),n(762),n(326);Math.sqrt(3),Math.sqrt(3);var z=n(663),L=n.p+"static/media/dude in walls.b439ef3f2395b4595c7c.png",O=n.p+"static/media/colored_transparent.e4db859d2f2e6eed7eb9.png",N=n(677),U=n(184),H={mapchip:new c.ImageSource(L),spritemap:new c.ImageSource(O),dude:new z.AsepriteResource("/seekers-of-byergur/beard dude 5.json"),font:new c.ImageSource("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEACAYAAABVmQgcAAAAAXNSR0IArs4c6QAACjpJREFUeJzt3UnS2zYaAFDK5TN572P5BH2s3vel0ouEMYwfMwEO0ntVqdgSBYIg8GHg4G17Y3/94+p8wFN86/3BUxpZmMcn5DfUm9+nHd9dPaVur9QdELZt216v12t2Rrbt9wk5elJmntSrKkhuv72fQ4+ugLC60oWBZta+jgSvkTzUgtrKXkhQ4Kjv+x9SlWnVSOBsZx1HS4N8vV6vPSj05kuDZ7Vv2/Z3RXsF9i8/uQIePfZSY9+/69nHvu27BOmzWBfo823bvlayO1e6vyJX5ye0l1tL+fWUsWAw5skLy1f5Xt8kLSzgUkWNT8RopU7tb3TovVJPXmrbtpZxLY2wvOLRyYyym5HP2VIB4G515Qq5wLiXy1BAiBPNFXRc6XINuBa9W6N7rhLsf85VhtaKclWFOrrP8Dykzkn4XbhNy/7jIBOXUa0C9h5HLqDlAlxtelaqM6njSKWX20f8+7CMR48ztU1vWqXtvsUf9gzFSyc+lUa8RlHLZMv3YXqp9F+BUvqt+agVakvZtZbvTK0NMK7oqQCR2rYnH7U0e+pEuH0uGIT7bcl/qb6UjJRxa/2OfxO3vVJgy6UbHuf+/+8tmSplNKU1vVLU7fndqFQQS6UZR9nUdqUTFgsbRG+Uv4ujQS3VW+Z6s1JPPSqVzqpAXTt/8XGnAlst8OXqZaw20vhyH8JZFW/kxL4iM/bfkodckKhtQ7vZjTFuRKnvzzhntRFla2c4MvqIf1cLBts2eKfiqKMjkd5hUW/6VxgZMr6bVce2N/pSYFixz/3PvZ1eqYfvDRi1QJTb12kBYc/gjKAQOtKgrw4GrZ4UFGZU/hlSI8C7lF84ZWwRBpaW39aCwZ5W6ruugJBqmKnvStFq/y48SS0RPDXEm1WhZlXO0TRaKsfdKnWstQxbAvnRY4w7nzC90bTjut96ro9MN8N2Ebev1HHU8pQrh3A/X25M2g82VwFTOx39LG7kr0DuoFq2aREOJWf2VHdvuLP0NpBX5GhaPXlr/W1L3QvzV2sjtTZQ6+Bm1suUlo74o51ZOPHU56z95vJS+340j6O/TZXN1eWUcofzFzuSp+E7FXkfq3uiWe6Yzzvm6YhTrzLcyd2i+p1dXemdq3apNYceHxsQtm3OYtMMVze4Flfm8Qnl8y4+OiBs2z3ngO9EYz7P0dHBtgkIf7ii8mowZcrnXALCP86oeEYifQSDNjNHuR9f4LPvQ2jZ37ap7MzRc59Fi+U3PmzbnAczgPWWTRnCYNAynBEM4HpLAkI8MmgNCjvBAK5x2qJiKSi0Bot4O4t0MNfSgDBz9TNe/JuxGHiXG5PgLpYEhNQTXa0N2HSBFf77v/8I+HdS6oFHnvqbPf3o+S1wQOvjtUcbZGqNwa3J0G75489nNcbaGsPZNyDBEy1fVFyZfii8itHa+I0g4E+PeJYh12hTNzOlgkHus9Lf4RPdIiCMDOVzDbh1ZJB6v5+gAINah9o9q/4tVyLCP69swHH68Z8FD97R0Agh11BSWnv/1jfp7vurvSF3ltKxCgq8m1tMGXYtQeGsQFB6JbarFRDpmTLoSYGuub6gAde7xZQhXCy8Oi/wyZYGhPB9CCv3A7wZowMAAAAAAHgYlwNPEr7T7+ePX8qdS+31Ma6Ly9+YFGcg9q6N49OOd4XSi1FXlmOusdR+czRP8fGG6bV0KK35LpXrKZWz9sbbd2okV1Xid1NqACMNdsZ+j2zbs9/Qzx+/XqnvRoJCKeDsTg8Iqaj3Lg3l6h5t9X7O0HosK+pOS4NJbbsqGMT2/dSOvSW93G+XTxlahzrvVJG3bX5FbT3571CW21Yvv1zPOaonrVUBODcSir+rHXscOEr7iC0NCO/Uc12lJRjEo66rgsLR833VP6YyOtpYGQxq37XseyR/pzzt2DKfeSetQ82ap/T2exCKP1u93yuD3lnB4GyHRwi5SluqEKnvapX/ilX7VSOc3oWr3DaloePMVe/RABfnoacxnb2+dEZZneHoOlZT5ltWLltXgkeuOLT+pnfO1LKSPSOtWenmtm0Nlq37HlnVLukJCrV9H1mr6R21tEzVVl4N6f19z/Hl0vx3ypAa9sU76e31a9vECyWldH7++PWK/6vlvZReaYjbm1arkXRbG3W83WglGunF43y0zId7Rnz7+a3Vz568HpE6hqtHBr1y5ZGdMuSi4Cy5hZLUothILxY38FIvtf+9FLDCbUaG+ftnue9qU4PScbeqBZe4XHrOfSog9ZRZaz5HyyLMT+7c9KQb1p2Va2SjgaaljqY+/3eEsEf2MBKvinqzr9v29pDx9i2ruL0VJuzVZi8O1nrK1n2FlTp3zms9/pOURierFkFbGuaZ+aml/eUqQ23YlxtaX1FpZlbWWoDo+X1N6zRstdX7njH3n53H0nC/NPVcIVUPjnTIPZ1WLu2mqwzx0PHIwk7JXVZqc0anT3GwGal4pTWP3L560gs/X1X+RxvbynpRWyAs6Z1ytASjI1OF3BS4Je3m+xBa5rdH9ASDlrnwFaOXlqlHz2+3ra/XuqrXLTlSJuG2I/WvN/C2LIrm9p9a+Kyls6pNtSzq5ixtKLXFvNrntbTDv+fmh7ODwd1HMS1mldGVU8baeSjlbcU5XF3vznLa48/blh9ytwSNUlpH5/+f7MnlNTKavDIvT7D01uXeOXfvUPbsFfArFwBXWDk0HdUyzD+yzvFu53C25c8yrLxGO1OtIl59RWWmO19KrF0abA0GtXp31+O/2iWFkhrqX32yWuacqe8orw3N7sl706tNUfnTZQUz64TPNHrt9tPV7iS8utzuko8nuMWJ2t3hhOlRxtwxwNPPyWIawRQAgBs6+4EUeGePnd9ZxIL5Htl4ck+LxZ8Bb640RTB9gGOKDzfd8T4BYJ1kQCj1wNsmMMC7+vJwU+v7Atdkp27l23xMOfh0Q0+E9Y4Ueh5+aXkgpvRw1EjAaH1Hw2j68BTZx5+PvIYpVJt+jLxwNL6yMDsY7J+nRgxGELyzU/5tx5Wsa8A8jw0ItRet9qRTe7mmYMOn+HKVIXxN+Kpn23Nvw1mRbqj1TTupNYPRV7DDk3S/ZPVoYIgb2xmvTD/yjvtZacETJKcMpffahd/XlBbkZjSsljczj75yS8PnE3Vf3mt1RsOa/UKOUp5X/otG8Bh3vVknvix4NI93PU44U/UqQ236cIXZUw/TBPhb02XHOwaFbZvbgAUDmPCPvT6dtQH4rTkg3G10ELpz3uBJTv3HXmebEQiMDuC3t3lByp3zBk9RbUR3XYH3SDIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8Ob+D+7W84pdmiP+AAAAAElFTkSuQmCC"),dialogueBackground:new c.ImageSource("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAACACAYAAAACsL4LAAAAAXNSR0IArs4c6QAAHzRJREFUeJztnd9rlNfWx78TTRNk4hCZRA61oaR93wrHtlCPYGUUbSE3AeG1F0Iu9MARJH9AL3rnXS/8A0TwQOuF0At9oeBNoEY0tAesBa0HTlsdytRcmAyGaYbgJJOZc/HMemY9e/bez35+zGQS1weGmXnm+bHn+bHW2mutvTYgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCOmR2eoGCIIg7DQKMxebA7lXuHfla6uMpfUalWEs3Ljac3m8LRRAYeZi03RyCjMXm/6X8mbwx/wuANiSEysIwutHYepCEwAW5q5lAODE7PmmTglwuUUKIEBLltF+ukVfCsa397/XnDhzFKVb/wIATJ475P9Wr2bReDaIgXc2sDtbBQBMTA4BAErFmv+9VKz5y4m7lx4Gvk+eO4Ti9SegY/3+4pfUzscnn3/WBIA7l2+G7vOTzz9rFq8/CbSJ4OcBAA58ehLPv7ubuH1p/ldBENqG6ieff9YkGXTn8s3MJ59/1uRygJQCWf8A0KgMgz7z741ng11VAlsqBEjwkYDnQhBoC3IVVbBH5e6lhzh56bD/WT3+xJmj2J2tGoX32/vfa+qWk7DmCouj/le+Hn3n77Q//t6oDKeiAOIiikMQOiHhf2L2fHN3ttohu+rVLEjo03oAfCOWfgfaCoIUh6kXkQZbrgDoc/H6E18oq+is+bR4+OU8xs4e87/Xq1nQBXz45TwOf3HK/416ELp28t4HX58rGvUzKR+T8AfgC35iqxVAVERhCDuZwszF5rvHV/HV7I3M36/MBAzDr2Zv+AoBaHkvWpb97mzVlzXc0ORCn9YhuqEEdqe9wzBIm3ka0DsxxetPMDL0JwAEtCYJ024Jf/U43vGrWP7me4ApBVIE1EYbtO7DL+dx8pL3DkD7eWQIWP7me0yeO4blb75Xvs95bTszhZXbc4FjjHT3dPis1vZaf3c5H+9P/EXbW0qzHWmzFUrr71dmml/N3sjwz3xZkv1ygwNA4PPkuUPanq6plwvEOz+2/dno5rV4e/97TZd72MYbb5YBDIELf5IB70/8pcndt5PnDgEt4xIYQqlYRfH6k8C2pWKtZRhXE7XLlZ7e6NTtAeBb2QAClraqAFTrX6cg4qJa+LQMgL9ctw61g2vn3VlPcZDwj8r4+AgAYGlpNfK2rwu9VgRx4L08+s5jT6q7kX7X9RSJUrHm95C5MLe9m9ApA9p/XJIIUX5N4+4nyX2RpO25wmm8e9z+vKrnOUxm0fUhOUfeANU9FLvRCl1VABTp5oEOlDf97BxyZZy8dNioBNYX89qTrApZncA2CW++j1zhdGBZZeFbAMDodNDy5m6i5W++x9jZY74CIOHfTUhBdIPtqHT6URnYBC9gdiGGCW2de5HQuR7C0MXA4iiApNZzrwl7hqI+B6PTU5j8YANAp6zRyR6uAOh39drTOnRduJHJ3cFpKYGuKQA1zQnwGl2YutBEfhcqC98iVzgdiHyrrNyew+j0lJOAJQFNVjgQflEefjmP3MFpVP5z23+3kSuc9hWEesxekEQJJBHyr3PvxFXRkBANUwI6whRAEnRJFDwBgfzSceJK200BpM3Y2WPIzP/sf3/rH3/DH//8EW/942/a9UvFGjLzP/u/q0FioB0UBjy5Mjo95X/vRi+gZzGA3dkqTsyebzYqu5y3ISucW98mKGgLuPUCuPAH0CH8dUJv6Nd5jI+PYGlpFePjI3Axu1Sh7SpE07b4qd1JjpW0TdtRgbgKOYrh8KQCMkZcuv7Fx4MA2ul/PJuMhANZm7rtOJRTvvbbMgBgz+g+AMDzR/dx4MPjOPDhcaw/8r7bSFPAm+4/3T1Fzxf/3o/Uq1nQ2SehbhP+9WoWk//4m/Z+UNNA216G9jqUHp8mXVEAhakLzcCgrBwCmS1k/buyvpgPfNfdHDpLx+SPp3V1Qp/2p7vpaBmtN+bQdnU/3XTlRGnHVuDaBU+7q95r+P2quy8JUhaez7eVKdL6bWToT1/wk0B/er89WCjgVm1heq7oPqfkAfV7LzBds6jLt+re0B2X1LFJ6LtSr2bxxptlFhyu+e4hLvB/f/FL5kDlZNMLPKfTE0hVAeh8/vSZ/xGT8OfdH47qJuKCQmdZ8Is1Pj7id8voM06972R5uMDdP1sl3F2wta0bD02cc5HE1RT33Lscy9Z70sEFcb2axcrtOdSZv5hQe6Ze0kP7GfDTB6EX9JWFb5E7OO0tIzcmc1ECwOD+j4NtC3Fzdps4ln2Ua+u6bhr3/OQHG/jjQWeMhr5z/z1afQWvxzaI4uP2MkKNg5LMVNNBycAgr0oSJZCaAvDyV4Oj4NZbNy3PgyXtRd/57yokXNU0SPUij4+PAPM/Wy9+qVjzAx7cb2fbr41c4TTWF/tb6LvSb/+hF+2J2jOL3KaWu7CmDvFvobomw1xEJNhzB6e9tvzq9Wy5QNcJ940XP0RrdwvT/40iOFM/pykS5dhLS6va//1W612Xzbj8zfeBGCfFM9XPQEu5Z6u+u1CF5GSg7E2LvugB0OAFno0wMTmEYtX780FNGMSzioI3v+rXVK0Gl4f36f/vwcA7G76OXV/Mo4c9XqHPiRubibyPJU9wNyrDvnVvE/aZ+Z/RPPV+MMB4pG3Fu1jwPE6VNlEFZ5zt+g1br4W7f0j4+/KuvImVhaDxSsYsKQH6Pnb2mKYn0TaMbTI0SS8gsQIozFxs3rl8VZuKxi17+gPBm78zqPXwy/mOFMw4/sChl/eAl6HNjw0F2ESp7AzSEFDWffw6j+ab7/tfbenJ9KyQ8aL2gMOwxbFMbLWy2C6o/0nN+qGY4/j4CPDyXsCt6XIdVeOARgvrCPOguJBIAZDbx5SHzOth8IFfKjxQOz4+Ajz4weijj41aKVQQekxm/mfU/vcU/pifR/PU+/p1ADSemXvAQn+xtLTqu4LU5WHwuA759UvodJEDnvxcV9yJajHMOAzE3rJF2CCUickh/2WDLCLbiaOgL722ktFm/JGTwuvLG2+W0Tz1vv9MkJunXs1au/lCf6KLR7rKqIHcKz8W8O7xVbx7fDUgL3dnqx3x04HcKwzkXuHE7PmmKlOjDggEEiiAE7Pnm/Vq1prm5oraHV5aWkVt34nE++02ogSEqNSrWWTmf0bx8aAf66pXsxh88INv+a+tvPRcmMK2g2KUaqxSpwwalWE0KsMYnZ7SpqtzAU8eFFIIJrcPL7DpQqIeAAUeSsUaSsUaXAtX/fHPH52WpZmeKA+U0A8MPvgh8K5+BsSw2I6E1f/SBeXJmleFOa8dpXpPJiaHMPnBRke56TjWPxAzBuClI70Cr+gJeNqHFzEyDW/nfjMaDLPMhD0fobtVI2cFodeIkbKz0MmksLEuVCVYRedCT6NKcrwgcHkTjfIgkN/lByZIk/klnFlFO95Q0pSlYs3P819fzAdPFoueu+I6ilQQ+gXV8he2L4e/OIU//vljrPETE5NDWFb21SsiKwCaxkzng6pXs60RbsSgPwqS1h8fH8HGkY9Rr7aFdS2FDB0R/IIg9AsunouV23PIFU4H8v2jYJstUZ2G0kTiLCAORa35i5YT/MRQoGSrh6cLgiDEgSqAAjAGf23G6UDuVezsr4nJIT/oGzcZJ5ICKMxcbL7xZjnRwAMT/V7gSxAEwYZO2JvKSHB0VV5dIKGvvgPu8YFILiC/sBvbediEFMumHzSEjQEQBEHoR3gWY5SqtzVWIiQu9WoWkx9sxOoFOCsAPp0jJ0r6Ea+cScOiRbALgvA6srS0irFT5Y4gsAs0vwB5Y4qPB7E76ykALpPD5pWOHAPQ+avUA6g5sbbuiLh+BEHYjujGLulQB4epI4Wpiih/t0GWPo0HoHirOjbAhVhpoLoZbfiBXdKYXOqCx0kFlR6FIAj9DJd3Y2jLORfZpUutN30mbL0AJwVQmLrQVCt3ciXg4gbi3ZyGUtQobolZFRH+giB0A5PcecvwmzoplWn7ejWLlaVVLLWs/qVWL8DVkudy2GXqURW3HkB+FyY/WGMLvIOEBYB5Izl81qKowl+EvCAIvcYkd0rFmnZ0b1zXtkn4c8FOpXds6wBuhrlzDIAf0KXmj5qSRAHgJBU9RfgLgrCVqP789cW8U6qnieqPrARO4XSo/z8upiQepx7AQO5V5K6FaX1bd0nKOQiC0M+osqlW3kwkr5bYlJ2VhW8xOj2FetU+f4oLrt6ZRBPC2A4QxR/FI+P0HRBFIAhCf7O28tI4K2CcXkGjMozKwrcYO3ssWcMUTFNGOrmA1I1J8NtcQST8XYQ4BUlcu1JJulyCIAhpYSvdHcXVTeuQ8I9i/ZtiAio6N5BzD+Dp/REM5F4Fhi27dDFMU6apuI6ec11fEARhq4hqoKrr05iAMMIUBXcF6XoBTj0Ar/6/B81iFIZrGpOrIO+n6SAFQRBUongxbJiKw3FL32WaXY7JWHfrAZQ3sTB3LUOKgEo+64oYlYo1rC/mMZAb9NdTI9suAjzK4DBTeqikjQqCkDZxBq5GVQpjZ48ZjWgXwa8K/EQDwdZWXvqfVTcQ0Lb2Pc1l7iHwIG+YYDaNFNYFiNWBFlFG1gmCIETBNLCr23HJNGYAU3FSAHtG9wFoVwNVaTdsw3/XaS+X7J6wUXUmRNgLgtArkpapcVEWSQW+y3itSMXg+CQv3UAtlESvNEbYCYIg9BpeAM41RrByey6x8CcDnNcB0sUBQhXAR0fONBfmrgU0iYtmoSCFLpIdx7/PT6QgCMJ2QHV7uySxxJkTmAeIqVQ0zRYGJA0Cg3JI9da/rkJdGK5pneLPFwRhq4nrmubruXovTCmgXs3/oAymEtCUOWSbXEZnuDsrgEZlGGAH5yN9bYI/rLaFCHZBEPqFMCEd1Y+fFp6RPRhIEW1UhlGsvoIp8aZezaJUrFrHa8UqBcEnItYJ/7uXHgIAJs8dCt2Xy0kUJSEIQi+IOiA1jeOE7VNNqKFy+rqkHJoeklLww3BXAOVN4M3gIpvlPzL0Z2AKyEQFkxJ0vwRBENIiLQWhc4HzZQ+/nPfrAa0v5iO1sVSs+dNDchmtmxgmUg9gfTGPN94sd+yYQ9Y/n9ps7OwxLLFy0Jw4GlWEvyAI/UhcBcGXk+y0TfFoSskH4M8V7BKTDc3mKUxdaC7MXXMqLWri4ZfzGJ2e8ieC58iEMIIg7BTScBHxSqC6shCNyrBVAQD6ctKJgsBx4NFsnfAHop0wEf6CIPQTYdmMLkFldZ3lb77H6PRU7DZFmUugawog7sw2IuQFQdgquJchjjVv8u3rBL1trmAbA7lX2gG5FAAGOi3/xOMAorJa24uRoT8DiiBXOB2YD5jDB3upywVBEHpBXKFsgvYVpXaQzfrXjQNo01mck9w+iYrB6XbqEhM4/MUpv3z0yu05o/AHkvn3o+TuCoIg2HB143QjZTRXOI3SrbuYOHPUXxYsvqn361OGD5+sK/GUkLwMBB/tqx6MQ+tNnjvkC3/KWwXSEcbSSxAEoVeY5ItNMcQR/qu1vVj97m5r/JS7Hz9Jgo5zMbh6NYs7l29mbBPC8JQlHr2myY6BdKLkaaSSCoLw+sELsqmvqNvrSOJCOvDpSQDRJ3sJI/ZI4J8e3Mp8dORM86cHtwL+I9tEBbwuBafxbBC5g9Oo/Od2KpO+uygB6RkIgsAxFZzk70n2HXcfg/s/xnPf+vfGU528dNh5e9cZGFUixQBOzJ5vUoqRzf0TOAAFLfK7UFn4NhBhj+v3l/IRgrBz6bUxF9XFYyKJ8I/LJ59/1iSj++9XZppcBvPqoCZSywLilj/3+deV9dSTpEuRijJbmCAIOwtd775f3bxpuqMnzhzFxGRnJo8KF+h8tDBfTvXa6P3E7PmmblJ4JwXw0ZEzTT76TFcEzmuIZ+2vK8WKvFHA3ckAEgShd3Sz923bd7/Lh7C2h503b9ZFu/DXWfImlzvH9ntoKQjAUwB7RvcB+V2htYCe3vculDpYgReGc6FfLrjEFqIj9Z12JqbsuzjPSDct+ijH7tZ9F+X/5QqnjYO7dJBAp/XV76b1dT0AJwUAeDWBkN/lW/XqxPCAfsICoFP4c42olkV1KZPaK2GRRlAobeK2qZcCtps11UVRdJde3vMuz3e3Ur67PXbI9TzmDk7j+aP7mDx3qMOo1ln8OsObegE62Xvn8s3MidnzzUZlGAs3rsavBbS28hJ78mPa36ihVIK0eP1Jx1wAY2ePYfmb7wOVQYHgicoVTmPJMlhMt00/C4Sk7ezGiESil0E1Xdwn6j5ed3p1znp53uMEX9O6j9PqodhmMgzbx2ptL3JOR7HjKQWvBATJ4juXb2bI/3/vyteZwszFZKUgfnpwK1P4n4tNl0p0uolgorqAXEnqN+x2cGkrBH+vhWfa59D28Ox0xZBE8Gz1AMluPEu2/xCWj9+N47oYMy7HXq3txYEPj2PgnQ1MvHMUpul2XccD0MBctYS0KfhLdLUaKMGtfxPj4yPYaCmWXOE0hn6NV0zOlW4ILd2+4zzQLg+3adsox3TZl+s23eitbHWvKW4b4uByfaMWKuuVu7BbcbKw7J9+VXC29Qb3f4yNFz94X/K7AGygdOtfTrMnhqGrzmAT/kAEBfDRkTNNlDexMHctU5i60Cy1xgOYckzVyPPo9BTqipLjcwQsLa1itLWcjxfoFmnc5FF+j0MaN1wUovhe+zUWkVZOt21fUeDKzKbYwixd3eco+3BpY9xj6JRSGpZ5mLJzjRlGJa5bx/SMkNDn7yj9G0A7cOti6avZl7pszK9mb/iunzuXb4bGeCP1ANZWXrbfF8dQQlm7Xlhakgk+Z0C/5v2aSCp4dAK3Gzd3lDZQO9LMw45i3W/1PdCtXk2vXSXd3NZ1P+po2yQll3X7TRNbj8bW7jDLf8/oPlReAC9L/25Z/J78NFn/ulR72/c4xHIB7Rndh4HcK2NEOg7kJjLNHNbvpH0jbrXwI7rVjl7+v24JXd1xeoUqiNIor2Ij7bhUv/YgVdTz6wq/PntG96Hyn9vA6DRyB6ex+uh+YN0kgrxUrHVY+jrLX5cBBERUAN5gBQD5XdidXYFamtQk/FUfVzsWUPUF/8TkEJbhdYnGzh7zexHbURkI/UXSjA7XffRKqZkUWtQR9Zxup0W6Hqvfgvyptie/C4D7iN8w4hrbnEgKYGHuWqYwc7G5cOOq72fitDVZ8M/tztoDHDRtJL0DQKlYje1KEoQ49Euvy4atN5NU+PdK+Ib9h35TAmmwWtuLsZBBtFFwGQHsQk+ygOL8YV5aohes1vZGWn9k6M9I+zl56TDuXnrofwbiT5tpQ3d8U1uF7Uc3EgNUd1IvBPBOFPI6Vmt7MfbhCk7+3+GtboqWSOMA+Pc061XbSp+u1vZi4sxRlG79yzvumaNoVIbx/Lu7/vKkAi6q8A/bRjeqD0DHf+Q9HiBcIRz+4pS/Dm3Ltzn8xSlfydDx7l566LeVKyHTd94WOh5tP3nuEIrXn1jbSIwM/RnrvNK2Qu+IM1Cv1/RqBHCSY20c+Tjgsl6t7Y1U0tm1BHQarh/CuRQE0C4HsXDjqtN0Y0mhP6p2dXZnq/5oYz7qmIZD16tZX2GkgSooORNnjoJKZPcrUWuL67YH7OdhuyFKZmeylTWIKJ4JeMLfZAia4Hn8qpDnKffri3mgvOn/RrM2xqEnLqA4uPi4JiaHMBEQbN5waGADkx8EBZ6L4OLCnK+vum64YnIt4LSVJBH+6vZh+0pDQdiEM+9VkOLnD5nr8eP2TtJElFD69Kr3kiuc9uc4J2FPnwFzaqcLqvCvV7OdMdH8roASiEu0gWCAf1AahOAy+bBavzps3YnJoVDhH1WomdYPTmPZbp/L/l2Ff5T/HxXTNJw6TO1Ns02u10UnqE9eOhxQ/Gp7k6Qd076B9nlKs5cYB1clJIpi66HZDAPLmBKge7PY+s02SJbQTa/LC7vVq1lvbpXyJurvtJ/thRtXvdo+KSiB2D2AejWL4mOv1kTxcXt5g80FoBM4tsp13h8ewdNFhNYbSovgyLoqSkXLyi10gpafg07aF9q+npmwUq8umNblbYoyMjEJJkXBg/9J2mBTRPQfJ88d6htlYMMW2Bcl0n1yB6cD30enp1C65cUg1fOvu+90iqBezaLxbNBPDQ0srwyjjuDEWt0iehro1IVmYeZis1ExCOmWRmqUB7Gezxv3ta77c+VNoLUJ//PqcahL1M9+d4LKsFJRpsLMxSb/P7rieg1lQh0gKLx1N04Ai1WwtvLSG8j3jj4PmY5TfNybHkPaxHV38USD7YBO8B/48HisfT1XBiYlxdWF57J+r7Ap0lzrWaN1xrLV1n3W6WomSsUa1h+N4ukjAPmRzmfc8Ay7FNvklT2pOkNcnGcEU7OAAJOGcuiS2Lot5c0O/1ajrNGUgDFNtF7NaucrULF10Vws68D/V/9Tq700Ao+KMvEReZ5bTeezDPdj/jTnXY/C1IUmKWbA7YZYW3mJPc/2GX8j1EmACF2Aql8xzV7X/r1tSNy78kvsYFoYb+9/r+tJE1Y0wsaf2+PDdixFvbbri3k8/+5upENFja/0QzzGhGcYeNa+v8xwv/Nzt76YB7CJ54/u48CHx9FAW1Ys3LjqP6/0nT7rhP/C3DV/3FW9mk3VO+KkAFTh7/ugVFQhSMLcAFmjuv2ogmwPgus1MIz1Z8yHphzn6X1FOfG2+etGSPei7XX/R6fQWoXzbLvUKVU/1uKwLtDOAEiSCcAn+9lT6ZzzwbuZgzcnn41I11twjfXQQ6OuT/sFPEWrKiHTeu8ebytP2rdpoqJe8vuLeMolkuKwPGt07fh5aJ9z+7U68OlJADAqAi4cOdupR0V0JhaQla+39u9eeui7Eku3HhrPBQCDDNKjegFMBqlJLrgSOQYQWdAYrH1VwIdZsR3LVhBUHlGCIUkCJ4ZtkwhgTtILmgTbxBFAsMfju/BaSl516T1d7Nx+IPeK7WMETx9tYuAdT4kHFHZ5j7LlJtbLo/5DQ/GlTrdYcEpSYNA/3npgTms+ld5gTwccRsWkOHSKwTatoKuw75iVihV85MIx2FPQH3Py3KEO44FSuG3wDBp+jflYINqXLYZz4NOTVqHr3w9sW9eqnMTvL37JTFSPNv3POOony6ytvMTvL37J7Fv5a3MP9gVkHFn9uueNC/9uxwHSSQNNIFC5YF9beYmfHtzKkMtJtYZ1y/hJ1e1b28OIAAl2crUk2tk2xNTbCyx3vP6N8iDWVpaDC3+kD57lrrvGPi2l3xFf0vQ0KXuCuyQbZU/ZrGM0sH7dqfX9hU4x+MJnCzEpEK6AJixxGptbVmdd84B+55SKZdRz3HJWS9R42yYZfPX2/veaJKT9zxoPhismga/GBu5d+TpzYvZ84usdWwGogoGELQnkgLbTCGmboAeCcQfd7z89uBX0oxmOAQSFt05ZmJQIF/ivo/CPinrt1XO+MHctcK2twt4AGQkAs55CutO69kU55nYhbPIPQpe27ZLOHUwQ0LvudBSvP7EKfU7n/myxvPDejNq7C+7fXlufuyl5T4SEb6MyjN9f/JI5gJNNlDc9a/+3v2plFX1eW3lpjKlySL5ST6FbWZGpDgTj8wV8dORM0yZYdSeBvocJBtvJ0x3TRZDbFMROx//v7IZTrX5dT0BXYlYXk+CfTdccaCt6neJX17PFpfyHR3Otd6rwj8JXszcC54CPPg241SrDUONkdG6p1xSe1jyI31/8kikVD/mTlPSiigARJ0HBZO1z67xRGcbab15vlt45NhlllV/smTKVcKZ2NJ51jiOIykCSjRduXM2s/bbsC/5QrTZ3LaN7AMO247/zzzqLjr7HfdD5dlGt0+2O6YYL/F7eTGUEog6dcqCXbT0dYf9FaEMK4c7lm5l7V77ONCrDob0JWs/lBXi9BzWQqSoiWlZ8PAjdq1Ss+a+vZm9kXAcB8u34ix/TSy0PLq9Xs3h6fwTri3lUf1zF2m/LRqHPjVenRjFscTeVtGMCiXsAYdY6CdSoPjHXh74bFl3S3NqdAE9VC1glfWRBUxv9NnVJMb1u+Ne7dT5V150v/DTn23R/cMH11ewN33/NpzA0baf2Ooj1xTyKVbNf3Jb5defyzcC6jcpwILGBewS4gWtyRxsPFEIUQ4WUcmHmYjMtV2aiHgDQaSXb0hhNXfq0WJi7lhHhnR79JOxtvI5uu17g+jy5pCKTt4CuVaMy7Fu+64t5/0W/0YsEpM0dwnsa9Pnela8z64t53Ll8M0P75p8LMxeb1Ivx99/q3aqJKTp0PVP+m+k8xJV7vEeWZu+2K8Xg4gT30jx2Gvt43dw/2xVbFpjQXbhwdDEWAu5bi6/bJOBUtxRfz78HuACnHgrvqSi9lrXflv2Y0nYyHtMyzhL3AKJowa3McY/Ddmvv68526bEI6UPCm98DfJn62VXYx4k/vXaQtSxWs7DVSG+gO3x05ExzuzznvJ2mz7btBEEQBEEQBEEQdib/Be9HNhEojgGQAAAAAElFTkSuQmCC")},W=0,V=1,X=2,G=3,j=5,q=6,Y=32;c.ScreenElement;var K=new c.Loader((0,o.Z)(Object.values(H)));c.Actor;var Q=function(t){(0,l.Z)(n,t);var e=(0,u.Z)(n);function n(t,i){var r;return(0,s.Z)(this,n),(r=e.call(this,{x:t.x*Y+Math.floor(16)-1,y:t.y*Y+Math.floor(16)-1,width:Y,height:Y,color:c.Color.White,scale:new c.Vector(1,1),collisionType:c.CollisionType.Passive,z:2})).graphics.use(i),r}return(0,a.Z)(n)}(c.Actor),J=function(t){(0,l.Z)(n,t);var e=(0,u.Z)(n);function n(t){var i;return(0,s.Z)(this,n),(i=e.call(this,{x:t.x*Y+16,y:t.y*Y+16,width:16,height:16,color:c.Color.White,scale:new c.Vector(1,1),collisionType:c.CollisionType.Active,z:1})).idleAnim=H.dude.getAnimation("idle"),i.frontWalkAnim=H.dude.getAnimation("front walk"),i.sideWalkAnim=H.dude.getAnimation("side walk"),i.backWalkAnim=H.dude.getAnimation("back walk"),i.frontRunAnim=H.dude.getAnimation("front run"),i.sideRunAnim=H.dude.getAnimation("side run"),i.backRunAnim=H.dude.getAnimation("back run"),i.waveAnim=H.dude.getAnimation("wave"),i.waveAnim.strategy=c.AnimationStrategy.End,i.graphics.use(i.idleAnim),i.graphics.offset=new c.Vector(0,-8),i.waving=!1,i.vel=new c.Vector(0,0),i.running=!1,i}return(0,a.Z)(n,[{key:"wave",value:function(){this.waving=!0,this.waveAnim.reset()}},{key:"onPostUpdate",value:function(t,e){var n=new c.Vector(0,0),i=1;t.input.keyboard.isHeld("KeyW")&&(n.y=-1),t.input.keyboard.isHeld("KeyS")&&(n.y=1),t.input.keyboard.isHeld("KeyA")&&(n.x=-1),t.input.keyboard.isHeld("KeyD")&&(n.x=1),t.input.keyboard.isHeld("ShiftLeft")?(i=4,this.running=!0):this.running=!1,n.normalize(),this.vel.x+=7*n.x*i,this.vel.y+=7*n.y*i}},{key:"onPreUpdate",value:function(){var t=this,e=this.vel,n=this.waving;if(n&&0===e.x&&0===e.y)return this.graphics.use(this.waveAnim),void this.waveAnim.events.on("end",(function(){t.waving=!1,t.graphics.use(t.idleAnim)}));n&&(this.waving=!1),0!==e.x&&(this.graphics.use(this.running?this.sideRunAnim:this.sideWalkAnim),e.x>0?(this.sideWalkAnim.flipHorizontal=!0,this.sideRunAnim.flipHorizontal=!0):(this.sideWalkAnim.flipHorizontal=!1,this.sideRunAnim.flipHorizontal=!1)),0!==e.y&&Math.abs(e.y)>Math.abs(e.x)&&this.graphics.use(e.y<0?this.running?this.backRunAnim:this.backWalkAnim:this.running?this.frontRunAnim:this.frontWalkAnim),0===e.x&&0===e.y&&this.graphics.use(this.idleAnim);this.vel.x<5&&this.vel.x>-5&&(this.vel.x=0),this.vel.y<5&&this.vel.y>-5&&(this.vel.y=0),this.vel.x=.9*this.vel.x,this.vel.y=.9*this.vel.y,this.pos.x=Math.round(this.pos.x),this.pos.y=Math.round(this.pos.y)}}]),n}(c.Actor),$=function(){var e=(0,t.useRef)();return(0,t.useEffect)((function(){var t=[];if(e.current){var n=new c.Engine({width:800,height:600,pixelRatio:2,snapToPixel:!0,canvasElement:e.current,displayMode:c.DisplayMode.FitScreen,backgroundColor:new c.Color("#342a46")});n.start(K).then((function(){var e,a=c.SpriteSheet.fromImageSource({image:H.mapchip,grid:{rows:64,columns:64,spriteHeight:32,spriteWidth:32}}),s=function(){var t=N({width:64,height:48,retry:100,room:{ideal:18,min_width:4,max_width:14,min_height:4,max_height:14}});return console.log(t),t}(),l=s.world,u=s.enter,h=s.rooms,d=(s.walls,new c.TileMap({rows:48,columns:64,tileWidth:Y,tileHeight:Y,pos:new c.Vector(0,0)})),p=new c.Vector(u.x,u.y),v=[G,j,q,V],g=(e={topLeft:a.getSprite(14,1),top1:a.getSprite(15,1),top2:a.getSprite(18,1),top3:a.getSprite(19,1),topRightInterior:a.getSprite(20,1),topRightExterior:a.getSprite(23,3),left:a.getSprite(14,2),rightInterior:a.getSprite(20,2),rightExterior:a.getSprite(20,6),middle:a.getSprite(16,3),bottomLeft:a.getSprite(14,7),bottom1:a.getSprite(15,7),bottom2:a.getSprite(17,7)},(0,r.Z)(e,"bottom2",a.getSprite(19,7)),(0,r.Z)(e,"bottomRight",a.getSprite(20,7)),(0,r.Z)(e,"doorBottom",a.getSprite(16,7)),(0,r.Z)(e,"void",a.getSprite(14,9)),(0,r.Z)(e,"doorTop",a.getSprite(10,6)),(0,r.Z)(e,"doorTopShadow",a.getSprite(10,7)),(0,r.Z)(e,"doorSide",a.getSprite(14,5)),(0,r.Z)(e,"connectRightInterior",a.getSprite(11,6)),(0,r.Z)(e,"connectRightExterior",a.getSprite(20,3)),(0,r.Z)(e,"connectLeftInterior",a.getSprite(14,3)),(0,r.Z)(e,"connectLeftExterior",a.getSprite(18,8)),(0,r.Z)(e,"connectTInterior",a.getSprite(11,6)),(0,r.Z)(e,"connectTExterior",a.getSprite(18,7)),e);Object.entries(g).forEach((function(t){var e=(0,i.Z)(t,2);e[0];e[1].scale=new c.Vector(1,1)})),l.forEach((function(e,r){e.forEach((function(e,a){var s=Object.entries(h),u=d.getTile(a,r),p=function(t){return l[r-1]&&l[r-1][a]===t},y=function(t){return l[r+1]&&l[r+1][a]===t},m=function(t){return l[r][a-1]===t},_=function(t){return l[r][a+1]===t},w=function(t){return l[r+1][a+1]===t},x=function(t){return t(X)||t(G)};if(u){var b=s.filter((function(t){var e=(0,i.Z)(t,2);e[0];return e[1].walls.find((function(t){var e=(0,i.Z)(t,2),n=e[0],o=e[1];return n===a&&o===r}))})),k=b&&b[0]&&b[0][1];if(u.solid=!v.includes(e),e===V)return t.push(new c.Vector(a,r)),void u.addGraphic(g.middle);if(e===W)return void u.addGraphic(g.void);if(e===X&&k){var C=Math.max.apply(Math,(0,o.Z)(k.walls.map((function(t){var e=(0,i.Z)(t,2),n=e[0];e[1];return n})))),S=Math.max.apply(Math,(0,o.Z)(k.walls.map((function(t){var e=(0,i.Z)(t,2);e[0];return e[1]})))),A=Math.min.apply(Math,(0,o.Z)(k.walls.map((function(t){var e=(0,i.Z)(t,2),n=e[0];e[1];return n})))),E=Math.min.apply(Math,(0,o.Z)(k.walls.map((function(t){var e=(0,i.Z)(t,2);e[0];return e[1]}))))===r,T=S===r,P=A===a,I=C===a,Z=x(m)&&x(_)&&x(y),R=x(m)&&x(p)&&x(y)&&!x(_),M=x(p)&&x(y)&&x(_)&&!x(m),F=f.getItem([g.top2,g.top1,g.top1,g.top1]),D=f.getItem([g.bottom2,g.bottom2,g.bottom2,g.bottom1]),B=_(W)?g.rightExterior:g.rightInterior,z=_(W)?g.topRightExterior:g.topRightInterior,L=w(W)?g.connectRightExterior:g.connectRightInterior,O=_(W)?g.connectLeftExterior:g.connectLeftInterior;M?u.addGraphic(L):R?u.addGraphic(O):Z?u.addGraphic(w(W)?g.connectTExterior:g.connectTInterior):E&&P?u.addGraphic(g.topLeft):E&&I?u.addGraphic(x(p)?B:z):T&&P?u.addGraphic(x(m)||x(_)?y(W)?g.bottomLeft:g.top1:g.bottomLeft):T&&I?u.addGraphic(x(m)&&x(_)?y(W)?g.bottom1:g.top1:g.bottomRight):E?u.addGraphic(F):T?y(W)?u.addGraphic(D):u.addGraphic(F):P?u.addGraphic(g.left):I?x(_)&&x(m)?u.addGraphic(g.top1):u.addGraphic(B):u.addGraphic(g.middle)}else e===G?x(p)||x(y)?u.addGraphic(g.doorSide):(u.addGraphic(g.doorTopShadow),n.add(new Q(new c.Vector(a,r),g.doorTop))):u.addGraphic(g.middle)}}))}));var y=new J(p);n.add(d),n.input.keyboard.on("press",(function(t){"KeyE"!==t.key||y.wave()})),n.input.pointers.primary.on("down",(function(t){y.actions.clearActions();var e=t.worldPos,n=new c.Vector(Math.floor(e.x/Y),Math.floor(e.y/Y));new c.Vector(n.x*Y+16,n.y*Y+16)})),n.add(y),n.currentScene.camera.strategy.lockToActor(y)}))}}),[e]),(0,U.jsx)("canvas",{ref:e})},tt=function(t){t&&t instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(e){var n=e.getCLS,i=e.getFID,r=e.getFCP,o=e.getLCP,a=e.getTTFB;n(t),i(t),r(t),o(t),a(t)}))};e.createRoot(document.getElementById("root")).render((0,U.jsx)(t.StrictMode,{children:(0,U.jsx)($,{})})),tt()}()}();
//# sourceMappingURL=main.845456b8.js.map